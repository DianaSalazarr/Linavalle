var e,t,n,i={10992:(e,t,n)=>{n.d(t,{M$:()=>p,Pt:()=>u,U8:()=>r,Y_:()=>m,jI:()=>c});var i=n(14065),s=n(71291),o=n(45110),a=n(25508);function r(e){return l.apply(this,arguments)}function l(){return(l=(0,i.A)((function*({conversationId:e="0",messageIds:t=[],switchMessageId:n="0"}){yield(0,o.S6)({method:"POST",url:`${a.Jk}/message/put_chat_record`,data:{conversation_id:e,tool_message_id:t,switch_message_id:n}})}))).apply(this,arguments)}function c(e){return d.apply(this,arguments)}function d(){return(d=(0,i.A)((function*(e){return(0,o.S6)({method:"POST",url:`${a.kD}/plugin/detect_lang`,params:(0,s.wH)(),data:{raw_text:e}})}))).apply(this,arguments)}function u(e,t){return h.apply(this,arguments)}function h(){return(h=(0,i.A)((function*(e,t,n=0){return(0,o.S6)({method:"POST",url:`${a.kD}/plugin/translate`,params:(0,s.wH)(),data:{raw_text:e,target_lang:t,source_lang:n}})}))).apply(this,arguments)}function m(e){return g.apply(this,arguments)}function g(){return(g=(0,i.A)((function*(e){return(0,o.S6)({method:"POST",url:`${a.kD}/plugin/revise`,params:(0,s.wH)(),data:{items:e}})}))).apply(this,arguments)}function p(){return v.apply(this,arguments)}function v(){return(v=(0,i.A)((function*(){return(0,o.S6)({method:"POST",url:`${a.kD}/skill/recommend`,params:(0,s.wH)()})}))).apply(this,arguments)}},45110:(e,t,n)=>{n.d(t,{S6:()=>a,sY:()=>o});var i=n(14065),s=n(30510);const o=function(){var e=(0,i.A)((function*(e,t){const{data:n,success:i,error:o}=yield(0,s.cs)({name:"http-request",body:{config:e,options:t}});return i?n:o}));return function(t,n){return e.apply(this,arguments)}}(),a=function(){var e=(0,i.A)((function*(e,t){try{const{data:n,success:i,error:o}=yield(0,s.cs)({name:"http-request",body:{config:e,options:t}});if(!i)throw o;const{code:a,msg:r,data:l}=n;if(void 0!==a&&0!==a)throw new Error(`code invalid error: ${a}, ${r}`);return l}catch(n){return n}}));return function(t,n){return e.apply(this,arguments)}}()},71291:(e,t,n)=>{n.d(t,{Ql:()=>c,wH:()=>l});var i=n(57512),s=n(31774),o=n(45319),a=n(25508);const r=()=>{const{ttWid:e,webId:t=""}=(0,i.bU)();return e?t:"0"},l=()=>{var e;const{country:t,teaWebId:n,teaUuid:l}=(0,i.bU)();return{version_code:s.br,language:(0,o.XQ)(),browser_language:navigator.language,device_platform:a.lx,aid:a.sZ,pkg_type:a.eG,device_id:r(),web_id:null!==(e=null!=n?n:l)&&void 0!==e?e:"0",is_new_user:"0",region:t,sys_region:t,"use-olympus-account":1,samantha_web:"1"}},c=()=>{const e={},{isEnableDebug:t,extEnv:n}=(0,i.MI)();return t&&n&&(e["x-tt-env"]=n,e["production"===a.nD?"x-use-ppe":"x-use-boe"]="1"),e}},39853:(e,t,n)=>{n.d(t,{CN:()=>s,Im:()=>l,O:()=>a,fv:()=>r,nr:()=>o});var i=n(31774);function s(){return"ontouchend"in document}const o=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),a=()=>{var e;return(null===(e=Intl)||void 0===e||null===(e=e.DateTimeFormat())||void 0===e||null===(e=e.resolvedOptions())||void 0===e?void 0:e.timeZone)||""},r=()=>{try{return Boolean(getComputedStyle(document.documentElement||document.body).getPropertyValue("--arc-palette-title"))}catch(e){return!1}};function l(){var e;return i.Hn.some((e=>location.href.includes(e)))||["feishu","lark"].includes(null===(e=window.globalConfig)||void 0===e||null===(e=e.common)||void 0===e?void 0:e.product)}},89618:(e,t,n)=>{n.d(t,{X:()=>Z,P:()=>ee});var i=n(44557),s=n(14065),o=n(85204),a=n(1161),r=n(46487),l=n(32608),c=n(23718),d=n(57512),u=n(72595),h=n(3690),m=n(42402),g=n(33557),p=n(13907),v=n(80196),f=n(12487),_=n(45319),y=n(25508),x=n(79962),b=n(51809),A=n(47113),w=n(27547),S=n(6430),C=n(34539),k=n(10592),I=n(36792),E=n(71967),T=n(26823),j=n(51817),N=n(35746),M=n(11855),L=n(29019),R=n.n(L),P=n(34944),B=n(73648),O=n(97418),D=n(8506),F=n(31774),U=n(44859),H=n(63159);const z=P.EY.create(),q=e=>{const t=`popup-${B.m.getInstance().getHostId()}`;let n=document.getElementById(t);if(n)return e();n=document.createElement("div"),n.style.width="0",n.style.height="0",n.style.position="absolute",n.id=t,n.style.zIndex="99999";const i=n.attachShadow({mode:"open"}),s=document.createElement("body");s.classList.add("cici-ext-container"),i.appendChild(s),document.body.prepend(n),z.config({getPopupContainer:()=>{var e;const n=null===(e=document.getElementById(t))||void 0===e||null===(e=e.shadowRoot)||void 0===e?void 0:e.querySelector("body");return setTimeout((()=>{const e=null==n?void 0:n.querySelector('div.semi-toast-wrapper[id^="toast"]');e&&(e.id=`_${e.id}`)})),n||document.body}}),(0,D.NR)(i,F.QN).finally((()=>e())),(0,B.A)((()=>{var e;null===(e=document.getElementById(t))||void 0===e||e.remove()}))},V=e=>{const t=(0,O.Uk)(),n=(0,M.useCallback)((()=>{window.open(e.infoUrl)}),[e]);return(0,H.jsx)(H.Fragment,{children:(0,H.jsxs)("div",{className:R()(U.A.toastContainer),children:[(0,H.jsx)("div",{className:R()(U.A.text),children:t("flow_web_ext_bookmarks_saved")}),(0,H.jsx)("div",{className:R()(U.A.linkToInfo),onClick:n,children:t("flow_web_ext_bookmarks_saved_view")})]})})},$=()=>{const e=(0,O.Uk)();return(0,H.jsx)(H.Fragment,{children:(0,H.jsx)("div",{className:R()(U.A.toastContainer),children:(0,H.jsx)("div",{className:R()(U.A.text),children:e("bookmarks_remove_complete")})})})},K=()=>{const e=(0,O.Uk)();return(0,H.jsx)(H.Fragment,{children:(0,H.jsx)("div",{className:R()(U.A.toastContainer),children:(0,H.jsx)("div",{className:R()(U.A.loadingText),children:e("flow_web_ext_bookmarks_saving")})})})},W=()=>{const e=(0,O.Uk)();return(0,H.jsx)(H.Fragment,{children:(0,H.jsx)("div",{className:R()(U.A.toastContainer),children:(0,H.jsx)("div",{className:R()(U.A.errorText),children:e("flow_web_ext_bookmarks_failed")})})})};function G(){const e={content:(0,H.jsx)(K,{}),duration:0,showClose:!1,className:R()(U.A.toastLoadingCard),stack:!1,icon:(0,H.jsx)(P.tK,{}),id:"1",zIndex:99999};z.close("1"),q((()=>z.info(e)))}function Y(e,t){return G(),e().then((e=>(function(e){const t={content:(0,H.jsx)(V,{infoUrl:e.infoUrl}),duration:3,showClose:!1,className:R()(U.A.toastCard),stack:!1,id:"2",zIndex:99999};z.close("1"),q((()=>z.success(t)))}({infoUrl:t(e)}),e))).catch((e=>(function(){const e={content:(0,H.jsx)(W,{}),duration:3,showClose:!1,className:R()(U.A.toastErrorCard),stack:!1,id:"3",zIndex:99999};z.close("1"),q((()=>z.error(e)))}(),e)))}function Q(e){return e().then((()=>{!function(){const e={content:(0,H.jsx)($,{}),duration:3,showClose:!1,className:R()(U.A.toastCard),stack:!1,id:"2",zIndex:99999};z.close("1"),q((()=>z.success(e)))}()}))}var J=n(38062),X=n(22315);function Z(e){if((0,d.TK)("authInfo").isAuthenticated)switch(e.collectionType){case b.X.TranslateResult:case b.X.ExplainResult:case b.X.TextFragment:!function(e){const{actionMessages:t,currentAction:n,messageCursor:i,boxVisible:s}=k.t_.getState();if(s){var o,a,r;const{messages:s}=C.P.getState(),l=null!==(a=(null!==(o=t[n])&&void 0!==o?o:[])[i])&&void 0!==a?a:"",{text:c="",body:d,originParam:u}=s[l]||{};if(void 0===(null==d||null===(r=d.message)||void 0===r?void 0:r.message_id))return;n===X.EU.explain?((0,w.o2)(e.collectFrom,w.p6.ExplainResult),Y((()=>(0,I.Lv)(d.message.message_id,{selectionText:(null==u?void 0:u.text)||"",explainedText:(0,p.q4)(c)})),(e=>`${y.Vl}/${e.id}`)).then((t=>{(0,w.mL)(e.collectFrom,void 0!==t.id,w.p6.ExplainResult,`${t.id}`)})).catch((()=>{(0,w.mL)(e.collectFrom,!1,w.p6.ExplainResult)}))):((0,w.o2)(e.collectFrom,w.p6.TranslateResult),Y((()=>{var e;return(0,I.CE)(d.message.message_id,{selectionText:(null==u?void 0:u.text)||"",translate_lang:(null==d||null===(e=d.message)||void 0===e||null===(e=e.ext)||void 0===e?void 0:e.translate)||(0,_.XQ)(),translatedText:(0,p.q4)(c)})}),(e=>`${y.Vl}/${e.id}`)).then((t=>{(0,w.mL)(e.collectFrom,void 0!==t.id,w.p6.TranslateResult,`${t.id}`)})).catch((()=>{(0,w.mL)(e.collectFrom,!1,w.p6.TranslateResult)})))}else!function(e){const t=k.t_.getState().simpleSelectionBaseInfo;if(void 0===t.anchorOffset)return;const n={contextText:t.contextText,selectionText:t.text,anchorOffset:t.anchorOffset};(0,w.o2)(e.collectFrom,w.p6.textfragment),Y((()=>(0,I.gP)(n)),(e=>`${y.Vl}/${e.id}`)).then((t=>{(0,w.mL)(e.collectFrom,void 0!==t.id,w.p6.textfragment,`${t.id}`)})).catch((()=>{(0,w.mL)(e.collectFrom,!1,w.p6.textfragment)}))}(e)}(e);break;case b.X.SearchResult:!function(e){const t=e.messageId;if(void 0===t||void 0===e.localMessageId)return;(0,w.o2)(e.collectFrom,w.p6.searchresult);const n=C.P.getState().messages[e.localMessageId],{text:i=""}=n||{},s={searchText:e.userInput||"",generatedText:i};Y((()=>(0,I.Qx)(t,s)),(e=>`${y.Vl}/${e.id}`)).then((t=>{(0,w.mL)(e.collectFrom,void 0!==t.id,w.p6.searchresult,`${t.id}`)})).catch((()=>{(0,w.mL)(e.collectFrom,!1,w.p6.searchresult)}))}(e);break;case b.X.Web:te(e);break;case b.X.Pdf:ne(e);break;case b.X.VideoSummary:oe(e);break;case b.X.SocialWebCard:!function(e){const{getSocialWebCardContent:t}=e;if(!t)return;Y((0,s.A)((function*(){const e=yield t();if(!e)throw new Error("\u83b7\u53d6\u793e\u4ea4\u5361\u7247\u6536\u85cf\u4fe1\u606f\u51fa\u9519");const{text_content:n,html_content:i,cover_image_url:s="",source_url:o,content_height:a,content_width:r,body_content:l,content_img_key:c=""}=e;return yield(0,I.y6)({text_content:n,html_content:(0,m.NS)(i,a,r),cover_image_url:s,body_content:l.substr(0,500),content_img_key:c},o)})),(e=>ae(e.id.toString())))}(e)}else(0,N.DT)({trackMeta:{previous_page:"web",login_entrance:"web"}})}function ee(e){Q((()=>(0,I.rV)(e))).finally((()=>{h.A.emit("onWebpageSaved",void 0)}))}const te=function(){var e=(0,s.A)((function*(e){if((0,w.o2)(e.collectFrom,w.p6.web),(0,o.OM)())return void function(e){se.apply(this,arguments)}(e);const t={text_content:"",html_content:"",title:"",dir:"",description:"",cover_image_url:""};let n;if(e.getWebContent||(n=yield(0,g.q)(document),n))Y((0,s.A)((function*(){let i,s;if(e.getWebContent){const n=yield e.getWebContent();if(!n)throw new Error("\u83b7\u53d6\u7f51\u7ad9\u6536\u85cf\u4fe1\u606f\u51fa\u9519");t.text_content=n.text_content,t.html_content=(0,m.NS)(n.html_content,n.content_height,n.content_width),t.title=n.title,t.dir=n.dir,t.cover_image_url=n.cover_image_url,t.description=n.description,i=n.source_url}else if(n){const{imageUrl:e,desc:i}=yield(0,N.l_)();t.text_content=n.textContent,t.html_content=n.content,t.title=n.title,t.dir=n.dir,t.cover_image_url=e,t.description=i}s=yield(0,E.K)(c.e.Web,t.text_content);const o=(0,a.zV)(yield(0,I.N0)(),"image/jpeg"),r=yield(0,f.r)(o);return t.snapshot_img_key=r,yield(0,I.aZ)(t,s,i)})),(e=>`${y.Vl}/${e.id}`)).then((t=>{h.A.emit("onWebpageSaved",t.id),(0,w.mL)(e.collectFrom,void 0!==t.id,w.p6.web,`${t.id}`)})).catch((()=>{(0,w.mL)(e.collectFrom,!1,w.p6.web)}));else{(0,u.Ay)(location.href)&&(0,u.ow)()&&!window.location.protocol.startsWith("file:")&&ne(e)}}));return function(t){return e.apply(this,arguments)}}();function ne(e){(0,w.o2)(e.collectFrom,w.p6.pdf),Y((0,s.A)((function*(){const e=window.location.pathname.split("/").pop();return yield(0,I.s6)({url:window.location.href,filename:e||"pdf"})})),(e=>ae(e.id.toString()))).then((t=>{h.A.emit("onWebpageSaved",t.id),(0,w.mL)(e.collectFrom,void 0!==t.id,w.p6.pdf,`${t.id}`)})).catch((()=>{(0,w.mL)(e.collectFrom,!1,w.p6.pdf)}))}function ie(e,t=!1){const{sendMessage:n}=C.P.getState(),s=(0,d.TK)("uiLanguage");let o="",a="";const{title:l}=S.e.getState(),c={title:l,url:location.href,transcript_list:e},u={text:location.href,prompt:X.EU.youtube,browser_language:(0,r.wz)(s),current_page:(0,A.M5)(location.href),scene:x.sJ.youtube_click,sec_scene:x._o.youtube_click_summarize};return o=n((0,i.A)((0,i.A)({},u),{},{browser_youtube_transcript:{browser_youtube_summary_transcript:JSON.stringify(c)}})),t||(a=n((0,i.A)((0,i.A)({},u),{},{browser_youtube_transcript:{browser_youtube_timeline_transcript:JSON.stringify(c)}}))),{videoSummaryId:o,videoHighlightsId:a}}function se(){return se=(0,s.A)((function*(e){const t=T._1.getVideoSummaryMsgBlock(),n=T._1.getTranscriptData();let{videoSummaryId:i,videoHighlightsId:o}=t;const{videoId:a,title:r}=S.e.getState();if(G(),!T._1.hasTranscript()||i&&o){if(!T._1.hasTranscript()){const e=yield(0,J.B9)(),t=ie([{offset:0,duration:100,text:(null==e?void 0:e.textContent)||r}],!0);i=t.videoSummaryId,o=t.videoHighlightsId}}else{const e=ie(T._1.getTranscriptData());i=e.videoSummaryId,o=e.videoHighlightsId,T._1.updateVideoSummaryId(i),T._1.updateVideoHighlightsId(o)}const c=function(){var t=(0,s.A)((function*(){var t,s;const{messages:d}=C.P.getState();let u="",h="";if(i){const{isDone:e,text:t=""}=d[i]||{},n={isDone:!0,text:""},{isDone:s,text:a=""}=o&&d[o]||n;if(u=t,h=a,!e||!s)return void setTimeout((()=>c()),1e3)}const m=i&&(null===(t=d[i])||void 0===t||null===(t=t.body)||void 0===t||null===(t=t.message)||void 0===t?void 0:t.message_id)||"",g=o&&(null===(s=d[o])||void 0===s||null===(s=s.body)||void 0===s||null===(s=s.message)||void 0===s?void 0:s.message_id)||"",p={summary:u,summary_msg_id:m||"",videoParams:{video_type:(0,j.Zv)(),video_url:yield(0,j.PT)(a),title:r,timeline:(0,l.Bq)(h)||[],cover_url:(0,j.mJ)(a),timeline_msg_id_str:g||"",transcript:n?JSON.stringify(n):"",highlights_message_id:o}};oe({collectFrom:e.collectFrom,collectionType:b.X.VideoSummary,videoSummaryResult:p})}));return function(){return t.apply(this,arguments)}}();c()})),se.apply(this,arguments)}function oe(e){if(!e.videoSummaryResult)return;const t=e.videoSummaryResult;(0,w.o2)(w.vP.video_page_summarize,w.p6.videosummary),Y((0,s.A)((function*(){var e,n;null!=t&&null!==(e=t.videoParams)&&void 0!==e&&null!==(e=e.cover_url)&&void 0!==e&&e.startsWith("http")&&(t.videoParams.cover_url=yield(0,v.Vv)(null==t||null===(n=t.videoParams)||void 0===n?void 0:n.cover_url));return yield(0,I.Yb)(t.summary,t.summary_msg_id,t.videoParams)})),(e=>ae(e.id.toString()))).then((e=>{h.A.emit("onWebpageSaved",e.id),(0,w.mL)(w.vP.video_page_summarize,void 0!==e.id,w.p6.videosummary,`${e.id}`)})).catch((()=>{(0,w.mL)(w.vP.video_page_summarize,!1,w.p6.videosummary)}))}const ae=e=>`${y.Vl}/${e}`},42402:(e,t,n)=>{n.d(t,{NS:()=>y,dp:()=>f,cQ:()=>m,gs:()=>h,vg:()=>_});var i=n(14065),s=n(95514);const o=new Map,a=["META","STYLE","SCRIPT"];var r=n(14144),l=n(31774),c=n(80196),d=n(12487),u=n(64498);const h=()=>{var e;return(null===(e=document.head.querySelector("title"))||void 0===e?void 0:e.innerText)||""},m=(e,t)=>{if(!e||!t)return null;let n=e.parentElement;for(;n;){if(n.matches(t))return n;n=n.parentElement}return null},g=e=>{let t=e;return e.startsWith("webkit")&&(t=`-${t}`),t.replace(/([A-Z])/g,(function(e){return`-${e.toLowerCase()}`}))},p=function(){var e=(0,i.A)((function*(e,t){if(!e)return"";try{const n=t.get(e);if(n)return n;const i=yield(0,c.n_)(e);if(null!=i&&i.blob){const n=yield(0,d.r)(i.blob);return t.set(e,n),n}return""}catch(n){return(0,r.z3)("uploadImage error",n),""}}));return function(t,n){return e.apply(this,arguments)}}(),v=function(){var e=(0,i.A)((function*(e,t,n,i,s){try{var c;const{tagName:r}=e;if(a.includes(r))return;const d=e.getAttribute("class");if(null!=d&&d.includes(l.AC))return;Object.keys(e.dataset||{}).forEach((t=>{e.removeAttribute(`data-${g(t)}`)}));const h=window.getComputedStyle(t);if("none"===h.display)return void s.push(e);if(Object.entries(h).forEach((t=>{const[n,i]=t;if(!i||!isNaN(Number(n)))return;const s=(e=>{const t=o.get(e);if(t)return t;const n=document.createElement("div"),i=n.attachShadow({mode:"open"}),s=document.createElement(e);s.style.cssText="color: initial;",i.appendChild(s),"A"===e&&s.setAttribute("href","https://www.ciciai.com/browser-extension/landing"),document.body.insertBefore(n,document.body.firstElementChild);const a=new Map,r=window.getComputedStyle(s);return Object.entries(r).forEach((e=>{const[t,n]=e;n&&isNaN(Number(t))&&a.set(t,n)})),o.set(e,a),n.remove(),a})(r).get(n);s!==i&&(e.style[g(n)]=i)})),null!==(c=e.style.backgroundImage)&&void 0!==c&&c.includes("url")){const t=e.style.backgroundImage.substring(5,e.style.backgroundImage.length-2),n=yield p(t,i);n&&e.setAttribute(u.$_,n)}if("IMG"===r){const{src:t}=e,n=yield p(t,i);n&&e.setAttribute(u.$_,n)}else if("A"===r&&"A"===t.tagName)e.setAttribute("href",null==t?void 0:t.href);else if("SVG"===r)return;for(let o=0;o<t.children.length&&o<e.children.length;o++)n.pushTask((()=>new Promise(((a,r)=>{v(e.children[o],t.children[o],n,i,s).then(a).catch(r)}))))}catch(d){(0,r.z3)(d)}}));return function(t,n,i,s,o){return e.apply(this,arguments)}}(),f=function(){var e=(0,i.A)((function*(e,t=!0){const n=new Map,i=[],o=e.cloneNode(!0);if(yield new Promise((t=>{const a=new s.E(t);a.pushTask((()=>new Promise(((t,s)=>{v(o,e,a,n,i).then(t).catch(s)})))),a.loop()})),i.forEach((e=>e.remove())),o.querySelectorAll(`[class*=${l.AC}]`).forEach((e=>e.remove())),a.forEach((e=>o.querySelectorAll(e.toLocaleLowerCase()).forEach((e=>e.remove())))),t){const e=document.createElement("div");return e.appendChild(o),e}return o}));return function(t){return e.apply(this,arguments)}}(),_=e=>{null!=e&&e.style&&(e.style.height="unset",e.style.minHeight="unset",e.style.blockSize="unset",e.style.minBlockSize="unset")},y=(e,t,n)=>{const i=document.createElement("div");i.innerHTML='<iframe\n  scrolling="no"\n  frameBorder="no"\n  allowFullScreen="true"\n  sandbox="allow-same-origin allow-scripts allow-forms allow-popups"></iframe>';const s=i.querySelector("iframe");return s?(s.style.width="100%",s.style.height=`${t}px`,s.style.width=`${n}px`,s.srcdoc=`<html>\n        <head>\n          <style>\n            * {\n              cursor: unset !important;\n            }\n            a {\n              cursor: pointer !important;\n            }\n          </style>\n        </head>\n        <body style="margin: 0;padding: 0;">\n        ${e}\n        </body>\n      </html>`,i.innerHTML):e}},31774:(e,t,n)=>{n.d(t,{$9:()=>v,AC:()=>w,AJ:()=>y,BW:()=>C,Be:()=>S,Cp:()=>a,EP:()=>r,GW:()=>x,Hn:()=>E,JE:()=>l,M0:()=>f,OD:()=>A,Ow:()=>k,QN:()=>s,R3:()=>u,U6:()=>p,Yq:()=>m,aJ:()=>I,aS:()=>b,br:()=>o,hs:()=>g,j0:()=>d,ly:()=>h,o$:()=>i,o2:()=>c,tm:()=>_});const i="cici_host_style",s="static/css/content_list.json",o=20650,a="/browser-extension",r=`${a}/login`,l=`${a}/welcome`,c=`${a}/landing`,d=`${a}/uninstall`,u="Cici",h=`${u}-ai-csui`,m=`${u}-ai-assistant`,g=`${u}-ai-deep-search-assistant`,p=`${u}-ai-search-engine-assistant`,v=`${u}-ai-video-summary-assistant`,f=`${u}-ai-video-summary-assistant-fs-sidebar`,_=`${u}-ai-immersion-btn`,y=`${u}-ai-mail-assistant`,x=`${u}-ai-revision-highlighter`,b=`${u}-ai-revision-popup-card`,A=`${u}-ai-pdf-assistant`,w=`${u}-ai-collection-assistant`,S="710022013",C="710012001",k="2147483647",I="86",E=["larkoffice.com/wiki","larkoffice.com/docx","feishu.cn/wiki","feishu.cn/docx"]},8506:(e,t,n)=>{n.d(t,{Ig:()=>_,Ku:()=>y,LE:()=>k,NR:()=>m,QN:()=>A,V6:()=>w,VT:()=>h,XX:()=>f,YB:()=>p,f9:()=>g,mn:()=>x,ow:()=>b});var i=n(14065),s=n(9012),o=n(11855),a=n(75541),r=n(14144),l=n(31774),c=n(39853),d=n(73648);function u(e){e.stopPropagation()}const h=e=>{const t=document.createElement(e);var n;t.id=l.Yq,n=t,["click","copy","cut","paste","keydown","keyup","keypress"].forEach((e=>{n.addEventListener(e,u,!1)}));const i=t.attachShadow({mode:"open"}),s=document.createElement("div");s.id="ciciai-shadow-container",s.classList.add("cici-ext-container"),s.style.zIndex=(0,c.Im)()?l.aJ:l.Ow,s.style.position="absolute";let o=0,a=0;if("relative"===window.getComputedStyle(document.body).position){const e=document.body.getBoundingClientRect(),t=document.documentElement.getBoundingClientRect(),n={top:t.top-e.top,left:t.left-e.left};o+=n.top,a+=n.left}return s.style.top=`${o}px`,s.style.left=`${a}px`,s.style.visibility="visible",i.appendChild(s),{shadowHost:t,shadowRoot:i,shadowContainer:s}};const m=function(){var e=(0,i.A)((function*(e,t){try{const n=yield fetch(chrome.runtime.getURL(t)),i=(yield n.json()).content_css,s=yield Promise.all(i.map((e=>fetch(chrome.runtime.getURL(e))))),o=yield Promise.all(s.map((e=>e.text()))),a=o.join("\n"),r=document.createElement("style");r.className=l.o$,r.textContent=a,e.prepend(r)}catch(n){console.error(`Error applying styles: ${n.message}`)}}));return function(t,n){return e.apply(this,arguments)}}();function g(e){e.querySelectorAll(`.${l.o$}`).forEach((e=>e.remove()))}const p=e=>{document.body.appendChild(e)};let v;const f=(e,t)=>{if(v)try{v.unmount()}catch(n){(0,r.Rm)("unmount fail",n)}v=(0,a.createRoot)(e),v.render(o.createElement(t)),(0,d.A)((()=>{var e;null===(e=v)||void 0===e||e.unmount(),v=void 0}))};function _(e,t){var n;const i=new ClipboardEvent("paste",{clipboardData:new DataTransfer,bubbles:!0,cancelable:!0});null===(n=i.clipboardData)||void 0===n||n.setData("text/plain",e),t.dispatchEvent(i)}function y(e){return e&&("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName)}function x(e){if(!e.isContentEditable){let n=e.parentElement;for(let i=0;i<10&&n;i++){var t;if(null!==(t=n)&&void 0!==t&&t.isContentEditable){e=n;break}n=n.parentElement}}if(e.isContentEditable){let t=e;for(;null!==(n=t)&&void 0!==n&&null!==(n=n.parentElement)&&void 0!==n&&n.isContentEditable;){var n;t=t.parentElement}return t}return null}function b(e){const t=getComputedStyle(e);return!("0"===t.opacity||"none"===t.display||"hidden"===t.visibility)}function A(e){return("INPUT"===e.nodeName&&["text","url","search","password"].includes(e.type)||"TEXTAREA"===e.nodeName)&&!(e.disabled||e.readOnly)}function w(e,t){let n=null,i=null;const o=(0,s.A)(t,"maxWait",1e3);function a(){n&&(clearInterval(n),n=null)}return new Promise((r=>{const l=()=>{const n=(0,s.A)(t,"wrapper",document).querySelector(e);n&&(a(),i&&(clearTimeout(i),i=null),r(n))};n=window.setInterval(l,100),i=window.setTimeout((()=>{a(),r(null)}),o),l()}))}const S="Cici-ai-assistant",C="doubao-ai-assistant",k=e=>[S,C].includes(e)},97946:(e,t,n)=>{n.d(t,{_:()=>i});const i={windowId:-1,get isInSidePanel(){return location.href.startsWith(chrome.runtime.getURL("side_panel.html"))}}},7332:(e,t,n)=>{n.d(t,{A:()=>o});var i=n(11855),s=n(47421);const o=()=>(0,i.useContext)(s.A)},47421:(e,t,n)=>{n.d(t,{A:()=>i});const i=(0,n(11855).createContext)(null)},33186:(e,t,n)=>{n.d(t,{Ay:()=>c,N:()=>a,Vk:()=>l,nW:()=>o});var i=n(14065),s=n(11855);const o=e=>/^https:\/\/mail\.google\.com\/mail\/u\/\d+\//.test(e),a=e=>{if("gmail"!==e)return[];const t=[],n=document.querySelectorAll('[class="btC"]');for(const s of n){var i;const e=s.parentElement;if(!e)continue;const n=null===(i=e.closest("tr"))||void 0===i||null===(i=i.previousElementSibling)||void 0===i||null===(i=i.querySelector('[hidefocus="true"]'))||void 0===i?void 0:i.parentElement;n&&t.push([e,n])}return t},r=e=>{const t='[class="btC"]';return!(!e.matches(t)&&!e.matches(`:has(${t})`))},l=(0,s.createContext)(null),c=e=>{if(o(e)){return{name:"gmail",watchMailWritable:e=>{const t=new MutationObserver((function(t){for(const n of t)"childList"===n.type&&n.addedNodes.length>0&&n.addedNodes.forEach(function(){var t=(0,i.A)((function*(t){yield new Promise((e=>setTimeout(e,50))),t instanceof HTMLElement&&r(t)&&e()}));return function(e){return t.apply(this,arguments)}}())}));return t.observe(document.body,{childList:!0,subtree:!0}),()=>{t.disconnect()}}}}return null}},17043:(e,t,n)=>{n.d(t,{Iq:()=>d,UL:()=>c});var i=n(44557),s=n(14065),o=n(33451),a=n(14144),r=n(42325);const l=["tabId"];function c(e,t=1e4){const{tabId:n}=e,i=(0,o.A)(e,l);return Promise.race([new Promise((e=>{try{chrome.tabs.sendMessage(n,i,(t=>{var n;chrome.runtime.lastError?("tab-activated"!==i.name&&(0,a.z3)(`[ms][bg][runtime.lastError]${i.name}`,chrome.runtime.lastError),e({success:!1,error:new Error(`[${i.name}]${null===(n=chrome.runtime.lastError)||void 0===n?void 0:n.message}`),data:t})):null!=t&&t.__hasError?e({success:!1,error:new Error(t.errorMessage)}):e({success:!0,data:t})}))}catch(t){e({success:!1,error:t})}})),new Promise((e=>{setTimeout((()=>e({success:!1,error:new Error("timeout")})),t)}))])}function d(e){return u.apply(this,arguments)}function u(){return(u=(0,s.A)((function*(e,t=1e4){const n=yield(0,r.e6)();if(!n)return Promise.resolve({success:!1,data:{}});const s="string"==typeof e?{name:e}:e;return c((0,i.A)({tabId:n.id},s),t)}))).apply(this,arguments)}},30510:(e,t,n)=>{n.d(t,{Iq:()=>s.Iq,UL:()=>s.UL,cs:()=>i.c});var i=n(69366),s=n(17043)},74215:(e,t,n)=>{n.d(t,{F:()=>r,c:()=>l});var i=n(14065),s=n(10633),o=n(91689),a=n(14144);const r=new class{constructor(){var e,t;(0,s.A)(this,"handlers",{}),(0,s.A)(this,"interceptors",[]),null===(e=chrome)||void 0===e||null===(e=e.runtime)||void 0===e||null===(e=e.onMessage)||void 0===e||null===(t=e.addListener)||void 0===t||t.call(e,this.onMessage.bind(this)),this.interceptors=[],this.handlers={}}onMessage(e,t,n){let s=!1;this.interceptors.forEach((i=>{s=s||Boolean(i.onMessage(e,t,n))}));const o=this.handlers[e.name];var r;return(0,a.Rm)(`[runtime] onMessage -> [${e.name}][${o?"yes":"no"}] `,e.body||""),!!o&&(!o.preCheck||null!==(r=o.preCheck)&&void 0!==r&&r.call(o,t)?((0,i.A)((function*(){try{const i=yield o.handle(e.body,t);n(i)}catch(i){n({__hasError:!0,errorMessage:`${i.message}[${e.name}]`})}}))(),!0):s)}supportExternal(){var e,t;null===(e=chrome)||void 0===e||null===(e=e.runtime)||void 0===e||null===(e=e.onMessageExternal)||void 0===e||null===(t=e.addListener)||void 0===t||t.call(e,this.onMessage.bind(this))}register(e){const{name:t}=e||{};t&&(this.handlers[t]&&(0,a.z3)(`[runtime] handler name[${t}] duplicated !`),(0,a.Rm)(`[runtime] register handler for event: [${t}]`),this.handlers[t]=e)}unregister(e){delete this.handlers[e]}injectInterceptor(e){this.interceptors.push(e)}destroy(){this.handlers={},this.interceptors=[];try{chrome.runtime.onMessage.removeListener(this.onMessage)}catch(e){}}},l=e=>{const t=(0,o.A)(e)?e:[e];return t.forEach((e=>{r.register(e)})),()=>{t.forEach((e=>{r.unregister(e.name)}))}}},74901:(e,t,n)=>{n.d(t,{F8:()=>_});var i=n(44557),s=n(10633),o=n(68008),a=n(19425),r=n(76129),l=n(67122),c=n(24686),d=n(15210),u=n(26220),h=n(35580),m=n(22419),g=n(74215),p=n(14144),v=n(42325),f=n(12201);const _=new class{constructor(e){var t,n,d,_,y,x,b,A,w,S;(0,s.A)(this,"jsMonitor",void 0),(0,s.A)(this,"promiseMonitor",void 0),(0,s.A)(this,"fetchMonitor",void 0),(0,s.A)(this,"crashMonitor",void 0),(0,s.A)(this,"bid",void 0),(0,s.A)(this,"crashLog",void 0),(0,s.A)(this,"region",void 0),(0,s.A)(this,"_options",void 0),(0,s.A)(this,"client",void 0),(0,s.A)(this,"prepared",!1),(0,s.A)(this,"start",((e={})=>{if(self){const t=(0,c.m)(),n=(0,v.HF)();this.client.init((0,i.A)({env:"public",release:n,version:n,bid:this.bid,transport:{get:t.get,post:t.post}},e)),this.client.start(),this.runBgMonitors(),this.addMessageListeners(),(0,m.sN)(this),this.prepared=!0}})),(0,s.A)(this,"config",(e=>{this.client.config(e)})),(0,s.A)(this,"runBgMonitors",(()=>{var e;(this.jsMonitor&&new a.A(this.region),this.promiseMonitor&&new o.A(this.region),this.fetchMonitor)&&new r.A({region:this.region,rule:null===(e=this._options.plugins)||void 0===e?void 0:e.fetchInterceptRule});this.crashMonitor&&new l.A(this.region,this.crashLog)})),(0,s.A)(this,"addMessageListeners",(()=>{const e=this,t={name:"slardar-message",handle:t=>{const{type:n,data:i}=t||{};switch(n){case h.O4.CONTENT_EVENT:e.sendEvent(i);break;case h.O4.CONTENT_LOG:case h.O4.CONTENT_PERF_EVENT:e.sendLog(i)}}};(0,g.c)(t)})),(0,s.A)(this,"sendEvent",(e=>{var t,n;this.prepared||(0,p.z3)("slardar client must start first"),null===(t=(n=this.client).sendEvent)||void 0===t||t.call(n,e),(0,f.v)({type:"slardar",payload:e,action:"event"})})),(0,s.A)(this,"sendLog",(e=>{var t,n;this.prepared||(0,p.z3)("slardar client must start first"),null===(t=(n=this.client).sendLog)||void 0===t||t.call(n,e),(0,f.v)({type:"slardar",payload:e,action:"log"})})),this.jsMonitor=null===(t=null==e||null===(n=e.plugins)||void 0===n?void 0:n.jsMonitor)||void 0===t||t,this.promiseMonitor=null===(d=null==e||null===(_=e.plugins)||void 0===_?void 0:_.promiseMonitor)||void 0===d||d,this.fetchMonitor=null===(y=null==e||null===(x=e.plugins)||void 0===x?void 0:x.fetchMonitor)||void 0===y||y,this.crashMonitor=null===(b=null==e||null===(A=e.plugins)||void 0===A?void 0:A.crashMonitor)||void 0===b||b,this.bid=e.bid,this.crashLog=null!==(w=null==e||null===(S=e.log)||void 0===S?void 0:S.crashLog)&&void 0!==w&&w,this.region=(0,u.J)(),this._options=e,this.client=(0,u.K)(this.region)}configExtraInfo(e){d.A.recordExtraInfo(e)}}({bid:"flow_web_ext",plugins:{promiseMonitor:!1,crashMonitor:!1}})},72595:(e,t,n)=>{n.d(t,{Ay:()=>a,Er:()=>o,ow:()=>s});var i=n(11855);const s=()=>{const e=document.querySelector("embed");return"EMBED"===(null==e?void 0:e.nodeName)&&"application/pdf"===(null==e?void 0:e.type)},o=(0,i.createContext)(null),a=e=>(e=>/^https:\/\/arxiv\.org\/abs\/\d+\.\d+/.test(e))(e)?{name:"arxiv",prevNodeQuery:"a.download-pdf"}:s()?{name:"pdf"}:null},20409:(e,t,n)=>{n.d(t,{gw:()=>i});n(11855);window.location.href;const i=e=>/^https:\/\/www\.xiaoyuzhoufm\.com\/episode\/\w+/.test(e)},22315:(e,t,n)=>{n.d(t,{AA:()=>m,EU:()=>i,HO:()=>s,Hh:()=>u,I8:()=>p,R1:()=>o,Tz:()=>c,WN:()=>h,Xt:()=>g,YN:()=>_,aX:()=>l,em:()=>y,fS:()=>v,tE:()=>f,y3:()=>r});var i={search:"search",read:"read",explain:"explain",translate:"translate",summarize:"summarize",grammar:"grammar",rewrite:"rewrite",ask:"browser_ask",browser_explain:"browser_explain",youtube:"youtube",mail:"browser_mail",copy:"copy",browser_plugin_info:"browser_plugin_info",input_skill:"input_skill",collect:"collect"};[{cnName:"\u200b\u4e2d\u6587\u200b",enName:"Chinese\u200b",name:"\u4e2d\u6587",lang:"zh"},{cnName:"\u82f1\u6587\u200b",enName:"English\u200b",name:"English",lang:"en"},{cnName:"\u65e5\u8bed\u200b",enName:"Japanese\u200b",name:"\u65e5\u672c\u8a9e",lang:"ja"},{cnName:"\u97e9\u8bed\u200b",enName:"Korean\u200b",name:"\ud55c\uad6d\uc5b4",lang:"ko"},{cnName:"\u6cd5\u8bed\u200b",enName:"French\u200b",name:"Fran\xe7ais",lang:"fr"},{cnName:"\u5fb7\u8bed\u200b",enName:"German\u200b",name:"Deutsch",lang:"de"},{cnName:"\u897f\u73ed\u7259\u8bed\u200b",enName:"Spanish\u200b",name:"Espa\xf1ol",lang:"es"},{cnName:"\u4fc4\u8bed\u200b",enName:"Russian\u200b",name:"\u0420\u0443\u0441\u0441\u043a\u0438\u0439",lang:"ru"},{cnName:"\u610f\u5927\u5229\u8bed\u200b",enName:"Italian\u200b",name:"Italiano",lang:"it"},{cnName:"\u8461\u8404\u7259\u8bed\u200b",enName:"Portuguese\u200b",name:"Portugu\xeas",lang:"pt"},{cnName:"\u8377\u5170\u8bed\u200b",enName:"Dutch\u200b",name:"Nederlands",lang:"nl"},{cnName:"\u745e\u5178\u8bed\u200b",enName:"Swedish\u200b",name:"Svenska",lang:"sv"},{cnName:"\u4e39\u9ea6\u8bed\u200b",enName:"Danish\u200b",name:"Dansk",lang:"da"},{cnName:"\u632a\u5a01\u8bed\u200b",enName:"Norwegian\u200b",name:"Norsk",lang:"no"},{cnName:"\u6ce2\u5170\u8bed\u200b",enName:"Polish\u200b",name:"Polski",lang:"pl"},{cnName:"\u5e0c\u814a\u8bed\u200b",enName:"Greek\u200b",name:"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",lang:"el"},{cnName:"\u571f\u8033\u5176\u8bed\u200b",enName:"Turkish\u200b",name:"T\xfcrk\xe7e",lang:"tr"},{cnName:"\u8d8a\u5357\u8bed\u200b",enName:"Vietlangse\u200b",name:"Ti\u1ebfng Vi\u1ec7t",lang:"vi"},{cnName:"\u6cf0\u8bed\u200b",enName:"Thai\u200b",name:"\u0e44\u0e17\u0e22",lang:"th"},{cnName:"\u5370\u5730\u8bed\u200b",enName:"Hindi\u200b",name:"\u0939\u093f\u0928\u094d\u0926\u0940\u200b",lang:"hi"}].reduce(((e,t)=>(e[t.lang]=t.name,e)),{});const s=[{id:i.ask,prompt:"",name:"flow_web_ext_action_ask",icon:"cici"},{id:i.explain,prompt:"\u89e3\u91ca\u8fd9\u6bb5\u6587\u672c: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_explain",icon:"explain"},{id:i.translate,prompt:"\u628a\u4e0b\u9762\u8fd9\u6bb5\u6587\u672c\u7ffb\u8bd1\u6210\u76ee\u6807\u8bed\u8a00: $[lang]\u3002\u9700\u8981\u7ffb\u8bd1\u7684\u5185\u5bb9\u662f: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_translate",icon:"IconTranslateOutline"},{id:i.summarize,prompt:"\u603b\u7ed3\u4ee5\u4e0b\u5185\u5bb9: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_summarize",icon:"summarize"},{id:i.grammar,prompt:"\u6821\u5bf9\u5e76\u7ea0\u6b63\u8fd9\u6bb5\u6587\u5b57: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_grammar",icon:"check"},{id:i.rewrite,prompt:"\u91cd\u65b0\u8868\u8ff0\u8fd9\u6bb5\u6587\u5b57, \u4f7f\u8fd9\u6bb5\u6587\u5b57\u8868\u8ff0\u7684\u66f4\u52a0\u5408\u7406: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_rewrite",icon:"rewrite"},{id:i.copy,prompt:"",name:"message_long_press_copy",icon:"copy"},{id:i.collect,prompt:"",name:"flow_web_ext_action_bookmarks",icon:"collect",options:{brand:"Cici"}}],o=[i.ask,i.grammar,i.rewrite],a=[i.grammar,i.rewrite,i.explain,i.translate,i.copy],r=new Set([i.ask]),l=[i.explain,i.translate,i.collect],c=[i.copy],d=new Set([i.summarize]),u=(e=[])=>s.filter((t=>l.includes(t.id)&&!d.has(t.id)&&!e.includes(t.id))),h=(e=[])=>s.filter((t=>c.includes(t.id)&&!d.has(t.id)&&!e.includes(t.id))),m=[i.grammar,i.rewrite,i.collect],g=[i.explain,i.translate,i.copy],p=(e=[])=>s.filter((t=>m.includes(t.id)&&!d.has(t.id)&&!e.includes(t.id))),v=(e=[])=>s.filter((t=>g.includes(t.id)&&!d.has(t.id)&&!e.includes(t.id))),f=e=>(e||s).filter((e=>a.includes(e.id))),_=s.reduce(((e,t)=>(e[t.id]=t,e)),{});const y=e=>!_[e]},69327:(e,t,n)=>{n.d(t,{Ay:()=>o,mn:()=>s});var i=n(11855);const s=(0,i.createContext)(null),o=e=>/^https:\/\/www.baidu.com\//.test(e)?{name:"baidu",inputQuery:["input[name='wd']"],searchTag:"#searchTag",sidebarContainerQuery:"#content_right",searchParam:"wd",watchRouteChange:e=>{const t=document.getElementById("wrapper_wrapper");if(!t)return;const n=new MutationObserver((function(t){for(const n of t){if("childList"!==n.type)break;for(const t of n.addedNodes)if("container"===(null==t?void 0:t.id))return void e()}}));return n.observe(t,{childList:!0}),()=>{n.disconnect()}}}:/^https:\/\/www.google.com?(?:.\w+)?\/search\?/.test(e)?{name:"google",inputQuery:["input[name='q']","textarea[name='q']"],sidebarContainerQuery:"#rhs",searchParam:"q",customAppend(){if("lcl"===((e,t)=>new URL(t).searchParams.get(e))("tbm",window.location.href))return null;let e=document.querySelector(this.sidebarContainerQuery);if(!e){const t=document.querySelector("#rcnt");t&&(e=document.createElement("div"),e.id="rhs",t.appendChild(e))}return e}}:/^https:\/\/so.toutiao.com\/search\?/.test(e)?{name:"toutiao",inputQuery:["input[type='search']"],sidebarContainerQuery:".s-side-list",searchParam:"keyword",disabled:()=>!0}:/^https:\/\/\w+.bing.com\/search\?/.test(e)?{name:"bing",inputQuery:["[name='q']"],sidebarContainerQuery:"#b_context",searchParam:"q",containerStyle:{minWidth:470,marginLeft:-20},getPageContent:()=>[]}:null},74375:(e,t,n)=>{n.d(t,{RX:()=>N,qZ:()=>M});var i=n(14065),s=n(48485),o=n(59585),a=n.n(o),r=n(53713),l=n(46872),c=n(58020),d=n(48456),u=n(12893),h=n(38062),m=n(89618),g=n(10992),p=n(79962),v=n(51809),f=n(46350),_=n(474),y=n(27547),x=n(10592),b=n(94282),A=n(52335),w=n(73317),S=n(99916),C=n(32750),k=n(57512),I=n(22315),E=n(26106),T=n(9741);const j=(0,r.jco)(),N=function(){var e=(0,i.A)((function*(e){var t;A.l.getState().setIsShowSidebar(!0,_.cz.selectAssistantMenu);let n="";const i=l.K9.Search;try{var o;const[e]=yield Promise.all([(0,d.Rf)((0,g.M$)(),1500,(()=>{E.vF.persist.error({eventName:"[SELECT_BAR] - SEARCH",error:new Error("get skill res timeout")})})),(0,T.Z)()]);if(n=(null===(o=(0,s.A)(e.latest_skills,(e=>(null==e?void 0:e.skill_type)===i)))||void 0===o?void 0:o.skill_id)||"",""===n)throw new Error("search skill id is empty")}catch(y){E.vF.persist.error({message:"get skill failed",error:y})}let a={textContent:""};try{a=yield(0,h.B9)()}catch(y){E.vF.persist.error({message:"get doc failed when search",error:y})}const{convId:r,convType:m,mainBotId:v}=(0,u.IK)(),f={text:e||x.t_.getState().inputText,scene:p.sJ.highlight_search_result_tool,sec_scene:p._o.highlight_search_result_ask,extraExt:{input_skill:JSON.stringify({skill_id:n,skill_type:i,variables:{}}),earlier_search_result:"1",send_from_skill_guidance_or_suggestion:(0,k.TK)("authInfo").isAuthenticated?void 0:"1",samantha_context:JSON.stringify((0,w.k)({query_context:{web_content:(null===(t=a)||void 0===t?void 0:t.textContent)||""}})),need_create_thread:m===c.He.NewThread?"1":"0"},ctx:(0,S.Pe)(m,r,v)};yield(0,S.Bc)(m,f)}));return function(t){return e.apply(this,arguments)}}(),M=(e,t,n=!1)=>{(0,f.Bp)({button_name:(0,I.em)(e)?"customized_button":e,click_from:t});const{setCurrentAction:i,setBarVisible:s,setBarFakeHide:o,setBoxVisible:r,inputText:l}=x.t_.getState();if(!l)return;b.on.getState().setFloatingCardVisible(!1),b.on.getState().setSummaryActionVisible(!1);const c=(0,C.BB)({action:(0,C.OB)(e),triggerLogin:e===I.EU.ask,loginParams:{}});if(s(!1),e!==I.EU.ask)i(e),e!==I.EU.copy?e!==I.EU.collect?n?L(e,l):r(!0):(0,m.X)({collectFrom:y.vP.highlight_function_bar,collectionType:v.X.TextFragment}):a()(l);else{if(c)return;if(j){o(!0);const e=x.t_.getState().inputText;return void N(e)}N()}},L=function(){var e=(0,i.A)((function*(e,t){if((0,C.BB)({action:(0,C.OB)(e,"web"),loginParams:{trackMeta:{login_entrance:"sidebar_float"}}}))return;x.t_.getState().clearMessages(),A.l.getState().setIsShowSidebar(!0,_.cz.other);try{yield(0,T.Z)()}catch(l){E.vF.persist.error({message:"page load failed",error:l})}const{convId:n,convType:i,mainBotId:s}=(0,u.IK)(),o={text:t,scene:p.sJ.highlight_in_siderbar_chat,ctx:(0,S.Pe)(i,n,s)},a=(0,k.TK)("uiLanguage"),r=(0,k.TK)("translateLanguage");if([I.EU.translate,I.EU.explain].includes(e)){const t={[e]:"{}",browser_language:a,flag_browser_plugin:"1"};e===I.EU.translate&&(t[e]=r||"{}"),o.extraExt=t,o.sec_scene=e===I.EU.translate?"highlight_in_siderbar_chat_translate":"highlight_in_siderbar_chat_explain"}else{const t=R(e);o.extraExt={flag_browser_plugin:"1",browser_plugin_info:JSON.stringify({frontend_source:"plugin",custom_prompt_skill_id:e,lang:r||a,custom_ref_show_variable:{title:(null==t?void 0:t.name)||"",icon:(null==t?void 0:t.icon)||""}}),need_create_thread:i===c.He.NewThread?"1":"0"}}yield(0,S.Bc)(i,o)}));return function(t,n){return e.apply(this,arguments)}}(),R=e=>{const t=(0,k.TK)("readingPopupActions"),n=(0,k.TK)("editingPopupActions");return t.actionList.find((t=>t.id===e))||t.moreActionList.find((t=>t.id===e))||n.actionList.find((t=>t.id===e))||n.moreActionList.find((t=>t.id===e))}},57512:(e,t,n)=>{n.d(t,{Fc:()=>b,LR:()=>v,MI:()=>A,TK:()=>x,bU:()=>k,lv:()=>f,n5:()=>S,pu:()=>C,ue:()=>w,vE:()=>y});var i=n(14065),s=n(97724),o=n(46487),a=n(44377),r=n(2393),l=n(19735),c=n(42914),d=n(22315),u=n(43523),h=n(32201);const m=(0,l.c)(),g={synced:!1,authInfo:{isAuthenticated:!1},autoTranslateSubtitles:!0,subtitleTranslateLang:"system",launchInfo:{},launchConfig:{},abTestValue:{},chatInfo:{},debugInfo:{isEnableDebug:!1,webEnv:"",extEnv:""},requestCommonParams:{},fg:{},sidebarButtonDisabledAll:!1,sidebarButtonDisabledHosts:[],searchDisabledAll:!1,searchDisabledHosts:[],sidebarButtonTop:.5,sidebarButtonPosition:"right",autoTranslatePageHosts:[],disableGlobalGrammar:!1,disableGrammarHosts:[],quickDisabledAll:!1,quickDisabledHosts:[],actions:d.HO,translateLanguage:(0,o.wz)(m),themeMode:h.lG.AUTO,uiLanguage:m,sidePanelEnabled:!0,hasLatestVersion:!1,hostId:"",PopupListMaxCount:4,readingPopupActions:{actionList:(0,d.Hh)(),moreActionList:(0,d.WN)()},editingPopupActions:{actionList:(0,d.I8)(),moreActionList:(0,d.fS)()},selectBarOnlyIcon:!1,onboardingActionRecord:(0,r.wG)(),isSelectbarMoreMenuClicked:!1,needOpenSideBar:!1,featureInfo:null,pageTranslateService:h.c$.HUOSHAN,selectTranslateService:h.c$.HUOSHAN,pageTranslateShowUnderline:!1,tccConfig:(0,c.q)(),transPreferConfig:{tipShown:!1,langMap:{}},tabConversationMap:{},isHistoryChatsClicked:!1};let p=()=>{};const v=()=>{var e;null===(e=p)||void 0===e||e()},f=function(){var e=(0,i.A)((function*(){p=yield(0,a.X)(g),g.synced=!0}));return function(){return e.apply(this,arguments)}}(),_=(e,t,n=!1)=>{const i=g[e];return g[e]=n?(0,s.A)(i,t):t,u.A.set(e,g[e])},y=_;function x(e){return g[e]}function b(){return g.authInfo}function A(){return g.debugInfo}function w(){return g.launchInfo}function S(){return g.chatInfo}function C(e,t=!1){return _("chatInfo",e,t)}function k(){return g.requestCommonParams}},12893:(e,t,n)=>{n.d(t,{$D:()=>f,IK:()=>x,hC:()=>_,u3:()=>y});var i=n(14065),s=n(85371),o=n(98502),a=n(34553),r=n(97327),l=n(94682),c=n(66546),d=n(58020),u=n(80911),h=n(57512),m=n(14144),g=n(82741),p=n(94282);const v=()=>l.pU.getState().addNewLocalConversation({conversation:{conversation_type:a.Cr.CocoWebSub},conversationId:void 0}),f=function(){var e=(0,i.A)((function*(){const{convId:e,convType:t,mainBotId:n}=x(),i=t===d.He.NewThread;let o=e;try{if(i){var a;if(o=null===(a=(yield r.j.apiService.samantha.ThreadCreate({bot_id:n})).data)||void 0===a||null===(a=a.thread_info)||void 0===a||null===(a=a.conversation)||void 0===a?void 0:a.conversation_id,(0,s.A)(o))return void(0,m.z3)("[zx] create sub conversation failed, returned conversationId not valid",o);_(o)}}catch(l){throw console.error("thread_create_failed"),l}return o}));return function(){return e.apply(this,arguments)}}(),_=e=>{const{tabId:t}=p.on.getState().tabInfo;t?(((e,t,n)=>{if(!(0,h.TK)("authInfo").isAuthenticated)return;const i=(0,h.TK)("tabConversationMap");(0,h.vE)("tabConversationMap",Object.assign({},i,{[e]:{conversationId:t,conversationType:n}}))})(t,e,d.He.Conversation),p.on.getState().setTabInfo({tabId:t})):(0,m.z3)("[zx] tabId not valid",t)};function y(){const{tabId:e}=(0,p.on)((e=>e.tabInfo)),[t]=(0,g.Y)("authInfo"),[n]=(0,g.Y)("chatInfo"),{value:i}=(0,u.Tu)(u.FM.enableNewChat,!1);var s;if(!t.isAuthenticated||!i||!e)return{tabId:e,convId:null===(s=n.mainConversation)||void 0===s?void 0:s.conversation_id,convType:d.He.Conversation};const r=(0,h.TK)("tabConversationMap"),f=r?r[e]:void 0;var _;if(r||((0,m.z3)("[zx] tabConvMap not init"),(0,h.vE)("tabConversationMap",{})),f&&""!==f.conversationId)return f.conversationType!==d.He.NewThread||null!==(_=l.pU.getState().localConversationMap[f.conversationId])&&void 0!==_&&_.local||l.pU.setState((0,o.jM)((e=>{e.localConversationMap[f.conversationId]={local:{createStatus:c.Et.Pending},conversation_type:a.Cr.CocoWebSub}}))),{tabId:e,convId:f.conversationId,convType:f.conversationType};const y=v();return(0,h.vE)("tabConversationMap",Object.assign({},r,{[e]:{conversationId:y,conversationType:d.He.NewThread}})),{tabId:e,convId:y,convType:d.He.NewThread}}function x(){var e,t;const n=(0,h.TK)("authInfo"),{mainConversation:i}=(0,h.TK)("chatInfo"),s=(0,u.Mz)(u.FM.enableNewChat,!1),o=null==i?void 0:i.bot_id;if(!n.isAuthenticated||!s)return{convId:null==i?void 0:i.conversation_id,convType:d.He.Conversation,mainBotId:o};const{tabId:a}=p.on.getState().tabInfo,r=null==i?void 0:i.conversation_id,l=d.He.Conversation;if(!a)return{convId:r,convType:l,mainBotId:o};const c=(0,h.TK)("tabConversationMap");return{convId:null===(e=c[a])||void 0===e?void 0:e.conversationId,convType:null===(t=c[a])||void 0===t?void 0:t.conversationType,mainBotId:o}}},58876:(e,t,n)=>{n.d(t,{Ay:()=>l,jB:()=>a,un:()=>r});var i=n(11855);let s=window.location.href;const o={youtube:/^https:\/\/www.youtube.com\/watch\?/,bilibili:/^https:\/\/www\.bilibili\.com\/video\/\w+/},a=e=>!!e&&o[e].test(location.href),r=(0,i.createContext)(null),l=e=>/^https:\/\/www.youtube.com\//.test(e)?{name:"youtube",sidebarContainerQuery:"#columns #secondary",searchParam:"v",customAppend:()=>{const e=document.querySelector("#fixed-columns-secondary #secondary");return e||null}}:/^https:\/\/www\.bilibili\.com\/video\/\w+/.test(e)?{name:"bilibili",sidebarContainerQuery:"#danmukuBox",searchParam:"v",pageIsReady:e=>{const t=new MutationObserver((()=>{const t=document.querySelector(".bui-dropdown-name");null!=t&&t.textContent&&e()}));return t.observe(document.body,{childList:!0}),()=>{t.disconnect()}},onUrlChange:e=>{const t=setInterval((function(){window.location.href!==s&&(e(),s=window.location.href)}),1e3);return()=>{window.clearInterval(t)}}}:null},62277:(e,t,n)=>{n.d(t,{EE:()=>T,ab:()=>E,i4:()=>w});var i=n(44557),s=n(14065),o=n(56642),a=n(36266),r=n(81133),l=n(24973),c=n(52331),d=n(51187),u=n(94682),h=n(75522),m=n(89320),g=n(25508),p=n(47113),v=n(44343),f=n(22921),_=n(57512),y=n(43523),x=n(26106),b=n(71291),A=n(45110);const w=`https://${g.FI}`,S=e=>(0,v.w)((t=>e?t.botMap[e]:void 0),o.x),C=e=>t=>{try{var n;const i=null===(n=e.getState().conversationLinks[0])||void 0===n?void 0:n.conversationId,s=i?[i]:[],o={},a={};return s.forEach((e=>{var n;null!==(n=t.messageLinkMap)&&void 0!==n&&n[e]&&(o[e]=t.messageLinkMap[e].slice(Math.max(t.messageLinkMap[e].length-6,0)))})),s.forEach((e=>{var n;null!=o&&o[e]&&null!==(n=t.messageMap)&&void 0!==n&&n[e]&&(a[e]={},o[e].forEach((n=>{var i;null!==(i=t.messageMap)&&void 0!==i&&null!==(i=i[e])&&void 0!==i&&i[n.messageId]&&(a[e][n.messageId]=t.messageMap[e][n.messageId])})))})),{chunkTaskMap:t.chunkTaskMap,messageLinkMap:o,messageMap:a}}catch(i){return x.vF.persist.error({message:"ext persist state limit error",error:i instanceof Error?i:new Error(String(i))}),{chunkTaskMap:t.chunkTaskMap}}},k=e=>{try{return{userPreferences:e.userPreferences}}catch(t){return x.vF.persist.error({message:"ext persist state limit error",error:t instanceof Error?t:new Error(String(t))}),{userPreferences:e.userPreferences}}};let I;function E(){if(I)return I;const{eventEmitter:e}=(0,r.o)({isEnableDebug:!1,store:{prefix:"flow-ext",storage:{getItem:(o=(0,s.A)((function*(e){return yield y.A.get(e)})),function(e){return o.apply(this,arguments)}),setItem:(n=(0,s.A)((function*(e,t){return yield y.A.set(e,t)})),function(e,t){return n.apply(this,arguments)}),removeItem:(t=(0,s.A)((function*(e){return yield y.A.remove(e)})),function(e){return t.apply(this,arguments)})},merge:{chatFeedStore:(e,t)=>(0,i.A)((0,i.A)({},t),e||{}),chatInputStore:(e,t)=>(0,i.A)((0,i.A)({},t),e||{}),chatMessageStore:(e,t)=>(0,i.A)((0,i.A)({},t),e||{}),chatViewStore:(e,t)=>(0,i.A)((0,i.A)({},t),e||{})},partialize:{chatInputStore:k,chatMessageStore:C(u.pU)}},trackEvent:p.bs,http:{client:A.sY,baseURL:w,getCommonHeaders:b.Ql,getCommonParams:b.wH},globalConfig:()=>{var e;return{appId:Number(g.sZ),userId:(0,_.Fc)().userId,loginSource:"flow-ext",createUploader:e=>new h.G((0,i.A)((0,i.A)({},e),{},{useDirectUpload:!0})),isGuest:!(null!==(e=(0,_.Fc)())&&void 0!==e&&e.isAuthenticated)}},botConfig:(0,i.A)((0,i.A)({},v.w.getState()),{},{useBotInfo:S})});var t,n,o;return I=e,e}const T=function(){var e=(0,s.A)((function*(){const e=E();try{const t=yield j();return(0,l.q)({launchData:t,userInfoData:{}}),(0,d.IDn)({config:{},socketClient:m.Hv,reportEvent:(0,a.XB)({eventName:"ext_message_service"}),fetchStream:{baseURL:`https://${g.FI}`,client:m._v}}),(0,d.p4m)(),(0,m.Lt)(),(0,c.C)({onlyLoadAssistantBot:!0,isReload:!1}),e}catch(t){x.vF.persist.error({message:"init im core failed",error:t})}}));return function(){return e.apply(this,arguments)}}(),j=function(){var e=(0,s.A)((function*(){try{const{data:e}=yield f.g.setting.Launch();if(!e)throw Error("\u83b7\u53d6 launchData \u5931\u8d25");return e}catch(e){throw console.log("===Launch failed===",e),e}}));return function(){return e.apply(this,arguments)}}()},89320:(e,t,n)=>{n.d(t,{Hv:()=>w,Lt:()=>A,_v:()=>f,jo:()=>x});var i=n(44557),s=n(10633),o=n(37462),a=n(33664),r=n(51187),l=n(35746),c=n(45319),d=n(57512),u=n(62745),h=n(75012),m=n(14144),g=n(7728),p=n(31774);const v=new class{constructor(){(0,s.A)(this,"_recoder",void 0),(0,s.A)(this,"_recoderName",""),(0,s.A)(this,"start",((e,t="cici_im_fetch_stream_action_perf")=>{const n=u.Qz.get("cici_summary_page_action_perf");n?(this._recoderName="cici_summary_page_action_perf",this._recoder=n,this._recoder.mark(e)):(this._recoder=u.Qz.create(t,!0),this._recoderName=t,this._recoder.mark(e)),(0,m.Rm)(`[ts] ImCorePerfRecoder start ${this._recoderName}[${e}]`)})),(0,s.A)(this,"mark",((e,t="cici_im_fetch_stream_action_perf")=>{this._recoder?((0,m.Rm)(`[ts] ImCorePerfRecoder mark ${this._recoderName}[${e}]`),this._recoder.mark(e)):this.start(e,t)})),(0,s.A)(this,"end",((e,t={})=>{this._recoder&&((0,m.Rm)(`[ts] ImCorePerfRecoder end ${this._recoderName}[${e}], categories: `,t),this._recoder.end(e,t),u.Qz.remove(this._recoderName),this._recoderName="",this._recoder=void 0)}))}},f=e=>{const{req:t,reportMeta:n,onMessage:s,onError:o,onFinish:a,subscribeAbortTrigger:r,getCommonHttpParams:l}=e;(0,m.Rm)(null==n?void 0:n.conversationId);const d=(0,c.AP)();null==r||r((e=>{g.B.abort(d,e)})),v.mark("start_fetch_stream"),(0,m.Rm)("[lwx] start fetch stream...",e);const u={};g.B.fetch({reportMeta:n,req:(0,i.A)((0,i.A)({},{params:null==l?void 0:l()}),t)},{id:d,onUpdate:({body:e,logId:t=""})=>{var n;if("1"==`${null==e||null===(n=e.message)||void 0===n?void 0:n.chunk_seq}`){var i;(0,m.Rm)("[lwx] fetch stream first message",e);const{source:t,input_skill:n}=(null==e||null===(i=e.message)||void 0===i?void 0:i.ext)||{};if(t&&(u.source=t),n)try{const{skill_type:e}=JSON.parse(n)||{};u.inputSkillType=`${e}`}catch(o){(0,m.z3)("parse input skill type error: ",o)}v.mark("fetch_stream_first_message")}s(e,t)},onError:({jsonData:e,logId:t=""})=>{v.mark("fetch_stream_error"),v.end("end_fetch_stream",u),o(e,t)},onDone:()=>{v.end("end_fetch_stream",u),(0,m.Rm)("[lwx] fetch stream done"),a(!0)}})},_=(()=>{const e=(0,h.c)("im-sdk-socket");return()=>e})(),y=(e,t)=>_().postMessage({body:{type:e,payload:t}}),x=()=>{v.start("check_connection","cici_im_connection_action_perf"),y("check-connection")};let b=null;const A=()=>{_().onMessage.addListener((e=>{var t,n,i,s,o,r,c;((0,m.Rm)("[Daniel] - recv \u{1f53d}",e),null!==(t=e.body)&&void 0!==t&&t.event)&&((null===(n=e.body.event.message)||void 0===n||null===(n=n.ext)||void 0===n?void 0:n.has_err)!==p.Be||null!==(i=(0,d.Fc)())&&void 0!==i&&i.isAuthenticated||(0,l.DT)({}),"0"==`${null===(s=e.body.event.message)||void 0===s?void 0:s.chunk_seq}`?v.mark("socket_recv_first_message"):(null===(o=e.body.event.message)||void 0===o?void 0:o.message_type)===a.Go.Ack&&v.mark("socket_recv_open"),null===(r=b)||void 0===r||r({event:e.body.event,traceId:null===(c=e.body)||void 0===c?void 0:c.traceId}))}))},w={close:o.A,drop:o.A,send:e=>{(0,m.Rm)("[Daniel] - send \u{1f53c}",e),"string"==typeof e&&(v.mark("send_socket_message"),y("message",(0,i.A)({},JSON.parse(e))))},addEventListener:e=>{(0,m.Rm)("[zoei] socketClientProxy.addEventListener",e)},removeEventListener:e=>{(0,m.Rm)("[zoei] socketClientProxy.removeEventListener",e),e===r.QVB.open&&v.end("socket_proxy_init_end")},init:e=>{(0,m.Rm)("[zoei] socketClientProxy.init - connectSocketIfNeeded",e),v.mark("socket_proxy_init_begin"),(e=>{y("connect-if-needed",{options:e})})(e),b=e.onMessage}}},35746:(e,t,n)=>{n.d(t,{DT:()=>h,GT:()=>m,l_:()=>g});var i=n(14065),s=n(44557),o=n(65952),a=n(80196),r=n(25508),l=n(71169),c=n(30510),d=(n(14144),n(31774)),u=n(39853);const h=e=>{if(!location.href.includes(`${r.FI}${d.EP}`))if((0,u.nr)()){const{trackMeta:t}=e||{};window.open(function(e){const t={from:"ext"};return e&&(t.extra=btoa(JSON.stringify(e))),(0,o.ID)(`https://${r.FI}/browser-extension/login`,t)}({trackMeta:t}),"_blank")}else(0,c.cs)({name:"open-login-window",body:(0,s.A)((0,s.A)((0,s.A)({},(0,l.c)()),e),{},{clearWindow:(0,u.fv)()})})},m=()=>{window.location.hostname.endsWith(r.o8)&&window.postMessage({name:"click_float_btn"})},g=function(){var e=(0,i.A)((function*(){var e,t,n;let i=(null===(e=document.querySelector('meta[property="og:image"]'))||void 0===e?void 0:e.getAttribute("content"))||"";const s=(null===(t=document.querySelector('meta[property="og:description"]'))||void 0===t?void 0:t.getAttribute("content"))||(null===(n=document.querySelector('meta[name="description"]'))||void 0===n?void 0:n.getAttribute("content"))||"";try{i&&(i=yield(0,a.Vv)(i))}catch(o){console.error("image\u83b7\u53d6\u5931\u8d25!")}return{imageUrl:i,desc:s}}));return function(){return e.apply(this,arguments)}}()},82574:(e,t,n)=>{n.d(t,{$:()=>Wt,$N:()=>St,Ai:()=>nn,Cy:()=>Kt,EH:()=>en,GP:()=>Ft,Gk:()=>Zt,H9:()=>Rt,HD:()=>Pt,I:()=>un,JW:()=>Ct,K2:()=>Ot,Ni:()=>ut,P$:()=>Jt,PW:()=>Tt,Pl:()=>Qe,R0:()=>tn,TH:()=>Nt,Tf:()=>zt,U8:()=>Mt,Zx:()=>Vt,dd:()=>sn,eD:()=>gt,eI:()=>kt,fG:()=>nt,gz:()=>vt,hI:()=>Je,hk:()=>on,jR:()=>Lt,jZ:()=>Bt,jw:()=>dt,kK:()=>lt,li:()=>Qt,n4:()=>$t,o0:()=>xt,oE:()=>Ut,pt:()=>qt,qe:()=>jt,un:()=>Xt,ut:()=>an,vo:()=>Et,wO:()=>Gt,w_:()=>yt,yZ:()=>rn,zG:()=>Yt});var i=n(44557),s=(n(11855),n(79474)),o=n(44372),a=n(31355),r=n(42325),l=n(51223),c=n(47185),d=n(38188),u=n(78807),h=n(86275),m=n(43152),g=n(18502),p=n(78665),v=n(54899),f=n(20501),_=n(46201),y=n(27149),x=n(18720),b=n(81742),A=n(53690),w=n(43480),S=n(93711),C=n(82278),k=n(99154),I=n(52031),E=n(24372),T=n(19763),j=n(36740),N=n(37353),M=n(25760),L=n(68315),R=n(76822),P=n(11188),B=n(18024),O=n(17529),D=n(88951),F=n(19201),U=n(5476),H=n(99909),z=n(53675),q=n(75900),V=n(49079),$=n(90911),K=n(59837),W=n(24630),G=n(59728),Y=n(99627),Q=n(76774),J=n(99418),X=n(11473),Z=n(16990),ee=n(54983),te=n(18492),ne=n(11600),ie=n(89262),se=n(75537),oe=n(65949),ae=n(61477),re=n(44364),le=n(63942),ce=n(41295),de=n(90760),ue=n(30248),he=n(56678),me=n(34009),ge=n(51192),pe=n(41105),ve=n(39667),fe=n(80099),_e=n(60184),ye=n(92448),xe=n(88072),be=n(80678),Ae=n(90152),we=n(77817),Se=n(34939),Ce=n(49795),ke=n(64945),Ie=n(21550),Ee=n(81134),Te=n(31674),je=n(53968),Ne=n(8418),Me=n(65579),Le=n(92898),Re=n(57439),Pe=n(18917),Be=n(86864),Oe=n(19023),De=n(2831),Fe=n(49433),Ue=n(13568),He=n(73998),ze=n(12865),qe=n(40769),Ve=n(39498),$e=n(77175),Ke=n(54515),We=n(10145),Ge=n(91843),Ye=n(63159);(0,o.a)((0,Ye.jsx)(We.h,{})),(0,o.a)((0,Ye.jsx)(Ge.h,{})),(0,o.a)((0,Ye.jsx)(Ce.h,{})),(0,o.a)((0,Ye.jsx)(ve.h,{})),(0,o.a)((0,Ye.jsx)(Ne.h,{})),(0,o.a)((0,Ye.jsx)(Me.h,{})),(0,o.a)((0,Ye.jsx)(je.h,{})),(0,o.a)((0,Ye.jsx)(Le.h,{}));const Qe=(0,o.a)((0,Ye.jsx)(oe.h,{})),Je=((0,o.a)((0,Ye.jsx)(Ke.h,{})),(0,o.a)((0,Ye.jsx)(De.h,{})),(0,o.a)((0,Ye.jsx)(ee.h,{})),(0,o.a)((0,Ye.jsx)(re.h,{}))),Xe=(0,o.a)((0,Ye.jsx)(se.h,{})),Ze=(0,o.a)((0,Ye.jsx)(Z.h,{})),et=(0,o.a)((0,Ye.jsx)(Q.h,{})),tt=(0,o.a)((0,Ye.jsx)(q.h,{})),nt=(0,o.a)((0,Ye.jsx)(U.h,{})),it=(0,o.a)((0,Ye.jsx)(B.h,{})),st=(0,o.a)((0,Ye.jsx)(b.h,{})),ot=(0,o.a)((0,Ye.jsx)(_.h,{})),at=(0,o.a)((0,Ye.jsx)(v.h,{})),rt=(0,o.a)((0,Ye.jsx)(p.h,{})),lt=(0,o.a)((0,Ye.jsx)(l.h,{})),ct=(0,o.a)((0,Ye.jsx)(V.h,{})),dt=((0,o.a)((0,Ye.jsx)(K.h,{})),(0,o.a)((0,Ye.jsx)(W.h,{}))),ut=(0,o.a)((0,Ye.jsx)(f.h,{})),ht=(0,o.a)((0,Ye.jsx)(Y.h,{})),mt=(0,o.a)((0,Ye.jsx)(N.h,{})),gt=(0,o.a)((0,Ye.jsx)(w.h,{})),pt=((0,o.a)((0,Ye.jsx)(S.h,{})),(0,o.a)((0,Ye.jsx)(H.h,{}))),vt=(0,o.a)((0,Ye.jsx)(J.h,{})),ft=((0,o.a)((0,Ye.jsx)(F.h,{})),(0,o.a)((0,Ye.jsx)(ne.h,{}))),_t=(0,o.a)((0,Ye.jsx)(E.h,{})),yt=(0,o.a)((0,Ye.jsx)(T.h,{})),xt=(0,o.a)((0,Ye.jsx)(L.h,{})),bt=(0,o.a)((0,Ye.jsx)(x.h,{})),At=(0,o.a)((0,Ye.jsx)(C.h,{})),wt=(0,o.a)((0,Ye.jsx)(k.h,{})),St=((0,o.a)((0,Ye.jsx)($.h,{})),(0,o.a)((0,Ye.jsx)(le.h,{})),(0,o.a)((0,Ye.jsx)(m.h,{}))),Ct=(0,o.a)((0,Ye.jsx)(g.h,{})),kt=(0,o.a)((0,Ye.jsx)(h.h,{})),It=(0,o.a)((0,Ye.jsx)(D.h,{})),Et=(0,o.a)((0,Ye.jsx)(z.h,{})),Tt=(0,o.a)((0,Ye.jsx)(I.h,{})),jt=(0,o.a)((0,Ye.jsx)(c.h,{})),Nt=(0,o.a)((0,Ye.jsx)(P.h,{})),Mt=(0,o.a)((0,Ye.jsx)(d.h,{})),Lt=((0,o.a)((0,Ye.jsx)(ze.h,{})),(0,o.a)((0,Ye.jsx)($e.h,{})),(0,o.a)((0,Ye.jsx)(he.h,{})),(0,o.a)((0,Ye.jsx)(Ee.h,{})),(0,o.a)((0,Ye.jsx)(Te.h,{})),(0,o.a)((0,Ye.jsx)(fe.h,{}))),Rt=(0,o.a)((0,Ye.jsx)(O.h,{})),Pt=(0,o.a)((0,Ye.jsx)(ye.h,{})),Bt=((0,o.a)((0,Ye.jsx)(Pe.h,{})),(0,o.a)((0,Ye.jsx)(Be.h,{})),(0,o.a)((0,Ye.jsx)(_e.h,{}))),Ot=(0,o.a)((0,Ye.jsx)(A.h,{})),Dt=(0,o.a)((0,Ye.jsx)(R.h,{})),Ft=(0,o.a)((0,Ye.jsx)(u.h,{})),Ut=(0,o.a)((0,Ye.jsx)(te.h,{})),Ht=(0,o.a)((0,Ye.jsx)(G.h,{})),zt=(0,o.a)((0,Ye.jsx)(X.h,{})),qt=(0,o.a)((0,Ye.jsx)(M.h,{})),Vt=(0,o.a)((0,Ye.jsx)(j.h,{})),$t=(0,o.a)((0,Ye.jsx)(ae.h,{})),Kt=(0,o.a)((0,Ye.jsx)(Re.h,{})),Wt=((0,o.a)((0,Ye.jsx)(Ie.h,{})),(0,o.a)((0,Ye.jsx)(de.h,{}))),Gt=(0,o.a)((0,Ye.jsx)(me.h,{})),Yt=(0,o.a)((0,Ye.jsx)(Ae.h,{})),Qt=(0,o.a)((0,Ye.jsx)(ke.h,{})),Jt=(0,o.a)((0,Ye.jsx)(pe.h,{})),Xt=(0,o.a)((0,Ye.jsx)(ce.h,{})),Zt=(0,o.a)((0,Ye.jsx)(He.h,{})),en=((0,o.a)((0,Ye.jsx)(Ve.h,{})),(0,o.a)((0,Ye.jsx)(be.h,{}))),tn=(0,o.a)((0,Ye.jsx)(Fe.h,{})),nn=((0,o.a)((0,Ye.jsx)(ue.h,{})),(0,o.a)((0,Ye.jsx)(Oe.h,{})),(0,o.a)((0,Ye.jsx)(ge.h,{})),(0,o.a)((0,Ye.jsx)(we.h,{}))),sn=(0,o.a)((0,Ye.jsx)(Se.h,{})),on=(0,o.a)((0,Ye.jsx)(qe.h,{})),an=(0,o.a)((0,Ye.jsx)(Ue.h,{})),rn=(0,o.a)((0,Ye.jsx)(xe.h,{})),ln=(0,o.N)((0,r.Nf)()),cn=((0,o.a)((0,Ye.jsx)(ie.h,{})),(0,o.a)((0,Ye.jsx)(y.h,{}))),dn=(0,i.A)((0,i.A)({},a.M),{},{arrow:Qe,avatar:Xe,check:Ze,contact:et,drag:tt,explain:nt,instruct:it,rewrite:st,search:ot,sider:at,summarize:rt,translate:lt,del:ct,copy:Ht,conversation:ht,settings:ut,more:mt,regenerate:gt,expand:pt,close:vt,cancel:ft,ok:_t,messageFailed:xt,right:bt,IconRead:At,IconReadPage:wt,global:It,expandDownFilled:Et,IconTranslateOutline:jt,IconLangSettings:Nt,IconTranslateOutlineActive:Mt,IconLink:Dt,cici:ln,searchToggleSize:Lt,searchMore:Pt,searchSource:Bt,collect:s.Wur,searchAI:cn}),un=(e,t)=>{const n=dn[e];return n?(0,Ye.jsx)(n,(0,i.A)({},t)):(e=>{try{return new URL(e),!0}catch(t){return!1}})(e)?(0,Ye.jsx)("img",(0,i.A)({src:e},t)):(0,Ye.jsx)(Dt,(0,i.A)({},t))}},87412:(e,t,n)=>{n.d(t,{V:()=>o,s:()=>s});var i=n(57512);function s(){const e=(0,i.TK)("featureInfo");null!=e&&e.version&&(e.dotVisibleVersion=e.version,(0,i.vE)("featureInfo",e))}function o(){const e=(0,i.TK)("featureInfo");null!=e&&e.version&&(e.dotVisibleVersion=e.version,e.cardVisibleVersion=e.version,(0,i.vE)("featureInfo",e))}},83826:(e,t,n)=>{n.d(t,{EX:()=>o,Qn:()=>i,RB:()=>s,pX:()=>a});const i="https://www.youtube.com/watch?v=JN3KPFbWCy8#onboarding_have_a_try",s="#onboarding_have_a_try",o="https://sameerbajaj.com/jobs/#onboarding_have_a_try",a="https://sameerbajaj.com/jobs/"},26367:(e,t,n)=>{n.d(t,{Bq:()=>m,Ev:()=>x,Is:()=>v,OX:()=>u,Wd:()=>d,bg:()=>_,i1:()=>h,ld:()=>c,mW:()=>g,n7:()=>f,nG:()=>p,y4:()=>y});var i=n(44557),s=n(48869),o=n(85371),a=n(6430),r=n(58876);const l=e=>{if("string"==typeof e)try{const t=JSON.parse(e);return!("object"!=typeof t||!t)}catch(t){return!1}return!1},c=e=>{if(!l(e))return!1;return!!JSON.parse(e).some((e=>p(null==e?void 0:e.timestamp)))},d=e=>{if(!e)return"";return new URL(location.href).searchParams.get(e.searchParam)||""},u=()=>{var e;let t="",n="";if(!(0,r.jB)("bilibili"))return{videoId:t,title:n};let i=location.pathname;i=i.endsWith("/")?i.slice(0,-1):i;const s=i.split("/");t=s[s.length-1],n=(null===(e=document.querySelector(".video-title"))||void 0===e?void 0:e.innerHTML)||"";return{videoId:t,partId:new URL(location.href).searchParams.get("p")||"0",title:n}},h=(e,t)=>{const n=Number(e),i=Math.floor(n/3600),s=Math.floor(n%3600/60),o=Math.floor(n%3600%60),a=s<10?`0${s}`:s,r=o<10?`0${o}`:o;return 0!==i||t?`${i<10?`0${i}`:i}:${a}:${r}`:`${a}:${r}`},m=e=>{var t;if(!l(e))return"";const n=JSON.parse(e);if(!n.some((e=>p(null==e?void 0:e.timestamp))))return"";return null==n||null===(t=n.filter((e=>p(null==e?void 0:e.timestamp)&&e.section)))||void 0===t?void 0:t.map((e=>{var t;if(e.bullet_points&&(null===(t=e.bullet_points)||void 0===t?void 0:t.length)>0){const t=e.bullet_points.filter((e=>p(null==e?void 0:e.timestamp)&&e.point)),n=(0,s.A)(t,"timestamp",["asc"]);return(0,i.A)((0,i.A)({},e),{},{bullet_points:n})}}))},g=e=>{let t="";const n=m(e);return n&&0!==n.length?(n.map((e=>{var n;const i=h(e.timestamp);t+=`\n[${i}] ${e.section}`,t+="\n",e.bullet_points&&(null===(n=e.bullet_points)||void 0===n?void 0:n.length)>0&&e.bullet_points.map(((n,i)=>{const s=h(n.timestamp);t+=`\t[${s}] ${n.point}`,i!==e.bullet_points.length-1&&(t+="\n")}))})),t):""},p=e=>Number(e)>=0,v=(e,t)=>{const{setHighlightExploreCount:n}=a.e.getState();new IntersectionObserver((e=>{e.forEach((e=>{if(e.target instanceof HTMLElement&&e.isIntersecting){const{highlightExploreCount:e}=a.e.getState();n(),t(e+1)}}))})).observe(e)},f=e=>{const t=e[e.length-1];return t.bullet_points&&t.bullet_points.length>0?t.bullet_points[t.bullet_points.length-1].timestamp:t.timestamp},_=()=>{const e=document.querySelector("#wxwork-share-pic");if(!e)return"";const t=e.getAttribute("src");if(!t)return"";const n=t.lastIndexOf(".jpg");return n<=0?"":`https:${t.slice(0,n+4)}`},y=e=>`https://img.youtube.com/vi/${e}/maxresdefault.jpg`,x=e=>{var t;if(!e||e.length<=0)return;const n=(null===(t=e[e.length-1])||void 0===t?void 0:t.offset)/1e3>3600||!1;return"Time,Transcript\n"+e.map((e=>{if((0,o.A)(null==e?void 0:e.offset)||!p(null==e?void 0:e.offset)||!e.text)return;return`${h(e.offset/1e3,n)},${e.text}`})).join("\n")}},51817:(e,t,n)=>{n.d(t,{PT:()=>l,SY:()=>o,ZZ:()=>a,Zv:()=>r,mJ:()=>d});var i=n(14065),s=n(26367);const o=function(){var e=(0,i.A)((function*({videoId:e}){var t,n;const i=yield fetch(`https://api.bilibili.com/x/web-interface/view?bvid=${e}`,{credentials:"include"}).then((e=>e.json())).then((e=>e.data));if(!i.aid||!i.cid)return console.warn(`No web interface found for video: ${e}`),[];const s=i.aid;let o=i.cid;if((null===(t=i.pages)||void 0===t?void 0:t.length)>1){o=i.pages.reduce(((e,t)=>(e[t.page]=t,e)),{})[new URLSearchParams(location.search).get("p")||1].cid}const a=null===(n=(yield fetch(`https://api.bilibili.com/x/player/v2?aid=${s}&cid=${o}`,{credentials:"include"}).then((e=>e.json())).then((e=>e.data))).subtitle)||void 0===n||null===(n=n.subtitles)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.subtitle_url;if(!a)return console.warn(`No captions url found for video: ${e}`),[];const r=yield(yield fetch(`https:${a}`)).json();if(null==r||!r.body||0===r.body.length)return console.warn(`No captions found for video: ${e}`),[];return r.body.map((e=>({text:e.content,offset:parseInt(String(1e3*e.from)),duration:parseInt(String(1e3*(e.to-e.from)))})))}));return function(t){return e.apply(this,arguments)}}(),a=function(){var e=(0,i.A)((function*(e){var t;const n=yield fetch(`https://api.bilibili.com/x/web-interface/view?bvid=${e}`,{credentials:"include"}).then((e=>e.json())).then((e=>e.data));if(!n.aid||!n.cid)return console.warn(`No web interface found for video: ${e}`),`https://player.bilibili.com/player.html?bvid=${e}`;const i=n.aid;let s=n.cid,o=1;if((null===(t=n.pages)||void 0===t?void 0:t.length)>1){const e=n.pages.reduce(((e,t)=>(e[t.page]=t,e)),{});o=Number(new URLSearchParams(location.search).get("p")||1),s=e[o].cid}return`https://player.bilibili.com/player.html?aid=${i}&bvid=${e}&cid=${s}&p=${o}`}));return function(t){return e.apply(this,arguments)}}();function r(){return/youtube/.test(location.hostname)?"youtube":/bilibili/.test(location.hostname)?"bilibili":"youtube"}function l(e){return c.apply(this,arguments)}function c(){return(c=(0,i.A)((function*(e){const t=r();let n=window.location.href;return"bilibili"===t&&(n=yield a(e)),n}))).apply(this,arguments)}function d(e){return"bilibili"===r()?(0,s.bg)():(0,s.y4)(e)}},26823:(e,t,n)=>{n.d(t,{I_:()=>l,X_:()=>o,_1:()=>a,gq:()=>r});var i=n(10633),s=n(11855);let o=function(e){return e.recommendVideo="recommendvideo_list_click",e.playNext="next_button",e.recommendVideoEnding="recommendvideo_ending_click",e}({});const a=new class{constructor(){(0,i.A)(this,"_isImmersionMode",!1),(0,i.A)(this,"_lastEntryFullScreenFrom",void 0),(0,i.A)(this,"_shouldSummaryVideoDefault",!1),(0,i.A)(this,"_lastRelayBtnType",o.playNext),(0,i.A)(this,"_lastRelayBtnTime",Date.now()),(0,i.A)(this,"_currentTranscript",void 0),(0,i.A)(this,"_videoSummaryMsgBlock",{}),(0,i.A)(this,"_moduleClickFrom",void 0)}isImmersionMode(){return this._isImmersionMode}setImmersionMode(e){this._isImmersionMode=e}getLastEntryFullScreenFrom(){return this._lastEntryFullScreenFrom}updateEntryFullScreenFrom(e){this._lastEntryFullScreenFrom=e}updateTranscriptData(e){this._currentTranscript=e}getTranscriptData(){return this._currentTranscript}hasTranscript(){var e;return Boolean(null===(e=this._currentTranscript)||void 0===e?void 0:e.length)}shouldSummaryVideoDefault(){return this._shouldSummaryVideoDefault}updateShouldSummaryVideoDefault(e){this._shouldSummaryVideoDefault=e}getLastClickRelayBtnType(){return this._lastRelayBtnType}recordClickRelayBtnType(e){this._lastRelayBtnType=e,this._lastRelayBtnTime=Date.now()}resetClickRelayBtnType(e){if(e)return this._lastRelayBtnType=o.playNext,void(this._lastRelayBtnTime=Date.now());Date.now()-this._lastRelayBtnTime>1e4&&(this._lastRelayBtnType=o.playNext,this._lastRelayBtnTime=Date.now())}updateVideoSummaryId(e){this._videoSummaryMsgBlock.videoSummaryId=e}updateVideoHighlightsId(e){this._videoSummaryMsgBlock.videoHighlightsId=e}getVideoSummaryMsgBlock(){return this._videoSummaryMsgBlock}updateModuleClickFrom(e){this._moduleClickFrom||(this._moduleClickFrom=e)}getModuleClickFrom(){return this._moduleClickFrom}resetVideoSummaryStatus(){this._moduleClickFrom=void 0,this.updateTranscriptData(),this.updateVideoSummaryId(),this.updateVideoHighlightsId()}};function r(){const[e,t]=(0,s.useState)(a.isImmersionMode());return[e,(0,s.useCallback)((e=>{a.setImmersionMode(e),t(e)}),[t])]}function l(){const[e,t]=(0,s.useState)(a.shouldSummaryVideoDefault());return[e,t]}},73648:(e,t,n)=>{n.d(t,{A:()=>l,m:()=>r});var i,s=n(10633),o=n(57512),a=n(31774);class r{static getInstance(){return r._instance}init(){void 0===this._hostId&&(this._hostId=(0,o.TK)("hostId"),this._listenBrandInfoMessage(),this._listenStoreMessage(),this._sendHostIdMessage(),this._sendBrandInfo(),this._listenHostIdMessage())}registerRecyclable(e){this._recyclables.push(e)}registerRecyclables(e){e.forEach((e=>{e&&this._recyclables.push(e)}))}registerStore(e,t){this._stores.set(e,t)}getHostId(){return this._hostId}constructor(){(0,s.A)(this,"_recyclables",[]),(0,s.A)(this,"_stores",new Map),(0,s.A)(this,"_hostId",void 0),(0,s.A)(this,"_listenHostIdMessage",(()=>{window.addEventListener("message",this._hostIdMessageHandler)})),(0,s.A)(this,"_listenStoreMessage",(()=>{window.addEventListener("message",this._storeMessageHandler)})),(0,s.A)(this,"_listenBrandInfoMessage",(()=>{window.addEventListener("message",this._brandInfoMessageHandler)})),(0,s.A)(this,"_hostIdMessageHandler",(e=>{var t,n,i,s;void 0!==(null==e||null===(t=e.data)||void 0===t?void 0:t.brand)&&(null==e||null===(n=e.data)||void 0===n?void 0:n.brand)!==a.R3||void 0!==(null==e||null===(i=e.data)||void 0===i?void 0:i.hostId)&&(null==e||null===(s=e.data)||void 0===s?void 0:s.hostId)!==this._hostId&&(window.removeEventListener("message",this._hostIdMessageHandler),this._destory())})),(0,s.A)(this,"_brandInfoMessageHandler",(e=>{var t;null!=e&&null!==(t=e.data)&&void 0!==t&&null!==(t=t.extensionReq)&&void 0!==t&&t.requireExtensionInfo&&this._sendBrandInfo(e.origin)})),(0,s.A)(this,"_storeMessageHandler",(e=>{var t,n,i;if(void 0!==(null==e||null===(t=e.data)||void 0===t?void 0:t.brand)&&(null==e||null===(n=e.data)||void 0===n?void 0:n.brand)!==a.R3)return;if(void 0===(null==e||null===(i=e.data)||void 0===i?void 0:i.storeData))return;const s=JSON.parse(e.data.storeData);Object.keys(s).forEach((e=>{const t=this._stores.get(e);t&&t.setState(JSON.parse(s[e]))}))})),(0,s.A)(this,"_sendStoreData",(()=>{const e={};this._stores.forEach(((t,n)=>{e[n]=JSON.stringify(t.getState())}));const t=JSON.stringify(e);window.postMessage({storeData:t}),this._stores.clear()}))}_sendHostIdMessage(){window.postMessage({hostId:this._hostId,brand:a.R3})}_sendBrandInfo(e="*"){const t={brandName:a.R3};window.postMessage({extensionRes:t},e)}_destory(){window.removeEventListener("message",this._storeMessageHandler),window.removeEventListener("message",this._brandInfoMessageHandler),this._sendStoreData(),this._recyclables.forEach((e=>{try{"function"==typeof e?e():"function"==typeof(null==e?void 0:e.destory)&&e.destory()}catch(t){console.error("\u6267\u884cdestroy\u5931\u8d25 ",t)}})),this._recyclables=[]}}function l(e){r.getInstance().registerRecyclable(e)}i=r,(0,s.A)(r,"_instance",new i)},7745:(e,t,n)=>{var i={};n.r(i),n.d(i,{chatPageReadyHandler:()=>Ou,locateHighlightDomHandler:()=>Fu,readPageRequestHandler:()=>Uu,updateZustandStateHandler:()=>Hu});var s={};n.r(s),n.d(s,{closeSidebarHandler:()=>Um,contentMenuClickHandler:()=>Hm,openSidebarHandler:()=>hl,receiveTTSAudio:()=>Vm,tabActivatedHandler:()=>zm,toggleSidebarHandler:()=>qm});var o=n(44557),a=n(14065),r=(n(14450),n(53713)),l=n(97327),c=n(51187),d=n(73648),u=n(12648),h=n(51809),m=n(27547),g=n(14144),p=n(57921),v=n(31774),f=n(10633),_=n(42402);class y{constructor(){(0,f.A)(this,"getInsertContainerSelectors",(()=>[])),(0,f.A)(this,"getMutationObserverDelay",(()=>0))}}class x extends y{constructor(...e){super(...e),(0,f.A)(this,"getCollectionType",(()=>h.X.Web))}}var b=n(35746);class A extends x{constructor(...e){super(...e),(0,f.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("zhihu.com"))),(0,f.A)(this,"getCollectionData",function(){var e=(0,a.A)((function*(e){const t=(0,_.cQ)(e,e.closest(".MoreAnswers")?".List-item .ContentItem":".Card .ContentItem");if(!t)return null;const n=location.pathname.includes("/question"),i=yield(0,_.dp)(t),s=i.querySelector(".ContentItem-actions");s&&(s.style.position="unset");const o=n?document.querySelector("h1.QuestionHeader-title"):i.querySelector(".ContentItem-title");let a=(0,_.gs)(),r=location.href;if(o){a=(null==o?void 0:o.innerText)||"",o.remove();const e=o.querySelector("a");e&&(r=e.href)}if(n){var l;const e=null===(l=t.querySelector('.ContentItem > meta[itemprop="url"]'))||void 0===l?void 0:l.getAttribute("content");e&&(r=e)}const{desc:c,imageUrl:d}=yield(0,b.l_)(),{width:u,height:h}=t.getBoundingClientRect();return{text_content:i.innerText,html_content:i.innerHTML,dir:"",title:a,description:c,cover_image_url:d,source_url:r,content_height:h,content_width:u}}));return function(t){return e.apply(this,arguments)}}()),(0,f.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>{const t=(0,_.cQ)(e,e.closest(".MoreAnswers")?".List-item":".Card");return{containerElement:e,getCollectionData:()=>this.getCollectionData(e),style:{width:"24px",height:"24px","font-size":"16px","margin-left":"auto",visibility:"hidden"},insertIndex:6,hoverListenerElement:t}}))})),(0,f.A)(this,"getInsertContainerSelectors",(()=>[".Card .ContentItem-actions"]))}}class w extends y{constructor(...e){super(...e),(0,f.A)(this,"getCollectionType",(()=>h.X.SocialWebCard))}}class S extends w{constructor(...e){super(...e),(0,f.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("weibo.com"))),(0,f.A)(this,"getCollectionData",function(){var e=(0,a.A)((function*(e){var t,n,i,s;const o=(0,_.cQ)(e,"article.woo-panel-main");if(!o)return null;const a=yield(0,_.dp)(o);a.querySelectorAll(".woo-avatar-icon .woo-icon-main .woo-icon-frames").forEach((e=>e.remove()));const r=o.getBoundingClientRect();let{height:l}=r;const c=document.createElement("div"),d=document.querySelector("body > svg");d&&c.appendChild(d.cloneNode(!0)),c.appendChild(a);const u=null===(t=o.parentElement)||void 0===t?void 0:t.querySelector('div[class*="Detail_box"]'),h=a.querySelector("article");if(u&&h){(0,_.vg)(h);const e=u.querySelector("#composerEle");if(e){const t=yield(0,_.dp)(e);l+=e.getBoundingClientRect().height,h.appendChild(t)}const t=u.querySelector('div[class*="wbpro-tab"]');if(t){const e=yield(0,_.dp)(t);l+=t.getBoundingClientRect().height,h.appendChild(e)}const n=u.querySelectorAll('div[class*="wbpro-list"]');for(const i of n){const e=yield(0,_.dp)(i);l+=i.getBoundingClientRect().height,h.appendChild(e)}}const m=document.createElement("div");m.appendChild(c);const g=a.innerText,p=(null===(n=a.querySelector('div[class*="detail_wbtext"]'))||void 0===n?void 0:n.innerText)||g,v=(null===(i=a.querySelector(".woo-picture-main"))||void 0===i||null===(i=i.querySelector("img"))||void 0===i?void 0:i.getAttribute("data-img-tos-key"))||(null===(s=a.querySelector(".wbp-video .wbpv-poster"))||void 0===s?void 0:s.getAttribute("data-img-tos-key"))||"";return{text_content:g,html_content:m.innerHTML,body_content:p,content_img_key:v,content_height:l,content_width:r.width}}));return function(t){return e.apply(this,arguments)}}()),(0,f.A)(this,"getCollectionInsertInfo",(()=>{const e=[];this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))}));const t=e.length>1;return e.map((e=>{let n=null;const i={"margin-right":e.childElementCount?"8px":"0px"};var s;t&&(i.visibility="hidden",n=null===(s=(0,_.cQ)(e,"article.woo-panel-main"))||void 0===s?void 0:s.parentElement);return{containerElement:e,getCollectionData:()=>this.getCollectionData(e),insertIndex:0,style:i,hoverListenerElement:n}}))})),(0,f.A)(this,"getInsertContainerSelectors",(()=>[".woo-panel-main header.woo-box-flex > .woo-box-flex"]))}}const C=()=>location.pathname.includes("/status/");class k extends w{constructor(...e){var t;super(...e),t=this,(0,f.A)(this,"match",(()=>"https:"===location.protocol&&(location.host.endsWith("x.com")||location.host.endsWith("twitter.com")))),(0,f.A)(this,"getCollectionContent",(e=>{const t=(0,_.cQ)(e,'div[data-testid="cellInnerDiv"]');return C()?null==t?void 0:t.parentElement:t})),(0,f.A)(this,"getCollectionData",function(){var e=(0,a.A)((function*(e){var n,i,s;const o=t.getCollectionContent(e);if(!o)return null;const a=document.createElement("div"),r=o.getBoundingClientRect().width;let l=0;if(C())for(const t of o.querySelectorAll('div[data-testid="cellInnerDiv"]')){const e=yield(0,_.dp)(t,!1);e.style.position="unset",e.style.transform="none",a.appendChild(e);const{height:n}=t.getBoundingClientRect();l+=n}else{const e=yield(0,_.dp)(o,!1);e.style.position="unset",e.style.transform="none",a.appendChild(e);const{height:t}=o.getBoundingClientRect();l=t}const c=a.innerText,d=(null===(n=o.querySelector('div[data-testid="tweetText"]'))||void 0===n?void 0:n.innerText)||c,u=(null===(i=a.querySelector('div[aria-label="Image"]'))||void 0===i||null===(i=i.querySelector("img"))||void 0===i?void 0:i.getAttribute("data-img-tos-key"))||(null===(s=a.querySelector('button[aria-label="Play Video"]'))||void 0===s||null===(s=s.querySelector("img"))||void 0===s?void 0:s.getAttribute("data-img-tos-key"))||"";return{text_content:c,html_content:a.innerHTML,body_content:d,content_height:l,content_width:r,content_img_key:u}}));return function(t){return e.apply(this,arguments)}}()),(0,f.A)(this,"getCollectionInsertInfo",(()=>{const e=[];this.getInsertContainerSelectors().forEach((t=>{if(C()){const n=document.querySelector(t);n&&e.push(n)}else e.push(...document.querySelectorAll(t))}));const t=e.length>1;return e.map((e=>{var n;let i=null;const s={};return t&&(s.visibility="hidden",i=this.getCollectionContent(e)),{containerElement:null===(n=e.parentElement)||void 0===n||null===(n=n.parentElement)||void 0===n||null===(n=n.parentElement)||void 0===n?void 0:n.parentElement,getCollectionData:()=>this.getCollectionData(e),insertIndex:0,style:s,hoverListenerElement:i}}))})),(0,f.A)(this,"getInsertContainerSelectors",(()=>['main section [data-testid="cellInnerDiv"] article [data-testid="caret"]']))}}class I extends x{constructor(...e){super(...e),(0,f.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("stackoverflow.com"))),(0,f.A)(this,"getCollectionData",function(){var e=(0,a.A)((function*(e){const t=(0,_.cQ)(e,".post-layout"),n=yield(0,_.dp)(t),i=document.createElement("h2");i.innerText="Answer",i.style.paddingTop="20px",n.insertBefore(i,n.firstElementChild);const s=document.querySelector("#content .inner-content .question .post-layout");if(s){const e=yield(0,_.dp)(s);n.insertBefore(e,n.firstElementChild)}const{desc:o,imageUrl:a}=yield(0,b.l_)(),{width:r,height:l}=t.getBoundingClientRect(),{width:c,height:d}=s.getBoundingClientRect();return{text_content:n.innerText,html_content:n.innerHTML,dir:"",title:(0,_.gs)(),description:o,cover_image_url:a,source_url:location.href,content_height:l+d+100,content_width:Math.max(r,c)}}));return function(t){return e.apply(this,arguments)}}()),(0,f.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e,getCollectionData:()=>this.getCollectionData(e),style:{width:"24px",height:"24px","font-size":"16px","margin-top":e.childElementCount?"4px":"0px",visibility:"hidden"},hoverListenerElement:(0,_.cQ)(e,".post-layout")})))})),(0,f.A)(this,"getInsertContainerSelectors",(()=>["#content .inner-content .answer .js-voting-container"]))}}class E extends x{constructor(...e){super(...e),(0,f.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("reddit.com"))),(0,f.A)(this,"getCollectionData",function(){var e=(0,a.A)((function*(e){var t;const n=!location.pathname.includes("comments")?e:(0,_.cQ)(e,"main.main"),i=yield(0,_.dp)(n);null===(t=i.querySelector("shreddit-comments-page-ad"))||void 0===t||t.remove();const{desc:s,imageUrl:o}=yield(0,b.l_)(),{width:a,height:r}=n.getBoundingClientRect();return{text_content:i.innerText,html_content:i.innerHTML,dir:"",title:(0,_.gs)(),description:s,cover_image_url:o,source_url:location.href,content_height:r,content_width:a}}));return function(t){return e.apply(this,arguments)}}()),(0,f.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>{const t=!location.pathname.includes("comments");let n,i=e;const s={width:"32px",height:"32px","font-size":"22px"};let o=null;if(t){var a;const t=null===(a=e.shadowRoot)||void 0===a||null===(a=a.querySelector('slot[name="share-button"]'))||void 0===a?void 0:a.firstElementChild;t&&(s.position="absolute",s.left=`${t.getBoundingClientRect().width+t.offsetLeft}px`,s.visibility="hidden",o=e)}else{var r;const t=null===(r=e.shadowRoot)||void 0===r?void 0:r.querySelector('slot[name="share-button"]');if(null!=t&&t.parentElement)for(let e=0;e<t.parentElement.children.length;e++)if(t.parentElement.children[e]===t){n=e+1;break}i=null==t?void 0:t.parentElement}return{containerElement:i,getCollectionData:()=>this.getCollectionData(e),style:s,insertIndex:n,hoverListenerElement:o}}))})),(0,f.A)(this,"getInsertContainerSelectors",(()=>["shreddit-post","shreddit-ad-post"])),(0,f.A)(this,"getMutationObserverDelay",(()=>60))}}class T extends x{constructor(...e){super(...e),(0,f.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("quora.com"))),(0,f.A)(this,"getCollectionData",function(){var e=(0,a.A)((function*(e){if(!e)return null;const t=(0,_.cQ)(e,e.closest(".dom_annotate_multifeed_bundle_QuestionsBundle")?".dom_annotate_multifeed_bundle_QuestionsBundle > .q-box":"div.q-box.qu-borderAll.qu-borderRadius--small");if(!t)return null;const n=yield(0,_.dp)(t);let i=(0,_.gs)();const s=n.querySelector('div[class*="QuestionTitle"]');var o;s&&(i=s.innerText,null===(o=(0,_.cQ)(s,"div.q-box"))||void 0===o||o.remove());const{desc:a,imageUrl:r}=yield(0,b.l_)(),{width:l,height:c}=t.getBoundingClientRect();return{text_content:n.innerText,html_content:n.innerHTML,dir:"",title:i,description:a,cover_image_url:r,source_url:location.href,content_height:c,content_width:l}}));return function(t){return e.apply(this,arguments)}}()),(0,f.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>{const t=e.querySelector(".qu-zIndex--action_bar .qu-py--tiny"),n=t?(0,_.cQ)(t,t.closest(".dom_annotate_multifeed_bundle_QuestionsBundle")?".dom_annotate_multifeed_bundle_QuestionsBundle > .q-box":"div.q-box.qu-borderAll.qu-borderRadius--small"):null;return{containerElement:t?t.children[0]:null,getCollectionData:()=>this.getCollectionData(t),style:{width:"24px",height:"24px","font-size":"16px","margin-left":null!=t&&t.childElementCount?"10px":"0px",visibility:"hidden"},hoverListenerElement:n}}))})),(0,f.A)(this,"getInsertContainerSelectors",(()=>[".dom_annotate_multifeed_home > div > div",".dom_annotate_multifeed_bundle_QuestionsBundle > .q-box",'div[class*="dom_annotate_question_answer_item"]',".spacing_log_question_page_ad"]))}}class j extends x{constructor(...e){super(...e),(0,f.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("juejin.cn"))),(0,f.A)(this,"getCollectionData",(0,a.A)((function*(){const e=document.querySelector(".main-area.article-area");if(!e)return null;const t=yield(0,_.dp)(e);let n=(0,_.gs)();const i=t.querySelector(".article-title");i&&(n=i.innerText,i.remove());const{desc:s,imageUrl:o}=yield(0,b.l_)(),{width:a,height:r}=e.getBoundingClientRect();return{text_content:t.innerText,html_content:t.innerHTML,dir:"",title:n,description:s,cover_image_url:o,source_url:location.href,content_height:r,content_width:a}}))),(0,f.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e,getCollectionData:this.getCollectionData,style:{width:"48px",height:"48px","font-size":"24px"}})))})),(0,f.A)(this,"getInsertContainerSelectors",(()=>[".main-container .article-suspended-panel"]))}}class N extends w{constructor(...e){super(...e),(0,f.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("okjike.com"))),(0,f.A)(this,"getCollectionData",function(){var e=(0,a.A)((function*(e){var t,n,i,s;const o=(0,_.cQ)(e,"article.items-start");if(null==o||null===(t=o.parentElement)||void 0===t||!t.parentElement)return null;const a=yield(0,_.dp)(o.parentElement.parentElement),r=a.innerText,l=(null===(n=a.querySelector('div[class*="content_"]'))||void 0===n?void 0:n.innerText)||r,{width:c,height:d}=o.parentElement.parentElement.getBoundingClientRect(),u=a.querySelector('div[class*="MessagePictureGrid"]'),h=(null==u||null===(i=u.querySelector("img"))||void 0===i?void 0:i.getAttribute("data-img-tos-key"))||(null==u||null===(s=u.querySelector('div[class*="MessagePictureGrid__Cell"]'))||void 0===s?void 0:s.getAttribute("data-img-tos-key"))||"";return{text_content:r,html_content:a.innerHTML,body_content:l,content_height:d,content_width:c,content_img_key:h}}));return function(t){return e.apply(this,arguments)}}()),(0,f.A)(this,"getCollectionInsertInfo",(()=>{const e=[];this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))}));const t=e.length>1;return e.map((e=>{const n={width:"24px",height:"24px","font-size":"16px","margin-right":"18px"};let i=null;return t&&(n.visibility="hidden",i=(0,_.cQ)(e,"article.items-start")),{containerElement:e.lastElementChild,getCollectionData:()=>this.getCollectionData(e),insertIndex:e.lastElementChild?e.lastElementChild.childElementCount-1:0,style:n,hoverListenerElement:i}}))})),(0,f.A)(this,"getInsertContainerSelectors",(()=>[".items-stretch"]))}}class M extends x{constructor(...e){super(...e),(0,f.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("jianshu.com"))),(0,f.A)(this,"getCollectionData",(0,a.A)((function*(){const e=document.querySelector('div[role="main"] > div > section');if(!e)return null;const t=yield(0,_.dp)(e),n=t.querySelector("section");n&&(n.style.padding="0px",n.style.margin="0px");const i=e.getBoundingClientRect();let{height:s}=i;const o=document.querySelector('div[role="main"] > div #note-page-comment > section');if(o){const e=yield(0,_.dp)(o),n=e.querySelector("section");n&&(n.style.padding="0px",n.style.margin="0px"),t.appendChild(e);const{height:i}=o.getBoundingClientRect();s+=i}let a=(0,_.gs)();const r=t.querySelector('div[role="main"]>div>section>h1');r&&(a=r.innerText,r.remove());const{desc:l,imageUrl:c}=yield(0,b.l_)();return{text_content:t.innerText,html_content:t.innerHTML,dir:"",title:a,description:l,cover_image_url:c,source_url:location.href,content_height:s,content_width:i.width}}))),(0,f.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e.lastElementChild,getCollectionData:this.getCollectionData,style:{width:"48px",height:"48px","font-size":"24px",margin:"auto"}})))})),(0,f.A)(this,"getInsertContainerSelectors",(()=>location.pathname.startsWith("/p/")?["#__next"]:[]))}}class L extends x{constructor(...e){super(...e),(0,f.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("huggingface.co"))),(0,f.A)(this,"getCollectionData",function(){var e=(0,a.A)((function*(e){const t=(0,_.cQ)(e,"body > div.flex");if(!t)return null;const n=yield(0,_.dp)(t),{desc:i,imageUrl:s}=yield(0,b.l_)(),{width:o,height:a}=t.getBoundingClientRect();return{text_content:n.innerText,html_content:n.innerHTML,dir:"",title:(0,_.gs)(),description:i,cover_image_url:s,source_url:location.href,content_height:a,content_width:o}}));return function(t){return e.apply(this,arguments)}}()),(0,f.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e,getCollectionData:()=>this.getCollectionData(e),style:{width:"23px",height:"23px","font-size":"14px","margin-left":"8px"}})))})),(0,f.A)(this,"getInsertContainerSelectors",(()=>['div[data-target="DatasetHeader"] div.container > h1','div[data-target="ModelHeader"] div.container > h1']))}}class R extends x{constructor(...e){super(...e),(0,f.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("github.com"))),(0,f.A)(this,"getCollectionData",function(){var e=(0,a.A)((function*(e){const t=(0,_.cQ)(e,"div[data-turbo-body]");if(!t)return null;const n=yield(0,_.dp)(t),{desc:i,imageUrl:s}=yield(0,b.l_)(),{width:o,height:a}=t.getBoundingClientRect();return{text_content:n.innerText,html_content:n.innerHTML,dir:"",title:(0,_.gs)(),description:i,cover_image_url:s,source_url:location.href,content_height:a,content_width:o}}));return function(t){return e.apply(this,arguments)}}()),(0,f.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e,getCollectionData:()=>this.getCollectionData(e),insertIndex:0,style:{"margin-right":e.childElementCount?"8px":"0px",float:"left"}})))})),(0,f.A)(this,"getInsertContainerSelectors",(()=>["#repository-container-header ul.pagehead-actions"]))}}class P extends x{constructor(...e){super(...e),(0,f.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("csdn.net"))),(0,f.A)(this,"getCollectionData",function(){var e=(0,a.A)((function*(e){const t=(0,_.cQ)(e,"main");if(!t)return null;const n=t.querySelector(".blog-content-box");if(!n)return null;const i=yield(0,_.dp)(n,!1);i.style.padding="0px";const s=n.getBoundingClientRect();let{height:o}=s;const a=document.createElement("div");a.appendChild(i);const r=t.querySelector("#toolBarBox > div");if(r){const e=yield(0,_.dp)(r,!1);e.style.padding="0px",e.style.position="unset",o+=r.getBoundingClientRect().height,a.appendChild(e)}let l=(0,_.gs)();const c=i.querySelector(".article-title-box");c&&(l=c.innerText,c.remove());const{desc:d,imageUrl:u}=yield(0,b.l_)();return{text_content:i.innerText,html_content:a.innerHTML,dir:"",title:l,description:d,cover_image_url:u,source_url:location.href,content_height:o,content_width:s.width}}));return function(t){return e.apply(this,arguments)}}()),(0,f.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e,getCollectionData:()=>this.getCollectionData(e),insertIndex:0,style:{width:"24px",height:"24px","font-size":"16px","margin-right":e.childElementCount?"8px":"0px"}})))})),(0,f.A)(this,"getInsertContainerSelectors",(()=>["#mainBox #toolBarBox .toolbox-middle ul.toolbox-list"]))}}class B{constructor(){(0,f.A)(this,"_collectionProviderList",void 0),(0,f.A)(this,"getCollectionProvider",(()=>this._collectionProviderList.find((e=>e.match())))),this._collectionProviderList=[new S,new k,new A,new E,new T,new R,new L,new I,new P,new j,new M,new N]}}var O=n(89618);const D="cici-collection-button-container-style",F=e=>{const t=document.createElement("style");return t.id=D,t.innerHTML=`\n    ${e} {\n      cursor: pointer;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      height: 28px;\n      width: 28px;\n      outline: none;\n      border-radius: 999px;\n      border: none;\n      background: radial-gradient(\n        115.45% 162.76% at 19.33% 22.04%,\n        #0057ff 0%,\n        #4298fd 50%\n      );\n      color: #fff;\n      font-size: 16px;\n    }\n  `,t},U=(e,t,n,i=[])=>{const{containerElement:s,getCollectionData:o,style:a,insertIndex:r,hoverListenerElement:l}=e;if(!s)return;const c=`.${t}`;if(s.querySelector(c))return;const d=((e,t)=>{const n=document.createElement("div");return n.onclick=n=>{n.preventDefault(),n.stopPropagation();try{t===h.X.SocialWebCard?(0,O.X)({collectFrom:m.vP.webimage_collect,collectionType:h.X.SocialWebCard,getSocialWebCardContent:e}):t===h.X.Web&&(0,O.X)({collectFrom:m.vP.webimage_collect,collectionType:h.X.Web,getWebContent:e})}catch(i){(0,g.z3)(i)}},n.innerHTML='<svg width="1em" height="1em" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9.54132 3.34233C9.55338 3.44691 9.60969 3.4992 9.71025 3.4992C9.75248 3.4992 9.78969 3.48512 9.82187 3.45697C9.85405 3.42881 9.87315 3.39261 9.87918 3.34837C9.90332 3.1553 9.92745 3.00446 9.95159 2.89586C9.97572 2.78726 10.0159 2.70581 10.0723 2.65151C10.1286 2.5952 10.214 2.55196 10.3287 2.52179C10.4453 2.48961 10.6072 2.45643 10.8144 2.42224C10.9109 2.40414 10.9592 2.34783 10.9592 2.25331C10.9592 2.20906 10.9451 2.17085 10.9169 2.13867C10.8888 2.10649 10.8526 2.08839 10.8083 2.08437C10.6052 2.05622 10.4463 2.02906 10.3317 2.00292C10.2171 1.97678 10.1316 1.93655 10.0753 1.88225C10.019 1.82594 9.97773 1.74147 9.95159 1.62885C9.92745 1.51623 9.90332 1.35936 9.87918 1.15825C9.86511 1.05568 9.8088 1.00439 9.71025 1.00439C9.60969 1.00439 9.55338 1.05769 9.54132 1.16428C9.51718 1.35534 9.49305 1.50517 9.46891 1.61377C9.44478 1.72036 9.40456 1.80181 9.34825 1.85812C9.29194 1.91242 9.20546 1.95465 9.08881 1.98482C8.97217 2.01499 8.81128 2.04817 8.60614 2.08437C8.5076 2.10046 8.45832 2.15677 8.45832 2.25331C8.45832 2.34984 8.51363 2.40615 8.62424 2.42224C8.82535 2.4504 8.98222 2.47855 9.09485 2.50671C9.20747 2.53486 9.29194 2.5781 9.34825 2.63643C9.40456 2.69274 9.44478 2.7762 9.46891 2.88681C9.49305 2.99742 9.51718 3.14926 9.54132 3.34233Z" fill="white"/>\n  <path d="M11.7404 7.03334C11.7987 7.08563 11.8661 7.11177 11.9425 7.11177C12.0229 7.11177 12.0913 7.08563 12.1476 7.03334C12.2059 6.98105 12.2411 6.91468 12.2532 6.83424C12.2995 6.52452 12.3487 6.26308 12.401 6.0499C12.4533 5.83873 12.5207 5.66476 12.6031 5.52801C12.6856 5.39125 12.7932 5.28265 12.9259 5.2022C13.0607 5.12176 13.2306 5.05841 13.4357 5.01215C13.6409 4.96389 13.8923 4.92266 14.1899 4.88847C14.2744 4.88042 14.3438 4.84724 14.3981 4.78892C14.4524 4.72858 14.4795 4.65719 14.4795 4.57473C14.4795 4.4963 14.4524 4.42792 14.3981 4.3696C14.3458 4.31128 14.2774 4.27508 14.1929 4.261C13.8953 4.21876 13.6449 4.17351 13.4418 4.12525C13.2407 4.07698 13.0747 4.01262 12.944 3.93218C12.8133 3.85173 12.7067 3.74514 12.6243 3.61241C12.5418 3.47967 12.4724 3.30873 12.4161 3.09957C12.3618 2.8884 12.3075 2.62796 12.2532 2.31825C12.2391 2.23579 12.2029 2.16942 12.1446 2.11914C12.0883 2.06685 12.0209 2.04071 11.9425 2.04071C11.8641 2.04071 11.7957 2.06685 11.7373 2.11914C11.681 2.16942 11.6468 2.23579 11.6348 2.31825C11.5885 2.62796 11.5393 2.88941 11.487 3.10259C11.4347 3.31376 11.3663 3.48772 11.2818 3.62447C11.1994 3.75922 11.0918 3.86782 10.959 3.95028C10.8263 4.03072 10.6574 4.09407 10.4522 4.14033C10.2471 4.18659 9.99471 4.22681 9.69505 4.261C9.61259 4.27105 9.54421 4.30625 9.48991 4.36658C9.43561 4.4249 9.40846 4.49429 9.40846 4.57473C9.40846 4.65518 9.43461 4.72456 9.4869 4.78288C9.5412 4.84121 9.60957 4.8764 9.69203 4.88847C9.99169 4.93271 10.2421 4.97897 10.4432 5.02724C10.6463 5.0755 10.8132 5.13986 10.944 5.22031C11.0747 5.30075 11.1803 5.40734 11.2607 5.54007C11.3432 5.67281 11.4126 5.84376 11.4689 6.05291C11.5252 6.26408 11.5805 6.52452 11.6348 6.83424C11.6489 6.91468 11.6841 6.98105 11.7404 7.03334Z" fill="white"/>\n  <path d="M5.64812 2.74708L7.99999 2.74708V3.80542H5.67786C5.27922 3.80542 5.0799 3.80542 4.92764 3.87752C4.7937 3.94093 4.68481 4.04212 4.61657 4.16659C4.53899 4.30808 4.53899 4.49331 4.53899 4.86376V12.5735C4.53899 12.6488 4.53899 12.6864 4.55532 12.7047C4.56951 12.7207 4.5909 12.7295 4.61314 12.7287C4.63874 12.7277 4.66885 12.7025 4.72906 12.6521L7.23819 10.5536C7.50746 10.3284 7.64212 10.2158 7.79438 10.1731C7.92851 10.1355 8.0716 10.1355 8.20573 10.1731C8.358 10.2158 8.49264 10.3284 8.76192 10.5536L11.2711 12.6521C11.3313 12.7025 11.3614 12.7277 11.387 12.7287C11.4092 12.7295 11.4306 12.7207 11.4448 12.7047C11.4611 12.6864 11.4611 12.6488 11.4611 12.5735V8.00413H12.6V12.5735L12.6 12.5792C12.6001 12.6045 12.6005 12.6821 12.5934 12.7552L12.593 12.7594C12.587 12.8226 12.5597 13.1126 12.3224 13.3793C12.0812 13.6502 11.7175 13.8008 11.3395 13.7861C10.9674 13.7717 10.7171 13.5965 10.6626 13.5584L10.6589 13.5558C10.5958 13.5118 10.534 13.4597 10.5137 13.4426L10.5092 13.4388L8.00005 11.3403L5.49093 13.4388L5.48638 13.4426C5.46615 13.4597 5.40434 13.5118 5.34118 13.5558L5.33748 13.5584C5.28302 13.5965 5.03274 13.7717 4.66065 13.7861C4.2826 13.8008 3.91892 13.6502 3.67775 13.3793C3.44038 13.1126 3.41307 12.8226 3.40713 12.7594L3.40672 12.7552C3.39966 12.6821 3.39999 12.6045 3.40009 12.5792L3.40011 12.5735L3.40011 4.83612C3.40006 4.6754 3.40001 4.49761 3.41359 4.34313C3.42904 4.16738 3.46759 3.93092 3.60182 3.68611C3.77925 3.36251 4.06237 3.09941 4.4106 2.93453C4.67404 2.80979 4.92849 2.77397 5.11762 2.75961C5.28385 2.74699 5.47518 2.74703 5.64812 2.74708Z" fill="white"/>\n  </svg>\n  ',n})(o,n.getCollectionType());if(d.className=t,a&&d.setAttribute("style",Object.keys(a).map((e=>`${e}: ${a[e]}`)).join(";")),s.insertBefore(d,isNaN(Number(r))?null:s.children[r||0]),s.getRootNode()instanceof ShadowRoot){const e=F(c);s.insertBefore(e,s.firstElementChild),i.push((()=>{e.remove()}))}if(l){const e=()=>d.style.visibility="unset",t=()=>d.style.visibility="hidden";l.addEventListener("mouseenter",e),l.addEventListener("mouseleave",t),i.push((()=>{l.removeEventListener("mouseenter",e),l.removeEventListener("mouseleave",t)}))}i.push((()=>{d.remove()}))},H=()=>{const e=d.m.getInstance().getHostId();if(void 0===e)return;const t=(new B).getCollectionProvider();if(!t)return;const n=t.getInsertContainerSelectors(),i=[],s=`${v.AC}-${e}`;(e=>{(0,u.EY)(F(e))})(`.${s}`);const o=()=>{const e=t.getCollectionInsertInfo();e.length&&e.forEach((e=>{U(e,s,t,i)}))};if(o(),n.length){const e=new MutationObserver(function(){var e=(0,a.A)((function*(e){for(const i of e)if(t.getMutationObserverDelay()&&(yield new Promise((e=>setTimeout(e,t.getMutationObserverDelay())))),"childList"===i.type&&i.addedNodes.length>0)for(const e of i.addedNodes)if(e instanceof HTMLElement&&n.find((t=>e.matches(t)||e.querySelector(t))))return void o()}));return function(t){return e.apply(this,arguments)}}());e.observe(document.body,{childList:!0,subtree:!0}),i.push((()=>e.disconnect()))}return()=>{i.forEach((e=>e())),(()=>{if(!document.head)return;const e=document.head.querySelector(`#${D}`);e&&document.head.removeChild(e)})()}};var z=n(11855),q=n(75541),V=n(36266),$=n(30949),K=n(63159);const W=({element:e,children:t})=>((0,z.useEffect)((()=>{const t=e.parentElement;let n=0;if(!t)return;const i=new MutationObserver((i=>{for(const s of i)s.addedNodes.length>0&&n<15&&t.firstChild!==e&&requestAnimationFrame((()=>{t.prepend(e),n++}))}));return i.observe(t,{childList:!0,subtree:!1}),()=>{i.disconnect()}}),[e]),(0,K.jsx)(K.Fragment,{children:t}));var G=n(80911),Y=n(47113),Q=n(474),J=n(48850),X=n(57512);const Z=({search_engine_name:e,show_from:t})=>{(0,Y.z8)(Q.Ur.showSearchAssistant,{search_engine_name:e,show_from:t})},ee=({prompt_cnt:e,message_id:t,from_search_id:n,show_from:i,search_engine_name:s,suggested_type:o})=>{const{assistantBotId:a}=(0,X.ue)();(0,Y.z8)(Q.Ur.showSearchAssistantSuggest,{bot_id:a,suggested_type:o,prompt_cnt:e,message_id:t,from_search_id:n,show_from:i,search_engine_name:s})},te=({prompt_position:e,message_id:t,from_search_id:n,show_from:i,search_engine_name:s,suggested_type:o=Q.Ld.search})=>{const{assistantBotId:a}=(0,X.ue)();(0,Y.z8)(Q.Ur.showSearchAssistantSuggestQuestion,{bot_id:a,suggested_type:o,prompt_position:e,message_id:t,from_search_id:n,show_from:i,search_engine_name:s})},ne=({click_position:e,message_id:t,search_id:n,click_from:i,search_engine_name:s,suggested_type:o=Q.Ld.search})=>{const{assistantBotId:a}=(0,X.ue)();(0,Y.z8)(Q.Ur.clickSearchAssistantSuggest,{bot_id:a,suggested_type:o,click_position:e,message_id:t,button_name:Q._h.suggest,click_from:i||Q.Z5.searchAssistant,search_id:n,search_engine_name:s})};var ie=n(6430),se=n(52335),oe=n(26367),ae=n(29019),re=n.n(ae),le=n(26823),ce=n(34944),de=n(82574),ue=n(58876),he=n(42325);const me="container-j8RhVh",ge="button-XaY_FC",{Text:pe}=ce.Typography,ve=({className:e})=>{const t=(0,$.B)(),n=(0,z.useRef)(null);return(0,K.jsx)("span",{ref:n,className:re()(me,e),children:(0,K.jsx)(ce.$n,{theme:"solid",size:"small",className:ge,icon:(0,K.jsx)(de.oE,{}),onClick:()=>{const e=(0,ue.jB)("youtube");(0,b.DT)({trackMeta:{previous_page:e?"youtube":"bilibili",login_entrance:e?"youtube":"bilibili"}})},type:"primary",children:(0,K.jsx)(pe,{ellipsis:{showTooltip:{opts:{getPopupContainer:()=>n.current}}},style:{maxWidth:125},size:"small",children:t("flow_web_ext_search_login",{brand:(0,he.L2)()})})})})};var fe=n(46487),_e=n(55742),ye=n(30715);const xe="translateIcon-btNM0_",be="dropdownVisible-SWmfYq",Ae="select-Kuv39i",we="selectTitle-Hz1y6B",Se="selectDropdown-powb6o",Ce="languageLocal-NvRcHY",ke="languageSetting-lYgbLl",Ie="optionContainer-lVwcBY",Ee=e=>{const{scene:t,anchorRef:n,popContainerRef:i,translateLanguage:s,toolTipClassname:o,translateIconClassname:a,onLanguageChange:r}=e,[l,c]=(0,z.useState)(!1),d=(0,X.TK)("uiLanguage"),[u,h]=(0,z.useState)(null!=s?s:d),m=(0,ye.e)(!0),g=(0,$.B)();return(0,K.jsx)(ce.l6,{className:Ae,dropdownClassName:re()("test-youtube-translate-language-list",Se),position:"bottomRight",suffix:(0,K.jsx)(de.vo,{}),showArrow:!1,value:u,getPopupContainer:()=>n.current,onDropdownVisibleChange:e=>{e||c(!1)},onChange:e=>{c(!1),h(e),null==r||r(e),(0,_e.Su)({before_language_result:u,after_language_result:e,scene:t})},triggerRender:()=>(0,K.jsx)("div",{children:(0,K.jsx)(ce.m_,{content:g("flow_web_ext_youtube_respond"),className:o,getPopupContainer:()=>i.current,children:(0,K.jsx)("div",{className:re()(xe,a,{[be]:l}),onClick:()=>{c(!0)},"data-testid":"youtube-translate-language-setting",children:(0,K.jsx)(de.GP,{})})})}),outerTopSlot:(0,K.jsx)("div",{className:we,children:g("flow_web_ext_youtube_respond")}),children:null==m?void 0:m.map((({language_loc:e,language_code:t,language:n})=>{const i=t===u;return(0,K.jsx)(ce.l6.Option,{showTick:!1,value:t,children:(0,K.jsxs)("div",{className:Ie,"data-lang-option":t,children:[(0,K.jsxs)("div",{children:[(0,K.jsx)("div",{className:re()(Ce),children:e}),t!==fe.Aq&&(0,K.jsx)("div",{className:ke,children:n})]}),(0,K.jsx)("div",{children:i&&(0,K.jsx)(de.Tf,{})})]})},n+t)}))})};var Te=n(65952),je=n(33451);const Ne=["summary_message_id","highlights_message_id"];let Me=function(e){return e.UPPER_RIGHT="upper_right",e.SUBSCRIBED="subscribed",e.ONBOARDING="onboarding",e.IMMERSION_FULLSCREEN_BTN="fullscreen_click",e.VIDEO_DB_CLICK="video_dbclick",e.IMMERSION_FULLSCREEN_SHORT_CUT="shortcut",e.IMMERSION_BTN="immersion_click",e.WATCH_RELAY="watch_relay",e.recommendVideo="recommendvideo_list_click",e.playNext="next_button",e.recommendVideoEnding="recommendvideo_ending_click",e.PODCAST_SINGLE_BUTTON="podcast_single_button",e}({}),Le=function(e){return e.UPPER_RIGHT="upper_right",e.ONBOARDING="onboarding",e}({}),Re=function(e){return e.BOTTOM_RIGHT="bottom_right",e.SHARE_MENU="share_menu",e}({}),Pe=function(e){return e.PAGE="page",e.CLIP="current_clip",e}({}),Be=function(e){return e.TOOLBAR="video_toolbar",e.SHARE_PAGE="share_page",e.FULLSCREEN="fullscreen",e.SHORTCUT="shortcut",e.VIDEO_DB_CLICK="video_db_click",e}({}),Oe=function(e){return e.TOOLBAR="video_toolbar",e.SHARE_PAGE="share_page",e}({}),De=function(e){return e.EXPANDED="expanded",e.COLLAPSED="collapsed",e}({});const Fe=({summary_message_id:e,highlights_message_id:t})=>{let n=4;return n=e&&t?1:e?2:t?3:4,{summary_message_id:e,highlights_message_id:t,message_result_id:`${e}${t}`,show_type:n}},Ue=(e,t)=>{let{summary_message_id:n,highlights_message_id:i}=t,s=(0,je.A)(t,Ne);(0,Y.z8)(e,(0,o.A)((0,o.A)({},Fe({summary_message_id:n,highlights_message_id:i})),s))},He=e=>{(0,Y.z8)(Q.Ur.clickVideoImmersion,{click_from:e})},ze=e=>{(0,Y.z8)(Q.Ur.showVideoImmersion,{show_from:e})},qe=e=>{(0,Y.z8)(Q.Ur.immersionTimeLine,{mode:e})};var Ve=n(38514);const $e={closeAssistant:"closeAssistant-kOkYEs",videoSummaryAssistantContainer:"videoSummaryAssistantContainer-akGg3K",closeIcon:"closeIcon-O0Pyfg",area:"area-pKRbkk",header:"header-Y1_yxW",controls:"controls-TriwIR","content-visible":"content-visible-T7D5IW",contentVisible:"content-visible-T7D5IW",actionBtn:"actionBtn-h61pvg",footer:"footer-Bs22z8",actionFooterBtn:"actionFooterBtn-bfZlUX",content:"content-k93CU9",highlightPlaceholder:"highlightPlaceholder-DodOvW",highlightPlaceholderTitle:"highlightPlaceholderTitle-hScHbx",summary:"summary-C43f3d","no-transcript":"no-transcript-i7_Gk4",noTranscript:"no-transcript-i7_Gk4",gradientButton:"gradientButton-lSN9Xt",onboarding:"onboarding-j1o5b_",gradient_move:"gradient_move-YZnxFm",gradientMove:"gradient_move-YZnxFm",button:"button-zRpVJs",chatButton:"chatButton-uWBrKd",rightOperationButtons:"rightOperationButtons-PgKvtE",buttonItem:"buttonItem-DKpkLR",commonIcon:"commonIcon-zatgvP","highlight-title":"highlight-title-bNWBMa",highlightTitle:"highlight-title-bNWBMa",streamMessage:"streamMessage-Ly4SZU",scrollContainer:"scrollContainer-ONDBtF",fadeIn:"fadeIn-rs4Pol",optionContainer:"optionContainer-Fm0DdW","first-time-use-summarize":"first-time-use-summarize-f2OC1h",firstTimeUseSummarize:"first-time-use-summarize-f2OC1h","no-subtitles-with-guidance":"no-subtitles-with-guidance-liS6JO",noSubtitlesWithGuidance:"no-subtitles-with-guidance-liS6JO",shareDialogHeader:"shareDialogHeader-ofGjs3",title:"title-sAoKsj",shareDropdownContainer:"shareDropdownContainer-sZRrWX",shareItemContainer:"shareItemContainer-SIYAIc",shareItemText:"shareItemText-tWmZzE",uploadIcon:"uploadIcon-HHcMuG","tab-inactive":"tab-inactive-Idddik",tabInactive:"tab-inactive-Idddik","transcript-container":"transcript-container-yUdlQL",transcriptContainer:"transcript-container-yUdlQL",timeline:"timeline-pM2KOH",time:"time-oHJzL8",text:"text-gY_g3D"},Ke=({available:e,contentVisible:t,popContainerRef:n,isSummaryDone:i,isHighlightsDone:s,noContent:o,hasTranscript:a,isTranscriptLoaded:r,summarizeTriggered:l,hasNoSubtitles:c,hasShowedUserGuidance:d,translateLanguage:u,renderTab:h,setTranslateLanguage:m,onSummarizeVideo:g,trackResultEvent:p})=>{const v=(0,$.B)(),f=(0,z.useRef)((0,Te.o6)()),_=(0,z.useRef)(null),y=(0,z.useCallback)((()=>c&&d?null:l||(a||r)&&!a?(0,K.jsx)(K.Fragment,{}):(0,K.jsx)(ce.$n,{className:re()({[$e.gradientButton]:!f.current,[$e.onboarding]:f.current}),size:"small",theme:"solid",onClick:()=>{le._1.updateShouldSummaryVideoDefault(!0),null==g||g({clickFrom:f.current?Me.ONBOARDING:Me.UPPER_RIGHT})},"data-testid":"video-summary-assistant-summary-button",children:v("flow_web_ext_youtube_summarize")})),[a,r,l,c,d]),x=i&&s&&!o&&a&&r;return(0,K.jsxs)("div",{className:re()($e.header,{[$e["content-visible"]]:t}),ref:_,children:[(0,K.jsx)(Ve.A,{size:"large",disable:!0}),(0,K.jsxs)("div",{className:$e.controls,children:[e&&(0,K.jsx)(K.Fragment,{children:(0,K.jsxs)("div",{className:$e.actionBtn,children:[y(),x&&(null==h?void 0:h()),i&&s&&!o&&(0,K.jsx)(Ee,{scene:_e.jv.youtube_page_summary,anchorRef:_,translateLanguage:u,onLanguageChange:e=>{m(e),null==g||g({translateLang:e,clickFrom:Me.UPPER_RIGHT})},popContainerRef:n,trackResultEvent:p})]})}),!e&&(0,K.jsx)(ve,{})]})]})};var We=n(9388),Ge=n(89254),Ye=n.n(Ge),Qe=n(46913),Je=n.n(Qe),Xe=n(59585),Ze=n.n(Xe),et=n(79474),tt=n(23718),nt=n(51817),it=n(25508),st=n(34539),ot=n(7332);const at=["onCopyClick","onMouseEnter","onMouseLeave","className","isButtonWithText","containerClassName"],rt=(0,r.jco)(),lt=(0,z.forwardRef)(((e,t)=>{var n;let{onCopyClick:i,onMouseEnter:s,onMouseLeave:a,className:r,isButtonWithText:l,containerClassName:c}=e,d=(0,je.A)(e,at);const u=(0,$.B)(),h=null===(n=(0,ot.A)())||void 0===n?void 0:n.getPopupContainer,{onCopyClick:m,onMouseEnter:g,onMouseLeave:p,checked:v}=ct(i);if(!i)return null;const f=v?de.w_:de.jw,_=u(v?"flow_web_ext_action_popup_copy":"message_long_press_copy"),y=()=>(0,K.jsx)(f,(0,o.A)((0,o.A)({},d),{},{ref:t,className:r,onClick:m,onMouseEnter:()=>{null==s||s(),null==g||g()},onMouseLeave:()=>{null==a||a(),null==p||p()}})),x=()=>(0,K.jsxs)("div",{className:c,onClick:m,children:[(0,K.jsx)(f,(0,o.A)((0,o.A)({},d),{},{ref:t,className:r})),(0,K.jsx)("div",{children:_})]});return l?(0,K.jsx)(x,{}):rt?(0,K.jsx)(y,{}):(0,K.jsx)(ce.m_,{content:_,getPopupContainer:h,children:(0,K.jsx)(y,{})})})),ct=e=>{const[t,n]=(0,z.useState)(!1),[i,s]=(0,z.useState)(!1),o=(0,z.useRef)(-1);return(0,z.useEffect)((()=>{t&&(o.current=Number(setTimeout((()=>{n(!1)}),3e3)))}),[t]),{onCopyClick:()=>{e(),n(!0)},onMouseLeave:()=>{s(!0)},onMouseEnter:()=>{s(!1),i&&(n(!1),clearTimeout(o.current))},checked:t}},dt=(e,t)=>{var n;null===(n=G.Ay.Tea)||void 0===n||n.event(e,(0,o.A)({},t))};var ut=n(45110);const ht=({visible:e})=>{const t=(0,$.B)();return e?(0,K.jsxs)("div",{"data-testid":"video-summary-assistant-share-success-toast",style:{padding:"10px 14px 10px 10px",borderRadius:10,background:"rgba(15, 15, 15, 1)",fontSize:16,fontWeight:500,display:"flex",alignItems:"center",color:"rgba(255, 255, 255, 0.95)",boxShadow:"0px 6px 10px 0px rgba(0, 0, 0, 0.08), 0px 0px 1px 0px rgba(0, 0, 0, 0.15)"},children:[(0,K.jsx)(de.wO,{style:{height:24,marginRight:4}}),(0,K.jsx)("div",{children:t("flow_web_ext_action_popup_copy")})]}):null},mt=({onClickContinueInChat:e,popContainerRef:t,onCopy:n,videoId:i,currentPlayingClip:s,summaryResult:o,highlightResult:r,trackShareEvent:l,videoTitle:c,transcript:d,videoSummaryId:u,videoHighlightsId:h,enableDownload:v=!1})=>{const f=(0,$.B)(),[_,y]=(0,z.useState)(!1),[x,b]=(0,z.useState)(!1),A=(0,z.useRef)(document.createElement("div")),w=(0,z.useRef)(null),[S,C]=(0,z.useState)(""),k=(0,ue.jB)("youtube"),[I,E]=(0,z.useState)(!1);(0,z.useEffect)((()=>{A.current=document.createElement("div"),A.current.id="cici-toast-tag",A.current.style.position="fixed",A.current.style.top="100px",A.current.style.left="50%",A.current.style.transform="translateX(-50%)",A.current.style.zIndex="9999",document.body.appendChild(A.current)}),[]),(0,z.useEffect)((()=>{dt("show_button",{button_type:"copy",current_page:(0,Y.M5)(location.href)})}),[]);const T=function(){var e=(0,a.A)((function*(){if(k)try{const e=yield(0,ut.S6)({method:"POST",url:`${it.C1}/samantha/plugin/youtube_share`,data:{content:JSON.stringify({video_id:i,title:c.replace(/ - YouTube$/,""),share_clip_index:-1,summary:o,highlight:r})}});if(null!=e&&e.share_id){const t=`https://${it.FI}/summary/youtube/${e.share_id}`;C(t)}}catch(e){(0,g.Rm)("[Rowan] share clip failed",e)}}));return function(){return e.apply(this,arguments)}}();(0,z.useEffect)((()=>{T()}),[]);const j=({shareAll:e})=>{e?null==l||l(Re.SHARE_MENU,Pe.PAGE):null==l||l(Re.SHARE_MENU,Pe.CLIP),y(!1),S&&(Ze()(`${S}?share_clip=${e?-1:s}`),b(!0),setTimeout((()=>{b(!1)}),3e3))},N=(0,st.P)((e=>e.messages)),M=function(){var e=(0,a.A)((function*(){var e,t;const n=(0,ue.jB)("bilibili");let s=window.location.href;n&&(s=yield(0,nt.ZZ)(i)),(0,O.X)({collectFrom:m.vP.video_page_summarize,collectionType:tt.e.VideoSummary,videoSummaryResult:{summary:o,summary_msg_id:(null===(e=N[u])||void 0===e||null===(e=e.body)||void 0===e||null===(e=e.message)||void 0===e?void 0:e.message_id)||"",videoParams:{video_type:n?"bilibili":"youtube",video_url:s,title:c,timeline:r||[],cover_url:n?(0,oe.bg)():(0,oe.y4)(i),timeline_msg_id_str:(null===(t=N[h])||void 0===t||null===(t=t.body)||void 0===t||null===(t=t.message)||void 0===t?void 0:t.message_id)||"",transcript:d?JSON.stringify(d):"",highlights_message_id:h}}})}));return function(){return e.apply(this,arguments)}}();return(0,z.useEffect)((()=>{(0,p.ku)()&&(0,m.ae)(m.vP.video_page_summarize,m.p6.videosummary)}),[]),(0,K.jsxs)("div",{className:$e.footer,children:[(0,K.jsxs)("div",{className:$e.actionFooterBtn,children:[(0,K.jsx)(ce.$n,{className:$e.chatButton,size:"small",icon:(0,K.jsx)(de.oE,{}),onClick:e,children:f("flow_web_ext_action_translate_chat")}),(0,K.jsxs)("div",{className:$e.rightOperationButtons,children:[v&&(0,K.jsx)("div",{className:$e.buttonItem,children:(0,K.jsx)(ce.m_,{content:f(I?"flow_web_ext_podcast_downloaded_hover":"flow_web_ext_podcast_download_hover"),getPopupContainer:()=>t.current,children:(0,K.jsx)("div",{children:I?(0,K.jsx)(et.eWz,{className:$e.commonIcon}):(0,K.jsx)(et.sxB,{className:$e.commonIcon,onClick:()=>{if(I)return;const e=new(Ye()),t=(0,oe.Ev)(d);t&&e.file("timeline.csv",t),e.file("summary.txt",o),e.generateAsync({type:"blob"}).then((e=>{var t;null===(t=Je().saveAs)||void 0===t||t.call(Je(),e,"doubao-summary-transcript.zip"),E(!0)}))},"data-testid":"media-summary-assistant-download-button"})})})}),(0,K.jsx)("div",{className:$e.buttonItem,children:(0,K.jsx)(ce.m_,{content:f("message_long_press_copy"),getPopupContainer:()=>t.current,children:(0,K.jsx)(lt,{style:{fontSize:20},onCopyClick:n,"data-testid":"video-summary-assistant-copy-button"})})}),(0,p.ku)()&&(0,K.jsx)("div",{className:$e.buttonItem,children:(0,K.jsx)(ce.m_,{content:f("flow_web_ext_action_bookmarks"),getPopupContainer:()=>t.current,children:(0,K.jsx)("div",{children:(0,K.jsx)(et.Wur,{className:$e.commonIcon,onClick:M,"data-testid":"video-summary-assistant-collect-button"})})})}),(0,K.jsx)("div",{children:k&&(0,K.jsx)("div",{ref:w,onMouseDown:e=>e.stopPropagation(),style:{position:"relative"},children:(0,K.jsx)(ce.ms,{trigger:"custom",visible:_,onVisibleChange:y,onClickOutSide:()=>y(!1),className:$e.shareDropdownContainer,position:"topRight",getPopupContainer:()=>w.current,render:(0,K.jsxs)("div",{children:[(0,K.jsxs)("div",{className:$e.shareDialogHeader,children:[(0,K.jsx)("div",{className:$e.title,children:f("flow_web_ext_youtube_sharepage_share")}),(0,K.jsx)(de.gz,{className:$e.icon,onClick:()=>y(!1)})]}),(0,K.jsxs)("div",{children:[(0,K.jsxs)("div",{className:$e.shareItemContainer,onClick:()=>j({shareAll:!1}),"data-testid":"video-summary-assistant-share-single-clip-button",children:[(0,K.jsx)("div",{children:"\u{1f4c4}"}),(0,K.jsx)("div",{className:$e.shareItemText,children:f("flow_web_ext_youtube_sharepage_share_clip")})]}),(0,K.jsxs)("div",{className:$e.shareItemContainer,onClick:()=>j({shareAll:!0}),"data-testid":"video-summary-assistant-share-all-clip-button",children:[(0,K.jsx)("div",{children:"\u{1f4d1}"}),(0,K.jsx)("div",{className:$e.shareItemText,children:f("flow_web_ext_youtube_sharepage_share_page")})]})]})]}),children:(0,K.jsx)(ce.$n,{className:$e.button,size:"small",theme:"solid",onClick:()=>{y(!0),dt("show_button",{button_type:"share",current_page:"youtube",range:"page"}),dt("show_button",{button_type:"share",current_page:"youtube",range:"current_clip"})},"data-testid":"video-summary-assistant-share-button",icon:(0,K.jsx)(de.$,{className:$e.uploadIcon}),children:f("flow_web_ext_youtube_sharepage_share")})})})})]})]}),We.createPortal((0,K.jsx)(ht,{visible:x}),null==A?void 0:A.current)]})};var gt=n(85371);const pt=e=>{var t;const{transcript:n,mediaElement:i}=e,s=(null==n||null===(t=n[(null==n?void 0:n.length)-1])||void 0===t?void 0:t.offset)/1e3>3600||!1;return(0,K.jsx)("div",{className:$e["transcript-container"],children:null==n?void 0:n.map(((e,t)=>{if((0,gt.A)(null==e?void 0:e.offset)||!(0,oe.nG)(null==e?void 0:e.offset)||!e.text)return;const n=(0,oe.i1)(e.offset/1e3,s);return(0,K.jsxs)("div",{className:$e.timeline,children:[(0,K.jsx)("div",{className:$e.time,style:{minWidth:s?"70px":"50px"},onClick:()=>{return t=e.offset/1e3,void(i&&(i.currentTime=t,i.play()));var t},children:n}),(0,K.jsx)("div",{className:$e.text,children:e.text})]},t)}))})};let vt=function(e){return e.summary="summary",e.transcript="transcript",e}({});var ft=n(9012),_t=n(85886),yt=n(39625),xt=n(6693);const bt="__Cici_translate_similar_text_content__",At="__Cici_translate_origin_node__",wt="__Cici_translate_translated_inject_node__",St="__Cici_translate_need_wrapper__",Ct="lle-page-translate-retry",kt="__Cici_translate_loading__",It="__Cici_translate_clamp_unset__",Et="__Cici_translate_global_wrapper__",Tt="__Cici_translated_text_show_underline__",jt="__Cici_translate_hide_origin_content_wrapper__",Nt="__Cici__translate__",Mt="highlight-list-wrapper-xihFaP",Lt="content-breakdown-wrapper-ZO8UZw",Rt="highlight-title-aEzmlu",Pt="breakdownContainer-hE5NKx",Bt="breakdownExpand-eXdPNP",Ot="breakdownTitle-c4_spY",Dt="breakdownIsPlaying-nx8qEe",Ft="breakdownTag-wncJGJ",Ut="activeTag-SApbRQ",Ht="breakdownContentContainer-kJyNZ5",zt="breakdownSectionContainer-oZtSm0",qt="breakdownContent-NHj0oy",Vt="expandIconContainer-cezszg",$t="expandIconBg-lnivJk",Kt="isExpanding-s5YPFu",Wt="bulletPointContainer-bmPPeT",Gt="pointTimestamp-XpceP1",Yt="pointContent-Tui7tV",Qt="currentActiveBulletPoint-MnWa2i",Jt="activeBreakdownContainer-CjiZNA",Xt="progressBarContainer-c3vF1o",Zt="progressBar-mU8Ne9",en=({timestamp:e,section:t,bulletPoints:n,trackResultEvent:i,trackHighlightEvent:s,isCurrentActiveBreakdown:o,progress:a=0,currentActiveBulletPointIndex:r,isLastTimestampOverHour:l,onChangeVideoState:c,breakdownIndex:d,calcProgress:u,highlightContainerRef:h,videoElement:m,isImmersionMode:g=!1,handleUserInteract:p,userInteracting:v,activeScroll:f})=>{const _=(0,z.useRef)(null),[y,x]=(0,z.useState)(g),{highlightExploreCount:b}=(0,ie.e)(),A=t=>{s(Q.Ur.showVideoAssistantHighlightsTimeline,Number(e),t,g)};(0,z.useEffect)((()=>{_.current&&(0,oe.Is)(_.current,A)}),[]),(0,z.useEffect)((()=>{o&&x(!0)}),[o]);const w=(0,z.useCallback)((0,xt.A)((()=>{const e=h.current,t=_.current;if(e&&t){var n,i,s,o,a,r,l;const u=null==e?void 0:e.getBoundingClientRect(),h=null==t?void 0:t.getBoundingClientRect(),m=(null!==(n=null==e?void 0:e.scrollTop)&&void 0!==n?n:0)+(null!==(i=null==h?void 0:h.top)&&void 0!==i?i:0)-(null!==(s=null==u?void 0:u.top)&&void 0!==s?s:0),p=(null!==(o=null==t?void 0:t.offsetTop)&&void 0!==o?o:0)-40,v=(null!==(a=null==t?void 0:t.offsetHeight)&&void 0!==a?a:0)+(null!==(r=null==t?void 0:t.offsetTop)&&void 0!==r?r:0)-(null!==(l=null==e?void 0:e.offsetHeight)&&void 0!==l?l:0)+40;var c;if(g)if((null==h?void 0:h.top)<(null==u?void 0:u.top))null==e||e.scrollTo({top:p,behavior:"smooth"});else if((null==u?void 0:u.bottom)<(null==h?void 0:h.bottom))null==e||e.scrollTo({top:v,behavior:"smooth"});else{var d;null===(d=_.current)||void 0===d||d.scrollIntoViewIfNeeded(!0)}else if(t.clientHeight>400)null==e||e.scrollTo({top:m,behavior:"smooth"});else null===(c=_.current)||void 0===c||c.scrollIntoViewIfNeeded(!0)}}),g?600:100),[h,g]);return(0,z.useEffect)((()=>{f&&o&&!v&&w()}),[v,o,f,g]),(0,K.jsxs)("div",{className:re()(Pt,"__Cici__video_highlight__",{[Bt]:y,[Jt]:o}),ref:_,children:[(0,K.jsxs)("div",{style:{zIndex:1},"data-testid":`video-summary-assistant-highlight-item-${d}`,className:re()(Ot,{[Dt]:o}),onClick:t=>{m&&(c({currentActiveBulletPointIndex:0,currentActiveBreakdownIndex:d,progress:0}),m.currentTime=Number(e),m.play(),i(Q._h.highlightSelectionBar),s(Q.Ur.clickVideoAssistantHighlightsTimeline,Number(e),b,g),t.stopPropagation(),x(!0),w())},children:[(0,K.jsx)(ce.vw,{className:re()(Ft,{[Ut]:o}),children:(0,oe.i1)(e,l)}),(0,K.jsxs)("div",{className:Ht,children:[(0,K.jsxs)("div",{className:zt,children:[(0,K.jsx)("div",{className:qt,"data-testid":`video-summary-assistant-breakdown-content-${d}`,children:t}),(o||y)&&(0,K.jsx)("div",{className:Xt,children:(0,K.jsx)("div",{style:{width:o?100*a+"%":0},className:Zt})})]}),n&&(null==n?void 0:n.length)>0&&(0,K.jsx)("div",{className:re()(Vt,{[Kt]:y}),onClick:e=>{x(!y),p(),i(y?Q._h.fold:Q._h.expand),e.stopPropagation()},children:(0,K.jsx)("div",{className:$t,children:(0,K.jsx)(de.Pl,{})})})]})]}),(0,K.jsx)("div",{"data-testid":`video-summary-assistant-bullet-points-${d}`,children:y&&n&&(null==n?void 0:n.length)>0&&(0,K.jsx)(K.Fragment,{children:n.map(((e,t)=>(0,oe.nG)(null==e?void 0:e.timestamp)&&e.point?(0,K.jsxs)("div",{className:re()(Wt,{[Qt]:r===t&&o}),onClick:()=>{var n;m&&(c({currentActiveBreakdownIndex:d,currentActiveBulletPointIndex:t,progress:u(d,null!==(n=Number(e.timestamp))&&void 0!==n?n:0)}),m.currentTime=Number(e.timestamp),m.play(),i(Q._h.highlightSelectionBar),s(Q.Ur.clickVideoAssistantHighlightsTimeline,Number(e.timestamp),b,g),w())},children:[(0,K.jsx)(ce.vw,{className:Gt,children:(0,oe.i1)(e.timestamp,l)}),(0,K.jsx)("div",{className:Yt,children:e.point})]},t):(0,K.jsx)(K.Fragment,{})))})})]})},tn=({text:e,mediaElement:t,trackResultEvent:n,trackHighlightEvent:i,videoDuration:s=0,videoState:a,setVideoState:r,isImmersionMode:l,handleUserInteract:c,userInteracting:d,activeScroll:u})=>{const h=(0,$.B)(),m=(0,z.useRef)(null),g=(0,z.useMemo)((()=>t||((0,ue.jB)("youtube")?document.querySelector(".video-stream"):document.querySelector("video"))),[t]),p=(0,oe.Bq)(e),v=(e,t)=>{var n,i,o,a,r;return e===p.length-1?(t-(null===(a=p[e])||void 0===a?void 0:a.timestamp))/(s-(null===(r=p[e])||void 0===r?void 0:r.timestamp)):(t-(null===(n=p[e])||void 0===n?void 0:n.timestamp))/((null===(i=p[e+1])||void 0===i?void 0:i.timestamp)-(null===(o=p[e])||void 0===o?void 0:o.timestamp))};(0,z.useEffect)((()=>{const e=(0,ft.A)(m,"current"),t=()=>{c()};if(e)return e.addEventListener("scroll",t),()=>{e.removeEventListener("scroll",t)}}),[]),(0,z.useEffect)((()=>{p&&p.length>0&&g&&(g.ontimeupdate=(0,_t.A)((()=>{p.map(((e,t)=>{var n;if(g.currentTime>=Number(null==e?void 0:e.timestamp)&&(g.currentTime<Number(null===(n=p[t+1])||void 0===n?void 0:n.timestamp)||t===p.length-1)){r((e=>(0,o.A)((0,o.A)({},e),{},{currentActiveBreakdownIndex:t,currentActiveBulletPointIndex:0,progress:v(t,g.currentTime)})));const n=null==e?void 0:e.bullet_points;null==n||n.map(((e,t)=>{var i;g.currentTime>=Number(null==e?void 0:e.timestamp)&&(g.currentTime<Number(null==n||null===(i=n[t+1])||void 0===i?void 0:i.timestamp)||t===(null==n?void 0:n.length)-1)&&r((e=>(0,o.A)((0,o.A)({},e),{},{currentActiveBulletPointIndex:t})))}))}}))}),300))}),[]);const f=(0,yt.wR)(p.length,{from:{opacity:0,maxHeight:0},to:{opacity:1,maxHeight:1e3},config:{duration:200}});if(p&&p.length>0){const e=(e,t)=>(0,K.jsx)(en,{timestamp:e.timestamp,section:e.section,bulletPoints:e.bullet_points,trackResultEvent:n,trackHighlightEvent:i,isCurrentActiveBreakdown:t===a.currentActiveBreakdownIndex,currentActiveBulletPointIndex:a.currentActiveBulletPointIndex,progress:Number(a.progress),breakdownIndex:t,isLastTimestampOverHour:(0,oe.n7)(p)>=3600,onChangeVideoState:({currentActiveBreakdownIndex:e,currentActiveBulletPointIndex:t,progress:n})=>r((i=>(0,o.A)((0,o.A)({},i),{},{currentActiveBreakdownIndex:null!=e?e:i.currentActiveBreakdownIndex,currentActiveBulletPointIndex:null!=t?t:i.currentActiveBulletPointIndex,progress:null!=n?n:i.progress}))),calcProgress:v,highlightContainerRef:m,videoElement:g,isImmersionMode:l,handleUserInteract:c,userInteracting:d,activeScroll:u},t);return(0,K.jsxs)("div",{id:"cici-assistant-highlights",className:Mt,"data-testid":"video-summary-assistant-highlights",children:[(0,K.jsx)("div",{className:Rt,children:h("flow_web_ext_youtube_highlights")}),(0,K.jsx)("div",{className:Lt,ref:m,children:l?f.map(((t,n)=>(0,K.jsx)(yt.CS.div,{style:(0,o.A)((0,o.A)({},t),{},{overflow:"hidden",marginBottom:"10px"}),children:e(p[n],n)},n))):p.map(((t,n)=>(0,oe.nG)(null==t?void 0:t.timestamp)&&t.section?e(t,n):null))})]})}return(0,K.jsx)(K.Fragment,{})};var nn=n(16380),sn=n.n(nn),on=n(97164),an=n(72372),rn=n(31704),ln=n(73795),cn=n(33413),dn=n(57787);const un=["slots","autoFixSyntax"],hn=(0,z.forwardRef)((function(e,t){let{slots:n={},autoFixSyntax:i=!0}=e,s=(0,je.A)(e,un);return(0,K.jsx)(dn.FH,(0,o.A)({ref:t,slots:(0,an.A)(n,{Tex:cn.MathJaxTex,CodeBlockHighlighter:ln.PrismCodeBlockHighlighter}),autoFixSyntax:i&&(0,o.A)({katex:rn.default},(0,on.A)(i)?{}:i)},s))}));var mn=n(23627),gn=n(63522),pn=n(85335);const vn="failureMsg-CQv3Nt",fn=e=>{const t=(0,$.B)();return(0,K.jsxs)("div",{className:vn,children:[(0,K.jsx)(de.o0,{}),"fail"===e.type&&(0,K.jsx)("span",{children:(0,K.jsxs)(pn.x,{i18nKey:"flow_web_ext_search_fail_x",children:["Generate failed",(0,K.jsx)("a",{href:"#",onClick:t=>{var n;t.preventDefault(),null===(n=e.onRetry)||void 0===n||n.call(e)},children:"retry"})]})}),"overload"===e.type&&(0,K.jsxs)("span",{children:[" ",t("flow_web_ext_search_overload")]})]})},_n="dot-flashing-tY0s3i",yn="disabled-92Mg9r",xn=({disabled:e=!1})=>(0,K.jsx)("div",{"data-testid":"dot-flashing",className:re()(_n,{[yn]:e})}),bn=sn().bind({"cici-ext-container":"cici-ext-container-cHKkaZ",ciciExtContainer:"cici-ext-container-cHKkaZ","inactivelink-hover-animation":"inactivelink-hover-animation-cI1oFG",inactivelinkHoverAnimation:"inactivelink-hover-animation-cI1oFG","notactivelink-hover-animation":"notactivelink-hover-animation-OwGmzQ",notactivelinkHoverAnimation:"notactivelink-hover-animation-OwGmzQ","light-click-animation":"light-click-animation-uLAyJ8",lightClickAnimation:"light-click-animation-uLAyJ8","click-animation":"click-animation-TXvTAL",clickAnimation:"click-animation-TXvTAL","semi-animation-rotate":"semi-animation-rotate-GHrtgv",semiAnimationRotate:"semi-animation-rotate-GHrtgv","inactive-btn-hover-animation":"inactive-btn-hover-animation-D_DftX",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-D_DftX","cici-ext-always-dark":"cici-ext-always-dark-z_3gqK",ciciExtAlwaysDark:"cici-ext-always-dark-z_3gqK","cici-ext-always-light":"cici-ext-always-light-HTNkT5",ciciExtAlwaysLight:"cici-ext-always-light-HTNkT5",ellipsis:"ellipsis-tW3jMv",wrapper:"wrapper-dd4lUG","has-more":"has-more-_fO3cj",hasMore:"has-more-_fO3cj",inner:"inner-Ve1jl9","enable-scroll":"enable-scroll-t0C3zh",enableScroll:"enable-scroll-t0C3zh","activelink-hover-animation":"activelink-hover-animation-Ufh8M6",activelinkHoverAnimation:"activelink-hover-animation-Ufh8M6"}),An=(0,z.forwardRef)(((e,t)=>{const{className:n,styles:i,children:s,enableScroll:o=!0,containerClassName:a,showShadow:r=!0}=e,[l,c]=(0,z.useState)(!1),d=(0,z.useCallback)((0,_t.A)((e=>{const{scrollHeight:t,clientHeight:n,scrollTop:i}=e;c(t-n-i>=2)}),200,{leading:!0}),[]);return(0,z.useEffect)((()=>{const e=(0,ft.A)(t,"current"),n=()=>{d(e)};if(e){e.addEventListener("scroll",n);const t=new MutationObserver((()=>d(e)));return t.observe(e,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeFilter:["class","style"]}),()=>{e.removeEventListener("scroll",n),t.disconnect()}}}),[]),(0,K.jsx)("div",{className:bn("wrapper",a,{"has-more":l&&r}),children:(0,K.jsx)("div",{className:bn(n,"inner",{"enable-scroll":o}),ref:t,style:i,children:s})})})),wn=An,Sn={"cici-ext-container":"cici-ext-container-cwkaXi",ciciExtContainer:"cici-ext-container-cwkaXi","inactivelink-hover-animation":"inactivelink-hover-animation-jtgbD5",inactivelinkHoverAnimation:"inactivelink-hover-animation-jtgbD5","notactivelink-hover-animation":"notactivelink-hover-animation-kQNgSQ",notactivelinkHoverAnimation:"notactivelink-hover-animation-kQNgSQ","light-click-animation":"light-click-animation-dzLBTC",lightClickAnimation:"light-click-animation-dzLBTC","click-animation":"click-animation-elidtS",clickAnimation:"click-animation-elidtS","semi-animation-rotate":"semi-animation-rotate-bS1vd9",semiAnimationRotate:"semi-animation-rotate-bS1vd9","inactive-btn-hover-animation":"inactive-btn-hover-animation-aMr3TK",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-aMr3TK","cici-ext-always-dark":"cici-ext-always-dark-IBLAYT",ciciExtAlwaysDark:"cici-ext-always-dark-IBLAYT","cici-ext-always-light":"cici-ext-always-light-kFnVOm",ciciExtAlwaysLight:"cici-ext-always-light-kFnVOm",ellipsis:"ellipsis-GnOiMR",message:"message-AguzyJ",enableScroll:"enableScroll-_KZA2R",placeholder:"placeholder-lfssXU","activelink-hover-animation":"activelink-hover-animation-CbI9P3",activelinkHoverAnimation:"activelink-hover-animation-CbI9P3"},Cn=sn().bind(Sn),kn=(0,r.jco)(),In=({className:e,style:t,id:n,type:i,query:s="",enableScroll:a=!1,autoScrollToEnd:r=!0,skeletonRow:l=3,onRetry:c,containerClassName:d,showShadow:u=!0,textFormatter:h,loadingStyle:m="skeleton",MDBoxProps:g={},smooth:p=!0})=>{const[v,f]=(0,z.useState)(!1),_=(0,z.useRef)(null),y=(0,st.P)((e=>e.messages[n])),x=(0,$.B)(),{isDone:b,isError:A,isAborted:w,text:S="",jsonData:C}=y||{},k=!(S||A||b||w),I=!A&&Boolean(S);(0,z.useEffect)((()=>{if(_.current){let e=0;const t=()=>{var n;const i=null===(n=_.current)||void 0===n?void 0:n.scrollTop;var s;i<e&&(f(!0),null===(s=_.current)||void 0===s||s.removeEventListener("scroll",t));e=i};return _.current.addEventListener("scroll",t),()=>{var e;null===(e=_.current)||void 0===e||e.removeEventListener("scroll",t)}}}),[]),(0,z.useLayoutEffect)((()=>{const e=_.current;e&&r&&!v&&e.scrollTo({top:e.scrollHeight})}),[y]),(0,z.useLayoutEffect)((()=>{const e=_.current;e&&b&&r&&!v&&setTimeout((()=>e.scrollTo({top:e.scrollHeight})),300)}),[b]),(0,z.useEffect)((()=>{if(A||w){const e="search"===i?"search_card_show":"highlight_function_click";dt("generation_failure",{err_code:null==C?void 0:C.code,err_tips:null==C?void 0:C.msg,scene:e})}}),[A,w]);const E=k?"loading":A||w?"failed":b?"done":"init";return(0,K.jsxs)("div",{"data-testid":`stream-message-${E}`,children:["loadingBar"===m&&k&&(0,K.jsx)(gn.c_,{text:s,t:x,searchType:mn.n.DeepSearch}),(0,K.jsx)(ce.EA,{loading:"selection"!==i&&"skeleton"===m&&k,placeholder:(0,K.jsx)("div",{className:Sn.placeholder,children:(0,K.jsx)(ce.EA.Paragraph,{rows:l})}),active:!0,children:(0,K.jsx)(wn,{className:Cn("message",e),containerClassName:d,styles:(0,o.A)({},t),enableScroll:a,ref:_,showShadow:u,children:(0,K.jsxs)(K.Fragment,{children:[k&&"selection"===i&&(0,K.jsx)(xn,{}),I&&(0,K.jsx)(hn,(0,o.A)((0,o.A)({markDown:h?h(y):S,showIndicator:!b,smooth:{enable:!!p&&!b},autoFitRTL:!0},g),{},{style:kn?{fontSize:"16px"}:{}}),n),(A||w)&&(0,K.jsx)(fn,{type:"fail",onRetry:c})]})})})]})},En=({available:e,hasNoSubtitles:t,hasShowedUserGuidance:n,noContent:i,contentVisible:s,videoSummaryId:o,mediaElement:a,activeTab:r,onRetry:l,isHighlightsDone:c,transcript:d,highlightsResult:u,trackResultEvent:h,trackHighlightEvent:m,videoState:g,setVideoState:p,handleUserInteract:v,userInteracting:f,isImmersionMode:_})=>{const y=(0,$.B)(),x=()=>(0,K.jsxs)("div",{className:$e["first-time-use-summarize"],"data-testid":"video-summary-assistant-first-time-use-summarize",children:[(0,K.jsx)("div",{style:{marginRight:4},children:"\u{1f449}"}),(0,K.jsx)("div",{children:y("flow_web_ext_youtube_welcome")})]}),b=(0,K.jsxs)("div",{className:$e.highlightPlaceholder,children:[(0,K.jsx)("div",{className:$e.highlightPlaceholderTitle,children:y("flow_web_ext_youtube_highlights")}),(0,K.jsx)(ce.EA.Paragraph,{rows:3})]});if(t)return(0,K.jsxs)("div",{className:$e["no-transcript"],"data-testid":"video-summary-assistant-no-transcript",children:[!n&&x(),(0,K.jsx)("div",{className:$e["no-subtitles-with-guidance"],children:y("flow_web_ext_youtube_nosubtitles",{brand:(0,he.L2)()})})]});if(e&&!n&&void 0!==n)return x();if(i)return(0,K.jsx)("div",{className:$e["no-transcript"],children:y("flow_web_ext_youtube_error")});const A=()=>{var e,t;return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("div",{className:$e.content,children:(0,K.jsx)("div",{className:$e.summary,children:(0,K.jsx)(In,{id:o,onRetry:l,type:"summary",className:$e.streamMessage,enableScroll:!0,autoScrollToEnd:!1,containerClassName:$e.scrollContainer})})}),(0,K.jsx)(ce.EA,{placeholder:b,loading:!c,active:!0,children:(0,K.jsx)(tn,{videoDuration:((null==d||null===(e=d[(null==d?void 0:d.length)-1])||void 0===e?void 0:e.offset)+(null==d||null===(t=d[(null==d?void 0:d.length)-1])||void 0===t?void 0:t.duration))/1e3,mediaElement:a,text:u,trackResultEvent:h,trackHighlightEvent:m,videoState:g,setVideoState:p,handleUserInteract:v,userInteracting:f,activeScroll:!_})})]})};return e&&s?r?(0,K.jsxs)("div",{children:[(0,K.jsx)("div",{className:re()({[$e["tab-inactive"]]:r!==vt.summary}),children:A()}),(0,K.jsx)("div",{className:re()({[$e["tab-inactive"]]:r!==vt.transcript}),children:(0,K.jsx)(pt,{transcript:d,mediaElement:a})})]}):A():null};var Tn=n(94654),jn=n(60588);const Nn=e=>new Promise((t=>setTimeout(t,e))),Mn="PING",Ln="PONG",Rn="PAGE_TRANSLATED";chrome.runtime.Port;let Pn=function(e){return e.EXT="EXTENSION",e.PAGE="WEB_PAGE",e}({});const Bn="CICI_X_EVENT_CHANNEL";const On=new class{constructor(){var e=this;(0,f.A)(this,"xeeId",(0,Tn.A)()),(0,f.A)(this,"ee",new jn.A),(0,f.A)(this,"port",void 0),(0,f.A)(this,"onMsgCallbackMap",new Map),(0,f.A)(this,"getPortWithRetry",function(){var t=(0,a.A)((function*(t){let n=3;for(;n>0;){const i=yield e.getPort(t);if(i)return i;yield Nn(2e3),n-=1}return null}));return function(e){return t.apply(this,arguments)}}()),(0,f.A)(this,"getPort",function(){var t=(0,a.A)((function*(t){if(e.port)return e.port;if(t===Pn.EXT){const t=yield e.createMsgPortByExt();if(t)return e.port=t,e.listen(),e.port}return null}));return function(e){return t.apply(this,arguments)}}()),(0,f.A)(this,"testConnection",function(){var t=(0,a.A)((function*(t){const n=new Promise((n=>{const i=e.makeMsg(Mn,e.xeeId);t.postMessage(i),t.onMessage.addListener((t=>{var i;t.name===Ln&&(null==t||null===(i=t.params)||void 0===i?void 0:i[0])===e.xeeId&&n(!0)}))})),i=new Promise((e=>{setTimeout((()=>{e(!1)}),3e3)}));return Promise.race([n,i])}));return function(e){return t.apply(this,arguments)}}()),(0,f.A)(this,"createMsgPortByExt",(0,a.A)((function*(){const t=yield e.getCurrentTabId();if(!t)return;const n=chrome.tabs.connect(t,{name:Bn});n.onDisconnect.addListener((()=>{window.close()}));return(yield e.testConnection(n))?n:null}))),(0,f.A)(this,"getCurrentTabId",(0,a.A)((function*(){return new Promise((e=>{chrome.tabs.query({active:!0,currentWindow:!0},(t=>{var n;const i=null===(n=t[0])||void 0===n?void 0:n.id;e(i)}))}))}))),(0,f.A)(this,"waitForConnection",(()=>{const e=e=>{e.name===Bn&&(this.port=e,this.listen())};chrome.runtime.onConnect.addListener(e),window.onbeforeunload=()=>{var t;chrome.runtime.onConnect.removeListener(e),null===(t=this.port)||void 0===t||t.disconnect()}})),(0,f.A)(this,"listen",(()=>{var e;null===(e=this.port)||void 0===e||e.onMessage.addListener((e=>{this.onMsgCallbackMap.forEach((t=>{t(e)}))}))})),(0,f.A)(this,"makeMsg",((e,...t)=>({name:e,params:(0,o.A)({},t)}))),(0,f.A)(this,"makeMsgCallback",((e,t)=>n=>{if(n.name===e){const e=Object.values(n.params);t(...e)}})),(0,f.A)(this,"on",((e,t,n)=>{this.ee.on(e,n);const i=(0,Tn.A)(),s=this.makeMsgCallback(e,n);return this.onMsgCallbackMap.set(i,s),()=>{this.ee.off(e,n),this.onMsgCallbackMap.delete(i)}})),(0,f.A)(this,"emit",function(){var t=(0,a.A)((function*(t,n,i){e.ee.emit(t,i);const s=yield e.getPortWithRetry(n);if(s){const n=e.makeMsg(t,i);s.postMessage(n)}else console.error("NO PORT FOUND, OPEN POPUP TO CREATE ONE")}));return function(e,n,i){return t.apply(this,arguments)}}()),this.waitForConnection()}};var Dn=n(31937),Fn=n(79124),Un=n.n(Fn),Hn=n(20283),zn=n.n(Hn);const qn=function(){var e=(0,a.A)((function*({videoID:e,useUILang:t=!0,lang:n="en"}){const i=yield fetch(location.href),s=yield i.text();if(!s.includes("captionTracks"))return console.warn(`No captions found for video: ${e}`),[];const o=/"captionTracks":(\[.*?\])/.exec(s);if(!o)return console.warn(`Failed to extract captionTracks from video: ${e}`),[];const[a,r]=o,l=JSON.parse(r),c=t?(0,fe.wz)((0,X.TK)("uiLanguage")):n;let d;d=c.includes("zh")?[c,"zh","zh-Hans","zh-Hant","en","es","ja"]:[c,"en","es","ja"];const u=(0,Dn.A)(d.map((e=>{const t=l.find((t=>"en"===e?t.languageCode.includes(e):t.languageCode===e));return t}))),h=l[0],m=u[0]||h;if(null==m||!m.baseUrl)return console.warn(`Could not find ${n} captions for ${e}`),[];const g=yield fetch(m.baseUrl),p=yield g.text(),v=/start="([\d.]+)"/,f=/dur="([\d.]+)"/;return p.replace('<?xml version="1.0" encoding="utf-8" ?><transcript>',"").replace("</transcript>","").split("</text>").filter((e=>e&&e.trim())).reduce(((e,t)=>{const n=v.exec(t),i=f.exec(t);if(!n||!i)return console.warn(`Failed to extract start or duration from line: ${t}`),e;const[,s]=n,[,o]=i,a=t.replace(/<text.+>/,"").replace(/&amp;/gi,"&").replace(/<\/?[^>]+(>|$)/g,""),r=zn().decode(a),l=Un()(r);return e.push({start:s,dur:o,text:l}),e}),[]).map((e=>{const{start:t,dur:n,text:i}=e;return{text:i,duration:1e3*parseInt(n),offset:1e3*parseInt(t)}}))}));return function(t){return e.apply(this,arguments)}}(),Vn=function(){var e=(0,a.A)((function*({videoId:e}){return(0,ue.jB)("youtube")?yield qn({videoID:e}):(0,ue.jB)("bilibili")?yield(0,nt.SY)({videoId:e}):void 0}));return function(t){return e.apply(this,arguments)}}();var $n=n(79962),Kn=n(32750),Wn=n(43523),Gn=n(22315),Yn=n(62745),Qn=n(89996);let Jn;const Xn="has_showed_user_guidance",Zn=function(){var e=(0,a.A)((function*(e){var t;const n=yield Wn.A.get(Xn);Jn=void 0!==n&&Boolean(n),e(null!==(t=Boolean(n))&&void 0!==t&&t)}));return function(t){return e.apply(this,arguments)}}(),ei=({videoParamId:e,videoTitle:t,isImmersionMode:n})=>{const i=(0,z.useRef)((0,Te.o6)()),[s,r]=(0,z.useState)(""),[l,c]=(0,z.useState)(""),d=(0,X.TK)("uiLanguage"),[u,h]=(0,z.useState)(d),m=(0,st.P)((e=>e.sendMessage)),g=(0,st.P)((e=>e.messages));(0,z.useEffect)((()=>{On.on("SUMMARIZE VIDEO",Pn.PAGE,(()=>{F({clickFrom:Me.ONBOARDING})}))}),[]);const p=(0,z.useMemo)((()=>Yn.Qz.create("cici_video_summary_action_perf")),[]),[v,f]=(0,z.useState)(!1),[_,y]=(0,le.I_)(),[x,b]=(0,z.useState)(!1),[A,w]=(0,z.useState)(!1),[S,C]=(0,z.useState)(Jn),[k,I]=(0,Qn.r)(Xn),{isDone:E,text:T="",isUnAuthorized:j}=g[s]||{},{isDone:N,text:M="",isUnAuthorized:L}=g[l]||{},R=le._1.hasTranscript(),{setIsLoadingDone:P}=(0,ie.e)();(0,z.useEffect)((()=>{P(!(!N||!M))}),[N,M]);const B=A&&R&&N&&E&&!(0,oe.ld)(M)&&!T,O=!R&&v&&!x,D=function(){var t=(0,a.A)((function*(){try{const t=yield Vn({videoId:e});return le._1.updateTranscriptData(t),t}catch(t){le._1.updateTranscriptData([])}finally{f(!0),b(!1)}}));return function(){return t.apply(this,arguments)}}(),F=function(){var e=(0,a.A)((function*({clickFrom:e,translateLang:n}){if((({click_from:e})=>{(0,Y.z8)(Q.Ur.clickVideoAssistantSummarizeBtn,{click_from:e,button_name:Q._h.summarizeVideo})})({click_from:e}),le._1.updateModuleClickFrom(e),w(!0),y(!0),C(!0),(0,Kn.BB)({action:"web_video_summary",loginParams:{}}))return;null==p||p.start(),null==p||p.mark("request_transcript_start");const i=yield D();null==p||p.mark("request_start");const s={title:t,url:location.href,transcript_list:i};i&&i.length>0&&(((e,t)=>{const n=m((0,o.A)((0,o.A)({},e),{},{browser_language:(0,fe.wz)(null!=t?t:d),current_page:(0,Y.M5)(location.href),scene:$n.sJ.youtube_click,sec_scene:$n._o.youtube_click_summarize}));r(n),le._1.updateVideoSummaryId(n)})({text:location.href,prompt:Gn.EU.youtube,browser_youtube_transcript:{browser_youtube_summary_transcript:JSON.stringify(s)}},n),((e,t)=>{const n=m((0,o.A)((0,o.A)({},e),{},{browser_language:(0,fe.wz)(null!=t?t:d),current_page:(0,Y.M5)(location.href),scene:$n.sJ.youtube_click,sec_scene:$n._o.youtube_click_summarize}));c(n),le._1.updateVideoHighlightsId(n)})({text:location.href,prompt:Gn.EU.youtube,browser_youtube_transcript:{browser_youtube_timeline_transcript:JSON.stringify(s)}},n))}));return function(t){return e.apply(this,arguments)}}();return(0,z.useEffect)((()=>{if(le._1.resetVideoSummaryStatus(),_){const e=le._1.getLastClickRelayBtnType()||Me.UPPER_RIGHT;e&&F({clickFrom:e})}}),[]),(0,z.useEffect)((()=>{Zn((e=>{C(e)}))}),[]),(0,z.useEffect)((()=>{var t;t=i.current?Le.ONBOARDING:Le.UPPER_RIGHT,(0,Y.z8)(Q.Ur.showVideoAssistant,{show_from:t}),e&&(b(!0),D()),I(!0)}),[]),(0,z.useEffect)((()=>{E&&(null==p||p.mark("response_summary_done"))}),[E]),(0,z.useEffect)((()=>{N&&(null==p||p.mark("response_timeline_done"))}),[N]),(0,z.useEffect)((()=>{var e;E&&N&&(null==p||p.end("response_end"),e={summary_message_id:T?s:"",highlights_message_id:(0,oe.ld)(M)?l:"",language:(0,fe.wz)(u),is_immersion:n,click_from:le._1.getModuleClickFrom()},Ue(Q.Ur.showVideoAssistantSummarizeResult,e))}),[E,N,n]),{videoSummaryId:s,videoHighlightsId:l,translateLanguage:u,transcript:le._1.getTranscriptData(),isTranscriptLoaded:v,contentVisible:A,isSummaryDone:E,isHighlightsDone:N,hasTranscript:R,summaryResult:T,highlightsResult:M,summarizeTriggered:_,noContent:B,hasNoSubtitles:O,hasShowedUserGuidance:S,setTranslateLanguage:h,handleSummarizeVideo:F,isMessageUnAuthorized:L||j}};var ti=n(63379),ni=n(34870),ii=n(45498);const si={showSetting:!1,buttonHeight:33,subtitleReady:!1,popoverPosition:{left:0,bottom:0},resetVideoUI:0,isFullscreen:!1},oi=(0,ii.vt)()((0,ni.eh)((e=>(0,o.A)((0,o.A)({},si),{},{setResetVideoUI:t=>e({resetVideoUI:t}),setShowSetting:t=>e({showSetting:t}),setButtonHeight:t=>e({buttonHeight:t}),setSubtitleReady:t=>e({subtitleReady:t}),setPopoverPosition:t=>e({popoverPosition:t}),setIsFullscreen:t=>e({isFullscreen:t})}))));var ai=n(70593);const ri={UNSPECIFIED:0,AA:1,AB:2,AE:3,AF:4,AK:5,AM:6,AN:7,AR:8,AS:9,AV:10,AY:11,AZ:12,BA:13,BE:14,BG:15,BH:16,BI:17,BM:18,BN:19,BO:20,BR:21,BS:22,CA:23,CE:24,CH:25,CO:26,CR:27,CS:28,CU:29,CV:30,CY:31,DA:32,DE:33,DV:34,DZ:35,EE:36,EL:37,EN:38,EO:39,ES:40,ET:41,EU:42,FA:43,FF:44,FI:45,FJ:46,FO:47,FR:48,FY:49,GA:50,GD:51,GL:52,GN:53,GU:54,GV:55,HA:56,HE:57,HI:58,HO:59,HR:60,HT:61,HU:62,HY:63,HZ:64,IA:65,ID:66,IE:67,IG:68,II:69,IK:70,IO:71,IS:72,IT:73,IU:74,JA:75,JV:76,KA:77,KG:78,KI:79,KJ:80,KK:81,KL:82,KM:83,KN:84,KO:85,KR:86,KS:87,KU:88,KV:89,KW:90,KY:91,LA:92,LB:93,LG:94,LI:95,LN:96,LO:97,LT:98,LU:99,LV:100,MG:101,MH:102,MI:103,MK:104,ML:105,MN:106,MO:107,MR:108,MS:109,MT:110,MY:111,NA:112,NB:113,ND:114,NE:115,NG:116,NL:117,NN:118,NO:119,NR:120,NV:121,NY:122,OC:123,OJ:124,OM:125,OR:126,OS:127,PA:128,PI:129,PL:130,PS:131,PT:132,QU:133,RM:134,RN:135,RO:136,RU:137,RW:138,SA:139,SC:140,SD:141,SE:142,SG:143,SH:144,SI:145,SK:146,SL:147,SM:148,SN:149,SO:150,SQ:151,SR:152,SS:153,ST:154,SU:155,SV:156,SW:157,TA:158,TE:159,TG:160,TH:161,TI:162,TK:163,FIL:164,TN:165,TO:166,TR:167,TS:168,TT:169,TW:170,TY:171,UG:172,UK:173,UR:174,UZ:175,VE:176,VI:177,VO:178,WA:179,WO:180,XH:181,YI:182,YO:183,ZA:184,ZH:185,ZU:186,"HI-LATN":1001,"ZH-HANT":1002,"ZH-HANT-HK":1003,"ZH-HANT-TW":1004,CEB:2001,CKB:2002,KMR:2003,UMB:2004,NSO:2005,KAM:2006,LUO:2007,FUV:2008,LZH:3001,YUE:3002,CMN:3003,WUU:3004,NAN:3005};var li,ci=n(10992);const di=e=>{let t=e;return"zh-CN"===e&&(t="zh"),"es-ES"===e&&(t="es"),t};let ui=0;class hi{constructor(){var e=this;(0,f.A)(this,"isTranslating",!1),(0,f.A)(this,"id",0),(0,f.A)(this,"texts",[]),(0,f.A)(this,"translatePromise",void 0),(0,f.A)(this,"resolveTranslate",void 0),(0,f.A)(this,"translateFinished",!1),(0,f.A)(this,"startTime",void 0),(0,f.A)(this,"endTime",void 0),(0,f.A)(this,"addText",((e,t,n)=>{(void 0===this.startTime||this.startTime>t)&&(this.startTime=t);const i=t+n;(void 0===this.endTime||this.endTime<i)&&(this.endTime=i),this.texts.push(e);const s=100===this.texts.length?new hi:this,o=this.texts.length-1,a=this.translatePromise.then((t=>[e,t[o]]));return this.triggerTranslate(),{nextThread:s,translateResult:a}})),(0,f.A)(this,"detectLang",(e=>e?new Promise((t=>{chrome.i18n.detectLanguage(e,(e=>{var n;const i=null==e||null===(n=e.languages[0])||void 0===n?void 0:n.language;t(di(i))}))})).catch((e=>"en")):"en")),(0,f.A)(this,"handleTranslateFinished",void 0),(0,f.A)(this,"onReady",(e=>{this.handleTranslateFinished=e})),(0,f.A)(this,"translate",(0,a.A)((function*(){const t="system"===hi.translateTargetLang?di(chrome.i18n.getUILanguage()):hi.translateTargetLang;if(0===e.texts.length)return yield(n=300,new Promise((e=>{setTimeout((()=>{e(!0)}),n)}))),e.translate();var n;const i=e.texts[0]+(e.texts[1]||"")+(e.texts[2]||"")+(e.texts[3]||"");var s,o;return(yield e.detectLang(i))===t?(null===(s=e.resolveTranslate)||void 0===s||s.call(e,e.texts),e.translateFinished=!0,void(null===(o=e.handleTranslateFinished)||void 0===o||o.call(e,e.id))):mi(e.texts,t).then((t=>{var n,i;null===(n=e.resolveTranslate)||void 0===n||n.call(e,t),e.translateFinished=!0,null===(i=e.handleTranslateFinished)||void 0===i||i.call(e,e.id)})).catch((e=>{console.log("fetch err: ",e)}))}))),(0,f.A)(this,"triggerTranslate",(()=>{this.isTranslating||(this.isTranslating=!0,hi.doTheTranslate(this))})),this.id=ui,ui+=1,hi.translateThreads.push(this),this.translatePromise=new Promise((e=>{this.resolveTranslate=e}))}}li=hi,(0,f.A)(hi,"translateTargetLang","system"),(0,f.A)(hi,"onThreadReady",((e,t)=>{const n=li.translateThreads.find((t=>t.id===e));n&&n.onReady(t)})),(0,f.A)(hi,"setTranslateTargetLang",(e=>{li.translateTargetLang=e})),(0,f.A)(hi,"translateTasks",[]),(0,f.A)(hi,"resetTranslateTasks",(()=>{li.translateTasks=[]})),(0,f.A)(hi,"sortTranslateThreads",(e=>{const t=(0,ai.A)(li.translateTasks,(t=>Boolean(t.startTime&&t.endTime&&t.startTime<=e&&e<=t.endTime)));if(t<=0)return;const n=li.translateTasks.splice(t);li.translateTasks=[...n,...li.translateTasks]})),(0,f.A)(hi,"doTheTranslate",(e=>{li.translateTasks.push(e),li.loopTasks()})),(0,f.A)(hi,"isLooping",!1),(0,f.A)(hi,"loopTasks",(0,a.A)((function*(){if(!li.isLooping){for(;li.translateTasks.length>0;){li.isLooping=!0;const e=li.translateTasks.shift();e&&(yield e.translate())}li.isLooping=!1}}))),(0,f.A)(hi,"translateThreads",[]),(0,f.A)(hi,"findTranslateReady",(e=>{if(void 0===e||e<0)return!1;const{translateFinished:t}=li.translateThreads.find((t=>t.id===e))||{};return!!t}));const mi=function(){var e=(0,a.A)((function*(e,t="zh"){const n=function(e){return ri[e.toUpperCase()]}(t);if(void 0===n)return e;return(yield(0,ci.Pt)(e,n)).items.map((e=>e.res))}));return function(t){return e.apply(this,arguments)}}();var gi=n(84645);class pi{constructor(){(0,f.A)(this,"videoPlaying",!1),(0,f.A)(this,"timeUpdateHandler",void 0),(0,f.A)(this,"lastTime",0),(0,f.A)(this,"handleBottomVisibilityToggle",void 0),(0,f.A)(this,"handleYoutubeToggleFullscreen",void 0),(0,f.A)(this,"getYoutubeVideoContainer",(()=>document.querySelector(".html5-video-player"))),(0,f.A)(this,"getVideoSetting",(()=>document.querySelector(".ytp-settings-menu"))),(0,f.A)(this,"getYoutubeVideo",(()=>document.querySelector(".html5-main-video"))),(0,f.A)(this,"watchVideoStatus",(()=>{const e=this.getYoutubeVideoContainer();e?(0,gi.SM)(e,(e=>{var t,n,i,s;(e.includes("playing-mode")?this.videoPlaying=!0:e.includes("paused-mode")&&(this.videoPlaying=!1),e.includes("ytp-autohide"))?null===(t=this.handleBottomVisibilityToggle)||void 0===t||t.call(this,!1):null===(n=this.handleBottomVisibilityToggle)||void 0===n||n.call(this,!0);e.includes("ytp-fullscreen")?null===(i=this.handleYoutubeToggleFullscreen)||void 0===i||i.call(this,!0):null===(s=this.handleYoutubeToggleFullscreen)||void 0===s||s.call(this,!1)})):setTimeout(this.watchVideoStatus,300)})),(0,f.A)(this,"pauseVideo",(()=>{var e;null===(e=this.getYoutubeVideo())||void 0===e||e.pause()})),(0,f.A)(this,"playVideo",(()=>{var e;null===(e=this.getYoutubeVideo())||void 0===e||e.play()})),(0,f.A)(this,"bindVideoOnclickHandler",(e=>{e.addEventListener("click",(()=>{this.videoPlaying?this.pauseVideo():this.playVideo()}))})),(0,f.A)(this,"getBoundingClientRect",(()=>{const e=this.getYoutubeVideoContainer();if(!e)return{left:0,bottom:0};const{left:t,bottom:n}=e.getBoundingClientRect();return{left:t,bottom:n}})),(0,f.A)(this,"onVideoResizeHandler",(e=>{const t=this.getYoutubeVideoContainer();if(t){new ResizeObserver(e).observe(t)}else setTimeout(e,300)})),(0,f.A)(this,"onBottomVisibilityToggle",(e=>{e(!0),this.handleBottomVisibilityToggle=e})),(0,f.A)(this,"onYoutubeToggleFullscreen",(e=>{this.handleYoutubeToggleFullscreen=e})),(0,f.A)(this,"handleTimeupdate",null),(0,f.A)(this,"handleTimeJump",null),(0,f.A)(this,"watchSettingChange",((e,t=3)=>{const n=this.getVideoSetting();n?((0,gi.V$)(n,e),e()):t&&setTimeout((()=>{this.watchSettingChange(e,t-1)}),600)})),(0,f.A)(this,"onTimeUpdated",(e=>{this.handleTimeupdate=e;const t=this.getYoutubeVideo();t&&(this.timeUpdateHandler&&t.removeEventListener("timeupdate",this.timeUpdateHandler),this.timeUpdateHandler=(0,_t.A)((()=>{var e;const n=1e3*t.currentTime;var i;Math.abs(n-this.lastTime)>2e4&&(null===(i=this.handleTimeJump)||void 0===i||i.call(this));this.lastTime=n,null===(e=this.handleTimeupdate)||void 0===e||e.call(this,n)}),50),t.addEventListener("timeupdate",this.timeUpdateHandler))})),(0,f.A)(this,"fireTimeUpdateEvent",(()=>{var e;const t=this.getYoutubeVideo();t&&(null===(e=this.handleTimeupdate)||void 0===e||e.call(this,1e3*t.currentTime))})),(0,f.A)(this,"pause",(()=>{var e;null===(e=this.getYoutubeVideo())||void 0===e||e.pause()})),(0,f.A)(this,"onTimeJump",(e=>{this.handleTimeJump=e})),this.watchVideoStatus()}}const vi=()=>{const e=document.querySelector(".ytp-caption-window-container");e&&"none"!==e.style.display&&(e.style.display="none")},fi=(e,t=3)=>e().catch((n=>{if(0===t)throw n;return fi(e,t-1)}));const _i=new class{constructor(){var e=this;(0,f.A)(this,"youtubeVideoManager",new pi),(0,f.A)(this,"uiStore",void 0),(0,f.A)(this,"currentSubtitle",void 0),(0,f.A)(this,"lastLang",void 0),(0,f.A)(this,"currentVideoId",""),(0,f.A)(this,"fetchingVideoId",""),(0,f.A)(this,"subtitleButtonContainer",null),(0,f.A)(this,"getVideoIdFromUrl",(()=>new URL(window.location.href).searchParams.get("v")||"")),(0,f.A)(this,"urlChangeHandler",(e=>{var t;const n=null==e||null===(t=e.detail)||void 0===t||null===(t=t.response)||void 0===t||null===(t=t.playerResponse)||void 0===t?void 0:t.videoDetails;if(this.currentVideoId=(null==n?void 0:n.videoId)||"",this.currentVideoId||(this.currentVideoId=this.getVideoIdFromUrl()),this.watchSettingLang(),this.currentVideoId){this.preloadSubtitles();try{Wn.A.get("autoTranslateSubtitles").then((e=>{e&&this.openBilingualSubtitle()}))}catch(i){}}})),(0,f.A)(this,"measureRightControls",(()=>{const e=document.querySelector(".ytp-right-controls");return e?e.getBoundingClientRect().height:0})),(0,f.A)(this,"computeButtonHeight",(()=>{var e,t;const{height:n}=(null===(e=this.subtitleButtonContainer)||void 0===e?void 0:e.getBoundingClientRect())||{height:0};null===(t=this.uiStore)||void 0===t||t.setButtonHeight(n)})),(0,f.A)(this,"pauseVideo",(()=>{this.youtubeVideoManager.pause()})),(0,f.A)(this,"computePopoverPosition",(()=>{var e,t;const{left:n}=(null===(e=this.subtitleButtonContainer)||void 0===e?void 0:e.getBoundingClientRect())||{left:0},{left:i}=this.youtubeVideoManager.getBoundingClientRect(),s=n-i+20,o=this.measureRightControls()+16-72;null===(t=this.uiStore)||void 0===t||t.setPopoverPosition({left:s,bottom:o})})),(0,f.A)(this,"preloadSubtitles",(()=>{this.fetchSubtitles()})),(0,f.A)(this,"fetchSubtitles",(0,a.A)((function*(){e.currentVideoId=e.currentVideoId||e.getVideoIdFromUrl();const t=e.getSubtitleLang();if(!e.currentVideoId)return;if(e.fetchingVideoId===e.currentVideoId&&e.lastLang===t)return;e.lastLang=t,e.fetchingVideoId=e.currentVideoId;const n=yield fi((()=>qn({videoID:e.currentVideoId,useUILang:!t,lang:t})),10);var i;(n&&(e.currentSubtitle=n),e.currentVideoId===e.fetchingVideoId)&&(null===(i=e.uiStore)||void 0===i||i.setSubtitleReady(!0));return n}))),(0,f.A)(this,"restart",(()=>{this.reset(),this.fetchSubtitles()})),(0,f.A)(this,"reset",(()=>{var e,t;null===(e=this.uiStore)||void 0===e||e.setSubtitleReady(!1),this.stopWatchingSubtitles(),null===(t=this.uiStore)||void 0===t||t.setResetVideoUI((new Date).getTime()),hi.resetTranslateTasks()})),(0,f.A)(this,"getCurrentSubtitles",(()=>this.currentSubtitle)),(0,f.A)(this,"setSubtitleButtonContainer",(e=>{this.subtitleButtonContainer=e})),(0,f.A)(this,"watchButtonPosition",(()=>{this.youtubeVideoManager.onVideoResizeHandler((()=>{this.computePopoverPosition(),this.computeButtonHeight()}))})),(0,f.A)(this,"bindVideoOnclickHandler",this.youtubeVideoManager.bindVideoOnclickHandler),(0,f.A)(this,"onBottomVisibilityToggle",this.youtubeVideoManager.onBottomVisibilityToggle),(0,f.A)(this,"closeBilingualSubtitle",(()=>{(()=>{const e=document.querySelector(".ytp-caption-window-container");e&&(e.style.display="")})()})),(0,f.A)(this,"openBilingualSubtitle",(0,a.A)((function*(){vi(),yield e.fetchSubtitles()}))),(0,f.A)(this,"reopenTranslate",(e=>{hi.setTranslateTargetLang(e),this.openBilingualSubtitle()})),(0,f.A)(this,"stopWatchingSubtitles",(()=>{this.youtubeVideoManager.onTimeUpdated(null),this.youtubeVideoManager.onTimeJump(null)})),(0,f.A)(this,"watchCurrentSubtitle",((e,t)=>{const n=this.currentVideoId;this.youtubeVideoManager.onTimeUpdated((i=>{if(n!==this.currentVideoId)return;hi.sortTranslateThreads(i);const s=e.find((e=>e.offset<=i&&i<e.offset+e.duration));t(s?s.text:{threadId:-1,originalText:"",getTranslate:()=>Promise.resolve(["",""])})})),setTimeout((()=>{this.youtubeVideoManager.fireTimeUpdateEvent()}))})),(0,f.A)(this,"getSubtitleLang",(()=>{let e="";const t=localStorage.getItem("yt-player-caption-sticky-language");if(t){const n=JSON.parse(t);e=(null==n?void 0:n.data)||""}return e})),(0,f.A)(this,"updateSubtitlesIfLangChange",(()=>{this.getSubtitleLang()!==this.lastLang&&this.restart()})),(0,f.A)(this,"watchSettingLang",(()=>{this.youtubeVideoManager.watchSettingChange(this.updateSubtitlesIfLangChange)})),(0,f.A)(this,"onVideoToggleFullscreen",this.youtubeVideoManager.onYoutubeToggleFullscreen),(0,f.A)(this,"makeSureOriginalSubtitleHide",(()=>{vi()})),(0,f.A)(this,"onTimeJump",this.youtubeVideoManager.onTimeJump),this.urlChangeHandler(),"navigation"in window?window.navigation.addEventListener("navigate",(()=>{this.reset(),this.urlChangeHandler()})):window.addEventListener("yt-navigate-start",this.reset),window.addEventListener("yt-navigate-finish",this.urlChangeHandler),window.addEventListener("yt-navigate-cache",this.reset),this.uiStore=oi.getState()}},yi=_i;var xi=n(26106),bi=n(97418),Ai=n(29679),wi=n(71834),Si=n(82741);const Ci="subtitles_container-XYzb2H",ki="original_subtitle-vSPrki",Ii="translated_subtitle-RT8XdR",Ei=()=>{const[e]=(0,Si.Y)("subtitleTranslateLang"),[t]=(0,Si.Y)("autoTranslateSubtitles"),[n,i]=(0,z.useState)(1),[s,o]=(0,z.useState)(""),[a,r]=(0,z.useState)(["",""]),[l,c]=(0,z.useState)(!1),[d,u]=(0,z.useState)(),[h,m]=(0,z.useState)(),[g,p]=(0,z.useState)(),{subtitleReady:v,isFullscreen:f,resetVideoUI:_}=oi();return(0,z.useEffect)((()=>{p(void 0),m(void 0),o(""),r(["",""])}),[_]),(0,z.useEffect)((()=>{e&&t&&(i((new Date).getTime()),yi.reopenTranslate(e),m(void 0),r(["",""]))}),[e,t]),(0,z.useEffect)((()=>{if(v||n){const e=yi.getCurrentSubtitles();if(!e)return;const t=(e=>{const t=[];let n=new hi;return e.forEach((e=>{const{text:i,offset:s,duration:o}=e,{nextThread:a,translateResult:r}=n.addText(i,s,o);t.push({text:{threadId:n.id,originalText:i,getTranslate:()=>r},offset:s,duration:o}),n=a})),t})(e);t&&p(t)}}),[v,n]),(0,z.useEffect)((()=>(g&&(yi.watchCurrentSubtitle(g,(e=>{m(e),u(e.threadId),o(e.originalText)})),yi.onTimeJump((()=>{r(["",""])}))),()=>{yi.stopWatchingSubtitles()})),[g]),(0,z.useEffect)((()=>{if(void 0===d||d<0)return;hi.findTranslateReady(d)?c(!0):(c(!1),hi.onThreadReady(d,(e=>{e===d&&c(!0)})))}),[d]),(0,z.useEffect)((()=>{if(!l)return;const{getTranslate:e}=h||{};null==e||e().then((([e,t])=>{r([e,t])}))}),[l,h]),h&&v&&t?-1===(null==h?void 0:h.threadId)?null:s?(yi.makeSureOriginalSubtitleHide(),(0,K.jsxs)("div",{className:Ci,children:[(0,K.jsx)("div",{className:ki,style:{fontSize:f?"2.4em":"2em"},children:s}),(0,K.jsx)("div",{className:Ii,style:{fontSize:f?"2.4em":"2em"},children:s===a[0]?a[1]:"..."})]})):null:null},Ti="translate_target-YPSdRA",ji="translate_target_names-MzTahw",Ni="translate_target_lang_name-Zx5GGz",Mi="selected-CN1cnk",Li="dark-MZOLTG",Ri="translate_target_lang_translated_name-OtoxsR",Pi="translate_target_selected_icon_container-msUmt5",Bi=e=>{const{code:t,langTranslatedName:n,langLocName:i,selected:s,onSelect:o,theme:a="light"}=e;return(0,K.jsxs)("div",{className:Ti,onClick:()=>{o(t)},children:[(0,K.jsxs)("div",{className:ji,children:[(0,K.jsx)("div",{className:re()({[Ni]:!0,[Mi]:s,[Li]:"dark"===a}),children:i}),(0,K.jsx)("div",{className:re()({[Ri]:!0,[Li]:"dark"===a}),children:n})]}),(0,K.jsx)("div",{className:Pi,children:s&&(0,K.jsx)(de.Tf,{})})]})},Oi="subtitle_setting_wrapper-kvmobz",Di="subtitle_target_lang_title-zPumr7",Fi="subtitle_target_lang_list-_zVVpf",Ui=()=>{const[e,t]=(0,Si.Y)("subtitleTranslateLang"),n=(0,bi.Uk)(),i=(0,ye.e)(),s=e=>{t(e)};return(0,K.jsxs)("div",{className:Oi,onClick:e=>{e.stopPropagation()},children:[(0,K.jsx)("span",{className:Di,children:n("flow_web_youtube_subtitles_setting_language")}),(0,K.jsxs)("div",{className:Fi,children:[(0,K.jsx)(Bi,{theme:"dark",selected:"system"===e,code:"system",langTranslatedName:n("flow_web_youtube_subtitles_setting_systemlanguage"),langLocName:n("background_follow_system"),onSelect:()=>{t("system")}},"system"),null==i?void 0:i.map((t=>(0,K.jsx)(Bi,{theme:"dark",selected:e===t.language_code,code:t.language_code,langTranslatedName:t.language,langLocName:t.language_loc,onSelect:s},t.language_code)))]})]})},Hi="subtitle_window-r78hdZ",zi="subtitle_container-l66tBz",qi="subtitle_popover-VcCs4b",Vi=()=>{const{popoverPosition:e,setShowSetting:t,showSetting:n}=oi(),i=(0,wi.A)((()=>{t(!1)}));return(0,K.jsxs)("div",{className:Hi,children:[(0,K.jsx)("div",{className:zi,children:(0,K.jsx)(Ei,{})}),(0,K.jsx)("div",{ref:i,className:qi,style:{left:e.left,bottom:e.bottom},children:n?(0,K.jsx)(Ui,{}):null})]})},$i=()=>{var e;const t=(0,bi.Uk)();return(0,Ai.A)(null===(e=document.querySelector(`[id*=${v.$9}]`))||void 0===e?void 0:e.shadowRoot),(0,K.jsx)(V.Yd.Provider,{value:xi.vF,children:(0,K.jsx)($.C,{t,children:(0,K.jsx)(Vi,{})})})},Ki="subtitle_button-lmC4ch",Wi="setting_part-S380fg",Gi="setting_part_icon-y7_pqu",Yi="setting_part_text-w4VMKV",Qi="subtitle_button_divider-KIxXhg",Ji="toggle_part-iB9SjP",Xi="toggle_part_icon-jX7JTa",Zi=()=>{const[e]=(0,Si.Y)("authInfo"),t=(null==e?void 0:e.isAuthenticated)||!1,[n,i]=(0,Si.Y)("autoTranslateSubtitles"),s=(0,bi.Uk)(),{buttonHeight:o,setShowSetting:r,showSetting:l,isFullscreen:c,setIsFullscreen:d}=oi();(0,z.useEffect)((()=>{n?yi.openBilingualSubtitle():yi.closeBilingualSubtitle()}),[n]),(0,z.useEffect)((()=>{!t&&n&&(yi.closeBilingualSubtitle(),i(!1))}),[t,n]),(0,z.useEffect)((()=>{yi.onVideoToggleFullscreen(d)}),[]);const u=function(){var e=(0,a.A)((function*(){if(n)yield yi.closeBilingualSubtitle(),i(!1);else{if(!t)return void(0,b.DT)({trackMeta:{login_entrance:"bilingual_subtitles"}});yield yi.openBilingualSubtitle(),i(!0)}}));return function(){return e.apply(this,arguments)}}();return(0,K.jsxs)("div",{className:Ki,style:{height:c?38:33,marginTop:c?3:0},children:[(0,K.jsxs)("div",{className:Wi,onClick:()=>{l||(yi.pauseVideo(),yi.computePopoverPosition()),r(!l)},children:[(0,K.jsx)("div",{className:Gi,children:(0,K.jsx)(de.eI,{})}),(0,K.jsx)("div",{className:Yi,children:s("flow_web_youtube_subtitles_bilingual")})]}),(0,K.jsx)("div",{className:Qi}),(0,K.jsx)("div",{className:re()(Ji),style:{height:o},onClick:u,children:(0,K.jsx)("div",{className:Xi,children:n?(0,K.jsx)(de.$N,{}):(0,K.jsx)(de.JW,{})})})]})},es="subtitle_assistant_container-_RjPH3",ts=()=>{const e=(0,z.useRef)(null);return(0,z.useEffect)((()=>{const t=e.current;t&&(yi.setSubtitleButtonContainer(t),yi.watchButtonPosition())}),[e]),(0,K.jsx)("div",{ref:e,className:es,children:(0,K.jsx)(Zi,{})})},ns=()=>{var e;const t=(0,bi.Uk)();return(0,Ai.A)(null===(e=document.querySelector(`[id*=${v.$9}]`))||void 0===e?void 0:e.shadowRoot),(0,K.jsx)(V.Yd.Provider,{value:xi.vF,children:(0,K.jsx)($.C,{t,children:(0,K.jsx)(ts,{})})})};var is=n(8506);const ss=`${(0,he.L2)()}_subtitle_assistant`,os=e=>{const t=document.createElement("div");t.id=ss,t.className="ytp-button",t.style.cssText="width: fit-content; height: 100%;";const n=d.m.getInstance().getHostId(),i=`${v.tm}${n}`,s=e.querySelector(`#${i}`);if(null!=s&&s.nextSibling){if(Boolean(document.querySelector(`#${ss}`)))return;e.insertBefore(t,s.nextSibling);const n=t.attachShadow({mode:"open"}),i=(0,q.createRoot)(n);(0,is.NR)(n,v.QN).then((()=>{i.render((0,K.jsx)(W,{element:t,children:(0,K.jsx)(ns,{})}))})),(0,d.A)((()=>{var e;i.unmount(),null===(e=document.querySelector(`#${ss}`))||void 0===e||e.remove()}))}},as=e=>{const t=document.querySelector(`#${ss}`);t&&(t.style.display=e?"inline-block":"none")},rs=`${(0,he.L2)()}_subtitle_window`,ls=e=>{const t=document.createElement("div");t.id=rs,t.style.cssText="position: absolute; width: 100%; top: 0; bottom: 0; left: 0; z-index: 12; pointer-events: none;";if(Boolean(document.querySelector(`#${rs}`)))return;e.appendChild(t);const n=t.attachShadow({mode:"open"}),i=(0,q.createRoot)(n);yi.bindVideoOnclickHandler(t),yi.onBottomVisibilityToggle((e=>{t.style.bottom=e?"60px":"12px"})),(0,is.NR)(n,v.QN).then((()=>{i.render((0,K.jsx)(W,{element:t,children:(0,K.jsx)($i,{})}))})),(0,d.A)((()=>{var e;i.unmount(),null===(e=document.querySelector(`#${rs}`))||void 0===e||e.remove()}))},cs=e=>{const t=document.querySelector(`#${rs}`);t&&(t.style.display=e?"block":"none")},ds={width:"350px",position:"absolute",right:"10px",top:"100px",pointerEvents:"none"},us='<svg width="20" height="23" viewBox="0 0 12 13" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M6.37888 10.7863C6.27162 10.7863 6.17707 10.7496 6.09521 10.6762C6.01618 10.6028 5.96679 10.5097 5.94703 10.3968C5.87082 9.96209 5.7932 9.59658 5.71417 9.30021C5.63514 9.00667 5.53776 8.76675 5.42204 8.58047C5.30914 8.39418 5.16096 8.24458 4.97749 8.13168C4.79403 8.01878 4.55976 7.92846 4.27468 7.86072C3.99243 7.79298 3.64102 7.72806 3.22047 7.66597C3.10474 7.64903 3.00878 7.59964 2.93257 7.51778C2.85918 7.43593 2.82249 7.33855 2.82249 7.22565C2.82249 7.11275 2.8606 7.01537 2.9368 6.93352C3.01301 6.84885 3.10898 6.79945 3.2247 6.78534C3.64526 6.73736 3.99949 6.6809 4.28738 6.61599C4.57528 6.55107 4.81237 6.46216 4.99866 6.34926C5.18495 6.23353 5.33595 6.08112 5.45168 5.89201C5.57022 5.70008 5.66619 5.45593 5.73957 5.15956C5.81296 4.86037 5.88211 4.49344 5.94703 4.05878C5.96397 3.94305 6.01195 3.84991 6.09098 3.77934C6.17283 3.70596 6.2688 3.66927 6.37888 3.66927C6.48896 3.66927 6.58351 3.70596 6.66254 3.77934C6.74439 3.84991 6.7952 3.94305 6.81496 4.05878C6.89117 4.49344 6.96737 4.85896 7.04358 5.15533C7.12261 5.44887 7.21999 5.68879 7.33571 5.87507C7.45144 6.06136 7.60103 6.21095 7.7845 6.32386C7.96796 6.43676 8.20082 6.52708 8.48307 6.59482C8.76815 6.66256 9.11955 6.72607 9.53729 6.78534C9.65583 6.8051 9.7518 6.8559 9.82518 6.93776C9.90139 7.01961 9.9395 7.11557 9.9395 7.22565C9.9395 7.34138 9.90139 7.44158 9.82518 7.52625C9.74898 7.6081 9.6516 7.65468 9.53305 7.66597C9.11532 7.71395 8.7625 7.77181 8.4746 7.83955C8.18671 7.90447 7.9482 7.99338 7.75909 8.10628C7.57281 8.21918 7.4218 8.3716 7.30608 8.56353C7.19035 8.75546 7.0958 8.99961 7.02241 9.29598C6.94903 9.59517 6.87988 9.96209 6.81496 10.3968C6.79802 10.5097 6.74863 10.6028 6.66677 10.6762C6.58774 10.7496 6.49178 10.7863 6.37888 10.7863ZM3.24604 5.71619C3.10491 5.71619 3.02588 5.64281 3.00895 5.49603C2.97508 5.22507 2.9412 5.01197 2.90733 4.85673C2.87346 4.70149 2.81701 4.58436 2.73798 4.50533C2.65895 4.42347 2.54041 4.36279 2.38234 4.32327C2.22428 4.28376 2.00413 4.24424 1.72187 4.20473C1.56663 4.18215 1.48901 4.10312 1.48901 3.96763C1.48901 3.83215 1.55817 3.75312 1.69647 3.73054C1.98437 3.67974 2.21017 3.63316 2.37388 3.59083C2.53758 3.54849 2.65895 3.48922 2.73798 3.41301C2.81701 3.33398 2.87346 3.21966 2.90733 3.07007C2.9412 2.91765 2.97508 2.70738 3.00895 2.43923C3.02588 2.28964 3.10491 2.21484 3.24604 2.21484C3.38434 2.21484 3.46337 2.28682 3.48313 2.43077C3.517 2.71302 3.55087 2.93318 3.58474 3.09124C3.62143 3.2493 3.6793 3.36785 3.75833 3.44688C3.83736 3.52309 3.95732 3.57954 4.1182 3.61623C4.27908 3.65292 4.50206 3.69103 4.78714 3.73054C4.84923 3.73619 4.90004 3.76159 4.93956 3.80675C4.97907 3.85191 4.99883 3.90554 4.99883 3.96763C4.99883 4.10029 4.93109 4.17932 4.79561 4.20473C4.50489 4.25271 4.27767 4.29928 4.11397 4.34444C3.95308 4.38678 3.83312 4.44746 3.75409 4.5265C3.67506 4.6027 3.61861 4.71702 3.58474 4.86943C3.55087 5.02185 3.517 5.23354 3.48313 5.5045C3.47466 5.5666 3.44785 5.6174 3.40269 5.65692C3.35753 5.69643 3.30531 5.71619 3.24604 5.71619Z" fill="white"/>\n</svg>';var hs=n(99153),ms=n(1948);const gs="ytFullscreenContainer-K6ZrdB",ps="loadingContainer-ltwkb1",vs="autoLoading-JUPFt6",fs="loadingContent-icDCrd",_s="loadingText-oeBWbj",ys="icon-NjW_ma",xs="dotFlashingContainer-glAeVf",bs="guideTipsContainer-Y01UcZ",As="divider-lvkDKI",ws="guideText-OJW1d9",Ss="openImmersionMode-XvGrwN",Cs="iconBtnContainer-NkCm0n",ks="noSubTitleTipsContainer-uGz3__",Is="noSubTitleTips-g20rKq",Es="immersionExpandContainer-MgvC6v",Ts="immersionFoldIcon-IdWict",js="immersionExpandContent-u3BBFX",Ns="immersionFold-ZMrrMP",Ms="immersionExpandTooltip-Oo7a6E",Ls="login-button-u5nUka",Rs=e=>{const{setSummaryAssistantClose:t}=e,n=(0,$.B)(),i=(0,z.useCallback)((()=>{null==t||t(!0)}),[t]);return(0,K.jsx)("div",{className:ks,children:(0,K.jsxs)("div",{className:Is,children:[n("flow_web_ext_youtube_nosubtitles",{brand:(0,he.L2)()}),(0,K.jsx)(ms.A,{style:{cursor:"pointer"},onClick:i})]})})},Ps=({loadingTextRef:e,loadingTextWidth:t,isAutoSummarize:n})=>{const i=(0,$.B)(),s=(0,yt.zh)({from:{width:32},to:{width:t+32},config:{duration:300}}),o=(0,yt.zh)({from:{opacity:0},to:{opacity:1},config:{duration:1500}});return(0,K.jsx)("div",{className:re()(ps,{[vs]:n}),children:(0,K.jsxs)(yt.CS.div,{className:fs,style:s,children:[(0,K.jsx)(yt.CS.div,{ref:e,className:_s,style:o,children:(0,K.jsxs)(K.Fragment,{children:[n&&(0,K.jsx)(et.k4K,{className:ys}),i("flow_web_ext_youtube_summarizing")]})}),(0,K.jsx)("div",{className:xs,children:(0,K.jsx)(xn,{})})]})})};var Bs=function(e){return e.INDEPENDENT="independent",e.FOLD="fold",e.EXPAND="expand",e}(Bs||{});const Os={[Bs.INDEPENDENT]:(0,K.jsx)(de.yZ,{}),[Bs.FOLD]:(0,K.jsx)(de.ut,{}),[Bs.EXPAND]:(0,K.jsx)(de.hk,{})},Ds=({immersionHighlightExpand:e,onToggleExpand:t})=>{const n=(0,$.B)(),i=(0,ot.A)(),[s,o]=(0,z.useState)(Bs.INDEPENDENT),[a,r]=(0,z.useState)(!1);return(0,z.useEffect)((()=>{const e=setTimeout((()=>{r(!0)}),1e3);return()=>{clearTimeout(e)}}),[]),a?(0,K.jsx)("div",{className:re()(Es,{[Ts]:s===Bs.FOLD,[Ns]:!e}),onMouseEnter:()=>{o(e?Bs.FOLD:Bs.EXPAND)},onMouseLeave:()=>o(Bs.INDEPENDENT),children:(0,K.jsx)(ce.m_,{content:n(e?"flow_web_ext_youtube_sharepage_putaway":"flow_web_ext_youtube_sharepage_expand"),position:"left",getPopupContainer:null==i?void 0:i.getPopupContainer,className:Ms,children:(0,K.jsx)("div",{className:js,onClick:t,children:(0,K.jsx)("div",{children:Os[s]})})})}):null},Fs=({text:e,trackResultEvent:t,trackHighlightEvent:n,videoDuration:i=0,videoState:s,setVideoState:o,loadingTextWidth:a,isNeedLoadingAnimation:r,handleUserInteract:l,userInteracting:c,activeScroll:d})=>{const[u,h]=(0,yt.zh)((()=>({from:{width:a+44+32}})));return(0,z.useEffect)((()=>{h.start({to:{width:a+44+12},config:{duration:300}}),setTimeout((()=>{h.start({to:{width:300}})}),500)}),[]),(0,K.jsx)(K.Fragment,{children:r?(0,K.jsx)(yt.CS.div,{className:ps,style:u}):(0,K.jsx)(tn,{videoDuration:i,text:e,trackResultEvent:t,trackHighlightEvent:n,videoState:s,setVideoState:o,isImmersionMode:!0,handleUserInteract:l,userInteracting:c,activeScroll:d})})};var Us=n(26069);const Hs=({loadingTextWidth:e,onClickGuideBtn:t})=>{const n=(0,$.B)(),[i,s]=(0,z.useState)(!1),[o,{width:a}]=(0,Us.A)(),r=le._1.getModuleClickFrom();(0,z.useEffect)((()=>{var e;e=r,(0,Y.z8)(Q.Ur.showVideoImmersionGuideTips,{click_from:e})}),[]),(0,z.useEffect)((()=>{setTimeout((()=>{s(!0)}),5e3)}),[]),(0,z.useEffect)((()=>{var e;i&&(e=r,(0,Y.z8)(Q.Ur.showVideoImmersionGuideIcon,{click_from:e}))}),[i]);const l=(0,yt.zh)({from:{width:i?a+32:e+32},to:{width:i?40:a+32},config:{duration:300}}),c=(0,yt.zh)({from:{opacity:0},to:{opacity:1},config:{duration:1500}});return(0,K.jsx)(yt.CS.div,{className:re()(bs,{[Cs]:i}),style:l,children:i?(0,K.jsx)(et.k4K,{className:ys,onClick:()=>{var e;t(),e=r,(0,Y.z8)(Q.Ur.clickVideoImmersionGuideIcon,{click_from:e,button_name:Q._h.immersionGuideIcon})}}):(0,K.jsxs)(yt.CS.div,{className:ws,ref:o,style:c,children:[(0,K.jsx)("div",{children:n("flow_web_ext_youtube_summary_generated")}),(0,K.jsx)(ce.cG,{layout:"vertical",className:As}),(0,K.jsx)("div",{onClick:()=>{var e;t(),e=r,(0,Y.z8)(Q.Ur.clickVideoImmersionGuideTips,{click_from:e,button_name:Q._h.immersionGuideTips})},className:Ss,children:n("flow_web_ext_youtube_summary_view")})]})})};var zs=n(47421);const qs=(0,z.forwardRef)(((e,t)=>{const n=(0,z.useRef)(null),[i,s]=(0,z.useState)(e),{transcript:o,highlightsResult:a,trackResultEvent:r,trackHighlightEvent:l,videoState:c,setVideoState:d,isLoadingDone:u,isFetchSummarize:h,hasNoSubtitles:m,isSummaryAssistantClose:g,setSummaryAssistantClose:p,userInteracting:v,handleUserInteract:f,isImmersionMode:_,defaulTimmersionHighlightExpand:y=!1,isMessageUnAuthorized:x}=i,b=(0,Kn.vh)("web_video_summary",x),A=(0,bi.Uk)(),[w,S]=(0,z.useState)(m),C=o&&(null==o?void 0:o.length)>0,[k,I]=(0,z.useState)(y),{isLoadingDone:E}=(0,ie.e)(),[T,j]=(0,z.useState)(!k&&!E),{videoId:N}=(0,ie.e)();(0,z.useEffect)((()=>{j(!k&&!E)}),[N]);const[M,{width:L}]=(0,hs.A)();(0,z.useImperativeHandle)(t,(()=>({updateProps:e=>{s(e)}})),[s]);const[R,P]=(0,z.useState)(!u&&!T);if((0,z.useEffect)((()=>{u&&!T&&setTimeout((()=>{P(!1)}),800)}),[u]),g)return null;const B=(0,z.useMemo)((()=>{var e,t;return m?w&&k?(0,K.jsx)(Rs,{setSummaryAssistantClose:()=>S(!1)}):null:b?u?T?(0,K.jsx)(Hs,{loadingTextWidth:L,onClickGuideBtn:()=>{j(!1),I(!0)}}):(0,K.jsx)(Fs,{videoDuration:((null==o||null===(e=o[(null==o?void 0:o.length)-1])||void 0===e?void 0:e.offset)+(null==o||null===(t=o[(null==o?void 0:o.length)-1])||void 0===t?void 0:t.duration))/1e3,text:a,trackResultEvent:r,trackHighlightEvent:l,videoState:c,setVideoState:d,loadingTextWidth:L,isFirstSummarizing:h,isNeedLoadingAnimation:R,userInteracting:v,handleUserInteract:f,isImmersionMode:_,activeScroll:k&&_}):(0,K.jsx)(Ps,{loadingTextRef:M,loadingTextWidth:L,isAutoSummarize:T}):(0,K.jsx)(ve,{className:Ls})}),[u,m,M,L,p,o,a,r,l,c,d,C,h,R,w,S,k,v,f,T,j,I]),O=(0,z.useCallback)((()=>{qe(k?De.COLLAPSED:De.EXPANDED),r(k?Q._h.collapsed:Q._h.expanded),I(!k)}),[k,I,r,qe]);return(0,K.jsx)($.C,{t:A,children:(0,K.jsx)(zs.A.Provider,{value:{getPopupContainer:()=>n.current||document.body},children:(0,K.jsxs)("div",{ref:n,className:re()("cici-ext-container",gs),children:[(0,K.jsx)("div",{style:{pointerEvents:"all",transform:k||T?void 0:"translate(110%, 0px)"},children:B}),u&&!T&&(0,K.jsx)(Ds,{immersionHighlightExpand:k,onToggleExpand:O})]})})})})),Vs=qs;const $s="immersion-button-container-style",Ks=()=>{let e=document.getElementById($s);e||(e=document.createElement("style"),e.id=$s,e.innerHTML="\n  .immersion-btn-container {\n    height: 33px !important;\n    width: auto !important;\n    border-radius: 16px;\n    padding: 0 14px 0 10px !important;\n    background-blend-mode: lighten;\n    vertical-align: top;\n    margin: 7px 10px 0px 10px;\n    color: #ffffff;\n    position: relative;\n    overflow: hidden;\n\n    span, div {\n      z-index: 1;\n    }\n\n    &::before {\n      content: '';\n      left: 50%;\n      top: 50%;\n      position: absolute;\n      width: 200px;\n      height: 200px;\n      transform: translate(-50%, -50%);\n      background:\n        radial-gradient(115.45% 162.76% at 19.33% 22.04%, #0057FF 0%, #4298FD 50%);\n    }\n  }\n\n  .immersion-btn-container:hover::before {\n    animation: inactive-btn-hover-animation 3s linear infinite;\n  }\n\n  @keyframes inactive-btn-hover-animation {\n    0% {\n      transform: translate(-50%, -50%) rotate(0);\n    }\n    100% {\n      transform: translate(-50%, -50%) rotate(1turn);\n    }\n  }\n",(0,u.EY)(e))};let Ws,Gs;const Ys=z.createRef();function Qs(e){const t=d.m.getInstance().getHostId(),n=document.querySelector("div.html5-video-container");if(!t||!n)return;const i=`${v.M0}-${t}`;let s=document.getElementById(i);const a=()=>{var e,t;null===(e=document.getElementById(i))||void 0===e||e.remove(),null===(t=Ws)||void 0===t||t.unmount(),s=null,Ws=void 0,Gs=void 0};var r;if(s)return null===(r=Ys.current)||void 0===r||r.updateProps(e),a;s=document.createElement("div"),s.id=i;const l=s.attachShadow({mode:"open"}),c=document.createElement("div");return l.appendChild(c),(0,ti.A)(c.style,ds),n.appendChild(s),(0,is.NR)(l,v.QN).then((()=>{Ws=(0,q.createRoot)(c),Gs=z.createElement(Vs,(0,o.A)((0,o.A)({ref:Ys},e),{},{defaulTimmersionHighlightExpand:le._1.getLastEntryFullScreenFrom()===Me.IMMERSION_BTN})),Ws.render(Gs)})),(0,d.A)(a),a}let Js=!1;function Xs(e,t){const{hasNoSubtitles:n,isMessageUnAuthorized:i,isSummaryAssistantClose:s}=t;Js=Boolean(i),Ks();const o=document.querySelector("div.ytp-chrome-controls div.ytp-right-controls");if(!o)return;const a=d.m.getInstance().getHostId(),r=`${v.tm}${a}`;let l=o.querySelector(`#${r}`);if(l){s&&l.remove();const e=document.fullscreenElement;return l.style.display=e?"none":"inline-block",void(n?(l.style.display="none",yi.closeBilingualSubtitle(),as(!1),cs(!1)):(as(!0),cs(!0)))}l=document.createElement("button"),l.addEventListener("click",(()=>{var e;Js?(0,b.DT)({trackMeta:{previous_page:"youtube",login_entrance:"youtube"}}):(le._1.updateEntryFullScreenFrom(Me.IMMERSION_BTN),le._1.updateShouldSummaryVideoDefault(!0),null===(e=document.querySelector("html"))||void 0===e||e.requestFullscreen(),He(Be.TOOLBAR))})),l.id=r,l.className="ytp-button",l.classList.add("immersion-btn-container"),n?l.style.display="none":ze(Oe.TOOLBAR);const c=document.createElement("div"),u=document.createElement("span");u.style.marginRight="4px",u.style.display="inline-block",u.innerHTML=us;const h=document.createElement("span");if(h.textContent=e("flow_web_ext_youtube_sharepage_immersionbutton"),h.style.fontWeight="600",h.style.fontSize="12px",Wn.A.watch({uiLanguage:()=>{h.textContent=e("flow_web_ext_youtube_sharepage_immersionbutton")}}),c.style.height="33px",c.style.lineHeight="initial",c.style.display="flex",c.style.alignItems="center",c.prepend(h),c.prepend(u),s||(l.appendChild(c),o.prepend(l)),(0,d.A)((()=>{var e;null===(e=o.querySelector(`#${r}`))||void 0===e||e.remove()})),(0,ue.jB)("youtube")){const e=document.querySelector(".ytp-right-controls");os(e);const t=document.querySelector("#container .html5-video-player");ls(t)}}function Zs(e){if(!(0,Te.tY)())return;const t=(0,z.useCallback)((()=>{e.isFetchSummarize&&e.isImmersionMode&&e.handleSummarizeVideo({clickFrom:le._1.getLastEntryFullScreenFrom(),translateLang:e.translateLanguage})}),[e]),n=(0,$.B)();var i;i=e.hasNoSubtitles,(0,z.useEffect)((()=>{var e,t;if(i)return;const n=e=>{document.fullscreenElement||"f"!==e.key||(He(Be.SHORTCUT),le._1.updateEntryFullScreenFrom(Me.IMMERSION_FULLSCREEN_SHORT_CUT))},s=e=>{document.fullscreenElement||(He(Be.FULLSCREEN),le._1.updateEntryFullScreenFrom(Me.IMMERSION_FULLSCREEN_BTN))},o=e=>{document.fullscreenElement||(He(Be.VIDEO_DB_CLICK),le._1.updateEntryFullScreenFrom(Me.VIDEO_DB_CLICK))};return document.addEventListener("keydown",n,!0),null===(e=document.querySelector("button.ytp-fullscreen-button"))||void 0===e||e.addEventListener("click",s,!0),null===(t=document)||void 0===t||null===(t=t.querySelector(".html5-main-video"))||void 0===t||t.addEventListener("dblclick",o,!0),()=>{var e,t;document.removeEventListener("keydown",n,!0),null===(e=document.querySelector("button.ytp-fullscreen-button"))||void 0===e||e.removeEventListener("click",s,!0),null===(t=document)||void 0===t||null===(t=t.querySelector(".html5-main-video"))||void 0===t||t.removeEventListener("dblclick",o,!0)}}),[i]);const s=(0,z.useCallback)((n=>{var i;if(e.isImmersionMode)return void t();"watch"!==(null==n||null===(i=n.detail)||void 0===i?void 0:i.pageType)&&(le._1.resetClickRelayBtnType(!0),le._1.updateShouldSummaryVideoDefault(!1))}),[e,t]),o=(0,z.useCallback)((e=>{le._1.resetClickRelayBtnType()}),[]);(0,z.useEffect)((()=>{let i;!function(){const e=document.querySelector("div.html5-video-player");if(!e)return;const t=e.querySelector(".ytp-chrome-top");t&&(t.style.display="none");const n=e.querySelector(".ytp-chapter-container");n&&(n.style.display="none")}(),Xs(n,e);const a=()=>{const s=document.querySelector("#Cici-ai-assistant");var o;(Xs(n,e),document.fullscreenElement)?(e.setImmersionMode(!0),e.isImmersionMode=!0,t(),i=Qs(e),s&&(s.style.display="none")):(e.setImmersionMode(!1),null===(o=i)||void 0===o||o(),i=void 0,s&&(s.style.display="block"))};return document.addEventListener("fullscreenchange",a),document.addEventListener("yt-navigate-start",o),document.addEventListener("yt-navigate-finish",s),e.isImmersionMode&&(t(),i=Qs(e)),()=>{document.removeEventListener("fullscreenchange",a),document.removeEventListener("yt-navigate-start",o),document.removeEventListener("yt-navigate-finish",s)}}),[e,n])}const eo=()=>{le._1.recordClickRelayBtnType(le.X_.playNext)},to=()=>{le._1.recordClickRelayBtnType(le.X_.recommendVideo)},no=()=>{le._1.recordClickRelayBtnType(le.X_.recommendVideoEnding)};var io=n(94282),so=n(99916),oo=n(9741);const ao=({videoSummaryId:e,videoHighlightsId:t})=>{const[n,i]=(0,z.useState)(!1),s=(0,se.l)((e=>e.setIsShowSidebar)),r=(0,st.P)((e=>e.messages)),{text:l="",body:c}=r[e]||{},{text:d=""}=r[t]||{},u=()=>({summary_message_id:l?e:"",highlights_message_id:(0,oe.ld)(d)?t:""}),h=function(){var e=(0,a.A)((function*(){var e,t,s,o;if(n)return;i(!0);const a={messageIds:[null!==(e=null==c||null===(t=c.message)||void 0===t?void 0:t.reply_id)&&void 0!==e?e:"",null!==(s=null==c||null===(o=c.message)||void 0===o?void 0:o.message_id)&&void 0!==s?s:""]};yield(0,so.ci)(a)}));return function(){return e.apply(this,arguments)}}();return{trackResultEvent:(e,t,n)=>{var i;i=(0,o.A)((0,o.A)({},u()),{},{button_name:e,is_immersion:t,show_from:n}),Ue(Q.Ur.clickVideoAssistantSummarizeResult,i)},handleClickContinueInChat:function(){var e=(0,a.A)((function*(){var e,t;if(t=(0,o.A)({},u()),(0,J.Kp)((0,o.A)((0,o.A)({},Fe(t)),{},{click_from:Q.Z5.videoAssistant})),null!==(e=(0,X.TK)("authInfo"))&&void 0!==e&&e.isAuthenticated)io.on.getState().setFloatingCardVisible(!1),io.on.getState().setSummaryActionVisible(!1),s(!0,Q.cz.videoAssistant),yield(0,oo.Z)(),yield h();else{const e=(0,ue.jB)("youtube");(0,b.DT)({trackMeta:{previous_page:e?"youtube":"bilibili",login_entrance:e?"youtube":"bilibili"}})}}));return function(){return e.apply(this,arguments)}}(),handleClickLogin:()=>{const e=(0,ue.jB)("youtube");(0,b.DT)({trackMeta:{previous_page:e?"youtube":"bilibili",login_entrance:e?"youtube":"bilibili"}})},trackHighlightEvent:(e,t,n,i)=>{var s,a;s=e,a=(0,o.A)((0,o.A)({},u()),{},{video_time:t,position:n,is_immersion:i?1:0}),Ue(s,a)},trackShareEvent:(e,t)=>{var n;n=(0,o.A)((0,o.A)({},u()),{},{click_from:e,range:t}),Ue(Q.Ur.share,n)},handleCopy:()=>{const e=(0,oe.mW)(d);var t;Ze()(`${l}${e}`),t=(0,o.A)({},u()),(0,J.ct)((0,o.A)((0,o.A)({},Fe(t)),{},{click_from:Q.Z5.videoAssistant}))}}};function ro({videoParamId:e,videoTitle:t}){const[n,i]=(0,le.gq)(),[s,o]=(0,z.useState)(void 0),{videoSummaryId:r,videoHighlightsId:l,translateLanguage:c,transcript:d,isTranscriptLoaded:u,contentVisible:h,summarizeTriggered:m,noContent:g,hasNoSubtitles:p,hasShowedUserGuidance:f,isSummaryDone:_,isHighlightsDone:y,hasTranscript:x,summaryResult:b,highlightsResult:A,setTranslateLanguage:w,handleSummarizeVideo:S,isMessageUnAuthorized:C}=ei({videoParamId:e,videoTitle:t,isImmersionMode:n}),k=(0,Kn.vh)("web_video_summary",C),{trackResultEvent:I,handleClickContinueInChat:E,handleClickLogin:T,trackHighlightEvent:j,trackShareEvent:N,handleCopy:M}=ao({videoSummaryId:r,videoHighlightsId:l}),L=e=>{I(e,n,s||le._1.getLastClickRelayBtnType())},R=(0,z.useCallback)(function(){var e=(0,a.A)((function*(e){void 0===s&&o(e.clickFrom),yield S(e)}));return function(t){return e.apply(this,arguments)}}(),[S,s,o]),[P,B]=(0,z.useState)(!1),[O,D]=(0,z.useState)({currentActiveBreakdownIndex:-1,currentActiveBulletPointIndex:-1,progress:0}),[F,U]=(0,z.useState)(!1),H=(0,z.useRef)(),q=()=>{U(!0),clearTimeout(H.current),H.current=setTimeout((()=>{U(!1)}),1e4)};(0,z.useEffect)((()=>{F||clearTimeout(H.current)}),[F]);Zs((0,z.useMemo)((()=>({transcript:d,highlightsResult:A,trackResultEvent:L,trackHighlightEvent:j,videoState:O,setVideoState:D,isLoadingDone:!(!y||!A),isFetchSummarize:!(!x||m),translateLanguage:c,handleSummarizeVideo:R,hasNoSubtitles:p,isSummaryAssistantClose:P,setSummaryAssistantClose:B,userInteracting:F,handleUserInteract:q,isImmersionMode:n,setImmersionMode:i,isMessageUnAuthorized:C})),[d,A,L,j,O,D,y,m,c,R,x,p,P,B,F,q,n,i,C])),function(){if(!(0,Te.tY)())return;const e=(0,z.useMemo)((()=>new MutationObserver((function(e){document.querySelectorAll("ytd-item-section-renderer").forEach((e=>{e.removeEventListener("click",to,!0),e.addEventListener("click",to,!0)}))}))),[]);(0,z.useEffect)((()=>{const t=document.querySelector("ytd-watch-next-secondary-results-renderer #contents");if(t)return e.observe(t,{childList:!0,subtree:!0}),()=>{e.disconnect()}}),[e]),(0,z.useEffect)((()=>{const e=document.querySelector(".ytp-next-button");if(e)return e.addEventListener("click",eo,!0),()=>{e.removeEventListener("click",eo,!0)}}),[]),(0,z.useEffect)((()=>{var e,t;return null===(e=document.querySelector(".ytp-autonav-endscreen-countdown-overlay"))||void 0===e||e.addEventListener("click",no,!0),null===(t=document.querySelector(".html5-endscreen"))||void 0===t||t.addEventListener("click",no,!0),()=>{var e,t;null===(e=document.querySelector(".ytp-autonav-endscreen-countdown-overlay"))||void 0===e||e.removeEventListener("click",no,!0),null===(t=document.querySelector(".html5-endscreen"))||void 0===t||t.removeEventListener("click",no,!0)}}),[])}(),(0,Te.id)()&&((0,z.useEffect)((()=>{le._1.resetClickRelayBtnType()}),[]),(0,z.useEffect)((()=>{var e,t;return null===(e=document.querySelector(".bpx-player-ctrl-next"))||void 0===e||e.addEventListener("click",eo,!0),null===(t=document.querySelector(".bpx-player-ctrl-prev"))||void 0===t||t.addEventListener("click",eo,!0),()=>{var e,t;null===(e=document.querySelector(".bpx-player-ctrl-prev"))||void 0===e||e.removeEventListener("click",eo,!0),null===(t=document.querySelector(".bpx-player-ctrl-next"))||void 0===t||t.removeEventListener("click",eo,!0)}}),[]),(0,z.useEffect)((()=>{const e=document.querySelector(".right-container");if(e)return e.addEventListener("click",to,!0),()=>{e.removeEventListener("click",to,!0)}}),[]),(0,z.useEffect)((()=>{const e=document.querySelector(".bpx-player-ending-panel");if(e)return e.addEventListener("click",no,!0),()=>{e.removeEventListener("click",no,!0)}}),[]));const V=(0,z.useRef)(null);return(0,K.jsxs)("div",{"data-testid":"video-summary-assistant-container",className:re()($e.videoSummaryAssistantContainer,{[$e.closeAssistant]:P}),ref:V,children:[(0,K.jsx)("div",{className:re()($e.area,$e.closeIcon),onClick:()=>{B(!0);const e=document.querySelector(`#${v.R3}-summary-btn`);e&&e.remove()},children:(0,K.jsx)(de.gz,{className:$e.icon})}),(0,K.jsx)(Ke,{available:k,contentVisible:h,popContainerRef:V,isSummaryDone:!!_,isHighlightsDone:!!y,noContent:!!g,hasTranscript:!!x,isTranscriptLoaded:u,summarizeTriggered:m,hasNoSubtitles:p,hasShowedUserGuidance:f,translateLanguage:c,setTranslateLanguage:w,onSummarizeVideo:({clickFrom:e,translateLang:t})=>R({clickFrom:e,translateLang:t}),onClickLogin:T,trackResultEvent:L}),(0,K.jsx)(En,{available:k,hasNoSubtitles:p,hasShowedUserGuidance:f,noContent:!!g,contentVisible:h,videoSummaryId:r,onRetry:()=>R({translateLang:c,clickFrom:Me.UPPER_RIGHT}),isHighlightsDone:!!y,transcript:d,highlightsResult:A,trackResultEvent:L,trackHighlightEvent:j,videoState:O,setVideoState:D,handleUserInteract:q,userInteracting:F,isImmersionMode:n}),k&&h&&_&&y&&!g&&(0,K.jsx)(mt,{videoTitle:t,onClickContinueInChat:E,popContainerRef:V,onCopy:M,videoId:e,currentPlayingClip:O.currentActiveBreakdownIndex,summaryResult:b,highlightResult:(0,oe.Bq)(A),trackShareEvent:(e,t)=>{N(e,t)},transcript:d,videoSummaryId:r,videoHighlightsId:l})]})}const lo=z.memo(ro),co=()=>{const{videoId:e,title:t,partId:n}=(0,ie.e)(),{isAuthenticated:i}=(0,Si.Y)("authInfo")[0]||{};return e?(0,K.jsx)("div",{className:"cici-ext-always-light semi-always-light",children:e&&(0,K.jsx)(lo,{videoParamId:e,videoTitle:t},e)},`${e}${n}-${i?1:0}`):null};var uo=n(81940),ho=n(58020);const mo="searchAssistantContainer-dCwn7m",go="header-YtilIR",po="controls-If21mO",vo="footer-KEZpq4",fo="buttonGroup-OCyzPQ",_o="content-DWiwJ2",yo="closeIcon-SQi8TC",xo="loginButton-QV9e95",bo="suggest-message-list-wrapper-VsKrvI",Ao="suggest-message-title-Kd6i2s",wo="suggest-message-title-icon-_VDoIY",So="suggest-message-title-deep-FqjPXb",Co="suggest-message-iywAli",ko="fadeIn-dVad2K",Io=({suggestMessageListWithStatus:e,className:t,onClick:n,fullMode:i=!1})=>{const{failed:s,suggests:o=[],isRegen:a}=e||{},r=(0,$.B)(),l=(0,z.useRef)({sgs:[]});return(0,z.useEffect)((()=>{l.current={sgs:o,botId:"TODO"}}),[o]),s||0===o.length?null:(0,K.jsxs)("div",{className:re()(bo,t),children:[(0,K.jsxs)("div",{className:re()(Ao,{[So]:i}),children:[i?(0,K.jsx)(de.oE,{className:wo}):null,(0,K.jsx)("div",{children:r("flow_web_ext_search_ask_more",{brand:(0,he.L2)()})})]}),o.map(((e,t)=>(0,K.jsxs)("div",{className:re()(Co,{[ko]:!a}),onClick:()=>((e,t)=>{n(e,t)})(e,t),children:[(0,K.jsx)("span",{style:{marginRight:8,fontSize:i?"14px":"12px"},children:e}),(0,K.jsx)(de.n4,{})]},t)))]})};var Eo=n(56819);const To="link-JieA9Q",jo="linkIcon-_nuf2A",No="text-Nef5ie",Mo=({href:e=""})=>{const t=(0,z.useMemo)((()=>{try{return new URL(e).hostname.replace(/^www\./,"")}catch(t){return""}}),[e]);return t?(0,K.jsxs)("a",{href:e,target:"_blank",className:To,children:[(0,K.jsx)(et.Dkt,{className:jo}),(0,K.jsx)("span",{className:No,children:t})]}):null};var Lo=n(99792),Ro=n(93507);const Po=({message_id:e,search_id:t,search_from:n,show_from:i,from_search_id:s})=>{(0,Y.z8)(Q.Ur.showDeepSearchAssistant,{search_engine_name:"google",message_id:e,search_id:t,search_from:n,show_from:i,from_search_id:s})},Bo=({search_id:e,title:t,show_content_message_id:n,show_content_wordlength:i,sources_count:s,rnk:o,source_name:a,source_publishtime:r,location_pagenum:l})=>{(0,Y.z8)(Q.Ur.showSources,{current_page:"search_engine",search_engine_name:"google",search_id:e,title:t,show_content_message_id:n,show_content_wordlength:i,sources_count:s,rnk:o,source_name:a,source_publishtime:r,location_pagenum:l})},Oo=({search_id:e,title:t,show_content_message_id:n,show_content_wordlength:i,sources_count:s,rnk:o,source_name:a,source_publishtime:r,location_pagenum:l})=>{(0,Y.z8)(Q.Ur.showSources,{current_page:"search_engine",search_engine_name:"google",search_id:e,title:t,show_content_message_id:n,show_content_wordlength:i,sources_count:s,rnk:o,source_name:a,source_publishtime:r,location_pagenum:l})},Do=({show_from:e})=>{(0,Y.z8)(Q.Ur.showDeepSearchBtn,{current_page:"search_engine",search_engine_name:"google",show_from:e})},Fo=({search_id:e,click_from:t})=>{(0,Y.z8)(Q.Ur.clickDeepSearchBtn,{current_page:"search_engine",search_engine_name:"google",search_id:e,click_from:t})},Uo=({click_from:e,message_id:t,search_id:n})=>{(0,Y.z8)(Q.Ur.copy,{click_from:e,message_id:t,search_id:n})},Ho={searchList:[],isDeepSearchMode:!1},zo=(0,ii.vt)()((0,ni.eh)((e=>(0,o.A)((0,o.A)({},Ho),{},{addSearch:t=>e((e=>({searchList:[...e.searchList,t]}))),replaceSearch:(t,n)=>e((e=>({searchList:e.searchList.map(((e,i)=>i===n?t:e))}))),resetSearch:t=>e((()=>({searchList:[t]}))),clearSearch:()=>e((()=>({searchList:[]}))),setDeepSearchMode:t=>e((()=>({isDeepSearchMode:t})))}))));var qo=n(12893),Vo=n(69327);const{Text:$o}=ce.Typography,Ko=e=>{if(!e)return"";let t;const n=document.querySelector(e.inputQuery[0]);if(n&&(t=n.value),!t){t=new URL(location.href).searchParams.get(e.searchParam)||""}return t};function Wo({hasDeepSearchEntry:e}){var t;const n=(0,$.B)(),[i,s]=(0,z.useState)(""),[r,l]=(0,z.useState)(!1),c=(0,z.useRef)(0),[d,u]=(0,z.useState)(""),[g,v]=(0,z.useState)(!1),f=(0,st.P)((e=>e.sendMessage)),_=(0,st.P)((e=>e.messages)),{searchList:y,clearSearch:x,resetSearch:A,isDeepSearchMode:w,setDeepSearchMode:S}=zo((e=>({searchList:e.searchList,clearSearch:e.clearSearch,resetSearch:e.resetSearch,isDeepSearchMode:e.isDeepSearchMode,setDeepSearchMode:e.setDeepSearchMode}))),{insertedElements:C}=(e=>{var t;const n=(null==e||null===(t=e.body)||void 0===t||null===(t=t.message)||void 0===t?void 0:t.meta_infos)||[],i=(null==e?void 0:e.id)||"",s=(0,z.useRef)({id:null==e?void 0:e.id,links:[]}),o=(0,z.useMemo)((()=>{i!==s.current.id&&(s.current.id=i,s.current.links=[]);const{links:e}=s.current;return n.forEach((t=>{if(-1===t.type){const n=(0,Eo.O)(t.info,{});null!=n&&n.url&&!e.find((e=>e.position===n.position))&&e.push(n)}})),s.current.links=e,e.map((e=>({range:e.position,render:()=>(0,K.jsx)(Mo,{href:e.url})})))}),[i,n]);return{insertedElements:o}})(w?void 0:_[i]),k=null===(t=(0,z.useContext)(Vo.mn))||void 0===t?void 0:t.engine,{isUnAuthorized:I,isDone:E,text:T="",suggests:j=[],body:N}=_[i]||{},M=(0,Kn.vh)((0,Kn.OB)(Gn.EU.search),I),L=e&&M&&E,R=e=>{const t=(0,fe.wz)((0,X.TK)("uiLanguage")),n=f((0,o.A)((0,o.A)({},e),{},{replyLang:t,prompt:Gn.EU.browser_plugin_info,browser_plugin_info:'{"skill_name":"search"}'}));s(n)};(0,z.useEffect)((()=>{const e=Ko(k);e&&u(e)}),[]),(0,z.useEffect)((()=>{l(!1)}),[i]),(0,z.useEffect)((()=>{w||Z({search_engine_name:null==k?void 0:k.name,show_from:"deep_search_mode"})}),[w]),(0,z.useEffect)((()=>{if(M&&d){(0,Kn.BB)({action:"web_search",triggerLogin:!1});const e={text:d,answerWithSuggest:!0,current_page:"search_engine",scene:"search_engine"};x(),R(e),xi.vF.persist.log({message:"[search - ui-creation] component mounted"})}}),[M,d]),(0,z.useEffect)((()=>{var e;E&&(ee({prompt_cnt:j.length,message_id:null==N||null===(e=N.message)||void 0===e?void 0:e.message_id,search_engine_name:null==k?void 0:k.name}),L&&Do({show_from:"search_result_card"}))}),[E]),(0,z.useEffect)((()=>{if(j.length&&j.length>c.current){for(let t=c.current;t<j.length;t++){var e;te({prompt_position:`${t+1}`,message_id:null==N||null===(e=N.message)||void 0===e?void 0:e.message_id,search_engine_name:null==k?void 0:k.name})}c.current=j.length}}),[j]);const{onCopyClick:P,onMouseEnter:B,onMouseLeave:D,checked:F}=ct((()=>{var e;Ze()(T),(({message_id:e})=>{(0,J.ct)({message_id:e,click_from:Q.Z5.searchAssistant})})({message_id:null==N||null===(e=N.message)||void 0===e?void 0:e.message_id})})),U=F?et.eWz:et.fFY,H=function(){var e=(0,a.A)((function*(){var e,t,n,i,s,o;if((({message_id:e})=>{(0,J.Kp)({message_id:e,click_from:Q.Z5.searchAssistant})})({message_id:null!==(e=null==N||null===(t=N.message)||void 0===t?void 0:t.message_id)&&void 0!==e?e:""}),r)return;l(!0);const a={messageIds:[null!==(n=null==N||null===(i=N.message)||void 0===i?void 0:i.reply_id)&&void 0!==n?n:"",null!==(s=null==N||null===(o=N.message)||void 0===o?void 0:o.message_id)&&void 0!==s?s:""]};yield(0,so.ci)(a)}));return function(){return e.apply(this,arguments)}}(),q=function(){var e=(0,a.A)((function*(){var e;null!==(e=(0,X.TK)("authInfo"))&&void 0!==e&&e.isAuthenticated?(io.on.getState().setFloatingCardVisible(!1),io.on.getState().setSummaryActionVisible(!1),se.l.getState().setIsShowSidebar(!0,Q.cz.searchAssistant),yield(0,oo.Z)(),yield H()):(0,b.DT)({trackMeta:{previous_page:"search_engine",login_entrance:"search_result_card"}})}));return function(){return e.apply(this,arguments)}}(),V=function(){var e=(0,a.A)((function*(e,t){var n,i;if(ne({click_position:`${t+1}`,message_id:null==N||null===(n=N.message)||void 0===n?void 0:n.message_id}),null===(i=(0,X.TK)("authInfo"))||void 0===i||!i.isAuthenticated)return void(0,b.DT)({trackMeta:{previous_page:"search_engine",login_entrance:"search_result_card"}});io.on.getState().setFloatingCardVisible(!1),io.on.getState().setSummaryActionVisible(!1),se.l.getState().setIsShowSidebar(!0,Q.cz.searchAssistant),yield(0,oo.Z)(),yield H();const{convId:s,convType:o,mainBotId:a}=(0,qo.IK)(),r={text:e,scene:$n.sJ.search_related_suggested_prompt,extraExt:{need_create_thread:o===ho.He.NewThread?"1":"0",browser_language:(0,fe.wz)((0,X.TK)("uiLanguage"))},ctx:(0,so.Pe)(o,s,a)};yield(0,oo.Z)(),yield(0,so.Bc)(o,r)}));return function(t,n){return e.apply(this,arguments)}}(),W=(0,z.useRef)(null),G=(null==k?void 0:k.containerStyle)||{};return(0,z.useEffect)((()=>{M&&E&&(0,p.ku)()&&(0,m.ae)(m.vP.search_result_card,m.p6.searchresult)}),[M,E]),(0,K.jsxs)("div",{"data-testid":"search-assistant-container",className:re()(mo,"cici-ext-always-light","semi-always-light"),style:(0,o.A)((0,o.A)({},G),{},{display:w?"none":"block"}),onMouseLeave:()=>v(!1),ref:W,children:[(0,K.jsx)(Lo.A,{className:yo,show:g,disableKey:Ro.lf.searchAssistant,setShow:v,cssStyle:{zIndex:100}}),(0,K.jsxs)("div",{className:go,children:[(0,K.jsx)(Ve.A,{size:"large",disable:!0,bransNameVisible:!1,children:n("flow_web_ext_search_summarytitle1",{brandName:(0,he.L2)()})}),(0,K.jsxs)("div",{className:po,children:[L&&(0,K.jsx)(uo.c,{type:"ai-primary",icon:(0,K.jsx)(et.zSs,{}),size:"small",onClick:()=>{if(!y.length){const e=(0,fe.wz)((0,X.TK)("uiLanguage")),t={skill_id:"8",skill_type:8},n=f({text:d,prompt:Gn.EU.input_skill,answerWithSuggest:!0,current_page:"search_engine",scene:"search_engine",sec_scene:"deep_search_mode",input_skill:JSON.stringify(t),replyLang:e});A({searchId:n,searchQuery:d})}S(!0),Fo({search_id:i,click_from:"search_result_card"})},children:n("flow_web_ext_search_deepinsearch")}),!M&&(0,K.jsx)(ce.$n,{theme:"solid",size:"small",className:xo,icon:(0,K.jsx)(de.oE,{}),onClick:()=>{(0,b.DT)({trackMeta:{previous_page:"search_engine",login_entrance:"search_result_card"}})},type:"primary",children:(0,K.jsx)($o,{ellipsis:{showTooltip:{opts:{getPopupContainer:()=>W.current}}},style:{maxWidth:125},size:"small",children:n("flow_web_ext_search_login",{brand:(0,he.L2)()})})})]})]}),M&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)("div",{className:_o,children:[(0,K.jsx)(In,{id:i,onRetry:()=>{var e;R({text:d,answerWithSuggest:!0,current_page:"search_engine",scene:"search_engine"}),(({message_id:e})=>{(0,J.hc)({message_id:e,click_from:Q.Z5.searchAssistant})})({message_id:null==N||null===(e=N.message)||void 0===e?void 0:e.message_id})},type:"search",MDBoxProps:{insertedElements:C}}),E&&(0,K.jsx)(Io,{suggestMessageListWithStatus:{isRegen:!1,loading:!1,suggests:j.filter((e=>e)),failed:!1},onClick:V})]}),E&&(0,K.jsxs)("div",{className:vo,children:[(0,K.jsx)("div",{className:fo,children:(0,K.jsx)(uo.c,{type:"tertiary",icon:(0,K.jsx)(et.EGn,{}),size:"small",onClick:q,children:n("flow_web_ext_action_translate_chat")})}),(0,K.jsxs)("div",{className:fo,children:[(0,p.ku)()&&(0,K.jsx)(ce.m_,{content:n("flow_web_ext_action_bookmarks"),getPopupContainer:()=>W.current,children:(0,K.jsx)(uo.c,{type:"tertiary",icon:(0,K.jsx)(et.Wur,{}),size:"small",onClick:()=>{var e;(0,O.X)({collectFrom:m.vP.search_result_card,collectionType:h.X.SearchResult,messageId:null==N||null===(e=N.message)||void 0===e?void 0:e.message_id,localMessageId:i,userInput:d})}})}),(0,K.jsx)(ce.m_,{content:n("message_long_press_copy"),getPopupContainer:()=>W.current,children:(0,K.jsx)(uo.c,{type:"tertiary",icon:(0,K.jsx)(U,{}),size:"small",onMouseEnter:B,onMouseLeave:D,onClick:P})})]})]})]})]})}n(12487),n(22921);n(20409);var Go=n(85204),Yo=n(36792),Qo=n(71967),Jo=n(72595),Xo=n(3690);function Zo(){const[e,t]=(0,z.useState)(void 0);return(0,z.useEffect)((()=>{const e=(0,_t.A)((()=>{if(!(0,p.ku)())return;const e=(0,Go.OM)()?tt.e.VideoSummary:(0,Jo.ow)()?tt.e.Pdf:tt.e.Web;(0,Qo.K)(e,e===tt.e.Web?void 0:"").then((e=>{(0,Yo.NK)(e).then((e=>{t(e)})).catch((()=>t(void 0)))})).catch((()=>t(void 0)))}),1e4),n=new MutationObserver(e);n.observe(document,{attributes:!0,childList:!0,subtree:!0});const i=n=>{t(n),e()};return Xo.A.on("onWebpageSaved",i),e(),()=>{n.disconnect(),Xo.A.off("onWebpageSaved",i)}}),[]),e}const ea=e=>{(0,Y.z8)(Q.Ur.showPdfAssistant,{show_from:e})},ta=e=>{(0,Y.z8)(Q.Ur.clickReadPdfBtn,{click_from:e})};var na=n(50235),ia=n(30510);const sa="pdfAssistantContainer-tzWRfF",oa="pdfCollectBtn-z2TM9_",aa="name-rmIuEu",ra="savedIcn-n9N3VS",la="readButton-ZDzC9k",ca="text-kak2Ld",da="buttonArxiv-s7j92h",ua="buttonPdfChrome-U0M4qX",ha="buttonPdfEdge-uB3XIz",ma="buttonPdfSafari-EZUGmo";function ga(){var e;const t=(0,bi.Uk)(),n=null===(e=(0,z.useContext)(Jo.Er))||void 0===e?void 0:e.platform,i=null==n?void 0:n.name,s=(0,se.l)((e=>e.isSidePanelMode)),o=(0,se.l)((e=>e.setIsShowSidebar)),l=(0,io.on)((e=>e.setFloatingCardVisible)),c=(0,io.on)((e=>e.setSummaryActionVisible)),[d,u]=(0,Si.Y)("needOpenSideBar"),g="arxiv"===i,v=(0,r.UPE)(),f=(0,r.nrF)(),_=window.location.protocol.startsWith("file:"),y=!g&&!_&&(0,p.ku)();(0,z.useEffect)((()=>{ea(g?Q.Z5.arxiv:Q.Z5.pdf),d&&(u(!1),o(!0,Q.cz.other),l(!1),c(!1))}),[]);const x=function(){var e=(0,a.A)((function*(){const e=location.href.replace("/abs/","/pdf/");g?ta(Q.Z5.arxiv):(o(!0,Q.cz.other),l(!1),c(!1),ta(Q.Z5.pdf)),s?(o(!0,Q.cz.other),yield(0,oo.Z)(),(0,ia.cs)({name:"read-pdf",body:{url:e}})):(yield(0,qo.$D)(),(0,na.M)({url:e})),g&&(u(!0),location.href=e)}));return function(){return e.apply(this,arguments)}}(),b=(0,z.useMemo)((()=>"arxiv"===(null==n?void 0:n.name)?m.vP.arxiv_view_pdf:m.vP.chrome_pdf_viewer),[n]);(0,z.useEffect)((()=>{y&&(0,m.ae)(b,m.p6.pdf)}),[_]);const A=Zo(),w=(0,z.useMemo)((()=>A?t("flow_web_ext_sidebar_bookmarks_saved"):t("flow_web_ext_pdf_page_bookmarks").replace("{{brandName}}",(0,he.L2)()||"")),[A,t]);return(0,K.jsxs)("div",{className:re()(sa,{[da]:g,[ua]:!g&&!v&&!f,[ha]:!g&&v,[ma]:!g&&f}),children:[(0,K.jsxs)("div",{className:re()(la),onClick:x,children:[(0,K.jsx)(de.HD,{}),(0,K.jsx)("div",{className:ca,children:t("flow_web_ext_pdf_page_airead")})]}),y&&(0,K.jsxs)("button",{className:oa,onPointerUp:()=>{A?(0,O.P)(A):(0,O.X)({collectFrom:b,collectionType:h.X.Pdf})},children:[A?(0,K.jsx)(et.u06,{className:ra}):(0,K.jsx)(et.Wur,{}),(0,K.jsx)("span",{className:aa,children:w})]})]})}var pa=n(91367),va="new-mail",fa="reply",_a="forward";let ya=function(e){return e.positive="positive",e.negative="negative",e.uncertain="need_more",e}({});var xa="create",ba="reply",Aa="regeneration",wa="formalize",Sa="elaborate",Ca="shorten",ka="insert",Ia="reply lange";const Ea='[class="gmail_quote"]',Ta=(e,t=!0)=>{if(!e)return"";let n="";return e.childNodes.forEach((e=>{e instanceof HTMLElement&&e.matches(Ea)||(n+=e.textContent)})),t?n.trim():n},ja=(e,t)=>{var n;if(t!==fa)return"";const i=document.querySelectorAll('[role="listitem"]');let s=null;for(const h of i)if(h.contains(e)){s=h;break}if(!s)return"";const o=s.querySelector('[data-message-id*="#msg-"]');if(!o)return"";const a=(null===(n=o.getAttribute("data-message-id"))||void 0===n?void 0:n.match(/^#msg-([r|f|a]):.+/))||null;if(!a)return"";const r=a[1],l="r"===r||"f"===r?o.querySelector('[jslog*="20277"]'):null;if(!l)return"";let c="",d=!1;const u=e=>{var t;if(e.nodeType===Node.TEXT_NODE)c+=(null===(t=e.textContent)||void 0===t?void 0:t.trim())||"";else if(e.nodeType===Node.ELEMENT_NODE){if((e=>{for(const t of[Ea,'[id*="divRplyFwdMsg"]','[id*="lark-mail-quote"]'])if(e.matches(t))return!0;return!1})(e))return void(d=!0);for(const t of e.childNodes)d||u(t)}};return u(l),c=c.replace(/\n\s*\n/g,"\n"),c},Na=e=>""!==(0,pa.A)(e),Ma=e=>{switch(e){case ya.positive:return Q.Z5.mailPositive;case ya.negative:return Q.Z5.mailNegative;default:return Q.Z5.mailNeedMore}},La="container-_HnD61",Ra="non-pop-window-LOUDTy",Pa="icon-write-pencil-C8Qtgc",Ba="help-write-btn-ft3n62",Oa="gradient-button-EctToC",Da="quick-reply-container-mec4qr",Fa="quick-reply-text-SLRpCO",Ua="quick-action-btn-l5msDz",Ha="quick-reply-popover-Ha5FIZ",za="quick-reply-message-container-w1Okm9",qa="mail-stream-message-rKVARE",Va="quick-reply-toolbar-rjWpIX",$a="mail-input-container-mE5nG4",Ka="mail-input-textarea-C_HZBR",Wa="mail-input-btn-container-uuyYvE",Ga="mail-input-cancel-btn-hxgwmJ",Ya="mail-header-left-lw1XVt",Qa="icon-arrow-FffRH_",Ja="mail-input-ok-btn-KOQQ5i",Xa="btn-disable-eEHGUv",Za="mail-message-container-t3DtyB",er="mail-stream-message-container-W2GSGg",tr="mail-toolbar-HMJVdE",nr="mail-toolbar-hidden-jlCCeB",ir="mail-toolbar-left-SRmWKN",sr="mail-operation-btn-BJdgZ4",or="mail-operation-btn-text-vOfZEO",ar="mail-toolbar-insert-button-IPiwra",rr="mail-header-input-Y5rKom",lr="is-inputting-UcaZT_",cr="header-right-lfm_Jq",dr="translate-btn-ITgdvD",ur="close-btn-wVRrfQ",hr="close-btn-behind-not-editable-E5QwMD",mr="not-editable-content-KpzdYO",gr="not-write-done-Lh5aMx",pr="mail-divider-KlplzU",vr="btn-dropdown-trigger-fuI45K",fr="btn-refine-yB7V1i",_r="btn-dropdown-container-fORGk6",yr="refine-triangle-expand-H3s7G3",xr="regenerate-icon-container-NZMvPS",br="translate-icon-container-Oipqv5",Ar="tooltip-xFTp38",wr=({handleClick:e})=>{const t=(0,$.B)();return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(ce.$n,{className:sr,onClick:()=>e(wa),icon:(0,K.jsx)(de.zG,{}),"data-testid":"mail-formalize-btn",children:(0,K.jsx)("div",{className:or,children:t("flow_web_ext_email_formalize")})}),(0,K.jsx)(ce.$n,{className:sr,onClick:()=>e(Sa),icon:(0,K.jsx)(de.li,{}),"data-testid":"mail-elaborate-btn",children:(0,K.jsx)("div",{className:or,children:t("flow_web_ext_email_elaborate")})}),(0,K.jsx)(ce.$n,{className:sr,onClick:()=>e(Ca),icon:(0,K.jsx)(de.P$,{}),"data-testid":"mail-shorten-btn",children:(0,K.jsx)("div",{className:or,children:t("flow_web_ext_email_shorten")})})]})},Sr=({handleClick:e,position:t="topLeft"})=>{const n=(0,z.useRef)(null),[i,s]=(0,z.useState)(!1),o=(0,$.B)();return(0,K.jsx)("div",{ref:n,onMouseDown:e=>e.stopPropagation(),style:{position:"relative"},children:(0,K.jsx)(ce.ms,{className:_r,position:t,trigger:"click",render:(0,K.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(0,K.jsx)(wr,{handleClick:e})}),getPopupContainer:()=>n.current,onVisibleChange:e=>{"topLeft"===t&&s(e)},children:(0,K.jsxs)("div",{className:vr,children:[(0,K.jsx)(de.EH,{}),(0,K.jsx)("div",{className:fr,children:o("flow_web_ext_email_refine")}),(0,K.jsx)(de.R0,{className:re()({[yr]:i})})]})})})},Cr=({handleClick:e,isShow:t})=>{const n=(0,$.B)(),[i,{width:s}]=(0,hs.A)();return(0,K.jsxs)("div",{ref:i,className:re()(tr,{[nr]:!t}),children:[(0,K.jsxs)("div",{className:ir,children:[(0,K.jsx)(ce.$n,{className:sr,onClick:()=>e(Aa),icon:(0,K.jsx)(de.eD,{}),"data-testid":"mail-regenerate-btn",children:(0,K.jsx)("div",{className:or,children:n("flow_web_ext_email_regen")})}),s<=502?(0,K.jsx)(Sr,{handleClick:e}):(0,K.jsx)(wr,{handleClick:e})]}),(0,K.jsx)(ce.$n,{"data-testid":"mail-insert-btn",type:"primary",theme:"solid",className:ar,onClick:()=>e(ka),children:n("flow_web_ext_email_insert")})]})},kr=e=>{const{replyLang:t,handleClick:n}=e,i=(0,$.B)(),s=(0,z.useRef)(null);return(0,K.jsxs)("div",{ref:s,className:Va,children:[(0,K.jsxs)("div",{className:ir,children:[(0,K.jsx)(ce.$n,{"data-testid":"mail-insert-btn",type:"primary",theme:"solid",className:ar,style:{marginRight:"8px"},onClick:()=>n(ka),children:i("flow_web_ext_email_insert")}),(0,K.jsx)(Sr,{position:"bottomLeft",handleClick:n})]}),(0,K.jsx)(Ee,{scene:_e.jv.mail,translateLanguage:t,anchorRef:s,popContainerRef:s,toolTipClassname:Ar,translateIconClassname:br,onLanguageChange:e=>{n(Ia,e)}}),(0,K.jsx)(ce.m_,{content:i("flow_web_ext_email_regen"),className:Ar,getPopupContainer:()=>s.current,children:(0,K.jsx)("div",{className:xr,onClick:()=>n(Aa),"data-testid":"mail-regenerate-btn",children:(0,K.jsx)(de.eD,{})})})]})},Ir=e=>{const t=(0,$.B)(),{content:n,onChangeContent:i,handleCancel:s,handleSubmit:o,onResize:a}=e,r=!Na(n);return(0,K.jsxs)("div",{"data-testid":"mail-input-container",className:re()($a,{}),children:[(0,K.jsxs)("div",{className:Ya,children:[(0,K.jsx)(de.un,{className:Pa}),(0,K.jsx)(ce.fs,{autosize:{maxRows:3},rows:1,className:re()({[Ka]:!r}),value:n,onChange:i,autoFocus:!0,onEnterPress:r?void 0:e=>{"Enter"===e.key&&e.shiftKey||o()},onResize:a,placeholder:t("flow_web_ext_email_tellme")})]}),(0,K.jsxs)("div",{className:Wa,children:[(0,K.jsx)(ce.$n,{className:Ga,theme:"solid",onClick:s,children:t("flow_web_ext_email_cancel")}),(0,K.jsx)(ce.$n,{className:re()(Ja,{[Xa]:r}),theme:"solid",disabled:r,onClick:o,children:t("flow_web_ext_email_write")})]})]})},Er=e=>{const{content:t,writeDone:n,lastSendContent:i,replyLang:s,inputting:o=!1,disable:a=!1,onBlur:r,onFoucs:l,onChangeContent:c,handleSubmit:d,handleClickClose:u,handleClickReturn:h,onSwitchDivider:m,onChangeLang:g}=e,p=(0,$.B)(),v=!Na(t)||t===i,f=(0,z.useRef)(null),_=(0,z.useRef)(null);return(0,z.useEffect)((()=>{const e=e=>{i!==t&&e.target!==f.current&&e.preventDefault()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[i,t]),(0,K.jsxs)("div",{"data-testid":"mail-header-input",className:re()(rr,{[lr]:o}),children:[a?(0,K.jsx)("div",{className:mr,children:t}):(0,K.jsxs)("div",{className:re()(Ya,{[gr]:!n}),onMouseEnter:()=>null==m?void 0:m(!1),onMouseLeave:()=>null==m?void 0:m(!0),children:[o?(0,K.jsx)(de.Gk,{onMouseDown:h,className:Qa}):(0,K.jsx)(de.un,{className:Pa}),(0,K.jsx)(ce.pd,{ref:f,borderless:!0,size:"small",value:t,disabled:!n,onFocus:l,onChange:c,onBlur:r,onMouseDown:e=>{e.stopPropagation()},onEnterPress:v?void 0:e=>{"Enter"===e.key&&e.shiftKey||d()},placeholder:p("flow_web_ext_email_tellme")})]}),o?(0,K.jsx)(ce.$n,{theme:"solid",onClick:d,disabled:v,className:re()(Ja,{[Xa]:v}),"data-testid":"mail-input-update-btn",children:p("flow_web_ext_email_update")}):(0,K.jsxs)("div",{ref:_,className:cr,children:[(0,K.jsx)(Ee,{scene:_e.jv.mail,anchorRef:_,translateLanguage:s,popContainerRef:_,toolTipClassname:Ar,translateIconClassname:dr,onLanguageChange:e=>{null==g||g(e)}}),(0,K.jsx)(ce.cG,{layout:"vertical"}),(0,K.jsx)("div",{className:re()(ur,{[hr]:a}),onClick:u,children:(0,K.jsx)(de.gz,{})})]})]})},Tr=e=>{const{id:t,isDone:n,content:i,lastSendContent:s,inputting:o,replyLang:a,inputDisable:r=!1,bottom:l,onInputBlur:c,onInputFocus:d,onInputChange:u,handleClose:h,handleReturn:m,handleUpdate:g,handleClickTool:p}=e;return(0,K.jsxs)("div",{"data-testid":"mail-message-container",style:{bottom:`${l}px`},className:Za,children:[(0,K.jsxs)("div",{children:[(0,K.jsx)(Er,{writeDone:n,content:i,lastSendContent:s,inputting:o,disable:r,replyLang:a,onBlur:c,onFoucs:d,onChangeContent:u,handleClickClose:h,handleClickReturn:m,handleSubmit:g,onChangeLang:e=>p(Ia,e)}),(0,K.jsx)(ce.cG,{className:pr,layout:"horizontal"}),(0,K.jsx)("div",{className:er,children:(0,K.jsx)(In,{id:t,type:"mail",enableScroll:!0,className:qa,autoScrollToEnd:!1})})]}),n&&(0,K.jsx)(Cr,{handleClick:p,isShow:!o})]})},jr=e=>{const{id:t,isDone:n,replyLang:i,handleClickBtn:s}=e;return(0,K.jsxs)("div",{className:za,children:[(0,K.jsx)(In,{id:t,type:"mail",enableScroll:!0,className:qa,autoScrollToEnd:!1}),n&&(0,K.jsx)(kr,{replyLang:i,handleClick:s})]})},Nr=e=>{(0,Y.z8)(Q.Ur.showMailEntryButton,(0,o.A)({},e))},Mr=e=>{(0,Y.z8)(Q.Ur.clickMailEntryButton,(0,o.A)({},e))},Lr=e=>{(0,Y.z8)(Q.Ur.showMailThreadResult,(0,o.A)({},e))},Rr=e=>{(0,Y.z8)(Q.Ur.closeMailThreadResult,(0,o.A)({},e))},Pr=e=>{var t;const n=null==e||null===(t=e.closest("table"))||void 0===t||null===(t=t.parentElement)||void 0===t||null===(t=t.closest("table"))||void 0===t?void 0:t.querySelectorAll('[role="toolbar"]');let i=null;if(n)for(const o of n)if(o.matches(":has([command])")){var s;i=null===(s=o.parentElement)||void 0===s?void 0:s.parentElement;break}return i},Br=(e,t)=>{var n;const{bannerHeight:i}=((e,t)=>{const n=e===va,[i,s]=(0,z.useState)(0);return(0,z.useEffect)((()=>{if(!n){var e;const n=null===(e=t.parentElement)||void 0===e||null===(e=e.previousElementSibling)||void 0===e?void 0:e.previousElementSibling;if(!n)return;const i=new MutationObserver((function(){if(n instanceof HTMLElement){n.style.marginLeft="0px",n.style.marginRight="0px";const e=n.style.display;if(""===e){const e=n.getBoundingClientRect().height;s(e)}else"none"===e&&s(0)}}));return i.observe(n,{childList:!1,subtree:!1,attributes:!0,attributeFilter:["style"]}),()=>{i.disconnect()}}}),[n]),{bannerHeight:i}})(t,e),s=(0,z.useRef)(Pr(e)),[o,a]=(0,z.useState)(!!s.current),[r,l]=(0,z.useState)((null===(n=s.current)||void 0===n?void 0:n.offsetHeight)||0);let c=0;return 0!==r&&(c+=r+20+i),(0,z.useEffect)((()=>{if(!o||!s.current)return;const e=new MutationObserver((function(){if(!s.current)return;const e=s.current.style.display;""===e?l(s.current.offsetHeight):"none"===e&&l(0)}));return e.observe(s.current,{childList:!1,subtree:!1,attributes:!0,attributeFilter:["style"]}),()=>{e.disconnect()}}),[o]),(0,z.useEffect)((()=>{if(o)return;const t=new MutationObserver((()=>{if(s.current)return;const t=Pr(e);t&&(s.current=t,a(!0))}));return t.observe(document.body,{childList:!0,subtree:!1}),()=>{t.disconnect()}}),[]),{bottom:c}},Or=()=>{const e=(0,$.B)(),t=(0,st.P)((e=>e.sendMessage)),n=(0,z.useRef)(""),[i,s]=(0,z.useState)([]);return{replyContentRef:n,quickReplys:i,setQuickReplys:s,initQuickReply:(i,o,a)=>{if(n.current=ja(i,o),""===n.current)return;(0,Y.z8)(Q.Ur.quickReplyButtonShow,{button_name:"positive"}),(0,Y.z8)(Q.Ur.quickReplyButtonShow,{button_name:"negative"}),(0,Y.z8)(Q.Ur.quickReplyButtonShow,{button_name:"need_more"});const r={action:ba,reply_content:n.current},l=[{type:ya.positive,text:e("flow_web_ext_email_reply_positive"),msgId:void 0},{type:ya.negative,text:e("flow_web_ext_email_reply_negative"),msgId:void 0},{type:ya.uncertain,text:e("flow_web_ext_email_reply_uncertain"),msgId:void 0}];for(const e of l){const n=t({text:e.text,scene:$n.sJ.mail,prompt:Gn.EU.mail,answerWithSuggest:!1,browser_mail:JSON.stringify(r),replyLang:(0,fe.wz)(a)});e.msgId=n}s(l)}}},Dr=(e,t,n)=>{const i=(0,st.P)((e=>e.sendMessage)),s=(0,X.TK)("uiLanguage"),[a,r]=(0,z.useState)(s),{inputContent:l,inputHeight:c,isInputting:d,lastInputContent:u,fromInputMsgId:h,currInputMsgId:m,generateScene:g,writingDone:p,writingResult:v,setInputContent:f,setIsInputting:_,setLastInputContent:y,setFromInputMsgId:x,setCurrInputMsgId:A,setGenerateScene:w,onChangeInputContent:S,onInputBlur:C,onInputFocus:k,onInputHeightChange:I}=(()=>{const e=(0,st.P)((e=>e.messages)),[t,n]=(0,z.useState)(""),[i,s]=(0,z.useState)(20),[o,a]=(0,z.useState)(!1),[r,l]=(0,z.useState)(""),[c,d]=(0,z.useState)(""),[u,h]=(0,z.useState)(""),[m,g]=(0,z.useState)(Q.Z5.mailCreate),{isDone:p,text:v=""}=e[u]||{};return(0,z.useEffect)((()=>{p&&Lr({message_id:u,from_message_id:c,scene:m,thread_length:v.length})}),[p]),{inputContent:t,inputHeight:i,isInputting:o,lastInputContent:r,fromInputMsgId:c,currInputMsgId:u,generateScene:m,writingDone:p,writingResult:v,setInputContent:n,setIsInputting:a,setLastInputContent:l,setFromInputMsgId:d,setCurrInputMsgId:h,setGenerateScene:g,onChangeInputContent:e=>{a(!0),n(e||"")},onInputBlur:()=>{a(!1),n(r)},onInputFocus:()=>{a(!0)},onInputHeightChange:e=>{s(e.height)}}})(),{replyContentRef:E,quickReplys:T,setQuickReplys:j,initQuickReply:N}=Or(),{isPopWindow:M,showHelpWriteBtn:L,showRewrite:R,showFooterInput:P,mainBodyContentRef:B,mainTextRef:O,setShowHelpWriteBtn:D,setShowRewrite:F,setShowFooterInput:U}=(e=>{var t;const n=(0,z.useRef)((null==e||null===(t=e.closest("table"))||void 0===t||null===(t=t.parentElement)||void 0===t||null===(t=t.closest("table"))||void 0===t?void 0:t.querySelector('[aria-multiline="true"][contenteditable="true"]'))||void 0),[i,s]=(0,z.useState)(!!n.current),o=(0,z.useRef)(Ta(n.current)),[a,r]=(0,z.useState)(""===o.current),[l,c]=(0,z.useState)(!a),[d,u]=(0,z.useState)(!1);return(0,z.useEffect)((()=>{if(i)return;const t=new MutationObserver((t=>{t.forEach((t=>{if(!n.current&&"childList"===t.type&&t.addedNodes.length>0){var i;const t=null==e||null===(i=e.closest("table"))||void 0===i||null===(i=i.parentElement)||void 0===i||null===(i=i.closest("table"))||void 0===i?void 0:i.querySelector('[aria-multiline="true"][contenteditable="true"]');if(t)return n.current=t,s(!0),o.current=Ta(n.current),c(""!==o.current),void r(""===o.current)}}))}));return t.observe(document.body,{childList:!0,subtree:!1}),()=>{t.disconnect()}}),[]),(0,z.useEffect)((()=>{if(!n.current)return;const e=new MutationObserver((()=>{o.current=Ta(n.current);const e=""===o.current;(a&&!e||l&&e||d&&!e)&&(c(!e),r(e),u(!1))}));return e.observe(n.current,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),()=>{e.disconnect()}}),[i,a,l,d]),{isPopWindow:(0,z.useMemo)((()=>Array.from(document.querySelectorAll('[role="dialog"][aria-labelledby]')).some((t=>t.contains(e)))),[]),showHelpWriteBtn:a,showRewrite:l,showFooterInput:d,mainBodyContentRef:o,mainTextRef:n,setShowHelpWriteBtn:r,setShowRewrite:c,setShowFooterInput:u}})(t),{bottom:H}=Br(t,n),q=(0,z.useMemo)((()=>({bottom:`${16+c}px`})),[c]),[V,$]=(0,z.useState)(!1),[K,W]=(0,z.useState)(!1),J=P&&""!==E.current&&!Na(l);((e,t,n,i,s,o,a)=>{var r;const l=e===va,c=(0,z.useRef)(null===(r=a.parentElement)||void 0===r?void 0:r.parentElement);(0,z.useLayoutEffect)((()=>{if(!l&&c.current){const e=`${c.current.offsetHeight}px`;c.current.parentElement&&(c.current.parentElement.style.height=e,c.current.parentElement.parentElement&&(c.current.parentElement.parentElement.style.height=e))}}),[l,t,n,i,s,o]),(0,z.useEffect)((()=>{if(!l&&c.current&&c.current.parentElement){const e=new MutationObserver((function(){if(!c.current)return;const e=`${c.current.offsetHeight}px`;c.current.parentElement&&(c.current.parentElement.style.height=e,c.current.parentElement.parentElement&&(c.current.parentElement.parentElement.style.height=e))}));return e.observe(c.current.parentElement,{childList:!1,subtree:!1,attributes:!0,attributeFilter:["style"]}),()=>{e.disconnect()}}}),[l])})(n,J,L,R,V,c,t),(0,z.useEffect)((()=>{var e;L?(null===(e=G.Ay.Tea)||void 0===e||e.event("show_button",{button_type:"help_me_write",current_page:"mail_page"}),Nr({button_name:Q._h.write})):R&&Nr({button_name:Q._h.rewrite})}),[]);const Z=(e,t,n)=>{const s={action:e};s.action===ba&&(s.reply_content=E.current);const o=i({text:t,scene:$n.sJ.mail,prompt:Gn.EU.mail,answerWithSuggest:!1,browser_mail:JSON.stringify(s),replyLang:(0,fe.wz)(null!=n?n:a)});return _(!1),e===xa&&y(t),o},ee=()=>{if(Mr({button_name:Q._h.write}),D(!1),U(!0),n===fa){if(0!==T.length&&T.every((e=>void 0!==e.msgId&&""!==e.msgId)))return;N(t,n,a)}},te=()=>{Mr({button_name:Q._h.rewrite}),F(!1),f(B.current),$(!0),A(Z(xa,B.current)),W(!0)},ne=()=>{f(""),""===B.current?D(!0):F(!0),U(!1),_(!1)};return{isPopWindow:M,showHelpWriteBtn:L,showRewrite:R,enableQuickReply:J,showFooterInput:P,showMessageBox:V,messageBottom:H,writingDone:p,writingResult:v,replyLang:a,inputContent:l,lastInputContent:u,inputHeight:c,isInputting:d,currInputMsgId:m,quickReplys:T,quickReplyStyle:q,onInputBlur:C,onInputFocus:k,onInputHeightChange:I,onChangeInputContent:S,handleCancelInput:ne,handleCloseMsgBox:()=>{ne(),x(""),$(!1),W(!1),Rr({message_id:m,scene:g,from_message_id:h,thread_length:v.length})},handleReturn:()=>{_(!1),f(u)},handleWriteOrUpdate:e=>{e===Q.Z5.mailCreate&&(U(!1),$(!0));const t=Z(xa,l);A(t),w(e),(e=>{(0,Y.z8)(Q.Ur.clickInputBar,{scene:e})})(e),x(t)},handleClickToolBar:(e,t,n,i,s)=>{const l=!!s,c=l?s.msgId||"":m;if(e===ka)((e,t,n)=>{if(!t)return;const i=t.querySelector(Ea);if(n)for(;t.firstChild&&t.firstChild!==i;)t.removeChild(t.firstChild);const s=(e=>{const t=e.split("\n");let n="";return t.forEach(((e,t)=>{""!==e.trim()?n+=`<div>${e}</div>`:n+="<br>"})),n+="<br>",n})(e),o=document.createElement("div");o.innerHTML=s,t.insertBefore(o,i)})(n,O.current,K||""===B.current),$(!1),F(!0),W(!1),f(""),x(""),U(!1),d={message_id:c,scene:l?Ma(s.type):g,from_message_id:l?"":h,thread_length:n.length},(0,Y.z8)(Q.Ur.insertMailThreadResult,(0,o.A)({},d));else{let c=t,d=e;switch(e){case Aa:d=l?ba:xa;break;case wa:case Sa:case Ca:c=n;break;case Ia:return void((e,t,n)=>{if(r(e),!n){const n=Z(xa,t,e);A(n)}const i=[...T];for(const s of i)s.msgId=Z(ba,s.text,e);j(i)})(null!=i?i:a,c,l)}const u=Z(d,c,i);l?j((e=>{const n=[...e],i=n.findIndex((e=>e.text===t));return n[i].msgId=u,n})):A(u),(e=>{(0,Y.z8)(Q.Ur.clickMailThreadResult,(0,o.A)({},e))})({thread_length:n.length,message_id:u,from_message_id:l?"":h,scene:l?Ma(s.type):g,button_name:e})}var d},handleClickEntry:()=>{e?L?ee():R&&te():(0,b.DT)({trackMeta:{previous_page:"gmail_page",login_entrance:"gmail_page"}})}}},Fr=e=>{const{showHelpWrite:t,onClick:n}=e,i=(0,$.B)();return(0,K.jsx)("div",{className:Ba,children:(0,K.jsx)(ce.$n,{theme:"solid",size:"default",icon:(0,K.jsx)(de.un,{}),onClick:n,"data-testid":t?"help-write-btn":"rewrite-btn",className:Oa,children:i(t?"flow_web_ext_email_helpme":"flow_web_ext_email_rewrite")})})},Ur=e=>{const{quickReplysData:t,replyLang:n,cssStyle:i,onClickToolbar:s}=e,a=(0,$.B)(),r=(0,st.P)((e=>e.messages)),l=(0,z.useRef)(null),c=(e,t)=>{const n=t.msgId||"",{isDone:i=!1,text:s=""}=r[n]||{},a=Ma(t.type);var l;e?(l={scene:a},(0,Y.z8)(Q.Ur.hoverQuickReplyButton,(0,o.A)({},l)),i&&Lr({message_id:n,from_message_id:"",scene:a,thread_length:s.length})):Rr({message_id:n,from_message_id:"",scene:a,thread_length:s.length})};return(0,K.jsxs)("div",{ref:l,className:Da,style:i,children:[(0,K.jsxs)("div",{className:Fa,children:[a("flow_web_ext_email_quickreply"),":"]}),t.map(((e,t)=>{const i=e.msgId||"",{isDone:o=!1,text:a=""}=r[i]||{};return(0,K.jsx)(ce.AM,{className:Ha,content:(0,K.jsx)(jr,{replyLang:n,id:i,isDone:o,handleClickBtn:(t,n)=>s(t,e.text,a,n,e)}),position:"topLeft",getPopupContainer:()=>l.current,onVisibleChange:t=>c(t,e),children:(0,K.jsx)(ce.vw,{className:Ua,children:e.text})},t)}))]})},Hr=({isLogin:e=!1,mailScene:t,mailToolContainer:n})=>{const{isPopWindow:i,showHelpWriteBtn:s,showRewrite:o,enableQuickReply:a,showFooterInput:r,showMessageBox:l,messageBottom:c,writingDone:d,writingResult:u,replyLang:h,inputContent:m,lastInputContent:g,isInputting:p,currInputMsgId:v,quickReplys:f,quickReplyStyle:_,onInputBlur:y,onInputFocus:x,onInputHeightChange:b,onChangeInputContent:A,handleCancelInput:w,handleCloseMsgBox:S,handleReturn:C,handleWriteOrUpdate:k,handleClickToolBar:I,handleClickEntry:E}=Dr(e,n,t),T=s||o;return(0,K.jsxs)("div",{className:re()(La,"cici-ext-always-light","semi-always-light",{[Ra]:!i}),children:[l&&(0,K.jsx)(Tr,{bottom:c,isDone:d||!1,content:m,lastSendContent:g,inputting:p,id:v,replyLang:h,onInputBlur:y,onInputFocus:x,onInputChange:A,handleClose:S,handleReturn:C,handleUpdate:()=>k(Q.Z5.mailUpdate),handleClickTool:(e,t)=>I(e,m,u,t)}),a&&(0,K.jsx)(Ur,{quickReplysData:f,replyLang:h,cssStyle:_,onClickToolbar:I}),r&&(0,K.jsx)(Ir,{content:m,onChangeContent:A,handleCancel:w,handleSubmit:()=>k(Q.Z5.mailCreate),onResize:b}),T&&(0,K.jsx)(Fr,{showHelpWrite:s,onClick:E})]})},zr=z.memo(Hr),qr=()=>{const[e,t]=(0,z.useState)(window.innerWidth),[n,i]=(0,z.useState)(28);return(0,z.useEffect)((()=>{const e=()=>{t(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,z.useEffect)((()=>{let t;t=e<1125?28:e>1300&&e<=1475?180:e>=1125&&e<=1300?(e-1124)/2+28:e>1475&&e<=1675?(e-1475)/4+180:230,i(t)}),[e]),{marginLeft:n}};var Vr=n(75962);const $r={"cici-ext-container":"cici-ext-container-yzw_fL",ciciExtContainer:"cici-ext-container-yzw_fL","inactivelink-hover-animation":"inactivelink-hover-animation-wFN4yJ",inactivelinkHoverAnimation:"inactivelink-hover-animation-wFN4yJ","notactivelink-hover-animation":"notactivelink-hover-animation-P26GaQ",notactivelinkHoverAnimation:"notactivelink-hover-animation-P26GaQ","light-click-animation":"light-click-animation-cDIscK",lightClickAnimation:"light-click-animation-cDIscK","click-animation":"click-animation-Dv_EtT",clickAnimation:"click-animation-Dv_EtT","semi-animation-rotate":"semi-animation-rotate-XsXC6r",semiAnimationRotate:"semi-animation-rotate-XsXC6r","inactive-btn-hover-animation":"inactive-btn-hover-animation-p6M2XE",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-p6M2XE","cici-ext-always-dark":"cici-ext-always-dark-yUc_nS",ciciExtAlwaysDark:"cici-ext-always-dark-yUc_nS","cici-ext-always-light":"cici-ext-always-light-W9IcgL",ciciExtAlwaysLight:"cici-ext-always-light-W9IcgL",ellipsis:"ellipsis-jZwXPH",searchTextResult:"searchTextResult-XBh4hJ",title:"title-zlKL9c",footer:"footer-Z3IUTP",searchMoreBtn:"searchMoreBtn-RHlNlZ",actionBtnContainer:"actionBtnContainer-WYRGZj",actionBtn:"actionBtn-XEBCCM",collectionBtn:"collectionBtn-NkBSVa","activelink-hover-animation":"activelink-hover-animation-o1pqTD",activelinkHoverAnimation:"activelink-hover-animation-o1pqTD"};function Kr({searchId:e,searchQuery:t,index:n,onReplaceSearch:i}){const s=(0,$.B)(),o=(0,st.P)((e=>e.messages)),{isDone:a,text:r="",body:l}=o[e]||{},{onCopyClick:c,onMouseEnter:d,onMouseLeave:u,checked:g}=ct((()=>{var t;Ze()(r),Uo({click_from:"deep_search_mode",search_id:e,message_id:null==l||null===(t=l.message)||void 0===t?void 0:t.message_id})})),v=g?de.w_:de.jw;return(0,z.useEffect)((()=>{a&&(0,p.ku)()&&(0,m.ae)(m.vP.search_result_card,m.p6.searchresult)}),[]),(0,K.jsxs)("div",{className:$r.searchTextResult,children:[0!==n&&(0,K.jsx)("div",{className:$r.title,children:t}),(0,K.jsx)(In,{id:e,query:t,type:"search",loadingStyle:"loadingBar",onRetry:()=>{i(t,n)}}),a&&(0,K.jsx)("div",{className:$r.footer,children:(0,K.jsxs)("div",{className:$r.actionBtnContainer,children:[(0,K.jsxs)("div",{className:$r.actionBtn,onMouseEnter:d,onMouseLeave:u,onClick:c,children:[(0,K.jsx)(v,{style:{fontSize:"20px"}}),(0,K.jsx)("div",{children:s("message_long_press_copy")})]}),(0,p.ku)()&&(0,K.jsxs)("div",{className:$r.actionBtn,onClick:()=>{var n;(0,O.X)({collectFrom:m.vP.search_result_card,collectionType:h.X.SearchResult,messageId:null==l||null===(n=l.message)||void 0===n?void 0:n.message_id,localMessageId:e,userInput:t})},children:[(0,K.jsx)(et.Wur,{className:$r.collectionBtn}),(0,K.jsx)("div",{children:s("flow_web_ext_action_bookmarks")})]})]})})]})}const Wr={container:"container-NLZ6ge",content:"content-xMnYqX",title:"title-gfqOLi",footer:"footer-kANaph",icon:"icon-j0I9WC",siteName:"siteName-gIk9DV"};function Gr({index:e,source:t,onClick:n}){return(0,K.jsx)("a",{className:Wr.container,href:t.url,target:"_blank",rel:"noreferrer noopener",onClick:()=>n(e),children:(0,K.jsxs)("div",{className:Wr.content,children:[(0,K.jsx)("div",{className:Wr.title,children:t.title}),(0,K.jsxs)("div",{className:Wr.footer,children:[t.logo_url?(0,K.jsx)("img",{className:Wr.icon,src:t.logo_url}):null,(0,K.jsx)("span",{className:Wr.siteName,children:`${t.sitename} \xb7 ${e}`})]})]})})}const Yr={searchSourceResult:"searchSourceResult-U65oyd",placeholder:"placeholder-SEg_go",loadingTitle:"loadingTitle-acF1Im",loadingParagraph:"loadingParagraph-hQR6xB",title:"title-KUjDzx",titleSource:"titleSource-_815Vn",sourceNum:"sourceNum-cUmfS1",content:"content-PQCuKv",pagination:"pagination-D124T5"};function Qr({searchId:e}){var t;const n=(0,$.B)(),i=(0,st.P)((e=>e.messages)),[s,o]=(0,z.useState)(1),{isDone:a,isError:r,isAborted:l,text:c="",cardResult:d}=i[e]||{},u=!(c||r||a||l),h=(null==d||null===(t=d.text_card)||void 0===t?void 0:t.card_list)||[],m=h.length,g=10*(s-1),p=g+10,v=h.slice(g,p),f=v.map((({title:e})=>e)).join("");(0,z.useEffect)((()=>{for(let n=0;n<v.length;n++){var t;const i=v[n];Bo({search_id:e,title:i.title,show_content_message_id:i.doc_id,show_content_wordlength:String(null===(t=i.sitename)||void 0===t?void 0:t.length),sources_count:String(m),rnk:n+1,source_name:i.sitename,source_publishtime:i.publish_time_second,location_pagenum:s})}}),[f]);const _=t=>{var n;const i=v[t-1];Oo({search_id:e,title:i.title,show_content_message_id:i.doc_id,show_content_wordlength:String(null===(n=i.sitename)||void 0===n?void 0:n.length),sources_count:String(m),rnk:t,source_name:i.sitename,source_publishtime:i.publish_time_second,location_pagenum:s})};return(0,K.jsx)("div",{className:Yr.searchSourceResult,children:!u&&v.length>0&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)("div",{className:Yr.title,children:[(0,K.jsxs)("div",{className:Yr.titleSource,children:[(0,K.jsx)(de.jZ,{}),(0,K.jsx)("div",{children:n("flow_web_ext_search_sources")})]}),(0,K.jsx)("div",{className:Yr.sourceNum,children:n("flow_web_ext_search_deepinsearch_close",{number:m})})]}),(0,K.jsx)("div",{className:Yr.content,children:v.map(((e,t)=>(0,K.jsx)(Gr,{source:e,index:t+1,onClick:_},t)))}),(0,K.jsx)(ce.dK,{hideOnSinglePage:!0,className:Yr.pagination,total:m,pageSize:10,currentPage:s,onPageChange:e=>{o(e)}})]})})}const Jr={searchResult:"searchResult-Iav9sW"};function Xr({searchId:e,searchQuery:t,index:n,onReplaceSearch:i}){return(0,K.jsxs)("div",{className:Jr.searchResult,children:[(0,K.jsx)(Kr,{searchId:e,searchQuery:t,index:n,onReplaceSearch:i}),(0,K.jsx)(Qr,{searchId:e})]})}const Zr={entryContainer:"entryContainer-qt6YHi",deepSearchAssistantContainer:"deepSearchAssistantContainer-fdGDgh",header:"header-DYJWq6",brandName:"brandName-Pw7R9V",minimizeBar:"minimizeBar-UMU3eL",footer:"footer-Cs4FRG",suggest:"suggest-adzrqs",askMore:"askMore-AFIX_A"};function el({hasEntry:e}){var t;const n=(0,$.B)(),i=(0,z.useRef)(null),s=(0,st.P)((e=>e.sendMessage)),o=(0,st.P)((e=>e.messages)),{searchList:a,addSearch:r,resetSearch:l,replaceSearch:c,isDeepSearchMode:d,setDeepSearchMode:u}=zo((e=>({searchList:e.searchList,addSearch:e.addSearch,resetSearch:e.resetSearch,replaceSearch:e.replaceSearch,isDeepSearchMode:e.isDeepSearchMode,setDeepSearchMode:e.setDeepSearchMode}))),[h,m]=(0,z.useState)(""),{searchId:g}=a[a.length-1]||{},{id:p,isDone:v,suggests:f=[]}=o[g]||{},_=null===(t=(0,z.useContext)(Vo.mn))||void 0===t?void 0:t.engine;(0,z.useEffect)((()=>{const e=Ko(_);e&&m(e)}),[]),(0,z.useEffect)((()=>{d?Po({search_id:g,message_id:p,search_from:"search_bar",show_from:"search_result_card"}):Do({show_from:"below_search_bar"})}),[d]),(0,z.useEffect)((()=>{v&&ee({prompt_cnt:f.length,from_search_id:g,show_from:"deep_search_mode",search_engine_name:"google"})}),[v]),(0,z.useEffect)((()=>{if(v)for(let e=0;e<f.length;e++)te({prompt_position:`${e+1}`,message_id:p,from_search_id:g,show_from:"deep_search_mode",search_engine_name:"google"})}),[v,f]);const y=e=>{const t=(0,fe.wz)((0,X.TK)("uiLanguage"));return s({text:e,prompt:Gn.EU.input_skill,answerWithSuggest:!0,current_page:"search_engine",scene:"search_engine",sec_scene:"deep_search_mode",input_skill:JSON.stringify({skill_id:"8",skill_type:8}),replyLang:t})},x=e=>{const t=y(e);return r({searchId:t,searchQuery:e}),setTimeout((()=>{var e;return null===(e=i.current)||void 0===e||null===(e=e.lastElementChild)||void 0===e?void 0:e.scrollIntoView({behavior:"smooth",block:"start",inline:"start"})}),0),t},b=(e,t)=>{const n=y(e);c({searchId:n,searchQuery:e},t)};return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)("div",{className:Zr.entryContainer,style:{display:!d&&e?"flex":"none"},children:[(0,K.jsx)(Ve.A,{size:"large",disable:!0,bransNameVisible:!1,children:n("flow_web_ext_search_summarytitle2",{brandName:(0,he.L2)()})}),(0,K.jsx)(uo.c,{type:"ai-primary",icon:(0,K.jsx)(et.zSs,{}),size:"small",onClick:()=>{if(!a.length){const e=y(h);l({searchId:e,searchQuery:h})}u(!0),Fo({search_id:g,click_from:"below_search_bar"})},children:n("flow_web_ext_search_deepinsearch")})]}),(0,K.jsxs)("div",{className:Zr.deepSearchAssistantContainer,style:{borderWidth:v?"1px":"0",display:d?"block":"none"},children:[(0,K.jsxs)("div",{className:Zr.header,children:[(0,K.jsx)(Ve.A,{size:"medium",disable:!0,bransNameVisible:!1,children:(0,K.jsx)("div",{className:Zr.brandName,children:n("flow_web_ext_search_deepinsearch")})}),(0,K.jsxs)("div",{className:Zr.minimizeBar,onClick:()=>{u(!1),(({search_id:e})=>{(0,Y.z8)(Q.Ur.collapseDeepSearchCard,{current_page:"search_engine",search_engine_name:"google",search_id:e})})({search_id:g})},children:[(0,K.jsx)(de.jR,{}),(0,K.jsx)("div",{children:n("flow_web_ext_search_deepinsearch_collapse")})]})]}),(0,K.jsx)("div",{className:Zr.content,ref:i,children:a.map((({searchId:e,searchQuery:t},n)=>(0,K.jsx)(Xr,{searchId:e,searchQuery:t,index:n,onReplaceSearch:b},e)))}),v&&(0,K.jsxs)("div",{className:Zr.footer,children:[(0,K.jsx)(Io,{fullMode:!0,className:Zr.suggest,suggestMessageListWithStatus:{isRegen:!1,loading:!1,suggests:f.filter((e=>e)),failed:!1},onClick:(e,t)=>{const n=x(e);Po({search_id:n,search_from:"sp_click",from_search_id:g}),ne({click_position:`${t+1}`,search_id:n,click_from:"deep_search_mode",search_engine_name:"google"})}}),(0,K.jsx)(Vr.Z,{className:Zr.askMore,placeholder:n("flow_web_ext_search_ask_more",{brand:(0,he.L2)()}),onSubmit:e=>{const t=x(e);Po({search_id:t,search_from:"enter_click",from_search_id:g}),(({from_search_id:e,search_id:t,scene:n})=>{(0,Y.z8)(Q.Ur.clickInputBar,{from_search_id:e,search_id:t,scene:n})})({search_id:t,from_search_id:g,scene:"deep_search_mode"})}})]})]})]})}const tl=(0,z.createContext)(null);var nl=n(33186);const il=({hasEntry:e})=>{var t;const n=(0,bi.Uk)();(0,Ai.A)(null===(t=document.getElementById(v.hs))||void 0===t?void 0:t.shadowRoot);const i=(0,se.l)((e=>e.isShowSearch)),[s]=(0,Si.Y)("searchDisabledAll"),[o]=(0,Si.Y)("searchDisabledHosts"),a=o.includes(window.location.host),r=!s&&!a&&i,{marginLeft:l}=qr();return(0,K.jsx)(V.Yd.Provider,{value:xi.vF,children:(0,K.jsx)($.C,{t:n,children:(0,K.jsx)("div",{id:"cici-inline-container-deep",className:"cici-ext-container",style:l?{marginLeft:`${l}px`}:{},children:r&&(0,K.jsx)(el,{hasEntry:e})})})})},sl=({hasDeepSearchEntry:e})=>{var t,n,i;const s=(0,bi.Uk)();(0,Ai.A)(null===(t=document.querySelector(`[id*=${v.U6}]`))||void 0===t?void 0:t.shadowRoot);const o=(0,se.l)((e=>e.isShowSearch)),[a]=(0,Si.Y)("searchDisabledAll"),[r]=(0,Si.Y)("searchDisabledHosts"),l=r.includes(window.location.host),[c,d]=(0,z.useState)((new Date).getTime()),u=!a&&!l&&o,h=null===(n=(0,z.useContext)(Vo.mn))||void 0===n?void 0:n.engine,m=null===(i=(0,z.useContext)(tl))||void 0===i?void 0:i.recorder;return(0,z.useEffect)((()=>{u?(d((new Date).getTime()),Z({search_engine_name:null==h?void 0:h.name}),null==m||m.end("cici_search_engine_ux_rendered")):(({duration:e})=>{(0,Y.z8)(Q.Ur.closeSearchAssistant,{duration:e})})({duration:(new Date).getTime()-c})}),[u]),(0,K.jsx)(V.Yd.Provider,{value:xi.vF,children:(0,K.jsx)($.C,{t:s,children:(0,K.jsx)("div",{id:"cici-inline-container",className:"cici-ext-container",children:u&&(0,K.jsx)(Wo,{hasDeepSearchEntry:e})})})})},ol=()=>{var e,t;const n=(0,bi.Uk)();(0,Ai.A)(null===(e=document.querySelector(`[id*=${v.$9}]`))||void 0===e?void 0:e.shadowRoot);const i=null===(t=(0,z.useContext)(tl))||void 0===t?void 0:t.recorder,s=(0,se.l)((e=>e.isShowVideo));return(0,z.useEffect)((()=>{s&&(null==i||i.end("cici_video_summary_ux_rendered"))}),[s]),(0,K.jsx)(V.Yd.Provider,{value:xi.vF,children:(0,K.jsx)($.C,{t:n,children:(0,K.jsx)("div",{id:"cici-inline-container",className:"cici-ext-container",children:s&&(0,K.jsx)(co,{})})})})},al=function(){var e=(0,a.A)((function*(e){const t=yield(e=>new Promise((t=>{const n=setInterval((()=>{let i=document.querySelector(e.sidebarContainerQuery);!i&&e.customAppend&&(i=e.customAppend()),i&&(window.clearInterval(n),t(i))}),500)})))(e);if(!t)return;const n=(0,G.Mz)(G.FM.deepSearchEntryMode,"");let i=!1,s=!1;"searchCard"===n?i=!0:"singleEntry"===n&&(s=!0);const o="2"===new URL(location.href).searchParams.get("udm"),a=(0,X.TK)("authInfo").isAuthenticated&&"google"===e.name&&!o;((e,t=!1,n=!1)=>{var i;const s=(0,Vo.Ay)(location.href);if(!s||null!=s&&null!==(i=s.disabled)&&void 0!==i&&i.call(s))return;const o=d.m.getInstance().getHostId(),a=`${v.U6}${o}`;if(e.querySelector(`#${a}`))return;const r=document.createElement("div");r.id=a,r.dataset.searchHostId=d.m.getInstance().getHostId(),r.style.order="-99999",e.insertBefore(r,e.firstChild),(0,g.Rm)("[Daniel] mount search-assistant at:",e,"before",r.firstChild);const l=Yn.Qz.create("cici_search_engine_ux_perf",!0),c=r.attachShadow({mode:"open"}),u=(0,q.createRoot)(c);(0,is.NR)(c,v.QN).then((()=>{l.mark("load_search_engine_css"),u.render((0,K.jsx)(tl.Provider,{value:{recorder:l},children:s&&(0,K.jsx)(Vo.mn.Provider,{value:{engine:s},children:(0,K.jsx)(W,{element:r,children:(0,K.jsx)(sl,{hasDeepSearchEntry:t&&n})})})}))})),(0,d.A)((()=>{var e;null===(e=document.querySelector(`#${a}`))||void 0===e||e.remove(),u.unmount()}))})(t,a,i),(e=>{const t=(0,ue.Ay)(location.href),n=(0,ue.jB)(null==t?void 0:t.name);if(!t||!n)return;const i=d.m.getInstance().getHostId(),s=`${v.$9}-${i}`;if(e.querySelector(`[id=${s}]`))return;const o=document.createElement("div");o.id=s,o.dataset.videoSearchHostId=d.m.getInstance().getHostId(),o.style.order="-99999",e.insertBefore(o,e.firstChild),(0,g.Rm)("[Rowan] mount video-summary-assistant at:",e,"before",o.firstChild);const a=Yn.Qz.create("cici_video_summary_ux_perf",!0),r=o.attachShadow({mode:"open"}),l=(0,q.createRoot)(r);(0,is.NR)(r,v.QN).then((()=>{a.mark("load_video_summary_page_css"),l.render((0,K.jsx)(tl.Provider,{value:{recorder:a},children:t&&(0,K.jsx)(ue.un.Provider,{value:{platform:t},children:(0,K.jsx)(W,{element:o,children:(0,K.jsx)(ol,{})})})}))})),(0,d.A)((()=>{var e;l.unmount(),null===(e=document.querySelector(`#${s}`))||void 0===e||e.remove()}))})(t),a&&(e=>{const t={name:"google",inputQuery:["input[name='q']","textarea[name='q']"],sidebarContainerQuery:"#rcnt",searchParam:"q"};if(!t)return;const n=document.querySelector(t.sidebarContainerQuery);if(!n)return;if(n.querySelector(`#${v.hs}`))return;const i=document.createElement("div");i.id=v.hs,i.dataset.searchHostId=d.m.getInstance().getHostId(),i.style.order="-99999",i.style.width="100%",n.insertBefore(i,n.firstChild),(0,g.Rm)("[Daniel] mount deep-search-assistant at:",n,"before",i.firstChild);const s=i.attachShadow({mode:"open"}),o=(0,q.createRoot)(s);(0,is.NR)(s,v.QN).then((()=>{o.render((0,K.jsx)(Vo.mn.Provider,{value:{engine:t},children:(0,K.jsx)(il,{hasEntry:e})}))})),(0,d.A)((()=>{var e;null===(e=document.querySelector(`#${v.hs}`))||void 0===e||e.remove(),o.unmount()}))})(s)}));return function(t){return e.apply(this,arguments)}}(),rl=({id:e,id_suffix:t,mailScene:n,mailToolContainer:i})=>{var s;const o=(0,bi.Uk)();(0,Ai.A)(null===(s=document.getElementById(e))||void 0===s?void 0:s.shadowRoot);const[a]=(0,Si.Y)("authInfo");return(0,K.jsx)(V.Yd.Provider,{value:xi.vF,children:(0,K.jsx)($.C,{t:o,children:(0,K.jsx)("div",{id:`cici-inline-container-${t}`,className:"cici-ext-container",children:(0,K.jsx)(zr,{isLogin:(null==a?void 0:a.isAuthenticated)||!1,mailScene:n,mailToolContainer:i})})})})},ll=(e,t)=>{const n=d.m.getInstance().getHostId();if(void 0===n)return;const i=`${v.AJ}-${n}`;if(t.querySelector(`[id=${i}]`))return;const s=document.createElement("div");s.id=i,s.dataset.mailHostId=n,s.style.order="-99999",t.insertBefore(s,t.firstChild);let o=va;const a=Array.from(document.querySelectorAll('[aria-label^="Re"]')).some((e=>e.contains(t))),r=Array.from(document.querySelectorAll('[aria-label^="Fwd"]')).some((e=>e.contains(t)));a?o=fa:r&&(o=_a);const l="cici_mail_ux_perf";let c;c=Yn.Qz.get(l)?Yn.Qz.get(l):Yn.Qz.create(l);const u=s.attachShadow({mode:"open"}),h=(0,q.createRoot)(u);return(0,is.NR)(u,v.QN).then((()=>{c.mark("load_mail_page_css"),h.render((0,K.jsx)(tl.Provider,{value:{recorder:c},children:e&&(0,K.jsx)(nl.Vk.Provider,{value:{platform:e},children:(0,K.jsx)(rl,{id:i,id_suffix:n,mailScene:o,mailToolContainer:t})})}))})),()=>{h.unmount(),s.remove()}},cl=e=>{const t=(0,nl.N)(e.name),n=[];for(const i of t)n.push(ll(e,i[0]));return()=>{n.forEach((e=>{e&&"function"==typeof e&&e()}))}},dl=()=>{var e;const t=(0,bi.Uk)();return(0,Ai.A)(null===(e=document.querySelector(`[id*=${v.OD}]`))||void 0===e?void 0:e.shadowRoot),(0,K.jsx)(V.Yd.Provider,{value:xi.vF,children:(0,K.jsx)($.C,{t,children:(0,K.jsx)("div",{id:`cici-inline-container-${v.OD}`,className:"cici-ext-container",children:(0,K.jsx)(ga,{})})})})},ul=()=>{const e=(0,Jo.Ay)(location.href);if(!e)return;const t=(e=>{const t=d.m.getInstance().getHostId();if(void 0===t)return;const n=`${v.OD}-${t}`;if(document.querySelector(`[id=${n}]`))return;const i=document.createElement("div");if(i.id=n,i.dataset.arxivHostId=t,i.style.order="999",i.style.display="inline-block",e.prevNodeQuery){const t=document.querySelector(e.prevNodeQuery),n=null==t?void 0:t.parentElement;n&&(n.style.display="inline-flex",n.style.alignItems="center",n.appendChild(i))}else document.body.appendChild(i);const s=i.attachShadow({mode:"open"}),o=(0,q.createRoot)(s);return(0,is.NR)(s,v.QN).then((()=>{o.render((0,K.jsx)(K.Fragment,{children:e&&(0,K.jsx)(Jo.Er.Provider,{value:{platform:e},children:(0,K.jsx)(dl,{})})}))})),()=>{o.unmount(),i.remove()}})(e);return()=>{null==t||t()}},hl={name:"open-cici-sidebar",handle:e=>{se.l.getState().setIsShowSidebar(!0,null==e?void 0:e.enterSidebarMode)}};var ml=n(69366);function gl(){var e;if(null===(e=window.location.host)||void 0===e||!e.endsWith(it.o8))return()=>{};const t=e=>{var t;"web"===(null===(t=e.data.body)||void 0===t?void 0:t.originContext)&&function(e){switch((0,g.Rm)("[zoei] login cs handleWebMessage",e),e.data.name){case"update-auth-info":(0,ml.c)({name:"update-auth-info",body:(0,o.A)((0,o.A)({},e.data.body),{},{reason:"login cs: web notify auth info updated"})});break;case"start-using":hl.handle({},{});break;case"start-try-summarize":(0,ml.c)({name:"start-try-summarize",body:(0,o.A)({},e.data.body)});break;case"call-background-method":if("is-on-toolbar"===e.data.body.method){const{promiseId:t}=e.data;(0,ml.c)("is-on-toolbar").then((e=>{const{isOnToolbar:n}=e.data;window.postMessage({name:"call-background-method-reply",isOnToolbar:n,promiseId:t})}))}}}(e)};return window.addEventListener("message",t),(0,a.A)((function*(){try{var e;const t=yield(0,ml.c)("get-window-info");if(!t.success||!t.data)throw t.error;const n=null===(e=t.data.authInfo)||void 0===e?void 0:e.isAuthenticated;n!==("true"===localStorage.getItem("flow_web_has_login"))&&(0,ml.c)({name:"update-auth-info",body:{reason:"login cs: detect auth info not same"}}).catch((e=>{xi.vF.persist.info({eventName:"[LOGIN] - UPDATE_AUTH_INFO",meta:(0,o.A)({},e)})}))}catch(t){xi.vF.persist.info({eventName:"[LOGIN] - INIT",meta:(0,o.A)({},t)})}}))(),()=>{window.removeEventListener("message",t)}}const pl="ciciai-with-right-side-chat-box",vl="ciciai-with-left-side-chat-box";var fl=n(10592),_l=n(94823),yl=n(73257);var xl=n(20318),bl=n(86836);const Al={"cici-ext-container":"cici-ext-container-R6tlmp",ciciExtContainer:"cici-ext-container-R6tlmp","inactivelink-hover-animation":"inactivelink-hover-animation-IVB8K3",inactivelinkHoverAnimation:"inactivelink-hover-animation-IVB8K3","notactivelink-hover-animation":"notactivelink-hover-animation-JRcS0J",notactivelinkHoverAnimation:"notactivelink-hover-animation-JRcS0J","light-click-animation":"light-click-animation-cHlJpM",lightClickAnimation:"light-click-animation-cHlJpM","click-animation":"click-animation-zSRLso",clickAnimation:"click-animation-zSRLso","semi-animation-rotate":"semi-animation-rotate-Pb1WMI",semiAnimationRotate:"semi-animation-rotate-Pb1WMI","inactive-btn-hover-animation":"inactive-btn-hover-animation-ChQRaf",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-ChQRaf","cici-ext-always-dark":"cici-ext-always-dark-e0NH3t",ciciExtAlwaysDark:"cici-ext-always-dark-e0NH3t","cici-ext-always-light":"cici-ext-always-light-QaRgiF",ciciExtAlwaysLight:"cici-ext-always-light-QaRgiF",ellipsis:"ellipsis-yU8vxe",container:"container-EHi_gj",header:"header-_BGIsL",left:"left-KcnQXz",draggable:"draggable-kLp2PR","close-btn":"close-btn-hADoYn",closeBtn:"close-btn-hADoYn",main:"main-mG2N4b",actions:"actions-yiy00z","action-btn":"action-btn-Q8mVce",actionBtn:"action-btn-Q8mVce",selected:"selected-KHLsMy","more-btn":"more-btn-mtf1AI",moreBtn:"more-btn-mtf1AI",input:"input-UEYnVw",text:"text-QEKPbd",output:"output-vt2imy","header-container":"header-container-jfozPy",headerContainer:"header-container-jfozPy",pad:"pad-TTK4CO",caption:"caption-RN84wj",translateServicePopover:"translateServicePopover-mNkMpW","stream-message-container":"stream-message-container-NDGCCQ",streamMessageContainer:"stream-message-container-NDGCCQ","llm-context-tip":"llm-context-tip-tEW0B1",llmContextTip:"llm-context-tip-tEW0B1",result:"result-Aj5YF_",operations:"operations-DAZHyl","continue-in-chat":"continue-in-chat-YDDLlF",continueInChat:"continue-in-chat-YDDLlF",right:"right-DhgCWf","operation-btn":"operation-btn-LsYdQO",operationBtn:"operation-btn-LsYdQO",prev:"prev-ACSjL9",next:"next-gAQstT",actionButton:"actionButton-h3aMjj",active:"active-VgYVkP",continueBtn:"continueBtn-W65oJX","operations-next":"operations-next-DshKuZ",operationsNext:"operations-next-DshKuZ","learn-more":"learn-more-jr1L_0",learnMore:"learn-more-jr1L_0",btn:"btn-A1sytI",dropdown:"dropdown-kJF1Mr","drop-item":"drop-item-iFBkm6",dropItem:"drop-item-iFBkm6","login-content":"login-content-wboNao",loginContent:"login-content-wboNao","login-btn":"login-btn-SRkx5R",loginBtn:"login-btn-SRkx5R","panel-wrapper":"panel-wrapper-EhSbKE",panelWrapper:"panel-wrapper-EhSbKE","icon-arrow-right":"icon-arrow-right-ojGboP",iconArrowRight:"icon-arrow-right-ojGboP","language-selector":"language-selector-gcO6os",languageSelector:"language-selector-gcO6os","language-options":"language-options-sGbzlT",languageOptions:"language-options-sGbzlT","language-wrapper":"language-wrapper-yyE_pK",languageWrapper:"language-wrapper-yyE_pK","writing-operations":"writing-operations-v1qhOA",writingOperations:"writing-operations-v1qhOA","icon-btn":"icon-btn-Vw1C1K",iconBtn:"icon-btn-Vw1C1K","disabled-caption":"disabled-caption-uAQqOr",disabledCaption:"disabled-caption-uAQqOr","activelink-hover-animation":"activelink-hover-animation-MRzecf",activelinkHoverAnimation:"activelink-hover-animation-MRzecf"},wl=(0,z.forwardRef)(((e,t)=>{var n;const i=null===(n=(0,ot.A)())||void 0===n?void 0:n.getPopupContainer,{className:s,tooltip:a,icon:r,children:l,tooltipOptions:c={},iconPosition:d,onClick:u}=e,h=(0,K.jsx)(ce.$n,{type:"secondary",theme:"borderless",ref:t,icon:r,onClick:u,className:re()(Al.actionButton,s),iconPosition:d,children:l});return a?(0,K.jsx)(ce.m_,(0,o.A)((0,o.A)({content:a,getPopupContainer:i},c),{},{children:h})):h}));wl.displayName="TooltipButton";const Sl=new jn.A;var Cl=n(13907);const kl=sn().bind(Al),Il=(0,r.jco)(),El=e=>{(()=>{const[e]=(0,Si.Y)("authInfo");null==e||e.isAuthenticated})();const{regenerateDisable:t,onMainButtonClick:n,onCopy:i,onRegenerate:s}=e,o=(0,$.B)(),{currentAction:a}=(0,fl.t_)(),r=(0,z.useCallback)((()=>{const e=a===Gn.EU.translate;(0,O.X)({collectionType:e?h.X.TranslateResult:h.X.ExplainResult,collectFrom:e?m.vP.highlight_result_card_translate:m.vP.highlight_result_card_explain})}),[a]);return(0,z.useEffect)((()=>{if((a===Gn.EU.explain||a===Gn.EU.translate)&&!Il&&(0,p.ku)()){const e=a===Gn.EU.translate;(0,m.ae)(e?m.vP.highlight_result_card_translate:m.vP.highlight_result_card_explain,e?m.p6.TranslateResult:m.p6.ExplainResult)}}),[Il,a]),(0,K.jsxs)("div",{className:kl("operations-next"),children:[(0,K.jsx)("div",{className:kl("learn-more"),children:(0,K.jsx)(ce.$x,{spacing:4,children:(0,K.jsx)(uo.c,{type:"tertiary",icon:a===Gn.EU.explain?(0,K.jsx)(et.zSs,{}):(0,K.jsx)(et.EGn,{}),size:"small",onClick:n,children:o(a===Gn.EU.explain?"flow_web_ext_action_popup_search":"flow_web_ext_action_popup_continue")})})}),(0,K.jsxs)("div",{className:kl("actions"),children:[!1,(0,p.ku)()&&(0,K.jsx)(wl,{tooltip:o("flow_web_ext_action_bookmarks"),icon:(0,K.jsx)(et.Wur,{}),onClick:r}),(0,K.jsxs)(ce.$x,{spacing:8,children:[(0,K.jsx)(wl,{tooltip:o("message_long_press_copy"),icon:(0,K.jsx)(de.jw,{}),onClick:i}),(0,K.jsx)(wl,{tooltip:o(!0===t?"maximum_regenerate_reached":"regenerate_button_hover_text"),icon:(0,K.jsx)(de.eD,{}),onClick:()=>{!0!==t&&s()}})]})]})]})},Tl="suggest-message-container-XdB13M",jl="suggest-message-OfZEb5",Nl=({suggestMessageListWithStatus:e,onClick:t,className:n})=>{const{failed:i,suggests:s=[]}=e||{};return i||0===s.length?null:(0,K.jsx)("div",{className:Tl,children:s.map(((e,i)=>(0,K.jsxs)("div",{className:re()(jl,n),onClick:()=>t(e,i),children:[(0,K.jsx)("span",{style:{marginRight:8},children:e}),(0,K.jsx)(et.B94,{})]},i)))})};var Ml=n(46350),Ll=n(50779),Rl=n(97946);const Pl=function(){var e=(0,a.A)((function*(e){var t,n;io.on.setState({floatingCardVisible:!1,summaryActionVisible:!1}),se.l.getState().setIsShowSidebar(!0,Q.cz.selectAssistantResult);const i={text:e,scene:$n.sJ.suggested_prompts,extraExt:{browser_language:(0,fe.wz)((0,X.TK)("uiLanguage"))},ctx:{botId:null===(t=(0,X.n5)().mainConversation)||void 0===t?void 0:t.bot_id,conversationId:null===(n=(0,X.n5)().mainConversation)||void 0===n?void 0:n.conversation_id}};yield(0,oo.Z)(),se.l.getState().isSidePanelMode&&!Rl._.isInSidePanel?(0,ia.cs)({name:"send-message-to-chat",body:{msg:i,chatType:ho.He.Conversation}}):(0,Ll.C)(i,{chatType:ho.He.Conversation})}));return function(t){return e.apply(this,arguments)}}(),Bl=e=>{if(e===Gn.EU.translate){var t;let e;const{inputTextLang:n}=fl.t_.getState(),i=(0,X.TK)("transPreferConfig");return e=n?null===(t=i.langMap)||void 0===t?void 0:t[n]:void 0,e||(0,X.TK)("translateLanguage")}};var Ol=n(74375);const Dl=()=>{var e,t;const{actionMessages:n,currentAction:i,messageCursor:s,setBoxVisible:r,contextText:l,search:c,regenerate:d,retry:u,inputText:h}=(0,fl.t_)(),m=(0,z.useRef)(h);m.current=h||m.current;const g=(0,z.useRef)(),p=(0,st.P)((e=>e.messages)),v=null!==(e=n[i])&&void 0!==e?e:[],f=null!==(t=v[s])&&void 0!==t?t:"",{text:_="",body:y}=p[f]||{},[x]=(0,Si.Y)("selectTranslateService"),A=()=>{var e;return!(null===(e=(0,X.TK)("authInfo"))||void 0===e||!e.isAuthenticated)||((0,b.DT)({trackMeta:{login_entrance:"highlight_result"}}),!1)},w=function(){var e=(0,a.A)((function*(){var e,t,n;const{mainConversation:i}=(0,X.n5)();let s=[null==y||null===(e=y.message)||void 0===e?void 0:e.reply_id].concat(v.map((e=>p[e])).map((e=>{var t;return null===(t=e.body)||void 0===t||null===(t=t.message)||void 0===t?void 0:t.message_id}))).filter(Boolean),o=null!==(t=null==y||null===(n=y.message)||void 0===n?void 0:n.message_id)&&void 0!==t?t:"0";var a,r,l,c;g.current&&(s=[null===(a=g.current)||void 0===a||null===(a=a.body)||void 0===a||null===(a=a.message)||void 0===a?void 0:a.reply_id,null===(r=g.current)||void 0===r||null===(r=r.body)||void 0===r||null===(r=r.message)||void 0===r?void 0:r.message_id].filter(Boolean),o=null!==(l=null===(c=g.current)||void 0===c||null===(c=c.body)||void 0===c||null===(c=c.message)||void 0===c?void 0:c.message_id)&&void 0!==l?l:"0");const d={conversationId:null==i?void 0:i.conversation_id,messageIds:s,switchMessageId:o};yield(0,so.ci)(d)}));return function(){return e.apply(this,arguments)}}(),S=function(){var e=(0,a.A)((function*(){var e,t;A()&&((0,Ml.oR)({message_id:null!==(e=null==y||null===(t=y.message)||void 0===t?void 0:t.message_id)&&void 0!==e?e:"0",skill_name:i}),r(!1),io.on.setState({floatingCardVisible:!1,summaryActionVisible:!1}),yield w(),se.l.getState().setIsShowSidebar(!0,Q.cz.selectAssistantResult))}));return function(){return e.apply(this,arguments)}}(),C=function(){var e=(0,a.A)((function*(e,t){var n;(0,Ml.Rr)({message_id:null==y||null===(n=y.message)||void 0===n?void 0:n.message_id,click_position:`${t+1}`}),A()&&(r(!1),yield w(),yield Pl(e))}));return function(t,n){return e.apply(this,arguments)}}();return(0,z.useEffect)((()=>{g.current=void 0}),[i]),{syncToChatMessage:g,doSearch:e=>{const t=(null==e?void 0:e.language)||Bl(i);c((0,o.A)({enter_chat_method:"highlight_search_result_tool",current_page:"web_otherpage",scene:$n.sJ.highlight_search_result_tool,sec_scene:$n._o.highlight_search_result_ask,contextText:l,translateService:x,language:t,answerWithSuggest:i===Gn.EU.explain},e))},handleAISearch:()=>{var e,t;A()&&((0,Ml.Dp)({message_id:null!==(e=null==y||null===(t=y.message)||void 0===t?void 0:t.message_id)&&void 0!==e?e:"0"}),(0,Ol.RX)(m.current),r(!1))},handleContinueInChat:S,handleCopy:()=>{var e;i===Gn.EU.translate?Ze()((0,Cl.YA)(_)):Ze()(_),(0,Ml.iN)({message_id:null==y||null===(e=y.message)||void 0===e?void 0:e.message_id,skill_name:i})},handleRegenerate:()=>{var e,t;d({replyId:null==y||null===(e=y.message)||void 0===e?void 0:e.reply_id,enter_chat_method:"highlight_search_result_tool",current_page:"web_otherpage",scene:"highlight_search_result_tool",answerWithSuggest:i===Gn.EU.explain}),(0,Ml.VM)({message_id:null==y||null===(t=y.message)||void 0===t?void 0:t.message_id,skill_name:i})},handleRetry:()=>{var e,t;u({replyId:null==y||null===(e=y.message)||void 0===e?void 0:e.message_id,enter_chat_method:"highlight_search_result_tool",current_page:"web_otherpage",scene:"highlight_search_result_tool",answerWithSuggest:i===Gn.EU.explain}),(0,Ml.t7)({message_id:null==y||null===(t=y.message)||void 0===t?void 0:t.message_id,skill_name:i})},handleClickFollowUpQuestion:C}},Fl=e=>{const{render:t}=e,{renderHeader:n,renderStreamMessage:i}=t;return(0,K.jsxs)(K.Fragment,{children:[n(),i()]})};var Ul=n(39853);class Hl{constructor(e){if((0,f.A)(this,"selectionEl",null),(0,f.A)(this,"containerEl",null),(0,f.A)(this,"range",void 0),(0,f.A)(this,"_canInsert",!1),this._canInsert=!1,e&&e.rangeCount>0){const t=e.getRangeAt(0);this.range=t.cloneRange();const n=t.startContainer.childNodes[t.startOffset]||t.startContainer;if(this.selectionEl=(0,ft.A)(n,"tagName")?n:n.parentElement,!this.selectionEl)return;const i=(0,is.QN)(this.selectionEl)?this.selectionEl:(0,is.mn)(this.selectionEl);i&&(0,is.ow)(i)&&(this.containerEl=i,this._canInsert=!0)}}insert(e,t=Ro.cD.replace_selection,n=""){if(!this.containerEl)return;const i=this.containerEl,s=document||"#document"===i.getRootNode().nodeName&&i.getRootNode();if((0,is.Ku)(i)){const n=i.selectionEnd;if(t===Ro.cD.replace_selection)i.setRangeText(e);else if(null!==n){const t=i.value[n-1]||"";t&&!/[\n\r\t]/gi.test(t)&&(e=`${e}`),i.setRangeText(e,n,n,"end"),i.setSelectionRange(n,n+e.length)}i.focus()}else{if(i.focus(),this.range){const e=s.getSelection();null==e||e.removeAllRanges(),null==e||e.addRange(this.range)}t===Ro.cD.insert_below&&(i.textContent&&(e=`${e}`),n&&(e=`${n}${e}`)),t===Ro.cD.insert_below&&i.textContent&&(e=`${e}`),setTimeout((()=>(0,is.Ig)(e,i)),0)}setTimeout((()=>function(e){(0,Ul.Im)()||null==e||e.dispatchEvent(new Event("input",{bubbles:!0}))}(i)),0)}select(e=0,t=0){const n=this.containerEl;if(n)if(n.focus(),(0,is.Ku)(n))n.setSelectionRange(e,t||n.value.length,"forward");else{const e=new Range;e.selectNodeContents(n);const t=window.getSelection();null==t||t.removeAllRanges(),null==t||t.addRange(e),this.range=e.cloneRange()}}get canInsert(){return this._canInsert}}const zl={baseInfo:yl.Ws,selectionHelper:null},ql=(0,z.createContext)(zl),Vl=()=>(0,z.useContext)(ql),$l=e=>{const{currentAction:t,messageId:n,message:i,onClickWritingAction:s,style:o}=e,{selectionHelper:a,baseInfo:r}=Vl(),l=e=>o=>{o.preventDefault(),o.stopPropagation(),(0,Ml.aX)({button_name:e,action_name:t,message_id:n}),null==a||a.insert(i,e,r.text),s(e)},c=(0,bi.Uk)();return(0,z.useEffect)((()=>{(0,Ml.ih)({button_name:Ro.cD.insert_below,show_from:Q.Z5.selectAssistantResult}),(0,Ml.ih)({button_name:Ro.cD.replace_selection,show_from:Q.Z5.selectAssistantResult})}),[]),(0,K.jsxs)("div",{style:o,className:Al["writing-operations"],onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onMouseUp:e=>{e.preventDefault(),e.stopPropagation()},children:[(0,K.jsx)(ce.$n,{disabled:!(null!=a&&a.canInsert),type:"secondary",onClick:l(Ro.cD.insert_below),className:Al["icon-btn"],icon:(0,K.jsx)(de.H9,{className:Al.icon}),children:(0,K.jsx)("span",{className:re()(Al.caption,{[Al["disabled-caption"]]:!(null!=a&&a.canInsert)}),children:c("flow_web_ext_action_popup_insert")})}),(0,K.jsx)(ce.$n,{disabled:!(null!=a&&a.canInsert),type:"secondary",onClick:l(Ro.cD.replace_selection),className:Al["icon-btn"],icon:(0,K.jsx)(de.K2,{className:Al.icon}),children:(0,K.jsx)("span",{className:re()(Al.caption,{[Al["disabled-caption"]]:!(null!=a&&a.canInsert)}),children:c("flow_web_ext_action_popup_replace")})})]})},Kl=e=>{var t;const{message:n,action:i,setBoxVisible:s}=e,a=null==n?void 0:n.isDone;return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(Fl,(0,o.A)({},e)),a&&(0,K.jsx)($l,{style:{marginTop:4},currentAction:i,messageId:null==n||null===(t=n.body)||void 0===t||null===(t=t.message)||void 0===t?void 0:t.message_id,message:(null==n?void 0:n.text)||"",onClickWritingAction:()=>s(!1)})]})};var Wl=n(15510),Gl=n(32201);const Yl=e=>(0,K.jsx)("svg",(0,o.A)((0,o.A)({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),{},{children:(0,K.jsx)("path",{fill:"#0057FF",d:"M6.922 12.885q-.375 0-.64-.333L3.583 9.177a1 1 0 0 1-.146-.234.7.7 0 0 1-.042-.235q0-.27.177-.448a.63.63 0 0 1 .458-.177q.318 0 .537.287L6.9 11.365l4.521-7.183a.8.8 0 0 1 .245-.255.6.6 0 0 1 .323-.078.6.6 0 0 1 .442.172.58.58 0 0 1 .172.437.7.7 0 0 1-.036.224 1 1 0 0 1-.115.235l-4.896 7.63a.73.73 0 0 1-.635.338"})})),Ql=e=>(0,K.jsxs)("svg",(0,o.A)((0,o.A)({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),{},{children:[(0,K.jsx)("path",{fill:"#F25022",d:"M4.871 4.871h6.489v6.489H4.871z"}),(0,K.jsx)("path",{fill:"#00A4EF",d:"M4.871 12.64h6.489v6.489H4.871z"}),(0,K.jsx)("path",{fill:"#7FBA00",d:"M12.641 4.871h6.489v6.489h-6.489z"}),(0,K.jsx)("path",{fill:"#FFB900",d:"M12.641 12.64h6.489v6.489h-6.489z"})]})),Jl={[Gl.c$.HUOSHAN]:{logo:(0,K.jsx)("img",{src:(0,he.Nf)(),width:18,height:18}),label:"flow_web_ext_sidebar_settings_translateservice_cici"},[Gl.c$.DOUBAO]:{logo:(0,K.jsx)("img",{src:(0,he.Nf)(),width:18,height:18}),label:"flow_web_ext_sidebar_settings_translateservice_doubao"},[Gl.c$.GPT]:{logo:(0,K.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAYJSURBVHgBxVhtTJNXFH7a+gEzYmFDtzHX/nEfCcSqoONDKSzROIiZLnHRiZQIOjcmTPwzIxEWXDP3A00QUJxFBH+4H8qmYROx4ATRaZRM5zCQlrIoCBH4wZDPs3tv62vp+pYWIT7Jad/33vPe+9xzzj3nfa8CvkPL5GMmi5nomagdwtHLxOqQOibnHNfTAgMTMxPyUW47np0y6JlYJkHEVSwvSoy7IX8KiLhKPp672GtoYTc1TZNYHHN4TcYyjWQ8klK43Ksdlvmfoitmz/ZDdHQUFi1ahOHhYdTXN+DBg2YQEXzAHSZxsO9Ot/AqZnZ+vpN6enrIFdev3yCtVjuZmHILgzcD7N+/X0xuNpspPj6eQkLeotDQMDIYUshisZCtzUbHjh2j0tJSMhq/p4iI5d6Q0rsjZJnoQd1inSCTn59PCoVSamd+p3Xr1lF7e7vo7+rqEuSGhobEPScXFBg0UTx5bx0FFBQVGUW/VlWJiQLF4ArRHhoaSrW1tWLiRuayuLg4RlYh+ufODaCsrCx737VGmjVrtidSBmdCsltco9FQdXW1FCdnz54V7cGvBVNRYZFoe/jwIaWnf2UnqXgu/J7rrl+/Xuhxd3sgZH5GRiunFBQUJCzCA3jvN3tpdHSUioqKHLGUQ/39/ZSb+y0FqgNFm1qtppycHGpqaqLdu3fTzJmzJFI85lpbWyeKJc4FmXIKRwqOiJXFxMSIFXMcKSgQfXxio9EoxVBCQgJ1dHbQ5cuX6eTJk0KXL2bTpk1CJ2vPHtHm7+fniVCmkv3Ewg14gkrauhVlZWW4erVeaicXrSW6Jaitq8P58+dh/M6I+PgPkZycjBUrPhAap0+fRmXlz1AHzBP3SpUKHsDfINzHT1hYmFjR2jVr7FZwWKjAyUKPWOxwd+7alUEpbNtbrTYymUzjclFKij0dcHR3dztiy/Nu63HXGR4eLgZZvXq1RGiM3RcWFom44IS4exYsWCA9s3DhQqq+VMO2fTcL8nTyc7hH87aGLly4IMbju9UDoR7uMreV12ptE/+RkZFS29OBp5g/P1iqN9carqGz87HUz/IQ6q/+jps3b2Lt2gTcv38fSUlJaLPZ8Nnmzbh39x4OHz4ED1Ar5Xq6u7tQx2IjLS0NbBeJGrWdXS9btgwXqy9Cq9FijMbcPmuztSEx8SPxPHMhlEolevv6UHy0GOEREWAulZsWnJBsYWNJDSEhISg7VSYGKa8oZ8X0HZw58xMSEhOxatUq1q6R9FmawNKlSzE2NgZeY61WK1QsiBXCpAo03WkSenxRMuj1SOjWrVtobm5mq00Uq922LRWjoyMoKSnB8uURYMHKqnw9a9+GL79IR0tLC3Q6HewFn1xGI6hm2HfYkydP5Ka08p9SyJYMiEA8WlxMFRUVUm7hdUshSgdox/YdUrGNjY0VwV5YWCgFPodSqRLjHT9+XCRXf39/uaA+xy10R44u1xgZGYWt/R9s2bIFGzZ8ItorKytxqrwcl2pqkHfgAMtXyYiPixNW5OAucwVLIyI/saSJgYEBuSlr+Y8WHtL59Rt/EJvoudVYlc/IyBDlITc316lsBFIOKyd9fX108OAPUq7iyM7OFvmKW9c5TUCmdHCY5ZQyMzPFoKlp28lel5zF/iaQlppKNptN6JlOmOj1N950uOhHqSjX1NRM9PJ229lUBk9W4gmQY9++bAp6NViq5nq9nq5cuSL6+H9M9EqJ6IwZM4VF+JsC13vW7kEMrv6zyCkHBMyj4qMlYmIWU9Ta0kodjzrE/WP2MrZx46fjLMetlpeXJ/p5xp+AiFQyOJwrXRNkPuQGBwdZ8fyFSRV6envxdHAId+/+yfJOIIaHhtDY2IgR9qKvUqoQwRKfyXRCFGYWY6K4eoGvIbO5DnmxGkl4TFT9Vkeu6OjodLyweTXOuFri7jPIzEQHH/Due+8jKnolXpkzB3//dQ8NDfUY+Lffm0etTJbAQ3Lm0OIlfii+LFJefYy6grvPp5jyUg5hEocNzjBg6o5j9JhCGDC5ExEzfDgXUsB3aGE/0ot1XHNxPtLjUgt7XvP5SO8/7DMsUnMU7ywAAAAASUVORK5CYII=",width:18,height:18}),label:"flow_web_ext_sidebar_settings_translateservice_gpt"},[Gl.c$.GOOGLE]:{logo:(0,K.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAeJSURBVHgBzVdbbFzVFV3nPmY8tmPHj8Rx4jiOUWnkJig1tOAquAlRWgKojSJSq8pH04fUj0pV+9GPfoHgC4EEgg+QkFAkkEDig4+IlwLilUgBQghgDCYxBGdiEht7nHg8nse9Z7PPOfde3zvjQD5GiG2d+zhzfPY6e6/9uMBPTET4cOjhpb6Chb9ZEBn1LhFeeUiL71aw0uMZM0f8VrTpvRf/s+p51EkcdRl59NJ1echjrGGdZC0UW0Ck3sgA42fSZ2AwwsC1PRrjW90AWUZp898F0boAQtWIoOk/RFdlXoIUGNj/QLYHdRLjB6qktBqiBAQg5tOVhNjBsFG2Vx1CPQFpvlS5KoIjrCQGJNcpwEKk/oR6AsJKQNTQ2msBJd8kr/S2HXh0YQ3qIE5CkSZGACByn0Q1VIp+t6KZDc2Fx85NZt93eMq2be1py7JISinCu1oYf1f3SqVSdF33xe7u7nMxQFbgMgFBuCpxqt1lwAptxbkCjZSW/BG3KRUuESpChVA3EsFdgQzBGos4Dhjcfdls9vqenp5ZMyutmFLSoU4rgIHaSwR4hVDwDSA+xXypGV9dLCK/VBBSwVhmQ3g8EUhiXwWUwbXz439jFvKCR6raQ81IXNch8PMNHlK2jdnLEh+cBxbKKV7lJzb/LJdBV+tlOOz2xqbMVSM0tFpMmTJhOgIktcuqrMKnbuecfWiHxMB6tYnk33397/sXLDx9UuLkl0lFH19oxHDfFRSLRVhMo4aGdAggsS4GpubdWEgmg0nxKMN7/et3ApvaJObyFt792sXiIltrrcSGThvnc2Ve6CZINVdM40LORV+HT4VCQeGgdDpdbajvYWkIKAysYHef33+9qYi+1S4u5FN48AgwX/Rh+y6k7SHTQCgsqZLnx4+pg2JiNo2NbYvC4nArFkuaM6lUKrQSVVunWgJShxFk6SGkxO3b0/D41yeOVjC/xHNkw2UgGWUUxtHgVJBx2NnCj46tdJ3+phGeilipQpxQYvcVimUseRWOpquDCYEGFlKIHIQh1MBKWxsFyp7ANzlWqhTw/L93VzDQbSJLBKd4/B0bJ87CLODZuXIjpnI2NnX42ijEB3n3o1G8efpj3PPPv6pcoEhFGr2otZghNZuCLJv3lJo/Fc+QyuUwdxgcH1DLzGVC1jVuXdsu4DrKSa42R1QWOf8dn/Awe2lCJUgmNzD57RwkG/L4qTFzeAHtwJ6uNWLj2s6g/OgMuJyp4+JzBH5yvojBPoG921y8cErqyn74uMOgLXQ2+bh/fxm25WI8W2IUJppULub4xfh0BpcmPocryjrzk3B0InztxPvMQdtkKbbUzsFt6GVANRaqdSjw6qiLm3p9/HG7h4q0cXS0gnJZYEObjX8MA+mUi9EskFsMeyNlf9+ET3ot9gzegY6GIrraW9DU4OgoPjE2gWMnP8Tdu3+LX1zfqwNhZQ4lsWg/n5kGDjM/Dg57uPuXPvZtT8FnTrmpsqb+zIKNw2+52gJSUyIoI6rU8u+fXHQwf+YNbPlZL24fGkQ+X8FHo6PobGnG5o1reC8PDlsrBqjKZURR2BtQAm+eJUzMA/tuALbxgWzmzxz3uSfO+jjyIVCoqJV+7KAieCbMFtuxpb8fo+Pj2NzdibNT01xWlvD7W4e0u6TvE0ejcBy71mVSnU7UdkOKqJPfOnj4dc4lVOETWSgx4SVzTIQAVPbRUbjcR6oxxfnrtq1bKDt1QRw59gFUnv/VDQPYvN50Karam+JrMnlY5Fbuh0joJEdBP6T6Qk+ksOTbTHg3yFlRI5LMuxR0npxGJvOtYlNPL3yfUwczvr+riy2QbGd831fg9KgFRCKoISEgMxDcKazuWM7qiGCJyGJh131qknB67At0tLSgMZPBkbffw6XcAmraPOXCakAUHZNiLYj5k6FNCNEAVmp54yJwRa5GY9s6HNj9Gxy86zbuAgjPvPIOLuaugK7y38uAyFSm4Ess/PBJPovlUdMvqVpBVd2ldLC+/1Y0ptNYlQL+ctdupJm1z776Nmbm88EnlpGEhbhFKiGKsO+tfdcmoZs5AYzPrtLJVDJnM5kUjezdiTRXgE/PfB3UP6rlUIn8J4kqc9euMMg7VRZZloCLDGp2IcURZ8FW2VlYor25iQ7euRM7bhzQ+S5oc5dbWnV55f9t5/bdm7vRsxfvJNvOWD+AR+q8HD7z6RfnbqL5/IgBG1301ef6OD2TRl+7a2jP+luamqM22Qq6x9BCdfAPsPfAS2u485k2ILiB0e5SCjzsGe7EH3Z1QNiS85hDumszTb8BYHKQGg/19/f/74eMcU3y8vN3zHAROaUKttpQJUnV8u7Z0cljNfdHvsq+OhkGn0MJQisJ5+sCSCuQeEEGH5cWA9h1SyuGb2lhRT7XXN2eULzNiEt8rn6AnPmnhPRUrGP45iYG1MwE9UjFlyV0wmS/WGFDlgCl5pjUuboCOvrcn6f4e3Rs11Azdg21MnmlbvBcjh5GBPN9SKG7qr86LvLtGfXsoI6yd6j13sHB9M3SK6k0KVQjolpuV7rk+7aocpeyiuoqC8yfR7Zu3XrtaefHlO8AA96ovNGXCxkAAAAASUVORK5CYII=",width:18,height:18}),label:"flow_web_ext_sidebar_settings_translateservice_google"},[Gl.c$.MICROSOFT]:{logo:(0,K.jsx)(Ql,{}),label:"flow_web_ext_sidebar_settings_translateservice_microsoft"},[Gl.c$.DEEPL]:{logo:(0,K.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAPySURBVHgBzZh7SFNRHMe/V8t0c2pm1tbUWkZpIBbR448sDKR3WbMolWwlPVYzizIFTaUXPczSGqX4CAmxLLMHFpMwyuhNUiY1a5llSSRlL3Pudu7AaDndfQV94MLuvWeHL+f8zu/3/V2KJuA/oh8E0tb2GacqDfAe6IElc8Ph7OQEQdACKLtooIPCo2nPsRHWa+yMGPrcpWpaCBSfLbv/qAFJe/S497jB7vvpk0ORlZoAVYACXOEk6OOndmRmF6DkbBXMXZY+xzJbty4mEtq4RZD7+kBUQZ1mM7KPlyKn5Cw+t38FFxgxKdpYREdGwIlFfDkUZLhxD9v36mE0NUMIo1T+OJqZiImhweAl6Fljk1VIde19UBQFsVgyOxwpuhUYrhwK1oJyi8tJrBTiZ2cn/gXenjIkrFqKBE0UHApqNL3B+DkrHa6KVOKK7z86YLHwy6tSV1c8v14KicTN5nmPKGtt++RQTPL6GJhuluNOZT78FEPAh/Zv3/GFXH/DOa2q/ORIWh+L/v37IXC4Ejs2aSAmnAX96OiwuZ8QMgZKuS/EgrOgt60fkXYwD89emFBz6yEqqq7jctEBJMQthkWEOt0jqG89rMes2ERwwY+s0NY10ZhGSkbqgTxUGm5Yt9SFpvDVbP+kMofBSILa18fb5rngas/wuqUVuvRDCCLJT79nG6JmTsWUSeMwyMsDhwvPID0rn/VcAr2CLU9fNCFMrcUwhRw+Az2tp3UTyTVeMhnrOUQVZJ3QmYKx6c3ve6YOdtEW1v8XZcu6CQoMwLa10ai5/QDuUleM9FMiu7AM7V/YF2TegpiT0J0+PT3csXGFGotnT8ORgjKUlF9F0ekq8IGXoPjl87F62Tw0Njbjdl094pctQMWVGoRFbeC0GqII8h3kjX3JWjDVZfQIfwSPUSFyTQqek4AWA85BLXFzwZ+lrq7BKJoYu4L85YP77BxMze+wK6fI+vtlUwsyDhaAD1K3ASTwJT2e2/VDu3OKse9EKYnc3o+rM+VMfLUZlBN38yYh1iVDtxLxMQvZCWJ4RVYiZf9xXKquhVjQpFxERkzF7uR1UAyxb/wdeupzF64h82gxXja3QAgTQoKQtjEOYVNC+xzHquswm7ugL6lAbtFpvP/QBi7IZO7ISNQgTj1LnK7jT1ref8DO3JPWvsyRq2S2R0ssCZO5vUjiZAuvzpVpiXRpWah98KTXMTPDJqP0WAa4wqu4Mtb18sks5KTrevXUXFZFsKBuYtVzcLNcjy2apXAZ4GL7kmcrJ9h+eMikSN2swd3zeVCTzzFCEc0PBZBONH9vEgynsqFSKkDx7Nd4BTUb6uqNCAkOBFf+mSC+/AIWMfZBAp6MNgAAAABJRU5ErkJggg==",width:18,height:18}),label:"flow_web_ext_sidebar_settings_translateservice_deepl"}},Xl=[Gl.c$.HUOSHAN,Gl.c$.GPT,Gl.c$.GOOGLE],Zl="wrapper-J04ZTz",ec="item-Q78HOk",tc="selected-nExULO",nc="label-wAU3wF",ic="selected-icon-pw2aKM",sc="logo-r4sXoe",oc=e=>{const t=(0,$.B)(),{selectedService:n,onSelectService:i,services:s}=e;return(0,K.jsx)("div",{className:Zl,children:s.map((e=>{const s=Jl[e];return(0,K.jsxs)("div",{className:re()(ec,{[tc]:e===n}),onPointerDownCapture:()=>null==i?void 0:i(e),children:[(0,K.jsx)("div",{className:sc,children:s.logo}),(0,K.jsx)("div",{className:nc,children:t(s.label)}),(0,K.jsx)(Yl,{className:ic})]},e)}))})},ac=e=>(0,K.jsx)("svg",(0,o.A)((0,o.A)({xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"none",viewBox:"0 0 14 14"},e),{},{children:(0,K.jsx)("path",{fill:"#000",fillOpacity:.85,d:"M7 9.707a.58.58 0 0 1-.415-.182l-3.468-3.55a.5.5 0 0 1-.119-.164.6.6 0 0 1-.036-.206q0-.15.068-.273a.53.53 0 0 1 .46-.264q.22 0 .383.164l3.35 3.431h-.442l3.345-3.431a.525.525 0 0 1 .652-.091q.118.068.186.191a.53.53 0 0 1 .073.273.5.5 0 0 1-.155.37l-3.468 3.55A.554.554 0 0 1 7 9.707"})})),rc="label-wrapper-PMjLSt",lc="logo-wrapper-RRaf8y",cc="logo-J2ewo3",dc=e=>{const t=(0,$.B)(),{mode:n,translateService:i}=e,s=Jl[i];return"label"===n?(0,K.jsxs)("div",{className:rc,children:[(0,K.jsx)("span",{children:t(s.label)}),(0,K.jsx)(ac,{})]}):(0,K.jsxs)("div",{className:lc,children:[(0,K.jsx)("div",{className:cc,children:s.logo}),(0,K.jsx)(ac,{})]})},uc=sn().bind({"cici-ext-container":"cici-ext-container-IYCEkb",ciciExtContainer:"cici-ext-container-IYCEkb","inactivelink-hover-animation":"inactivelink-hover-animation-a8Gq0G",inactivelinkHoverAnimation:"inactivelink-hover-animation-a8Gq0G","notactivelink-hover-animation":"notactivelink-hover-animation-fbsD3w",notactivelinkHoverAnimation:"notactivelink-hover-animation-fbsD3w","light-click-animation":"light-click-animation-JlAsqg",lightClickAnimation:"light-click-animation-JlAsqg","click-animation":"click-animation-MBAg5r",clickAnimation:"click-animation-MBAg5r","semi-animation-rotate":"semi-animation-rotate-CbK91s",semiAnimationRotate:"semi-animation-rotate-CbK91s","inactive-btn-hover-animation":"inactive-btn-hover-animation-nUPiTZ",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-nUPiTZ","cici-ext-always-dark":"cici-ext-always-dark-Ha0zoa",ciciExtAlwaysDark:"cici-ext-always-dark-Ha0zoa","cici-ext-always-light":"cici-ext-always-light-BtPMDH",ciciExtAlwaysLight:"cici-ext-always-light-BtPMDH",ellipsis:"ellipsis-JLALe7",select:"select-COUz7N","option-container":"option-container-DBZEFh",optionContainer:"option-container-DBZEFh","language-local":"language-local-TeDsvm",languageLocal:"language-local-TeDsvm","language-setting":"language-setting-qzXXeo",languageSetting:"language-setting-qzXXeo","selected-option":"selected-option-by2wk3",selectedOption:"selected-option-by2wk3","activelink-hover-animation":"activelink-hover-animation-aHHsTw",activelinkHoverAnimation:"activelink-hover-animation-aHHsTw"}),hc=({languageList:e,onLanguageChange:t,initialLanguage:n,getPopupContainer:i})=>{const s=e.length>0,o=(0,z.useMemo)((()=>{var t;const i=e.find((e=>e.language_code===n));return null!==(t=null==i?void 0:i.language_loc)&&void 0!==t?t:n}),[e,n]);return(0,K.jsx)(ce.l6,{value:o,clickToHide:!0,style:{flex:"1"},onChange:t,getPopupContainer:i,dropdownClassName:uc("select"),suffix:(0,K.jsx)(de.R0,{style:{marginRight:6}}),showArrow:!1,disabled:!s,position:"bottomRight",children:e.map((({language_loc:e,language_code:t,language:i})=>{const s=t===n;return(0,K.jsx)(ce.l6.Option,{showTick:!1,value:t,children:(0,K.jsxs)("div",{className:uc("option-container"),"data-lang-option":t,children:[(0,K.jsxs)("div",{children:[(0,K.jsx)("div",{className:uc("language-local",{"selected-option":s}),children:e}),t!==fe.Aq&&(0,K.jsx)("div",{className:uc("language-setting"),children:i})]}),(0,K.jsx)("div",{children:s&&(0,K.jsx)(de.Tf,{})})]})},i+t)}))})},mc=sn().bind(Al),gc=(0,r.jco)(),pc=()=>{const e=(0,$.B)(),[t,n]=(0,z.useState)(!0);(0,z.useEffect)((()=>{const e=()=>{(0,X.vE)("transPreferConfig",{tipShown:!0},!0)};return setTimeout((()=>{e(),n(!1)}),5e3),()=>e()}),[]);const i=(0,z.useRef)(null);return(0,K.jsx)("div",{style:{width:" 100%",position:"absolute",left:0,top:0},ref:i,children:(0,K.jsx)(ce.m_,{trigger:"custom",visible:t,getPopupContainer:()=>i.current,style:{fontSize:11},content:e("flow_web_ext_action_popup_translate_hover_preference"),children:(0,K.jsx)("div",{style:{width:"100%"}})})})},vc=({handleTranslate:e,style:t})=>{var n;const{translateLanguage:i,setStorageLanguage:s}=(()=>{const[e,t]=(0,Si.Y)("translateLanguage"),n=(0,fl.t_)((e=>e.inputTextLang)),[i]=(0,Si.Y)("transPreferConfig"),[s,o]=(0,z.useMemo)((()=>{var s;return[(null===(s=i.langMap)||void 0===s?void 0:s[n||""])||e,e=>{t(e),n&&(0,X.vE)("transPreferConfig",{langMap:{[n]:e}},!0)}]}),[e,i,n]);return{translateLanguage:s,setStorageLanguage:o}})(),o=(0,ye.e)(),{inputText:a}=(0,fl.t_)(),r=(0,$.B)(),l=(0,z.useRef)(a),c=(0,z.useRef)(null),[d,u]=(0,z.useState)(!1),h=null===(n=(0,Si.Y)("transPreferConfig")[0])||void 0===n?void 0:n.tipShown;return(0,K.jsxs)("div",{className:mc("language-options"),style:t,ref:c,children:[(0,K.jsx)("div",{className:mc("language-wrapper"),style:{flex:"1",fontSize:gc?"15px":"12px",height:gc?"34px":"28px"},children:r("flow_web_ext_action_popup_autodetect")}),(0,K.jsx)(de.hI,{className:mc("icon-arrow-right")}),(0,K.jsxs)("div",{className:mc("language-selector",{pad:gc}),style:{flex:"1"},children:[d&&!h?(0,K.jsx)(pc,{}):null,(0,K.jsx)(hc,{languageList:o||[],initialLanguage:i,onLanguageChange:t=>{const n=`${t}`;(0,_e.Su)({before_language_result:i,after_language_result:n,scene:_e.jv.highlight_result_choose}),u(!0),s(n),e({text:l.current,language:n,enter_chat_method:"highlight_search_result_tool",current_page:"web_otherpage",scene:"highlight_search_result_tool",abortOptions:{reason:"switch_language",from:i,to:n}})},getPopupContainer:()=>null==c?void 0:c.current})]})]})},fc=e=>{const{action:t,ready:n,render:i,doSearch:s,range:o,contextText:a,syncToChatMessage:r}=e,[l,c]=(0,z.useState)(!1),{renderHeader:d,renderStreamMessage:u,renderLLMContextTip:h}=i,[m,g]=(0,Si.Y)("selectTranslateService"),p=(0,z.useRef)(null),v=e=>{if(r.current=void 0,o){const n=(0,Cl.l$)(o),i=(null==e?void 0:e.language)||Bl(t);n&&(0,Cl.Oi)({encodeText:n,lang:i,translateService:(null==e?void 0:e.translateService)||m,contextText:a}).then((e=>r.current=e))}},f=e=>{s(e),v(e)},_=e=>{g(e),f({translateService:e}),c(!1)};(0,z.useEffect)((()=>{n&&v()}),[n]);return(0,K.jsxs)("div",{ref:p,children:[d((0,K.jsx)(ce.AM,{trigger:"custom",position:"bottomRight",visible:l,onClickOutSide:()=>c(!1),content:(0,K.jsx)(oc,{selectedService:m,onSelectService:_,services:Xl}),className:Al.translateServicePopover,getPopupContainer:()=>p.current,children:(0,K.jsx)("div",{onClick:()=>c(!l),children:(0,K.jsx)(dc,{mode:"logo",translateService:m})})})),n&&(0,K.jsx)(vc,{style:{marginTop:10},handleTranslate:f}),u({textFormatter:e=>{const{isDone:t}=e;let{text:n=""}=e;return t||(n=(0,Wl.sh)(n)),(0,Cl.q4)(n)}}),[Gl.c$.GPT,Gl.c$.DOUBAO].includes(m)&&h()]})},_c=e=>{const{render:t,message:n}=e,{renderLLMContextTip:i}=t,{body:s,suggests:a=[],isDone:r}=n||{},l=(0,z.useRef)(0);return(0,z.useEffect)((()=>{var e;if(r&&a.length)return(0,Ml.DM)({prompt_cnt:a.length,message_id:null==s||null===(e=s.message)||void 0===e?void 0:e.message_id}),()=>{l.current=0}}),[r]),(0,z.useEffect)((()=>{if(a.length){for(let t=l.current;t<a.length;t++){var e;(0,Ml.T)({prompt_position:`${t+1}`,message_id:null==s||null===(e=s.message)||void 0===e?void 0:e.message_id})}l.current=a.length}}),[a]),(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(Fl,(0,o.A)({},e)),i()]})},yc={[Gn.EU.translate]:fc,[Gn.EU.explain]:_c,[Gn.EU.rewrite]:Kl,[Gn.EU.grammar]:Kl},xc=e=>(0,K.jsx)("svg",(0,o.A)((0,o.A)({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 16 16"},e),{},{children:(0,K.jsx)("path",{fill:"currentColor",d:"M8.1 13.76a5.4 5.4 0 0 1-2.19-.445 5.7 5.7 0 0 1-1.81-1.223 5.8 5.8 0 0 1-1.227-1.803 5.5 5.5 0 0 1-.44-2.195q0-1.162.44-2.184A5.9 5.9 0 0 1 4.095 4.1a5.7 5.7 0 0 1 1.81-1.222 5.4 5.4 0 0 1 2.189-.446q1.162 0 2.19.446 1.031.44 1.809 1.222.782.783 1.227 1.81.446 1.02.446 2.184 0 1.167-.446 2.195a5.82 5.82 0 0 1-3.031 3.026 5.4 5.4 0 0 1-2.19.445m0-1.244q.917 0 1.716-.342a4.5 4.5 0 0 0 1.413-.945 4.365 4.365 0 0 0 1.293-3.135q0-.919-.348-1.717a4.4 4.4 0 0 0-.95-1.413 4.37 4.37 0 0 0-3.13-1.293 4.35 4.35 0 0 0-1.722.342 4.5 4.5 0 0 0-1.408.951 4.372 4.372 0 0 0-1.282 3.13q0 .923.337 1.727a4.5 4.5 0 0 0 .95 1.408q.61.603 1.408.945a4.35 4.35 0 0 0 1.722.342m-.951-1.478a.425.425 0 0 1-.45-.44q-.002-.184.129-.31a.45.45 0 0 1 .32-.124h.625V8.056h-.527a.46.46 0 0 1-.32-.12.42.42 0 0 1-.13-.32q0-.186.13-.31a.45.45 0 0 1 .32-.125h1.027q.239 0 .364.157a.62.62 0 0 1 .125.408v2.418h.56q.19 0 .32.125.13.124.13.31a.425.425 0 0 1-.45.44zm.929-4.656a.74.74 0 0 1-.533-.217.73.73 0 0 1-.223-.532q0-.32.223-.538a.73.73 0 0 1 .533-.223q.315 0 .532.223a.73.73 0 0 1 .217.538.74.74 0 0 1-.217.532.72.72 0 0 1-.532.217",opacity:.8})})),bc="output-Yv5fff",Ac="header-container-W750nM",wc="caption-j8fz7d",Sc="stream-message-container-U2Nsam",Cc="llm-context-tip-tYpfwb",kc="result-flKBGi",Ic=()=>{var e,t;const{actionMessages:n,currentAction:i,range:s,messageCursor:r,clearMessages:l,setBoxVisible:c,contextText:d,checkAndSetInputLang:u}=(0,fl.t_)(),[h,m]=(0,z.useState)(!1),g=(0,$.B)(),p=(0,st.P)((e=>e.messages)),v=null!==(e=n[i])&&void 0!==e?e:[],f=null!==(t=v[r])&&void 0!==t?t:"",{isDone:_,suggests:y=[]}=p[f]||{},[x]=(0,Si.Y)("editingPopupActions"),[b]=(0,Si.Y)("readingPopupActions"),{syncToChatMessage:A,doSearch:w,handleAISearch:S,handleContinueInChat:C,handleCopy:k,handleRegenerate:I,handleRetry:E,handleClickFollowUpQuestion:T}=Dl(),j=(0,z.useMemo)((()=>{var e;const t=(0,bl.A)([...x.actionList,...x.moreActionList,...b.actionList,...b.moreActionList],(e=>e.id===i)),n=(0,xl.A)(Gn.YN,(e=>e.id===i));return null!==(e=t[0])&&void 0!==e&&e.name?n||t[0].confId?g(t[0].name):t[0].name:""}),[i,x,b]);(0,z.useEffect)((()=>{try{(0,a.A)((function*(){i===Gn.EU.translate&&(yield u()),m(!0),w()}))()}catch(e){xi.vF.persist.error({eventName:"[SEARCH_CORE] - SEARCH",error:e})}return()=>{l()}}),[]);const N=yc[i]||Fl;const M={message:p[f],action:i,setBoxVisible:c,doSearch:w,ready:h,range:s,contextText:d,syncToChatMessage:A,render:{renderHeader:(e=null)=>(0,K.jsxs)("div",{className:Ac,children:[(0,K.jsx)("div",{className:wc,children:j}),(0,K.jsx)("div",{children:e})]}),renderStreamMessage:e=>{const{textFormatter:t,renderFollowupQuestions:n=!0}=e||{};return(0,K.jsxs)("div",{"data-flow-selectable":"true",className:Sc,children:[(0,K.jsx)(In,{className:kc,type:"selection",id:f,enableScroll:!0,onRetry:E,showShadow:!1,textFormatter:t}),n&&_&&(0,K.jsx)(Nl,{suggestMessageListWithStatus:{suggests:y.filter((e=>e))},onClick:T})]})},renderLLMContextTip:()=>_?(0,K.jsxs)("div",{className:Cc,style:{marginTop:12},children:[(0,K.jsx)(xc,{}),(0,K.jsx)("span",{children:g("flow_web_ext_action_popup_translate_notice")})]}):null}};return(0,K.jsxs)("div",{className:bc,"data-testid":"select-box-container",children:[(0,K.jsx)(N,(0,o.A)({},M)),_&&(0,K.jsx)("div",{style:{marginTop:16},children:(0,K.jsx)(El,{regenerateDisable:v.length>=it.ch,onMainButtonClick:()=>{i===Gn.EU.explain?S():C()},onCopy:k,onRegenerate:I})})]})},Ec=sn().bind(Al),Tc=(0,r.jco)(),jc=()=>{const e=(0,$.B)(),t=(()=>{var e;const{actionMessages:t,currentAction:n,messageCursor:i}=(0,fl.t_)(),s=(0,st.P)((e=>e.messages)),{isUnAuthorized:o}=s[(null===(e=t[n])||void 0===e?void 0:e[i])||""]||{};return(0,Kn.vh)((0,Kn.OB)(n),o)})(),n=(0,K.jsxs)("div",{className:Ec("login-content"),children:[(0,K.jsxs)("div",{className:Ec("text"),children:["\u{1f389} ",e("flow_web_ext_login_note")]}),(0,K.jsx)(ce.$n,{theme:"solid",type:"primary",className:Ec("login-btn"),onClick:()=>(0,b.DT)({trackMeta:{login_entrance:"highlight_result"}}),children:e("flow_web_ext_login")})]});return(0,K.jsx)("div",{className:Ec("container"),style:Tc?{gap:"10px"}:{},children:t?(0,K.jsx)(Ic,{}):n})};var Nc=n(66956);const Mc=e=>{var t;const n=null===(t=(0,z.useContext)(zs.A))||void 0===t?void 0:t.getPopupContainer,i=(0,fl.t_)((e=>e.setBoxVisible)),[s]=(0,z.useState)(e.selectionData),{top:a,left:l,width:c,height:d,clientBottom:u}=s,h={top:`${a+window.scrollY+5}px`,left:`${l+window.scrollX}px`,height:`${d}px`,width:`${c}px`},m=c/2;l+m<=210&&(h.left=`${210-m+window.scrollX}px`),u<300&&(h.top=a+window.scrollY+5+u-300+"px");const g={position:"relative",width:420,boxSizing:"border-box"},p=(0,wi.A)((()=>{i(!1)}),(0,r.jco)()),v=(0,K.jsx)("div",{ref:p,onMouseDown:e=>{if(!function(e){let t=e.target;for(;t&&t!==e.currentTarget;){if("true"===t.getAttribute("data-flow-selectable"))return!0;t=t.parentElement}return!1}(e))return e.preventDefault(),e.stopPropagation(),!1},children:(0,K.jsx)(jc,{})});return(0,K.jsx)(ce.AM,{content:v,trigger:"custom",visible:!0,autoAdjustOverflow:!0,getPopupContainer:n,onVisibleChange:e=>{i(e)},style:(0,o.A)({},g),className:Nc.A["popover-container"],children:(0,K.jsx)("span",{style:(0,o.A)({position:"absolute",pointerEvents:"none"},h)})})};var Lc=n(56642),Rc=n(53472);const Pc=e=>{var t;const[n,i]=(0,fl.t_)((e=>[e.barVisible,e.barFakeHide]),Lc.x),s=null===(t=Vl().selectionHelper)||void 0===t?void 0:t.canInsert,{top:a,left:r,width:l,height:c}=e.selectionData,{url:d}=(0,_l.IF)((e=>({url:e.url}))),u=d.includes("bytedance."),h=u?5:-5,m=u?"bottom":"top",g={top:`${a+window.scrollY+h}px`,left:`${r+window.scrollX}px`,height:`${c}px`,width:`${l}px`};(0,z.useEffect)((()=>{n&&(0,Ml._B)()}),[n]);const[p]=(0,Si.Y)("selectBarOnlyIcon"),[v]=(0,Si.Y)("editingPopupActions"),[f]=(0,Si.Y)("readingPopupActions"),_=(0,z.useMemo)((()=>[...[...Gn.y3].map((e=>Gn.YN[e])),...s?v.actionList:f.actionList]),[s,v,f]),y=(0,z.useMemo)((()=>s?v.moreActionList:f.moreActionList),[s,v,f]);return(0,K.jsx)(Rc.t,{selectBarOnlyIcon:p,availableActionList:_,moreActionList:y,visible:n,position:m,isAliginLeft:!0,rePosKey:JSON.stringify(g),autoAdjustOverflow:!0,style:{visibility:i?"hidden":"visible"},children:(0,K.jsx)("span",{style:(0,o.A)({position:"absolute",pointerEvents:"none"},g)})})},Bc=function(){var e=(0,a.A)((function*(e=100){return yield new Promise((t=>setTimeout(t,e))),(()=>{var e,t;const{currentAction:n,actionMessages:i,messageCursor:s}=fl.t_.getState();return null!==(t=(null!==(e=i[n])&&void 0!==e?e:[])[s])&&void 0!==t?t:""})()}));return function(){return e.apply(this,arguments)}}();var Oc=n(40165);const Dc=()=>{const{barVisible:e,boxVisible:t,setBarVisible:n}=(0,fl.t_)(),i=function(){const[e,t]=(0,z.useState)(!1),{inputText:n}=(0,fl.t_)(),i=(0,se.l)((e=>e.isShowQuick)),[s]=(0,Si.Y)("quickDisabledHosts"),[o]=(0,Si.Y)("quickDisabledAll"),a=null==s?void 0:s.includes(window.location.host);return(0,z.useEffect)((()=>{t(!!n&&(0,yl.C3)([r.G2O]))}),[n]),!i||a||o||e}(),[s,l]=(0,z.useState)((new Date).getTime()),[c,d]=(0,z.useState)(!0),{baseInfo:u,isContextMenu:h}=Vl(),m=u.text,g=(0,z.useRef)(m);(0,z.useEffect)((()=>{const e=Boolean(m);n(e),g.current!==m&&(io.on.getState().setFloatingCardVisible(e),e&&io.on.getState().setSummaryActionVisible(!1),g.current=m)}),[m]);const p=function(){var e=(0,a.A)((function*(){const e=yield Bc(),{currentAction:t}=fl.t_.getState(),n={button_name:t,message_id:e};if(t===Gn.EU.translate){let e="Auto Detect";try{const t=yield(0,he.od)(m);e=(0,Oc.S)(t)||"Auto Detect"}catch(i){}return(0,o.A)({before_language:e,after_language:(0,X.TK)("translateLanguage")},n)}return n}));return function(){return e.apply(this,arguments)}}();return(0,z.useEffect)((()=>{t&&(d(!1),l((new Date).getTime()),p().then((e=>{(0,Ml.x$)(e)}))),t||c||(0,Ml.gy)({duration:(new Date).getTime()-s})}),[t]),t?(0,K.jsx)(Mc,{selectionData:u}):!e||h||i?null:(0,K.jsx)(Pc,{selectionData:u})};var Fc=n(83826),Uc=n(85830);const Hc=e=>(0,K.jsxs)("svg",(0,o.A)((0,o.A)({xmlns:"http://www.w3.org/2000/svg",width:26,height:31,fill:"none",viewBox:"0 0 26 31"},e),{},{children:[(0,K.jsxs)("g",{filter:"url(#mouse_svg__a)",children:[(0,K.jsxs)("mask",{id:"mouse_svg__b",width:31.553,height:32.651,x:-7.203,y:-6.184,fill:"#000",maskUnits:"userSpaceOnUse",children:[(0,K.jsx)("path",{fill:"#fff",d:"M-7.203-6.184H24.35v32.651H-7.203z"}),(0,K.jsx)("path",{d:"m5.126 4.393 13.796 10.33-6.814 1.472-5.135 5.257z"})]}),(0,K.jsx)("path",{fill:"#000",d:"m5.126 4.393 13.796 10.33-6.814 1.472-5.135 5.257z"}),(0,K.jsx)("path",{fill:"#fff",d:"m5.126 4.393 1.198-1.601L2.642.035l.495 4.573zm13.796 10.33.423 1.954 4.287-.927-3.511-2.629zm-6.814 1.472-.422-1.954-.588.127-.42.43zm-5.135 5.257-1.988.216.456 4.214 2.963-3.032zM3.927 5.994l13.797 10.33 2.397-3.203L6.324 2.791zm14.572 6.773-6.813 1.474.845 3.91 6.814-1.474zm-7.821 2.03-5.135 5.258 2.86 2.795 5.136-5.257zm-1.716 6.44L7.114 4.177l-3.977.431 1.848 17.06z",mask:"url(#mouse_svg__b)"})]}),(0,K.jsx)("defs",{children:(0,K.jsxs)("filter",{id:"mouse_svg__a",width:25.311,height:30.169,x:.481,y:.035,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,K.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,K.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,K.jsx)("feOffset",{dy:2.161}),(0,K.jsx)("feGaussianBlur",{stdDeviation:1.08}),(0,K.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,K.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.12 0"}),(0,K.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_8224_23498"}),(0,K.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_8224_23498",result:"shape"})]})})]})),zc="summarizeOnboarding-bjgvPs",qc="card-VE1owl",Vc="mouse-RYBJj5",$c="clickMe-_5_fCR",Kc=({onClose:e})=>(0,K.jsxs)("div",{className:zc,children:[(0,K.jsx)("div",{className:qc,children:(0,K.jsx)(Uc.A,{onSummarize:()=>{e()}})}),(0,K.jsx)("div",{className:Vc,children:(0,K.jsx)(Hc,{})}),(0,K.jsx)("div",{className:$c,children:"Click here"})]}),Wc={"cici-ext-container":"cici-ext-container-tayrPu",ciciExtContainer:"cici-ext-container-tayrPu","inactivelink-hover-animation":"inactivelink-hover-animation-HRqUY6",inactivelinkHoverAnimation:"inactivelink-hover-animation-HRqUY6","notactivelink-hover-animation":"notactivelink-hover-animation-lomsAJ",notactivelinkHoverAnimation:"notactivelink-hover-animation-lomsAJ","light-click-animation":"light-click-animation-iZFe3U",lightClickAnimation:"light-click-animation-iZFe3U","click-animation":"click-animation-ahs_yg",clickAnimation:"click-animation-ahs_yg","semi-animation-rotate":"semi-animation-rotate-BL4TWA",semiAnimationRotate:"semi-animation-rotate-BL4TWA","inactive-btn-hover-animation":"inactive-btn-hover-animation-sxuohd",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-sxuohd","cici-ext-always-dark":"cici-ext-always-dark-jf13oz",ciciExtAlwaysDark:"cici-ext-always-dark-jf13oz","cici-ext-always-light":"cici-ext-always-light-THiaY_",ciciExtAlwaysLight:"cici-ext-always-light-THiaY_",ellipsis:"ellipsis-U4IiL4",floatBtn:"floatBtn-CjYdnn",left:"left-XFEjgX",right:"right-EKGjLV",floatBtnWrapper:"floatBtnWrapper-D6516N",reverse:"reverse-ycUQf6",floatBtnList:"floatBtnList-iGgAce",floatBtnBrand:"floatBtnBrand-DnIPgk",show:"show-D28vkP",expand:"expand-uTJJDF",toolDivider:"toolDivider-BKJgFG",floatBtnPanelItem:"floatBtnPanelItem-efEC8W",toolContainer:"toolContainer-cfl5wc",floatBtnPanelItemBlock:"floatBtnPanelItemBlock-r06VPi",floatBtnPanelItemIcon:"floatBtnPanelItemIcon-l8mIbk",floatBtnPanelItemIconReverse:"floatBtnPanelItemIconReverse-T2KtUO",floatBtnPanelItemIconCollected:"floatBtnPanelItemIconCollected-zM3YDL",floatBtnPanelItemText:"floatBtnPanelItemText-GtXLVZ",floatBtnPanelItemTranslate:"floatBtnPanelItemTranslate-o3CGMp",floatBtnPanelItemLangSettingsIcon:"floatBtnPanelItemLangSettingsIcon-re_b2w",floatBtnPanelItemBlockWithSetting:"floatBtnPanelItemBlockWithSetting-IuDJ96",showLangSettingIcon:"showLangSettingIcon-CXn0JL",active:"active-wXvkas",showLangSettingIconReverse:"showLangSettingIconReverse-FnQPkq",floatBtnPanelLine:"floatBtnPanelLine-fGjRZ9",closeBtn:"closeBtn-MUUSAu",floatBtnClose:"floatBtnClose-f19uOF",floatBtnCloseIcon:"floatBtnCloseIcon-BIhnyV",floatBtnAvatar:"floatBtnAvatar-zS_g4L",float_btn_pad:"float_btn_pad-PTtRJh",floatBtnPad:"float_btn_pad-PTtRJh",float_btn_item_main:"float_btn_item_main-fqtDEM",floatBtnItemMain:"float_btn_item_main-fqtDEM",float_btn_item_main_icon:"float_btn_item_main_icon-rhepOY",floatBtnItemMainIcon:"float_btn_item_main_icon-rhepOY",float_btn_item_main_text:"float_btn_item_main_text-RdYjRN",floatBtnItemMainText:"float_btn_item_main_text-RdYjRN",float_btn_item_divider:"float_btn_item_divider-jP6dmI",floatBtnItemDivider:"float_btn_item_divider-jP6dmI",float_btn_item_setting:"float_btn_item_setting-jxDZ_f",floatBtnItemSetting:"float_btn_item_setting-jxDZ_f",highlight:"highlight-uNeLu1",hide:"hide-YZweor","activelink-hover-animation":"activelink-hover-animation-EE8R_W",activelinkHoverAnimation:"activelink-hover-animation-EE8R_W"};var Gc=n(16456),Yc=n(38062);const Qc=()=>{const e=(0,se.l)((e=>e.setIsShowSidebar));return function(){var t=(0,a.A)((function*(t){try{var n;if((0,b.GT)(),(0,Kn.BB)({action:"web_summary",loginParams:{trackMeta:{login_entrance:"float_btn"}}}))return;(0,Gc.Ie)({button_name:Q._h.summarizePage});const i=window.location.href,s=yield(0,Yc.B9)(),o=(0,fe.wz)((0,X.TK)("uiLanguage"));e(!0,Q.cz.clickSidebar);const a={title:null==s?void 0:s.title,url:i,content:null==s?void 0:s.textContent};io.on.getState().setFloatingCardVisible(!1),io.on.getState().setSummaryActionVisible(!1),yield(0,oo.Z)();const{convId:r,convType:l,mainBotId:c}=(0,qo.IK)(),d={text:i,extraExt:{origin:location.origin,browser_explain:JSON.stringify(a),llm_without_mem:"1",browser_language:o,flag_browser_plugin:"1",answer_with_suggest:"0",need_create_thread:l===ho.He.NewThread?"1":"0"},scene:$n.sJ.chat_action_bar,ctx:(0,so.Pe)(l,r,c)};xi.vF.persist.log({eventName:"summary_page_action",meta:{contentLength:null===(n=a.content)||void 0===n?void 0:n.length,from:"float-btn"}}),se.l.getState().isSidePanelMode&&!Rl._.isInSidePanel?_l.IF.getState().type===gi.u9.pdf?(0,ia.cs)({name:"read-pdf",body:{url:i}}):(0,ia.cs)({name:"send-message-to-chat",body:{msg:d,chatType:l}}):_l.IF.getState().type===gi.u9.pdf?(0,na.M)({url:i}):(Yn.Qz.create("cici_summary_page_action_perf",!0),(0,Ll.C)(d,{chatType:l,sendMessageCallback:e=>{null==t||t((null==e?void 0:e[0].local_message_id)||"")}}))}catch(i){xi.vF.persist.error({eventName:"[FLOAT_BUTTON] - SUMMARIZE",error:i})}}));return function(e){return t.apply(this,arguments)}}()},Jc=()=>{const e=(0,$.B)(),t=Qc();(0,z.useEffect)((()=>On.on("SUMMARIZE PAGE",Pn.PAGE,(()=>{t()}))),[t]);const n=(0,z.useRef)(null);return(0,K.jsx)("div",{ref:n,className:Wc.toolContainer,children:(0,K.jsx)(ce.m_,{content:e("flow_web_ext_sidebar_summarize"),position:"left",getPopupContainer:()=>n.current,children:(0,K.jsx)("div",{className:Wc.floatBtnPanelItemIcon,onClick:()=>{t()},"data-testid":"float-button-read-page",children:(0,K.jsx)(et.oZ9,{})})})})};let Xc=function(e){return e.YOUTUBE_SUMMARIZE="onboarding_youtube_summarize",e.ARTICLE_SUMMARIZE="onboarding_article_summarize",e}({});const Zc=({current_page:e})=>{(0,Y.z8)(Q.Ur.enterPage,{current_page:e})},ed="onboarding-QNMbEE",td=()=>{const[e,t]=(0,z.useState)(!0),n=(0,se.l)((e=>e.setIsShowSidebar)),i=(0,se.l)((e=>e.isSidePanelMode)),s=Qc(),o=location.href===Fc.Qn,a=location.href===Fc.EX;if(a&&Zc({current_page:Xc.ARTICLE_SUMMARIZE}),o&&Zc({current_page:Xc.YOUTUBE_SUMMARIZE}),!e)return null;const r=()=>{(0,Y.z8)(Q.Ur.clickChatFloatCard,{highlight_page:Q.g6.webOther,button_name:Gn.EU.read,module_name:Gc.S1.READ_PAGE,click_from:Q.Z5.onboarding,current_page:Xc.ARTICLE_SUMMARIZE}),s(),history.pushState({},"",Fc.pX),t(!1)};return o?null:a?i?(r(),null):(n(!0,Q.cz.onboarding),(0,K.jsx)("div",{className:ed,children:(0,K.jsx)(Kc,{onClose:r})})):null};var nd=n(53683);var id=n(37462);const sd=(e,[t,n])=>Math.min(Math.max(e,t),n),od={prevent:!0,direction:"both",maxDistance:{x:{max:1/0,min:-1/0},y:{max:1/0,min:-1/0}},setCSS:!0,onStart:id.A,onMove:id.A,onEnd:id.A},ad=e=>{const t=(0,z.useMemo)((()=>(0,o.A)((0,o.A)({},od),e)),[e]),n=(0,z.useRef)(null),i=(0,z.useRef)(null),s=(0,z.useRef)([0,0]),a=(0,z.useRef)([0,0]),r=(0,z.useRef)([0,0]),l=(0,z.useRef)(!1),[c,d]=(0,z.useState)([0,0]),u=(0,z.useCallback)(((e,n)=>{r.current=e,d(e),i.current&&t.setCSS&&(i.current.style.transition=n||"",i.current.style.transform=`translate3d(${e[0]}px, ${e[1]}px, 0)`)}),[t.setCSS]),h=(0,z.useCallback)((e=>{var i;null===(i=n.current)||void 0===i||i.setPointerCapture(e.pointerId);const[o,c]=r.current;let[d,h]=r.current;l.current=!0,d=e.clientX-o,h=e.clientY-c,a.current=[e.clientX,e.clientY],s.current=[d,h],t.onStart(n,[d,h],u),e.preventDefault()}),[t,u]),m=(0,z.useCallback)((e=>{var i,o,a,c,d,h,m,g;if(!l.current)return;t.prevent&&e.preventDefault();const[p,v]=s.current;let[f,_]=r.current;f=e.clientX-p,_=e.clientY-v,f="vertical"===t.direction?0:sd(f,[null!==(i=null===(o=t.maxDistance)||void 0===o||null===(o=o.x)||void 0===o?void 0:o.min)&&void 0!==i?i:-1/0,null!==(a=null===(c=t.maxDistance)||void 0===c||null===(c=c.x)||void 0===c?void 0:c.max)&&void 0!==a?a:1/0]),_="horizontal"===t.direction?0:sd(_,[null!==(d=null===(h=t.maxDistance)||void 0===h||null===(h=h.y)||void 0===h?void 0:h.min)&&void 0!==d?d:-1/0,null!==(m=null===(g=t.maxDistance)||void 0===g||null===(g=g.y)||void 0===g?void 0:g.max)&&void 0!==m?m:1/0]),t.onMove(n,[f,_],u),u([f,_])}),[l,t,u]),g=(0,z.useCallback)((e=>{const[i,s]=a.current,o=Math.abs(e.clientX-i),c=Math.abs(e.clientY-s);var d;o<=4&&c<=4&&(null===(d=t.onClickLike)||void 0===d||d.call(t));l.current=!1,t.onEnd(n,r.current,u)}),[t,u]);return(0,z.useEffect)((()=>{const e=n.current;return null==e||e.addEventListener("pointerdown",h),null==e||e.addEventListener("pointermove",m),null==e||e.addEventListener("pointerup",g),null==e||e.addEventListener("pointercancel",g),()=>{null==e||e.removeEventListener("pointerdown",h),null==e||e.removeEventListener("pointermove",m),null==e||e.removeEventListener("pointerup",g),null==e||e.removeEventListener("pointercancel",g)}}),[n,t,h,m,g]),{anchor:n,target:i,position:c,setPosition:u}};var rd=n(30896);const ld={active:!1,showOrigin:!0,autoTranslate:!1,showLangNotice:!1},cd=(0,ii.vt)()((0,ni.eh)((e=>(0,o.A)((0,o.A)({},ld),{},{setActive:t=>{e((()=>({active:t})))},setShowOrigin:t=>{e((()=>({showOrigin:t})))},setAutoTranslate:t=>{e((()=>({autoTranslate:t})))},setShowLangNotice(t){e((()=>({showLangNotice:t})))}}))));var dd=n(75471),ud=n(566);const hd=function(){var e=(0,a.A)((function*(e,t=.7){if(0!==e.length)try{const{infos:n}=yield(0,ci.jI)(e),i=function(e){const t={};return e.forEach((({lang_code:e})=>{"not_lang"!==e&&(t[e]=(t[e]||0)+1)})),t}(n),s=(0,dd.A)(Object.values(i));let o,a=0;for(const[e,t]of Object.entries(i))t>a&&(o=e,a=t);if(o&&a/s>=t)return o}catch(n){}}));return function(t){return e.apply(this,arguments)}}(),md=(e,t=.7)=>Promise.race([hd(e,t),new Promise((e=>setTimeout(e,2e3)))]),gd=(e=50)=>{const t=[];for(let a=0;a<4;a++)t.push([]);const n=document.querySelectorAll(`.${At}`);let i=0;const s=Math.ceil(2)-1;for(const a of n){if(!a.textContent)continue;const n=(0,ud.UU)(a.textContent),o=n.length,r=Math.min(Math.floor(o/20),3);if(t[r].push(n),r>s&&i++,i>=e)break}const o=[];i=0;for(let a=3;a>=0;a--){if(0===a&&o.length>=20)return o;for(const n of t[a])if(o.push(n),i++,i>=e)return o}return o};var pd=n(5687),vd=n(89380);var fd=n(51747);const _d=`\n.${Nt} {\n  display: block;\n}\n\n.${Nt}.__Cici_translate_Safari__ {\n  display: inline;\n}\n\n.${Nt}[data-translating="true"] {\n  display: inline;\n}\n.${Nt}:has(> .${wt}) {\n  display: inline;\n}\n/* \u9690\u85cf\u539f\u6587\u65f6\u5982\u679c\u7ffb\u8bd1\u5185\u5bb9\u4e00\u81f4\u9700\u8981\u663e\u793a\u539f\u8282\u70b9\u7684\u514b\u9686\u8282\u70b9 */\n.${jt}\n  .${bt}\n  .${At} {\n  display: inline-block !important;\n}\n.${jt}\n  .${Nt}[data-translating="true"]\n  .${At} {\n  display: inline-block !important;\n}\n/* \u7ffb\u8bd1\u5185\u5bb9\u6837\u5f0f */\n.${Tt} .${Nt} .${wt} > span {\n  background: linear-gradient( to right, rgba(162, 162, 162, .5) 0%, rgba(162, 162, 162, .5) 50%, transparent 50%, transparent 100% ) repeat-x left bottom;\n  background-size: 8px 1px;\n  padding-bottom: 2px;\n}\n/* \u5982\u679c\u7ffb\u8bd1\u5185\u5bb9\u4e00\u81f4\u4e0d\u663e\u793a\u7ffb\u8bd1\u5185\u5bb9 */\n.${Nt}.${bt}\n  .${wt} {\n  display: none !important;\n}\n.${jt}\n  .${Nt}\n  .${St} {\n  margin: 0 !important;\n}\n.${Nt} .${St} {\n  margin: 8px 0 !important;\n}\n/* \u53bb\u9664\u539f\u6587\u4e2d\u7236\u5143\u7d20\u8bbe\u7f6e\u7684\u6ea2\u51fa\u9690\u85cf */\n.${Et} .${It} {\n  -webkit-line-clamp: unset !important;\n  max-height: unset !important;\n}\n/* loading\u6837\u5f0f */\n.${kt} {\n  width: 22px !important;\n  height: 22px !important;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n}\n.${kt} > i {\n  vertical-align: middle !important;\n  width: 10px !important;\n  height: 10px !important;\n  display: inline-block !important;\n  margin: 0 4px !important;\n  border: 2px rgba(221, 244, 255, 0.6) solid !important;\n  border-top: 2px rgba(0, 0, 0, 0.375) solid !important;\n  border-left: 2px rgba(0, 0, 0, 0.375) solid !important;\n  border-radius: 50% !important;\n  padding: 0 !important;\n  -webkit-animation: cici-translate-loading-animation 0.6s infinite\n    linear !important;\n  animation: cici-translate-loading-animation 0.6s infinite linear !important;\n}\n\n@-webkit-keyframes cici-translate-loading-animation {\n  from {\n    -webkit-transform: rotate(0deg);\n  }\n\n  to {\n    -webkit-transform: rotate(359deg);\n  }\n}\n\n@keyframes cici-translate-loading-animation {\n  from {\n    transform: rotate(0deg);\n  }\n\n  to {\n    transform: rotate(359deg);\n  }\n}\n`,yd=(0,fd.A)((()=>{const e=document.createElement("style");e.setAttribute("data-id","CiciTranslateGlobalStyle"),e.innerHTML=_d,(0,u.EY)(e)})),xd=e=>e.map((e=>{const t=document.createElement("font");t.classList.add(Nt);const n=document.createElement("font");return n.classList.add(At),n.style.display="none",e.forEach(((i,s)=>{const o=i.cloneNode(!0);if(o instanceof HTMLElement&&o.setAttribute("data-text-content",o.textContent||""),n.appendChild(o),s===e.length-1){var a;if(i.nextSibling instanceof HTMLElement&&i.nextSibling.classList.contains(Nt))return;t.appendChild(n),null===(a=i.parentNode)||void 0===a||a.insertBefore(t,i.nextSibling)}})),Ad(t),t})),bd=e=>{const t=e.childNodes;for(let n=0;n<t.length;n++){const i=t[n];i.nodeType===Node.COMMENT_NODE?(e.removeChild(i),n--):i instanceof HTMLElement&&bd(i)}},Ad=e=>{const{parentElement:t}=e;if(t){const e=window.getComputedStyle(t).getPropertyValue("-webkit-line-clamp");if(e&&"none"!==e)return void t.classList.add(It)}const n=null==t?void 0:t.parentElement;if(n){const e=window.getComputedStyle(n).getPropertyValue("-webkit-line-clamp");if(e&&"none"!==e)return void n.classList.add(It)}};function wd(e){const t=e.match(/^<(\w+)\s+.*?>/);return t?t[0]:""}const Sd=["a","code","em","mark","strong"],Cd=["code"];const kd={encode:function e(t,n={tags:[]}){const i=(0,vd.A)(t);let s="";for(const o of i){if((0,ud.DC)(o))continue;if(!(o instanceof HTMLElement)){s+=o.textContent||"";continue}const t=(0,ud.UU)(o.getAttribute("data-text-content")||"");if(""!==t&&""===(0,ud.UU)(o.textContent||"")){s+=t;continue}const i=o.tagName.toLowerCase();if(Sd.includes(i)){const t=o.cloneNode();t.removeAttribute("data-text-content");const a=wd(t.outerHTML)||`<${i}>`;n.tags.push({open:a,name:i,originContent:(0,ud.UU)((0,ud.OP)(o.textContent||""))});const r=n.tags.length-1,{output:l}=e(Array.from(o.childNodes),n);s+=`<b${r}>${l}</b${r}>`;continue}const{output:a}=e(Array.from(o.childNodes),n);s+=a}return{output:(0,ud.UU)(s),tags:n.tags}},decode:function(e,t,n){return t=function(e,t,n){return t=t.replaceAll(/(^["'\n]*)|(["'\n]*$)/g,""),1===n.length&&/^\s*<b\d+>[\s\S]*?<\/b\d+>\s*$/.test(e)&&!/<\/?\s*b\s*\d+\s*>/.test(t)?`<b0>${t}</b0>`:t}(e,t,n),(0,pd.A)(n,((e,n)=>{const{open:i,name:s,originContent:o}=e,a=new RegExp(`<\\s*b\\s*${n}\\s*>([\\s\\S]*?)<\\s*/\\s*b\\s*${n}\\s*>`),r=Cd.includes(s)?`${i}${o}</${s}>`:`${i}$1</${s}>`;t=t.replace(a,r)})),t=t.replaceAll(/<\s*\/?\s*b\s*\d+\s*>/g,"")}};let Id=function(e){return e.PASS="PASS",e.BLOCK="BLOCK",e.INNER="INNER",e}({});var Ed=n(41104);const Td=e=>{const{root:t,strategyFilters:n}=e,i=(0,vd.A)(t);let s=[];const o=[];for(const a of i){const{childNodes:e}=a,t=Array.from(e);for(const i of t)jd({curNode:i,childNode2D:s,tempTextList:o,strategyFilters:n})}return s=s.map((e=>e.filter((e=>{var t;return(null==n||null===(t=n.paragraphChild)||void 0===t?void 0:t.call(n,e))!==Id.BLOCK})))).filter((e=>e.length)),s},jd=e=>{var t;const{curNode:n,childNode2D:i,tempTextList:s,strategyFilters:o}=e;let a=!1,r=!1;if(!(0,ud.mp)(n))return void Md({childNode2D:i,tempTextList:s});const l=null==o||null===(t=o.traverse)||void 0===t?void 0:t.call(o,n);if(l!==Id.BLOCK){if(n instanceof HTMLElement)if(l===Id.PASS)a=!0;else{const{display:e,isBlockOrTableDisplay:t}=(0,ud.ZG)(n);"grid"===e||(0,ud.xd)(n)||n.matches(Ed.wU.join(","))||(t?a=!0:(s.push(n),r=!0))}if(n.nodeType===Node.TEXT_NODE&&(s.push(n),r=!0),!r)if(Md({childNode2D:i,tempTextList:s}),a)i.push(Nd(n));else if(n.childNodes.length&&n instanceof HTMLElement){const e=Td({root:n,strategyFilters:o});i.push(...e)}n.nextSibling||Md({childNode2D:i,tempTextList:s})}else Md({childNode2D:i,tempTextList:s})},Nd=e=>{const{childNodes:t}=e,n=Array.from(t).filter((e=>!(0,ud.DC)(e)&&!(0,ud.W$)(e)));return 1===n.length&&n[0]instanceof HTMLElement?Nd(n[0]):Array.from(e.childNodes).filter((e=>!(0,ud.DC)(e)))},Md=e=>{const{childNode2D:t,tempTextList:n}=e;if(!n.length)return;const i=n[0];if(1===n.length&&i instanceof HTMLElement)return t.push(Nd(i)),void(n.length=0);t.push(n.slice(0)),n.length=0},Ld=e=>{const{root:t=document.body,strategyFilters:n}=e||{};return Td({root:t,strategyFilters:n})};var Rd=n(77793);const Pd=new class{constructor(){(0,f.A)(this,"cache",new Map),(0,f.A)(this,"_getCacheKey",((e,t,n)=>[e,t,n].join("##"))),(0,f.A)(this,"add",((e,t,n,i)=>{const s=this._getCacheKey(e,t,n);this.cache.delete(s),this.cache.size>=500&&this.cache.delete(this.cache.keys().next().value),this.cache.set(s,i)})),(0,f.A)(this,"get",((e,t,n)=>{const i=this._getCacheKey(e,t,n);return this.cache.get(i)}))}};var Bd=n(7728);let Od=Gl.th.HUOSHAN;const Dd=new Map,Fd=new Set,Ud=(e,t,n)=>{if(!t)return;const{code:i,data:s}=t;if(0!==i)return;const{items:o}=s;for(const a of o){const{res:t,detect_lang:i,index:s}=a,o=e[s];if(!o)continue;const r=i===n?"":t;Pd.add(o.lang,Od,o.content,r);const l=Dd.get(o.id);l&&(l.resolve(r),Dd.delete(o.id))}},Hd=new class{constructor(e,t){(0,f.A)(this,"_batchTaskPromise",null),(0,f.A)(this,"_resolve",null),(0,f.A)(this,"_reject",null),(0,f.A)(this,"_tasks",[]),(0,f.A)(this,"_timer",null),(0,f.A)(this,"_handler",void 0),(0,f.A)(this,"_options",void 0),(0,f.A)(this,"_clearCollectState",(()=>{this._resolve=null,this._reject=null,this._batchTaskPromise=null,this._tasks=[]})),(0,f.A)(this,"_clearScheduledTasks",(()=>{this._timer&&(window.clearTimeout(this._timer),this._timer=null)})),this._handler=e,this._options=(0,o.A)({taskLimit:20,collectDelay:2e3},t)}_exec(){var e=this;return(0,a.A)((function*(){if(0===e._tasks.length)return;const t=e._resolve,n=e._reject,i=[...e._tasks];if(t&&n){e._clearCollectState();try{t(yield e._handler(i))}catch(s){n(s)}}else(0,g.z3)("[BatchAsyncTask] Internal status error, resolve or reject is null")}))()}_run(){null===this._batchTaskPromise&&(this._batchTaskPromise=new Promise(((e,t)=>{this._resolve=e,this._reject=t})));const{taskLimit:e,collectDelay:t}=this._options;-1!==e&&this._tasks.length>=e&&(this._clearScheduledTasks(),this._exec()),this._timer||(this._timer=window.setTimeout((()=>{this._clearScheduledTasks(),this._exec()}),t))}exec(e){return this._tasks.push(e),this._run(),this._batchTaskPromise}destroy(){this._clearCollectState(),this._clearScheduledTasks()}}((e=>new Promise((t=>{0===e.length&&t();const{lang:n}=e[0],i=e.map((e=>e.content)),s=e.map((e=>e.id)),o=Bd.B.fetch({req:{url:`https://${it.FI}/samantha/plugin/stream_article_translate`,body:{raw_text:i,target_lang:n,translate_service:Od}}},{onUpdate:t=>{const{body:i}=t;Ud(e,i,n)},onDone:i=>{const{body:a}=i;Ud(e,a,n),s.forEach((e=>{var t;null===(t=Dd.get(e))||void 0===t||t.resolve(""),Dd.delete(e)})),Fd.delete(o),t()},onError:()=>{s.forEach((e=>{var t;null===(t=Dd.get(e))||void 0===t||t.resolve(""),Dd.delete(e)})),Fd.delete(o),t()},onAbort:()=>{s.forEach((e=>{var t;null===(t=Dd.get(e))||void 0===t||t.resolve(""),Dd.delete(e)})),Fd.delete(o),t()}});Fd.add(o)}))),{taskLimit:50,collectDelay:500});function zd(){return zd=(0,a.A)((function*(e,t){const n=Pd.get(t,Od,e);if(n)return Promise.resolve(n);const i=(0,Rd.A)();return Hd.exec({id:i,content:e,lang:t}),new Promise((e=>{Dd.set(i,{resolve:e})}))})),zd.apply(this,arguments)}var qd=function(e){return e.INIT="INIT",e.RUNNING="RUNNING",e}(qd||{});class Vd{constructor(e){var t=this;(0,f.A)(this,"state",qd.INIT),(0,f.A)(this,"disconnectObserveIntersection",void 0),(0,f.A)(this,"disconnectObserveNewElement",void 0),(0,f.A)(this,"opts",void 0),(0,f.A)(this,"targetLang",void 0),(0,f.A)(this,"translateInPlace",!1),(0,f.A)(this,"originParagraphElementRelations",[]),(0,f.A)(this,"start",((e,t)=>{this.targetLang=e,function(e){Od=e}(t),this.clearTranslate(),this.state=qd.RUNNING,this.startTranslate()})),(0,f.A)(this,"clearInjectTranslateNode",(e=>{const t=(0,vd.A)(e);for(const n of t){n.querySelectorAll(`.${Nt}`).forEach((e=>e.remove()))}})),(0,f.A)(this,"clearTranslate",(()=>{var e,t;(()=>{for(const[,e]of Dd)e.resolve("");Dd.clear();for(const e of Fd)Bd.B.abort(e,"");Fd.clear()})(),this.state=qd.INIT,document.body.classList.remove(Et),this.doShowOriginContent(),this.originParagraphElementRelations=[],null===(e=this.disconnectObserveIntersection)||void 0===e||e.call(this),null===(t=this.disconnectObserveNewElement)||void 0===t||t.call(this),this.clearInjectTranslateNode(document.body)})),(0,f.A)(this,"doShowOriginContent",(()=>{for(const e of this.originParagraphElementRelations){const[t,n]=e;(0,pd.A)(n,(e=>{t.insertBefore(e,t.firstChild)}))}})),(0,f.A)(this,"showOriginContent",(()=>{var e;(this.translateInPlace=!1,document.body.classList.remove(jt),this.isTranslating)&&(null===(e=this.disconnectObserveNewElement)||void 0===e||e.call(this),this.doShowOriginContent(),this.originParagraphElementRelations=[],requestAnimationFrame((()=>this.observeNewElement(document.body))))})),(0,f.A)(this,"translatedTextShowUnderline",(e=>{e?document.body.classList.add(Tt):document.body.classList.remove(Tt)})),(0,f.A)(this,"doHideOriginContent",(e=>{for(const n of e){const[e,i]=n;for(const n of i)try{e.removeChild(n)}catch(t){}}})),(0,f.A)(this,"hideOriginContent",(()=>{this.translateInPlace=!0,document.body.classList.add(jt),this.isTranslating&&(this.originParagraphElementRelations=this.collectOriginParagraphRelation(),this.doHideOriginContent(this.originParagraphElementRelations))})),(0,f.A)(this,"collectOriginParagraphRelation",(e=>{const t=[],n=(e||document).querySelectorAll(`.${Nt}`);for(const i of n){const e=i.parentElement;if(!e)continue;const n=[];for(const t of e.childNodes){if(t===i)break;n.push(t)}t.push([e,n])}return t})),(0,f.A)(this,"hideTranslate",(()=>{document.querySelectorAll(`.${wt}, .${kt}, .${Ct}`).forEach((e=>{e instanceof HTMLElement&&(e.style.display="none")}))})),(0,f.A)(this,"showTranslate",(()=>{document.querySelectorAll(`.${wt}, .${kt}, .${Ct}`).forEach((e=>{if(e instanceof HTMLElement){const t=e.classList.contains(St);e.style.display=t?"block":"inline-block"}}))})),(0,f.A)(this,"startObserverIntersection",(e=>{const t=e||document,n=Array.from(t.querySelectorAll(`.${Nt}`)).filter((e=>e instanceof HTMLElement)).filter((e=>{const t=e.querySelector(`.${At}`);var n,i;return!t||(null===(n=this.opts.strategyFilters)||void 0===n||null===(i=n.paragraph)||void 0===i?void 0:i.call(n,t))!==Id.BLOCK}));n.length&&this.observerIntersection(n)})),(0,f.A)(this,"getTraverseRoot",((e=document.body)=>{var t;let n=[e];return null!==(t=this.opts.onlyNeedIncludeSelectors)&&void 0!==t&&t.length&&(n=Array.from(e.querySelectorAll(this.opts.onlyNeedIncludeSelectors.join(", ")))),n})),(0,f.A)(this,"startTranslate",(()=>{document.body.classList.add(Et),yd();const e=this.getTraverseRoot(this.opts.root),t=Ld({strategyFilters:this.opts.strategyFilters,root:e});xd(t),this.translateInPlace&&this.hideOriginContent(),this.startObserverIntersection(),this.observeNewElement(document.body)})),(0,f.A)(this,"newNodeOnlyNeedIncludeSelectorsCheck",(e=>{const t=this.opts.onlyNeedIncludeSelectors;if(null!=t&&t.length){const n=[...t,...t.map((e=>`:has(${e})`))].join(", ");return e.matches(n)}return!0})),(0,f.A)(this,"amendNewElementNode",(e=>{const t=this.opts.onlyNeedIncludeSelectors;if(null!=t&&t.length){if(e.matches(t.join(", ")))return e;if(e.matches(t.map((e=>`:has(${e})`)).join(", ")))return Array.from(e.querySelectorAll(t.join(", ")))}return e})),(0,f.A)(this,"observeNewElement",(e=>{var n;null===(n=this.disconnectObserveNewElement)||void 0===n||n.call(this);const i=new MutationObserver(((e,n)=>{for(const i of e)"childList"===i.type&&i.addedNodes.length>0&&i.addedNodes.forEach(function(){var e=(0,a.A)((function*(e){if(yield new Promise((e=>setTimeout(e,1e3))),e instanceof HTMLElement&&!t.hasElementTranslateRelated(e)&&t.newNodeOnlyNeedIncludeSelectorsCheck(e)){const n=t.amendNewElementNode(e);t.clearInjectTranslateNode(n);const i=Ld({strategyFilters:t.opts.strategyFilters,root:n});if(xd(i),t.translateInPlace){const n=t.collectOriginParagraphRelation(e);t.originParagraphElementRelations.push(...n),t.doHideOriginContent(n)}t.startObserverIntersection(e)}}));return function(t){return e.apply(this,arguments)}}())}));i.observe(e,{childList:!0,subtree:!0}),this.disconnectObserveNewElement=()=>i.disconnect()})),(0,f.A)(this,"observerIntersection",(e=>{const t=new IntersectionObserver((e=>{e.forEach((e=>{const n=e.target;n instanceof HTMLElement&&e.isIntersecting&&(this.reqTranslateTextList(n),t.unobserve(n))}))}));e.forEach((e=>{t.observe(e)})),this.disconnectObserveIntersection=()=>t.disconnect()})),(0,f.A)(this,"reqTranslateTextList",function(){var e=(0,a.A)((function*(e){const n=e.querySelector(`.${At}`);if(n instanceof HTMLElement&&(bd(n),t.clearRetryElement(e),!t.hasElementTranslated(e)))try{const i=kd.encode(n),s=i.output;if(""===s)return;t.addLoadingElement(e);let o=yield function(e,t){return zd.apply(this,arguments)}(s,t.targetLang);const a=""===o;a&&(o=s);const r=kd.decode(s,o,i.tags);((e,t,n,i)=>{const{needWrap:s,contentSimilar:o=!1}=i,a=document.createElement("font");a.style.display=s?"block":"inline-block",a.innerHTML=`<span>${n}</span>`,a.classList.add(wt),s&&a.classList.add(St),((0,ud.iw)(t,a.textContent||"")||o)&&e.classList.add(bt);const r=document.createTextNode(" ");s||e.appendChild(r),e.appendChild(a)})(e,s,r,{needWrap:function(e){let t=0;for(const n of e)t+=encodeURIComponent(n).length>1?2:1;return t}((0,pa.A)((0,ud.UU)(n.textContent||"")))>=t.breakLineNumber,contentSimilar:a})}catch(i){t.addRetryElement(e)}finally{t.clearLoadingElement(e)}}));return function(t){return e.apply(this,arguments)}}()),(0,f.A)(this,"addLoadingElement",(e=>{e.setAttribute("data-translating","true");const t=document.createElement("font");t.classList.add(kt),t.appendChild(document.createElement("i")),t.style.display="inline-block",e.appendChild(t)})),(0,f.A)(this,"clearLoadingElement",(e=>{e.removeAttribute("data-translating");e.querySelectorAll(`.${kt}`).forEach((e=>e.remove()))})),(0,f.A)(this,"addRetryElement",(e=>{const t=document.createElement("font");t.classList.add(Ct),t.style.display="inline-block",t.addEventListener("click",(t=>{t.stopPropagation(),this.reqTranslateTextList(e)})),e.appendChild(t)})),(0,f.A)(this,"clearRetryElement",(e=>{e.querySelectorAll(`.${Ct}`).forEach((e=>e.remove()))})),(0,f.A)(this,"hasElementTranslated",(e=>{const t=[wt,Ct,kt].map((e=>`.${e}`)).join(",");if(e.matches(t))return!0;return!!e.querySelectorAll(t).length})),(0,f.A)(this,"hasElementTranslateRelated",(e=>{const t=[`.${Nt}`],n=t.map((e=>`${e} *`));if(e.matches([...t,...n].join(", ")))return!0;if(e.lastChild instanceof HTMLElement&&e.lastChild.matches(t.join(", ")))return!0;let i=e.nextElementSibling;for(;i;){if(i.matches(t.join(", ")))return!0;i=i.nextElementSibling}return!1})),this.opts=e,this.targetLang=Ed.Sx}get breakLineNumber(){var e;return null!==(e=this.opts.breakLineNumber)&&void 0!==e?e:40}get isTranslating(){return this.state===qd.RUNNING}}var $d=n(48485);const Kd=[".notranslate","[translate=no]","footer","aside","nav","img","base","link","style","meta","s","audio","video","track","map","area","iframe","embed","object","source","canvas","noscript","script","form","input","label","button","datalist","fieldset","legend","meter","optgroup","option","output","progress","select","details","summary","dialog","menu","slot","template","svg","math","cite","time"],Wd=[...Kd,Kd.map((e=>`${e} *`))].join(", "),Gd=[8],Yd=[{tag:"New York Times \u65b0\u95fb\u5185\u5bb9\u9875",urlMatch:/nytimes\.com/,includeSelectors:["article#story header",".article-header header"]},{tag:"People",urlMatch:/people\.com/,excludeSelectors:["[id^=article-meta-dynamic]"]},{tag:"Google",urlMatch:/google\.com/,excludeSelectors:["#slim_appbar","g-scrolling-carousel","[role=navigation]"]},{tag:"Bing",urlMatch:/bing\.com/,excludeSelectors:["#b_tween"]},{tag:"Youtube",urlMatch:/youtube\.com/,exactUseSelectors:["#description-inline-expander #snippet"],excludeSelectors:["ytd-feed-filter-chip-bar-renderer","#footer","ytd-comment-thread-renderer #header","ytd-video-meta-block","ytd-thumbnail-overlay-time-status-renderer","ytd-masthead","ytd-mini-guide-renderer",".caption-window","ytd-video-owner-renderer","ytd-subscribe-button-renderer","ytd-menu-renderer","ytd-comments-header-renderer","ytd-comment-action-buttons-renderer","yt-touch-feedback-shape","ytd-comment-replies-renderer","yt-pdg-comment-chip-renderer","ytd-watch-info-text #info-container","tp-yt-paper-tooltip #tooltip",".ytd-channel-name","#metadata-line"]},{tag:"New York Post",urlMatch:/nypost\.com/,includeSelectors:["main header"]},{tag:"Daily Mail Online",urlMatch:/dailymail.co.uk/,excludeSelectors:["#page-container .h1-page-last-updated",".article-icon-links","#articleIconLinksContainer",".dms-puff",".rss_feeds_buttons_wrapper",".related-replace-count-wrap","#socialLinks"]},{tag:"The Washington Post",urlMatch:/washingtonpost\.com/,includeSelectors:["main header"],excludeSelectors:["[data-qa=article-actions]"]},{tag:"CNBC",urlMatch:/cnbc\.com/,includeSelectors:[".PageBuilder-page header"],exactUseSelectors:[".group > p"],excludeSelectors:[".QuickLinks-container",".MarketsBanner-container",".MarketMoversPlus-container","#cnbc-tv-container",".RiverByline-authorBylineContainer",".Card-threeUpCardFooterStyle",".Card-cardFooter",".QuoteFinder-container"]},{tag:"Forbes",urlMatch:/forbes\.com/,excludeSelectors:[".byline__author-group",".happening__metrics",".data-viz__timestamp",".article-footer .footer-row",".contrib-container"]},{tag:"Amazon",urlMatch:/amazon\.com/,includeSelectors:["header#navbar-main","form#addToCart"],excludeSelectors:["#navFooter","header#navbar-main #nav-belt","#wayfinding-breadcrumbs_container","[id*=hero-quick-promo]",".sp_desktop_sponsored_label"]},{tag:"Twitter",urlMatch:/twitter\.com/,includeSelectors:["header[role=banner]","nav[role=navigation]"],excludeSelectors:["[data-testid=reply]","[data-testid=retweet]","[data-testid=like]","[data-testid=app-text-transition-container]"]},{tag:"Baidu",urlMatch:/baidu\.com/,excludeSelectors:["#head","#s_tab",".c-icon","#page","[tpl=jy_hy_poem_precise_san]"]},{tag:"wikipedia",urlMatch:/wikipedia\.org/,includeSelectors:["nav[role=navigation]","main#content > header"],excludeSelectors:["#advancedSiteNotices","#section_SpokenWikipedia",".reflist",".refbegin"]},{tag:"yandex",urlMatch:/yandex\.com/,excludeSelectors:[".Organic-Subtitle"]},{tag:"reddit",urlMatch:/reddit\.com/,includeSelectors:["reddit-sidebar-nav nav","reddit-sidebar-nav nav *"],excludeSelectors:["[slot=credit-bar]","[slot=commentMeta]","faceplate-hovercard"]},{tag:"pinterest",urlMatch:/pinterest\.com/,excludeSelectors:["[data-test-id=unauth-header]","[data-test-id=header-Header]","[data-test-id=pointer-events-wrapper]","[data-test-id=comments-time-passed]","[data-test-id=comment-reply-button-container]","[data-test-id=comment-reaction-container-entry-point]","[data-test-id=comment-more-options]","[data-test-id=creator-card-profile]"]},{tag:"weather",urlMatch:/weather\.com/,includeSelectors:[".regionSidebar","[data-testid=HeaderTitle]"],excludeSelectors:["[data-testid=TemperatureValue]",".region-meta",".regionTopAds",".regionHeader"]},{tag:"eBay",urlMatch:/ebay\.com/,excludeSelectors:[".vl-flyout-nav",".vlp-merch-price",".x-evo-atf-breadcrumbs","[data-testid=x-bin-action]","[data-testid=ux-call-to-action]",".recs-price",".fdbk-container__details__info"]},{tag:"Newsweek",urlMatch:/newsweek\.com/,includeSelectors:["#header-container header"],excludeSelectors:[".news-author",".news-read-time",".subscription-tabs",".main-footer",".news-author-container",".newsletter-signup-horizontal",".article_pubTime"]},{tag:"wsj",urlMatch:/wsj\.com/,excludeSelectors:["header[role=banner]","[class*=market-data-strip]","[class*=summaryText] + [class*=stats]",'[aria-label="Markets summary"]',"[class*=AuthoringContent]"]},{tag:"apnews",urlMatch:/apnews\.com/,excludeSelectors:[".ap_banner-container","bsp-header",".Page-trending",".PagePromo-date",".StoryPage-actions-wrapper",".Page-authorInfo"]},{tag:"nbcnews",urlMatch:/nbcnews\.com/,includeSelectors:["header.article-hero__header"],excludeSelectors:["[data-testid=marqueeBreaking]","[class*=teaseTimestamp]",".related-content-tease__badge-label","[data-testid=unibrow-container]","[data-testid=right-rail-container]","[data-activity-map=inline-byline-article-top]","[data-activity-map=expanded-byline-article-bottom]","[data-testid=taboola-content]"]},{tag:"cbsnews",urlMatch:/cbsnews\.com/,includeSelectors:["header.content__header"],excludeSelectors:[".item__metadata","#component-taboola-below-homepage-feed",".slug--topic-stacks",".content__meta-wrapper"]},{tag:"Linkedin",urlMatch:/linkedin\.com/,includeSelectors:["aside:has(#org-right-rail)",".org-about-module-wrapper header"],exactUseSelectors:[".org-about-module__description"]},{tag:"Medium",urlMatch:/medium\.com/,excludeSelectors:["pre"]},{tag:"stackoverflow",urlMatch:/stackoverflow\.com/,excludeSelectors:["[id*=question-summary] .s-post-summary--stats",".s-post-summary--meta",".user-info",".comment-date",".comment-user"]},{tag:"BuzzFeed",urlMatch:/buzzfeed\.com/,excludeSelectors:[".embed-action-bar","[class*=backToTop]"]},{tag:"POLITICO",urlMatch:/politico\.com/,excludeSelectors:[".meta__details"]},{tag:"Docx",urlMatch:/larkoffice\.com/,includeSelectors:[".notranslate",".notranslate *"]}],Qd=e=>(...t)=>n=>{let i;for(const s of[...t,...e]){const e=s(n);if(void 0!==e){i=e;break}}return i};function Jd(e){return(0,$d.A)(Yd,(t=>t.urlMatch.test(e)))}function Xd(e,t){const n=Jd(e),i=function(e){const t=Jd(e);return t?e=>{const{includeSelectors:n,exactUseSelectors:i,excludeSelectors:s}=t;if(e instanceof HTMLElement){if(null!=n&&n.length){const t=[...n];if(e.matches(t.join(", ")))return Id.INNER}if(null!=i&&i.length&&e.matches(i.join(", ")))return Id.PASS;if(null!=s&&s.length){const t=[...s,...s.map((e=>`${e} *`))];if(e.matches(t.join(", ")))return Id.BLOCK}}}:()=>{}}(e),s=[];if(n){const e=t(n);e&&s.push(e)}return Qd([i])(...s)}const Zd=e=>{if(e instanceof HTMLElement&&e.matches(Wd))return Id.BLOCK},eu=e=>{if(Gd.includes(e.nodeType))return Id.BLOCK},tu=[eu,Zd,e=>{if(e instanceof HTMLElement&&(0,ud.N3)(e))return Id.BLOCK},e=>{if(e instanceof HTMLElement){const{display:t,isBlockOrTableDisplay:n}=(0,ud.ZG)(e);if(e.matches("code")&&"block"===t)return Id.BLOCK;if("grid"!==t&&n){const t=Array.from(e.childNodes).filter(ud.mp);if(Array.from(t).every((e=>e instanceof HTMLElement&&"CODE"===e.tagName)))return Id.BLOCK}}}],nu=[eu,Zd],iu=[e=>{let t="";if(e instanceof HTMLElement)for(const n of e.childNodes)n instanceof HTMLElement?t+=n.getAttribute("data-text-content")||"":t+=n.textContent||"";if(t=(0,ud.UU)(t),/^[0-9:,."';?+-<>\xb7\uff0c\u3002\/\[\]{}()\u300c\u300d\uff08\uff09\uffe5$\u201c\u201d]*$/.test(t))return Id.BLOCK}],su=Qd([function(e){return Xd(e,(e=>e.traverseStrategy))}(window.location.href),...tu]),ou=Qd([function(e){return Xd(e,(e=>e.paragraphStrategy))}(window.location.href),...iu]),au=Qd([function(e){return Xd(e,(e=>e.paragraphChildStrategy))}(window.location.href),...nu]),ru=function(e){var t;const n=Jd(e);if(null!=n&&null!==(t=n.onlyNeedIncludeSelectors)&&void 0!==t&&t.length)return n.onlyNeedIncludeSelectors}(window.location.href);const lu=new class{constructor(){var e=this;(0,f.A)(this,"translator",void 0),(0,f.A)(this,"prepareForMessageFromExtension",(()=>{On.on(Mn,Pn.PAGE,(e=>{On.emit(Ln,Pn.PAGE,e)})),On.on("TRANSLATE_PAGE",Pn.PAGE,(e=>{e?this.translatePage():this.clearTranslate()})),On.on("REQUEST_TRANSLATE_STATE",Pn.PAGE,(()=>{const{active:e}=cd.getState();return On.emit("RESPONSE_TRANSLATE_STATE",Pn.PAGE,e),e})),On.on("REQUEST_ALWAYS_TRANSLATE_STATUS",Pn.PAGE,(()=>{const{autoTranslate:e}=cd.getState();On.emit("RESPONSE_ALWAYS_TRANSLATE_STATUS",Pn.PAGE,e)})),On.on("CHANGE_TRANSLATE_STATUS",Pn.PAGE,(e=>{this.toggleCurrentPageAutoTranslate(e)})),On.on("REQUEST_SHOW_ORIGIN_STATUS",Pn.PAGE,(()=>{const{showOrigin:e}=cd.getState();On.emit("RESPONSE_SHOW_ORIGIN_STATUS",Pn.PAGE,e)})),On.on("CHANGE_SHOW_ORIGIN_STATUS",Pn.PAGE,(e=>{this.toggleShowOriginalContent(e)})),On.on("CHANGE_SELECTED_TARGET_LANGUAGE_CODE",Pn.PAGE,(e=>{this.setTargetLangCode(e)}))})),(0,f.A)(this,"setTargetLangCode",(e=>{(0,(0,Si.Y)("translateLanguage")[1])(e),Wn.A.set("translateLanguage",e);const{active:t}=cd.getState();t&&this.translatePage()})),(0,f.A)(this,"toggleShowOriginalContent",(e=>{const{setShowOrigin:t}=cd.getState();e?this.showOriginContent():this.hideOriginContent(),t(e)})),(0,f.A)(this,"toggleCurrentPageAutoTranslate",function(){var e=(0,a.A)((function*(e){const t=new URL(window.location.href).hostname,n=yield Wn.A.get("autoTranslatePageHosts"),i=e=>{Wn.A.set("autoTranslatePageHosts",e)};i(e?[...new Set([...n,t])]:(0,bl.A)(n,(e=>e!==t)))}));return function(t){return e.apply(this,arguments)}}()),(0,f.A)(this,"translatePage",(0,a.A)((function*(){const t=yield Wn.A.get("translateLanguage"),n=yield Wn.A.get("pageTranslateService"),{setShowLangNotice:i,setActive:s}=cd.getState();s(!0),e.pageTranslate({lang:t,translateService:(0,rd.w)(n)});t===(yield md(gd()))&&i(!0)}))),(0,f.A)(this,"pageTranslate",(e=>{On.emit(Rn,Pn.PAGE,!0);const{lang:t,translateService:n}=e;this.translator.start(t,n)})),(0,f.A)(this,"showOriginContent",(()=>{this.translator.showOriginContent()})),(0,f.A)(this,"translatedTextShowUnderline",(e=>{this.translator.translatedTextShowUnderline(e)})),(0,f.A)(this,"hideOriginContent",(()=>{this.translator.hideOriginContent()})),(0,f.A)(this,"clearTranslate",(()=>{const{setActive:e}=cd.getState();On.emit(Rn,Pn.PAGE,!1),this.translator.clearTranslate(),e(!1)}));const t=su(),n=ou(),i=au();this.translator=new Vd({strategyFilters:{traverse:t,paragraph:n,paragraphChild:i},onlyNeedIncludeSelectors:ru}),this.prepareForMessageFromExtension()}},{pageTranslate:cu,showOriginContent:du,hideOriginContent:uu,clearTranslate:hu,translatedTextShowUnderline:mu}=lu;const gu={"cici-ext-container":"cici-ext-container-ZsL3N4",ciciExtContainer:"cici-ext-container-ZsL3N4","inactivelink-hover-animation":"inactivelink-hover-animation-uqtsZZ",inactivelinkHoverAnimation:"inactivelink-hover-animation-uqtsZZ","notactivelink-hover-animation":"notactivelink-hover-animation-qIF7Pk",notactivelinkHoverAnimation:"notactivelink-hover-animation-qIF7Pk","light-click-animation":"light-click-animation-aP0sBM",lightClickAnimation:"light-click-animation-aP0sBM","click-animation":"click-animation-m_aVOk",clickAnimation:"click-animation-m_aVOk","semi-animation-rotate":"semi-animation-rotate-guIq9p",semiAnimationRotate:"semi-animation-rotate-guIq9p","inactive-btn-hover-animation":"inactive-btn-hover-animation-p55iH4",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-p55iH4","cici-ext-always-dark":"cici-ext-always-dark-cZEcux",ciciExtAlwaysDark:"cici-ext-always-dark-cZEcux","cici-ext-always-light":"cici-ext-always-light-asgCmn",ciciExtAlwaysLight:"cici-ext-always-light-asgCmn",ellipsis:"ellipsis-crsBmL",wrapper:"wrapper-hUZARQ",translateServicePopover:"translateServicePopover-hsdsA4",translatePanel:"translatePanel-zEvg3V",options:"options-Sqt4ba",translatePanelTitle:"translatePanelTitle-aF2p_o",translatePanelText:"translatePanelText-tZn2Vm","translate-panel-checkbox":"translate-panel-checkbox-zBRKCS",translatePanelCheckbox:"translate-panel-checkbox-zBRKCS",translatePanelSelectTitle:"translatePanelSelectTitle-PuACPl",translatePanelSelectList:"translatePanelSelectList-CM7MDK",translatePanelSelectItem:"translatePanelSelectItem-Hjf6Y1",nameWrapper:"nameWrapper-Ie1kv0",locName:"locName-jenbnm",active:"active-yOqMUg",name:"name-b4vXqU",checkbox:"checkbox-yjLP5c","language-notice-wrapper":"language-notice-wrapper-jvVOm3",languageNoticeWrapper:"language-notice-wrapper-jvVOm3","placement-left":"placement-left-rpzGBS",placementLeft:"placement-left-rpzGBS","language-notice":"language-notice-mWw7Vf",languageNotice:"language-notice-mWw7Vf",icon:"icon-C9iS8d",content:"content-TpyY49","activelink-hover-animation":"activelink-hover-animation-pD7DOP",activelinkHoverAnimation:"activelink-hover-animation-pD7DOP"};function pu(e,t){return vu.apply(this,arguments)}function vu(){return vu=(0,a.A)((function*(e,t){if((0,Kn.BB)({action:"web_translatePage",loginParams:{trackMeta:{login_entrance:"float_btn"}}}))return;const{setShowLangNotice:n}=cd.getState();cu({lang:e,translateService:(0,rd.w)(t)});e===(yield md(gd()))&&n(!0)})),vu.apply(this,arguments)}const fu=({onVisibleChange:e,reverse:t})=>{const n=(0,wi.A)((()=>{null==e||e(!1)})),[i,s]=(0,z.useState)({isOverlap:!1,overlapDistance:0}),[o,a]=(0,Si.Y)("translateLanguage"),[r,l]=(0,Si.Y)("autoTranslatePageHosts"),[c,d]=(0,Si.Y)("pageTranslateShowUnderline"),[u,h]=(0,Si.Y)("pageTranslateService"),{showOrigin:m,setShowOrigin:g,active:p,autoTranslate:v}=cd(),f=(0,ye.e)(),_=(0,$.B)();!function(e,t){const n=(0,z.useRef)(!1);(0,z.useEffect)((()=>{n.current=!0}),[]),(0,z.useEffect)((()=>{if(!n.current)return e();n.current=!1}),t)}((()=>{p&&pu(o,u)}),[o,u]);return(0,z.useEffect)((()=>{n.current&&(0,is.V6)(".active-option",{wrapper:n.current}).then((e=>{var t;null==e||null===(t=e.scrollIntoViewIfNeeded)||void 0===t||t.call(e)}))}),[o]),(0,z.useEffect)((()=>{var e;const t=null===(e=n.current)||void 0===e?void 0:e.getBoundingClientRect();null!=t&&t.top&&(null==t?void 0:t.top)<16&&s({isOverlap:!0,overlapDistance:(null==t?void 0:t.top)>0?16-(null==t?void 0:t.top)+40:Math.abs(null==t?void 0:t.top)+40+16}),null!=t&&t.bottom&&(null==t?void 0:t.bottom)>window.innerHeight-16&&s({isOverlap:!0,overlapDistance:(null==t?void 0:t.bottom)-window.innerHeight+16+40})}),[]),(0,z.useEffect)((()=>{(0,Gc.Jg)({button_name:Q._h.alwaysTranslatePage}),(0,Gc.Jg)({button_name:Q._h.displayOriginalText})}),[]),(0,K.jsxs)("div",{className:re()(gu.translatePanel,{[gu.translatePanelReverse]:t}),"data-testid":"page-translate-setting-panel",ref:n,style:{bottom:t?i.isOverlap?i.overlapDistance:40:"unset",top:t?"unset":i.isOverlap?i.overlapDistance:40},children:[(0,K.jsxs)("div",{className:gu.options,children:[(0,K.jsxs)("div",{className:gu.translatePanelTitle,children:[(0,K.jsx)("div",{className:gu.translatePanelText,children:_("flow_web_ext_sidebar_translate_hover_original")}),(0,K.jsx)(ce.Sc,{className:re()(gu["translate-panel-checkbox"],"show-origin-content-setting"),defaultChecked:m,onChange:e=>{var t;(0,Gc.mu)({button_name:Q._h.displayOriginalText,value:e.target.checked}),(t=Boolean(e.target.checked))?du():uu(),g(t)}})]}),(0,K.jsxs)("div",{className:gu.translatePanelTitle,children:[(0,K.jsx)("div",{className:gu.translatePanelText,children:_("flow_web_ext_sidebar_translate_always")}),(0,K.jsx)(ce.Sc,{className:re()(gu["translate-panel-checkbox"],"auto-translate-host-setting"),checked:v,onChange:e=>{(0,Gc.mu)({button_name:Q._h.alwaysTranslatePage,value:e.target.checked}),(e=>{const t=new URL(window.location.href).hostname;l(e?[...new Set([...r,t])]:(0,bl.A)(r,(e=>e!==t)))})(Boolean(e.target.checked))}})]}),(0,K.jsxs)("div",{className:gu.translatePanelTitle,children:[(0,K.jsx)("div",{className:gu.translatePanelText,children:_("flow_web_ext_sidebar_settings_translateunderline")}),(0,K.jsx)(ce.Sc,{className:re()(gu["translate-panel-checkbox"],"translated-text-show-underline"),checked:c,onChange:e=>{var t;t=Boolean(e.target.checked),d(t)}})]}),(0,K.jsxs)("div",{className:gu.translatePanelTitle,children:[(0,K.jsx)("div",{className:gu.translatePanelText,children:_("flow_web_ext_sidebar_settings_translateservice")}),(0,K.jsx)(ce.AM,{trigger:"click",position:"bottomRight",content:(0,K.jsx)(oc,{selectedService:u,onSelectService:h,services:Xl}),className:gu.translateServicePopover,getPopupContainer:()=>n.current,children:(0,K.jsx)("div",{children:(0,K.jsx)(dc,{mode:"label",translateService:u})})})]})]}),f&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("div",{className:gu.translatePanelSelectTitle,style:{marginTop:12},children:_("flow_web_ext_sidebar_translate_hover_to")}),(0,K.jsx)("div",{className:gu.translatePanelSelectList,"data-testid":"page-translate-language-list",children:f.map((e=>(0,K.jsxs)("div",{"data-lang-option":e.language_code,className:re()(gu.translatePanelSelectItem,{"active-option":o===e.language_code}),onClick:()=>(e=>{(0,_e.Su)({before_language_result:o,after_language_result:e,scene:_e.jv.translate_this_page}),a(e)})(e.language_code),children:[(0,K.jsxs)("div",{className:gu.nameWrapper,children:[(0,K.jsx)("div",{className:re()(gu.locName,{[gu.active]:e.language_code===o}),children:e.language_loc}),(0,K.jsx)("div",{className:gu.name,children:e.language})]}),(0,K.jsx)("div",{className:gu.checkbox,children:e.language_code===o&&(0,K.jsx)(de.Tf,{})})]},e.language_code)))})]})]})},_u=()=>{const{active:e}=cd();return e?(0,K.jsx)(de.U8,{}):(0,K.jsx)(de.qe,{})},yu=({placementLeft:e})=>{const t=(0,$.B)(),{setShowLangNotice:n}=cd(),i=(0,wi.A)((()=>{n(!1)}));return(0,K.jsx)("div",{"data-testid":"page-translate-same-language-notice",ref:i,className:re()(gu["language-notice-wrapper"],{[gu["placement-left"]]:e}),children:(0,K.jsxs)("div",{className:gu["language-notice"],children:[(0,K.jsx)(de.Zx,{className:gu.icon}),(0,K.jsx)("div",{className:gu.content,children:t("flow_web_ext_sidebar_translate_notify")})]})})},xu=({placementLeft:e})=>{const t=(0,$.B)(),{setShowLangNotice:n}=cd(),i=(0,wi.A)((()=>{n(!1)}));return(0,K.jsx)("div",{"data-testid":"page-translate-same-language-notice",ref:i,className:re()(gu["language-notice-wrapper"],{[gu["placement-left"]]:e}),children:(0,K.jsx)("div",{className:gu["language-notice"],children:(0,K.jsx)("div",{className:gu.content,children:t("flow_web_ext_sidebar_translate_notice_pdfsupport")})})})},bu=e=>{const{btnListReverse:t,showLangSettings:n}=e,[i]=(0,Si.Y)("translateLanguage"),[s]=(0,Si.Y)("pageTranslateService"),{active:o,setActive:a,showLangNotice:r}=cd(),[l,c]=(0,z.useState)(!1),d=(0,$.B)(),{type:u}=(0,_l.IF)(),[h]=(0,Si.Y)("pageTranslateShowUnderline");(0,z.useEffect)((()=>{mu(h)}),[h]);const m=(0,z.useRef)(null);return(0,K.jsxs)("div",{className:gu.wrapper,children:[(0,K.jsx)("div",{className:re()(Wc.floatBtnPanelItemTranslate),onMouseEnter:()=>{c(u===gi.u9.pdf)},onMouseLeave:()=>{c(!1)},children:(0,K.jsxs)("div",{className:re()(Wc.floatBtnPanelItemBlock,{[Wc.floatBtnPanelItemBlockWithSetting]:n}),onClick:e=>{e.stopPropagation(),e.preventDefault(),u!==gi.u9.pdf&&((0,b.GT)(),o?hu():pu(i,s),a(!o),(0,Gc.Ie)({button_name:Q._h.translatePage}))},"data-testid":"float-button-translate",children:[(0,K.jsx)("div",{className:re()(Wc.floatBtnPanelItemLangSettingsIcon,Wc.floatBtnPanelItemIcon,{[Wc.showLangSettingIcon]:n},{[Wc.showLangSettingIconReverse]:t}),onClick:t=>{t.stopPropagation(),t.preventDefault(),u!==gi.u9.pdf&&((0,b.GT)(),e.onClickSettings())},"data-testid":"float-button-translate-setting",children:(0,K.jsx)(de.TH,{})}),(0,K.jsx)("div",{ref:m,className:re()(Wc.floatBtnPanelItemIcon,{[Wc.floatBtnPanelItemIconReverse]:t}),"data-testid":"float-button-translate-icon",children:(0,K.jsx)(ce.m_,{content:d(o?"flow_web_ext_sidebar_translateoff":"flow_web_ext_sidebar_translate"),position:"left",getPopupContainer:()=>m.current,className:Wc.tooltipContainer,children:(0,K.jsx)("div",{style:{lineHeight:0},children:(0,K.jsx)(_u,{})})})})]})}),r&&(0,K.jsx)(yu,{placementLeft:t}),l&&(0,K.jsx)(xu,{placementLeft:t})]})},Au=()=>{const e=(0,$.B)(),t=Zo(),n=(0,z.useMemo)((()=>e(t?"flow_web_ext_sidebar_bookmarks_saved":"flow_web_ext_sidebar_bookmarks")),[e,t]),i=(0,z.useRef)(null);return(0,K.jsx)("div",{className:Wc.toolContainer,onClick:()=>{t?(0,O.P)(t):(0,O.X)({collectionType:h.X.Web,collectFrom:m.vP.side_bar_popover})},"data-testid":"float-button-collect-page",ref:i,children:(0,K.jsx)(ce.m_,{content:n,position:"left",getPopupContainer:()=>i.current,children:(0,K.jsx)("div",{className:Wc.floatBtnPanelItemBlock,children:t?(0,K.jsx)(et.u06,{className:re()(Wc.floatBtnPanelItemIcon,Wc.floatBtnPanelItemIconCollected)}):(0,K.jsx)(et.Wur,{className:re()(Wc.floatBtnPanelItemIcon)})})})})};var wu=n(87412),Su=n(8637);const Cu={dot:"dot-CShR0Q"};function ku(e){const{className:t,children:n}=e,i=(0,Su.A)();return null!=i&&i.version&&(i.version===i.dotVisibleVersion||i.version===i.cardVisibleVersion)||null==i||!i.data?null:(0,K.jsxs)("div",{className:re()(Cu.badge,t),children:[n,(0,K.jsx)("span",{className:Cu.dot})]})}const Iu=e=>-e*window.innerHeight,Eu={startX:0,startY:0,threshold:6,startT:0,start(e,t){this.startX=e,this.startY=t,(0,g.Rm)("[Daniel] floatBtn pos",e,t),this.startT=Date.now()},isValid(e,t){const n=e-this.startX,i=t-this.startY;return Math.sqrt(n*n+i*i)>this.threshold&&Date.now()-this.startT>300}};function Tu(e){const[t,n]=(0,Si.Y)("sidebarButtonTop"),[i,s]=(0,z.useState)(!1),[o,a]=(0,z.useState)(!1),[r,l]=(0,z.useState)(!1),[c,d]=(0,z.useState)(!1),[u,h]=(0,z.useState)(!1),g=490-window.innerHeight,v=42-window.innerHeight,{anchor:f,target:_,setPosition:y}=ad({direction:"both",onStart(e,t){const[n,i]=t;Eu.start(n,i)},onMove(e,t){const[n,i]=t;Eu.isValid(n,i)&&(s(!0),d(!1),l(!1))},onEnd(e,t){const i=-t[1]/window.innerHeight;const o=sd(Iu(i),[v,0]);n(i),y([0,o]),h(o<g),(0,nd.A)((()=>s(!1)))},maxDistance:{y:{min:v,max:0}},onClickLike:()=>{i||((0,b.GT)(),se.l.getState().toggleShowSidebar(Q.cz.clickSidebar),(0,wu.s)())}});(0,z.useEffect)((()=>{(0,Gc.oJ)()}),[]),(0,z.useEffect)((()=>{!i&&o&&((0,Gc.jv)(),(0,p.ku)()&&(0,m.ae)(m.vP.side_bar_popover,m.p6.web))}),[i,o]),(0,z.useLayoutEffect)((()=>{const e=sd(Iu(t),[v,0]);y([0,e]),h(e<g)}),[v,t]);const x=function(e,t,n){const[i,s]=(0,z.useState)([]);return(0,z.useEffect)((()=>{let i;return n&&(s([e]),i=setTimeout((()=>s([e,t])),50)),()=>{clearTimeout(i),s([])}}),[n]),i}(Wc.show,Wc.expand,!i&&o&&!r&&!c||c);return(0,K.jsx)("div",{ref:_,style:e.isSidebarShow?{[e.align]:it.gH}:{},className:re()(Wc.floatBtn,{[Wc.left]:"left"===e.align,[Wc.right]:"right"===e.align}),children:(0,K.jsxs)("div",{className:re()(Wc.floatBtnWrapper,{[Wc.reverse]:u}),onMouseEnter:()=>{a(!0)},onMouseLeave:()=>{a(!1)},children:[!i&&c&&!r&&(0,K.jsx)(fu,{onVisibleChange:e=>{d(e)},reverse:u}),!i&&(0,K.jsxs)("div",{"data-role":"float-button-list",className:re()(Wc.floatBtnList,[...x]),style:{flexDirection:u?"column-reverse":"column"},children:[(0,K.jsx)(bu,{btnListReverse:u,showLangSettings:c,onClickSettings:()=>{(0,Gc.Ie)({button_name:Q._h.languageSettings}),d(!c)}}),(0,K.jsx)(ce.cG,{className:Wc.toolDivider}),(0,K.jsx)(Jc,{}),(0,p.ku)()&&(0,K.jsx)(Au,{})]}),(0,K.jsxs)("div",{"data-testid":"float-button-brand-entry",className:re()(Wc.floatBtnBrand,{[Wc.expand]:!i&&o||r}),children:[(0,K.jsx)(Lo.A,{className:re()(Wc.closeBtn,{[Wc.closeBtnExpand]:!i&&o}),position:u?"bottomRight":"topRight",disableKey:Ro.lf.chatAssistant,show:r,setShow:l,renderChildren:({onTriggerClick:e})=>(0,K.jsx)(de.gz,{className:Wc.floatBtnCloseIcon,onClick:t=>{t.preventDefault(),t.stopPropagation(),r?l(!r):e(t)}})}),(0,K.jsx)("img",{ref:f,src:(0,he.Nf)(),className:Wc.floatBtnAvatar}),(0,K.jsx)(ku,{})]})]})})}n(94314);var ju=n(25003);var Nu=n(8444),Mu=n(74215),Lu=n(24354);const Ru=()=>{const[e,t]=(0,z.useState)(zl);return(0,z.useEffect)((()=>{let e;const n=(n=!1)=>{const i=(0,yl.GF)(),s=(0,yl.yI)();if(!i||(0,Lc.x)(e,i)||!s)return;e=i;const o=new Hl(window.getSelection());t({baseInfo:i,selectionHelper:o,isContextMenu:n}),fl.t_.setState({writeEnabled:o.canInsert,inputText:i.text,contextText:i.contextText,range:i.range,selectionBaseInfo:i,simpleSelectionBaseInfo:s})};let i=0;const s=()=>{clearTimeout(i),i=(0,nd.A)(n)},o=()=>{clearTimeout(i),i=(0,nd.A)((()=>n(!0)))},a=()=>n();return(0,Ul.CN)()&&document.addEventListener("selectionchange",s),document.addEventListener("pointerup",s),window.addEventListener("keydown",s),window.addEventListener("keyup",s),window.addEventListener("resize",a),window.addEventListener("wheel",a),window.addEventListener("scroll",a),window.addEventListener("contextmenu",o),()=>{clearTimeout(i),document.removeEventListener("selectionchange",s),document.removeEventListener("pointerup",s),window.removeEventListener("resize",a),window.removeEventListener("wheel",a),window.removeEventListener("scroll",a),window.removeEventListener("keydown",s),window.removeEventListener("keyup",s),window.removeEventListener("contextmenu",o)}}),[]),e};var Pu=n(59355);const Bu=()=>{const[e]=(0,Si.Y)("autoTranslatePageHosts"),{autoTranslate:t,setAutoTranslate:n,setActive:i,setShowLangNotice:s}=cd();(0,z.useEffect)((()=>{const t=new URL(window.location.href).hostname;n((0,Pu.A)(e,t))}),[e]);const o=function(){var e=(0,a.A)((function*(){try{const e=yield Wn.A.get("translateLanguage"),t=yield Wn.A.get("pageTranslateService");i(!0),cu({lang:e,translateService:(0,rd.w)(t)});e===(yield md(gd()))&&s(!0)}catch(e){}}));return function(){return e.apply(this,arguments)}}();(0,z.useEffect)((()=>{const{active:e}=cd.getState();t&&!e&&o()}),[t])},Ou={name:"chat-page-ready",handle:e=>{Xo.A.emit("chat-page-ready",e),(0,Nu.BF)()}};var Du=n(54549);const Fu={name:"locate-highlight-dom",handle:e=>{e&&(0,Du.p)(e)}},Uu={name:"read-page-request",handle:function(){var e=(0,a.A)((function*(){return(0,Yc.B9)()}));return function(){return e.apply(this,arguments)}}()},Hu={name:"update-zustand-state",handle:(e=[])=>{(0,Nu.Z3)(e)}},zu="assistant-WownMw",qu=()=>{const e=(0,se.l)((e=>e.isShowSidebar)),[t]=(0,Si.Y)("sidebarButtonPosition");return(0,K.jsx)(ju.A,{align:t,visible:e,scene:"sideBar"})},Vu=()=>{var e;(0,Ai.A)(null===(e=document.getElementById("ciciai-assistant"))||void 0===e?void 0:e.shadowRoot);const t=(0,se.l)((e=>e.isShowSidebar)),n=(0,se.l)((e=>e.isShowSidebarBtn)),s=(0,se.l)((e=>e.isSidePanelMode)),[o]=(0,Si.Y)("sidebarButtonDisabledAll"),[r]=(0,Si.Y)("sidebarButtonPosition"),[l]=(0,Si.Y)("sidebarButtonDisabledHosts"),c=l.includes(window.location.host),[d,h]=(0,z.useState)("\u2325K"),m=(0,z.useRef)(null),p=(0,bi.Uk)(),f=Ru();Bu();const _=function(){var e=(0,a.A)((function*(){var e;const{data:t}=yield(0,ml.c)("init-shortcut"),n=null==t||null===(e=t.shortcuts)||void 0===e?void 0:e._execute_action;n&&h(n)}));return function(){return e.apply(this,arguments)}}();(0,z.useEffect)((()=>((0,ml.c)("csui-init").then((e=>{const{shortcuts:t}=(null==e?void 0:e.data)||{},n=t._execute_action;n&&h(n)})),window.addEventListener("focus",_),()=>window.removeEventListener("focus",_))),[]),(0,z.useEffect)((()=>{s||(t?(e=>{const t="left"===e?vl:pl,n="left"===e?"\nhtml {\n  position: relative !important;\n  min-height: 100vh !important;\n  padding-left: 420px !important\n}\n":"\nhtml {\n  width: calc(100% - 420px)  !important;\n  position: relative !important;\n  min-height: 100vh !important\n}\n";let i=document.getElementById(t);i?i.innerHTML=n:(i=document.createElement("style"),i.id=t,i.innerHTML=n,(0,u.EY)(i))})("right"):(e=>{const t="left"===e?vl:pl,n=document.getElementById(t);n&&n.remove()})("right"))}),[t,s]),(0,z.useEffect)((()=>{if(!s||Rl._.isInSidePanel)return;const e=(0,Mu.c)(Object.values(i)),t=[(0,Nu._)(fl.t_,"select","contentScript"),(0,Nu._)(se.l,"layout","contentScript"),(0,Nu._)(io.on,"global","contentScript")];return()=>{e(),t.forEach((e=>e()))}}),[]),(0,z.useEffect)((()=>{const e=()=>{document.title!==_l.IF.getState().title&&((0,g.Rm)(`document update title from=${_l.IF.getState().title} to=${document.title}`),_l.IF.getState().setTitle(document.title))};try{const t=document.querySelector("title"),n=new MutationObserver((()=>{e()})),i={childList:!0};return n.observe(t,i),()=>{n.disconnect()}}catch(t){let n;const i=()=>{e(),n=setTimeout(i,300)};return i(),()=>{clearTimeout(n)}}}),[]);const y=!(o||c||!n||[it.o8,it.Ud].some((e=>location.host.endsWith(e)))&&(!location.pathname.startsWith(v.Cp)&&!location.pathname.startsWith("/ext/")));return(0,K.jsx)(V.Yd.Provider,{value:xi.vF,children:(0,K.jsx)(V.tH,{fallback:null,errorBoundaryName:"flow-ext-next",children:(0,K.jsx)(zs.A.Provider,{value:{getPopupContainer:()=>m.current||document.body},children:(0,K.jsx)(ql.Provider,{value:f,children:(0,K.jsx)($.C,{t:p,children:(0,K.jsxs)("div",{onMouseDown:Lu.N,className:re()(zu,"cici-ext-always-light","semi-always-light"),children:[null,(0,K.jsx)(Dc,{}),y?(0,K.jsx)(Tu,{align:r,shortcut:d,isSidebarShow:t}):null,s?null:(0,K.jsx)(qu,{}),(0,K.jsx)("div",{className:"cici-popup-container",ref:m}),(0,K.jsx)(td,{})]})})})})})})},$u=Vu;(0,fd.A)((function(e){const t=function(e){const t=new WebSocket(e);return t.onopen=()=>{console.log("hmr socket open")},t.onclose=()=>{console.log("hmr socket close")},t.onerror=e=>{console.log("hmr socket error",e)},t}("ws://localhost:9001/webpack-hmr");t.onmessage=t=>{switch(JSON.parse(t.data).type){case"still-ok":case"ok":!function(e){console.log("hrm reload style"),(0,is.f9)(e),(0,is.NR)(e,v.QN).catch((e=>{console.log("\u70ed\u66f4\u65b0reloadStyleError(\u7b26\u5408\u9884\u671f,chrome\u4e0a\u4e0b\u6587\u4e22\u5931\u5bfc\u81f4)")}))}(e)}},d.m.getInstance().registerRecyclable((()=>null==t?void 0:t.close()))}));var Ku=n(23754);function Wu(){return(Wu=(0,a.A)((function*(e){const t=(0,X.TK)("authInfo");return e?yield(0,Ku.AT)({method:"POST",url:`${it.kD}/plugin/prompt_skill/list_by_user`,data:{user_id:t.userId,frontend_source:1}}):yield(0,ut.S6)({method:"POST",url:`${it.kD}/plugin/prompt_skill/list_by_user`,data:{user_id:t.userId,frontend_source:1}})}))).apply(this,arguments)}const Gu=()=>{const e=[];return(0,p.ku)()||e.push(Gn.EU.collect),e},Yu=(e,t,n)=>{const i={actionList:[],moreActionList:[]},s=new Set,o=Gu();return e&&(e.selectbar.forEach((e=>{if(o.includes(e))return;const n=t.get(e);n&&(i.actionList.push(n),s.add(e))})),e.dropdown.forEach((e=>{if(o.includes(e))return;const n=t.get(e);n&&(i.moreActionList.push(n),s.add(e))}))),t.forEach(((e,t)=>{if(!s.has(t)&&!o.includes(t)){(n?Gn.aX.includes(t):Gn.AA.includes(t))?i.actionList.push(e):i.moreActionList.push(e)}})),i},Qu={readingPopupActions:{selectbar:Gn.aX,dropdown:Gn.Tz},editingPopupActions:{selectbar:Gn.AA,dropdown:Gn.Xt}},Ju=()=>{const e=Gu();(0,X.vE)("readingPopupActions",{actionList:(0,Gn.Hh)(e),moreActionList:(0,Gn.WN)(e)}),(0,X.vE)("editingPopupActions",{actionList:(0,Gn.I8)(e),moreActionList:(0,Gn.fS)(e)})};function Xu(){return Zu.apply(this,arguments)}function Zu(){return Zu=(0,a.A)((function*(e=!1){try{const t=(0,X.TK)("authInfo");if(!t.isAuthenticated||!t.userId)return void Ju();const n=yield function(e){return Wu.apply(this,arguments)}(e);if(!n)return;const{user_setting:i,items:s}=n;if(!i||!s)return;const o=new Map([...(0,Gn.Hh)(),...(0,Gn.WN)()].map((e=>[e.id,e]))),a=new Map([...(0,Gn.I8)(),...(0,Gn.fS)()].map((e=>[e.id,e])));null==s||s.forEach((e=>{const{id:t,extra:n,title:i,prompt_template:s}=e,r=JSON.parse(n),{use_in:l="",icon:c="",displayMode:d,conf_id:u}=r||{},h={id:t,icon:c,name:i,prompt:s,displayMode:d,confId:u};"reading"===l?o.set(t,h):"editing"===l&&a.set(t,h)}));const{settings:r=""}=i,l=r?JSON.parse(r):Qu,c=Yu(l.readingPopupActions,o,!0),d=Yu(l.editingPopupActions,a,!1);c.actionList.length+c.moreActionList.length&&(0,X.vE)("readingPopupActions",c),d.actionList.length+d.moreActionList.length&&(0,X.vE)("editingPopupActions",d)}catch(t){(0,g.z3)("initSelectBarSkillList err",t),xi.vF.persist.info({eventName:"getSelectBarSkillList",meta:(0,o.A)({},t)})}})),Zu.apply(this,arguments)}var eh=n(82914);let th=function(e){return e.Input="input",e.Rich="rich",e}({});function nh(e,t,n){const i=e.split("."),s=t.split(".");let o=null!=n?n:Math.min(i.length,s.length);for(;o>0;){if(i.pop()!==s.pop())return!1;o--}return!0}function ih(e){return e instanceof HTMLElement}function sh(e,t=1){let n=t-1,i=e.parentElement;for(;n>0&&i;)i=i.parentElement,n-=1;return i}function oh(e,t){let n=e;for(;n;){if(t(n))return n;n=n.parentElement}}function ah(e,t){return!(e.start>t.end||e.end<t.start)}function rh(e,t){let n=e;for(;n;){if(t(n))return!0;n=n.parentElement}return!1}function lh(e,t,n){const i=function(e,t,n){const i=document.createRange();return i.setStart(e,t),i.setEnd(e,n),i}(e,t,n),s=i.getClientRects();return i.detach(),s}function ch(e,t){const n=[];for(const s of t){const e=(0,eh.A)(n);e&&e.top===s.top&&e.height===s.height&&e.right>=s.left?(e.right=s.right,e.width+=s.width):n.push(s.toJSON())}const i=e.getBoundingClientRect();return n.map((t=>{const n=t.top-i.top+e.scrollTop,s=t.left-i.left+e.scrollLeft,o=n+t.height,a=s+t.width,{width:r,height:l}=t;return{x:s,y:n,top:n,left:s,bottom:o,right:a,width:r,height:l}})).sort(((e,t)=>e.left-t.left))}const dh=["larkoffice.com"];var uh=n(3888),hh=n(22290),mh=n(81725),gh=n.n(mh),ph=n(95081),vh=n(22437);const fh="wrapper-qH3fD2",_h="mask-v8dwr4",yh="setting-popover-HXRy3h",xh="spell-card-xCZkfq",bh="revision-type-PTC8JH",Ah="suggest-FdbK8z",wh="setting-CE1uYq",Sh="ignore-Mq8qMp",Ch="setting-wrapper-cOQKNa",kh="tip-ZTQTKU",Ih="host-UdPObE",Eh=e=>{const{allowGrammar:t,onAllowGrammarChange:n}=e,i=function(e){const t=e.split(".").slice(-2),n=t[0],i=t[1];if(n.length>=13)return`${n.substring(0,5)}...${n.substring(n.length-5)}.${i}`;return`${n}.${i}`}(location.hostname);return(0,K.jsxs)("div",{className:re()(Ch,"row"),onMouseDownCapture:e=>{e.stopPropagation(),e.preventDefault()},children:[(0,K.jsx)("div",{className:re()("row-item",kh),children:(0,K.jsx)(pn.x,{i18nKey:"flow_web_ext_grammar_setting_onandoff",defaults:"Check grammar for <0>{{ website }}</0>",values:{website:i},components:[(0,K.jsx)("span",{className:Ih})]})}),(0,K.jsx)("div",{className:"row-auto",style:{marginLeft:8},children:(0,K.jsx)(ce.Sc,{checked:t,onChange:e=>{var t;return null==n?void 0:n(null!==(t=e.target.checked)&&void 0!==t&&t)}})})]})},Th=(0,z.createContext)(void 0),jh=Th.Provider;function Nh(){const e=(0,z.useContext)(Th);if(!e)throw new Error("Revision Evn is undefined");return e}const Mh=e=>(0,K.jsx)("svg",(0,o.A)((0,o.A)({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),{},{children:(0,K.jsx)("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.459 7.252c-.955 0-1.763-.63-2.031-1.496H2.615c-.322 0-.583-.282-.583-.63s.261-.63.583-.63h4.813a2.127 2.127 0 0 1 4.062 0h1.895c.322 0 .583.282.583.63s-.261.63-.583.63H11.49A2.13 2.13 0 0 1 9.46 7.252m0-1.063a1.063 1.063 0 1 1 0-2.126 1.063 1.063 0 0 1 0 2.126M6.541 13c.955 0 1.763-.63 2.031-1.496h4.813c.322 0 .583-.282.583-.63s-.261-.63-.583-.63H8.572a2.127 2.127 0 0 0-4.062 0H2.615c-.322 0-.583.282-.583.63s.261.63.583.63H4.51A2.13 2.13 0 0 0 6.54 13m0-1.063a1.063 1.063 0 1 0 0-2.126 1.063 1.063 0 0 0 0 2.126",clipRule:"evenodd"})})),Lh=(0,z.forwardRef)(((e,t)=>{const{t:n}=(0,vh.B)(),i=Nh(),{popupCardShadowContainer:s}=i,[o,a]=(0,z.useState)(!1),{style:r,replacement:l,onReplace:c,allowGrammar:d,onAllowGrammarChange:u,onIgnore:h}=e;return(0,K.jsxs)("div",{className:fh,ref:t,style:r,children:[(0,K.jsx)(ce.AM,{trigger:"custom",position:"rightTop",visible:o,spacing:0,className:yh,getPopupContainer:()=>{return(null==s||null===(e=s.shadowRoot)||void 0===e?void 0:e.querySelector(`.${fh}`))||document.body;var e},onClickOutSide:()=>a(!1),content:(0,K.jsx)(Eh,{allowGrammar:d,onAllowGrammarChange:u}),showArrow:!1,children:(0,K.jsx)("div",{className:_h})}),(0,K.jsxs)("div",{className:xh,children:[(0,K.jsxs)("div",{className:"row",children:[(0,K.jsx)("div",{className:re()("row-item",bh),children:n("flow_web_ext_grammar_title_note")}),(0,K.jsx)("div",{className:re()("row-auto",wh),onMouseDownCapture:e=>{e.stopPropagation(),a(!o)},children:(0,K.jsx)(Mh,{})})]}),(0,K.jsxs)("div",{className:"row",style:{marginTop:12},children:[(0,K.jsx)("div",{className:re()("row-item",Ah),onClick:e=>{e.stopPropagation(),e.preventDefault(),null==c||c()},children:l}),(0,K.jsx)("div",{className:re()("row-item",Sh),style:{marginLeft:6},onClick:()=>null==h?void 0:h(),children:n("flow_web_ext_grammar_action_ignore")})]})]})]})})),Rh=Lh;var Ph=n(20716);function Bh(e){const t=parseFloat(e);return isNaN(t)?0:t}function Oh(e){return(0,z.useMemo)((()=>e?function(e){const t={x:e.x,y:e.y,top:e.top,left:e.left,right:e.right,width:e.width,height:e.height+2,bottom:e.bottom+2};return{getBoundingClientRect:()=>(0,o.A)((0,o.A)({},t),{},{toJSON:()=>t})}}(e):null),[e])}function Dh(e,t){document.body.contains(Dh.dom)||document.body.append(Dh.dom),Dh.dom.removeAttribute("style");const n=getComputedStyle(e),i=function(e){const t=getComputedStyle(e),n=Bh(t.width),i=Bh(t.height),s=Bh(t.paddingTop),o=Bh(t.paddingRight),a=Bh(t.paddingBottom),r=Bh(t.paddingLeft),l=Bh(t.borderTopWidth),c=Bh(t.borderRightWidth),d=Bh(t.borderBottomWidth),u=Bh(t.borderLeftWidth);return"border-box"===t.boxSizing?{width:n-r-o-u-c,height:i-s-a-l-d,offsetLeft:r+u,offsetTop:s+l,offsetRight:o+c,offsetBottom:a+d}:{width:n,height:i,offsetLeft:0,offsetTop:0,offsetRight:0,offsetBottom:0}}(e);return Dh.dom.style.top="0",Dh.dom.style.left="0",Dh.dom.style.position="fixed",Dh.dom.style.pointerEvents="none",Dh.dom.style.opacity="0",Dh.dom.style.opacity="0",Dh.dom.style.width=`${e.clientWidth}px`,Dh.dom.style.boxSizing=n.boxSizing,Dh.dom.style.padding=n.padding,Dh.dom.style.border=n.border,Dh.dom.style.fontSize=n.fontSize,Dh.dom.style.fontFamily=n.fontFamily,Dh.dom.style.fontStyle=n.fontStyle,Dh.dom.style.fontWeight=n.fontWeight,Dh.dom.style.lineHeight=n.lineHeight,Dh.dom.style.letterSpacing=n.letterSpacing,Dh.dom.style.textAlign=n.textAlign,t?(Dh.dom.style.whiteSpace="nowrap",Dh.dom.style.height=`${e.clientHeight}px`,Dh.dom.style.lineHeight=`${i.height}px`):(Dh.dom.style.whiteSpace=n.whiteSpace,Dh.dom.style.wordBreak=n.wordBreak),Dh.dom.textContent=e.value,Dh.dom}Dh.dom=document.createElement("div"),Dh.dom.classList.add("fake-editor");const Fh=()=>{const e=Nh(),[t,n]=(0,Si.Y)("disableGrammarHosts"),{clearRemoveActiveTimer:i,setActiveRevision:s}=function(){const e=(0,z.useRef)(void 0),t=Nh(),n=t.store((e=>e.spellRevisions)),{setActiveRevision:i}=t.store.getState(),s=t.editor.dom,o=(n,s=!1)=>{window.clearTimeout(e.current),e.current=void 0;const o=t.store.getState().activeRevision;(0,Ph.A)(o,n)||(s||n?i(n):e.current=window.setTimeout((()=>{i(void 0)}),300))};return(0,z.useEffect)((()=>{const e=()=>{o(void 0,!0)};return window.addEventListener("wheel",e),()=>{window.removeEventListener("wheel",e)}}),[]),(0,z.useEffect)((()=>{const e=(0,_t.A)((e=>{const t=s.getBoundingClientRect(),i=e.clientX-(t.left-s.scrollLeft),a=e.clientY-(t.top-s.scrollTop);let r;e:for(const o of(0,uh.A)(n))for(const e of o.rects)if(i>=e.left&&i<=e.right&&a>=e.top&&a<=e.bottom+2){const n=e.top+(t.top-s.scrollTop),i=e.left+(t.left-s.scrollLeft);r={id:o.revision.id,rect:{x:i,y:n,top:n,left:i,width:e.width,height:e.height,right:0,bottom:0}};break e}o(r)}),32),t=()=>{o(void 0)};return s.addEventListener("pointermove",e),s.addEventListener("pointerleave",t),()=>{s.removeEventListener("pointermove",e),s.removeEventListener("pointerleave",t)}}),[s,t,n]),{clearRemoveActiveTimer:()=>{window.clearTimeout(e.current),e.current=void 0,console.log("xxxxx","clearRemoveActiveTimer")},setActiveRevision:o}}(),{activeRevision:a,spellRevisions:r}=e.store((e=>({activeRevision:e.activeRevision,spellRevisions:e.spellRevisions}))),[l,c]=(0,z.useState)(null),d=Oh(null==a?void 0:a.rect),{styles:u}=(0,ph.E)(d,l,{placement:"bottom-start",strategy:"fixed"}),h=(0,z.useCallback)(i,[]),m=(0,z.useCallback)((()=>{s(void 0)}),[]);if((0,z.useEffect)((()=>(null==l||l.addEventListener("pointerenter",h),null==l||l.addEventListener("pointerleave",m),()=>{null==l||l.removeEventListener("pointerenter",h),null==l||l.removeEventListener("pointerleave",m)})),[l]),!a)return null;const g=r[a.id];if(!g)return null;const{revision:p}=g,v=!t.includes(window.location.host);return(0,K.jsx)(Rh,{allowGrammar:v,onAllowGrammarChange:e=>{n(e?t.filter((e=>e!==window.location.host)):[...new Set([...t,window.location.host])])},replacement:p.replacement,ref:c,style:(0,o.A)((0,o.A)({},u.popper),{},{zIndex:2147483647}),onReplace:()=>{e.store.getState().setActiveRevision(void 0),e.replace(p)},onIgnore:()=>{e.store.getState().setActiveRevision(void 0),e.ignore(p)}})};class Uh{constructor(e){(0,f.A)(this,"dom",void 0),(0,f.A)(this,"shadowRoot",void 0),(0,f.A)(this,"root",void 0),(0,f.A)(this,"init",(()=>{const e=this.render();this.root.render(e),this.mount(this.dom)})),this.dom=document.createElement(e),this.shadowRoot=this.dom.attachShadow({mode:"open"});const t=document.createElement("div");t.classList.add("cici-ext-container");const n=document.createElement("div");n.classList.add("cici-ext-always-light","semi-always-light"),t.appendChild(n),this.shadowRoot.appendChild(t),this.root=(0,q.createRoot)(n),(0,is.NR)(this.shadowRoot,v.QN).then((()=>{this.init()}))}destroy(){this.root.unmount(),this.dom.remove()}}class Hh extends Uh{constructor(e){super(v.aS),(0,f.A)(this,"env",void 0),this.env=e,this.env.popupCardShadowContainer=this.dom}mount(){document.documentElement.append(this.dom)}render(){return(0,K.jsx)(jh,{value:this.env,children:(0,K.jsx)(Fh,{})})}}const zh=e=>(0,K.jsx)("svg",(0,o.A)((0,o.A)({xmlns:"http://www.w3.org/2000/svg",width:24,height:25,fill:"none",viewBox:"0 0 24 25"},e),{},{children:(0,K.jsx)("path",{fill:"#007F27",d:"M12 24.492q-2.45 0-4.617-.937a12.2 12.2 0 0 1-3.809-2.59 12.2 12.2 0 0 1-2.59-3.809 11.5 11.5 0 0 1-.937-4.617q0-2.45.937-4.605a12.3 12.3 0 0 1 2.579-3.82 12.2 12.2 0 0 1 3.808-2.59 11.5 11.5 0 0 1 4.617-.938q2.45 0 4.618.937a12.2 12.2 0 0 1 3.82 2.59 12.2 12.2 0 0 1 2.59 3.82q.937 2.157.937 4.606 0 2.45-.937 4.617a12.2 12.2 0 0 1-2.59 3.809 12.2 12.2 0 0 1-3.82 2.59 11.4 11.4 0 0 1-4.606.937m-1.312-6.234q.304 0 .55-.14.246-.142.434-.423l5.508-8.683q.105-.176.199-.375a.9.9 0 0 0 .094-.399.77.77 0 0 0-.305-.644 1.06 1.06 0 0 0-.68-.246q-.515 0-.843.539l-5.004 8.039-2.38-3.07q-.222-.294-.433-.399a.96.96 0 0 0-.457-.105.87.87 0 0 0-.668.293.95.95 0 0 0-.27.68q0 .198.07.398.083.188.212.363l2.941 3.61q.235.304.48.433.247.129.552.129"})})),qh="anchor-qw0rRl",Vh="container-obHg0v",$h="content-XrnZ0O",Kh="segment-QsUnSG",Wh="active-eqi0bb",Gh="diff-nTBpB8",Yh="toolbar-DnsvyW",Qh="mini-editor-tnZXZT",Jh="badge-container-CxxCMk",Xh="badge-Np7DF4",Zh="show-dot-LiokIi",em="wrapper-R8fIwm",tm="loading-z0pt3x",nm=e=>{const{t}=(0,vh.B)(),{loading:n=!1,revisionCount:i=0,showSuccess:s=!1,showDotBadgeTip:o=!1,isMiniEditor:a=!1,onBadgeTipClick:r}=e;return(0,K.jsx)("div",{className:re()(Yh,{[Qh]:a}),children:n?(0,K.jsx)("div",{className:re()(em),children:(0,K.jsx)("div",{className:tm,children:(0,K.jsx)(ce.tK,{})})}):i?(0,K.jsx)("div",{className:re()(Jh),children:(0,K.jsx)(ce.m_,{content:t("flow_web_ext_grammar_overall_note"),getPopupContainer:()=>(0,u.E8)()||document.body,mouseEnterDelay:300,children:(0,K.jsx)("div",{className:re()(Xh,{[Zh]:o}),onPointerUp:e=>{e.stopPropagation(),null==r||r()},children:i})})}):s?(0,K.jsx)("div",{className:re()(em),children:(0,K.jsx)(zh,{})}):null})},im={width:30,height:27};function sm(e,t){const n=new ResizeObserver(t),i=new MutationObserver(t);return window.addEventListener("resize",t),n.observe(e),i.observe(e,{attributes:!0,childList:!0,subtree:!0}),()=>{window.removeEventListener("resize",t),n.disconnect(),i.disconnect()}}const om=e=>e+1;const am=()=>{const e=Nh(),t=(0,z.useRef)(null),n=(0,z.useRef)(null),i=(0,z.useRef)(null),{layoutChangedVersion:s}=function(e,t,n){const i=Nh(),[s,o]=(0,z.useReducer)(om,0),a=i.editor.dom;return(0,z.useEffect)((()=>{const i=e.current,s=t.current,r=n.current;if(!i||!s||!r)throw new Error("can not find elements");const l=(0,_t.A)((()=>{const e=getComputedStyle(a);if("fixed"===e.position)return i.style.position="fixed",i.style.top=e.top,void(i.style.left=e.left);let t=0,n=0;const l=i.style.transform.match(/\-?\d+(\.\d+)?(?=px)/g);l&&(t=Number(l[0]),n=Number(l[1]));const c=a.getBoundingClientRect(),d=i.getBoundingClientRect();t+=c.left-d.left,n+=c.top-d.top,i.style.transform=`translate3d(${t}px, ${n}px, 0)`,"sticky"===e.position&&(i.style.position="sticky","auto"!==e.top&&(i.style.top=parseInt(e.top,10)-n+"px"),"auto"!==e.bottom&&(i.style.bottom=parseInt(e.bottom,10)-n+"px")),s.style.width=`${a.offsetWidth}px`,s.style.height=`${a.offsetHeight}px`,r.style.width=`${a.scrollWidth+a.clientLeft}px`,r.style.height=`${a.scrollHeight+a.clientTop}px`,r.style.transform=`translate3d(${-a.scrollLeft}px, ${-a.scrollTop}px, 0)`,o()}),100),c=sm(a,l);return()=>{c(),l.cancel()}}),[e,t,n,a]),(0,z.useEffect)((()=>{const e=n.current;if(!e)throw new Error("can not find elements");const t=()=>{e.style.transform=`translate3d(${-a.scrollLeft}px, ${-a.scrollTop}px, 0)`};return a.addEventListener("scroll",t),()=>{a.removeEventListener("scroll",t)}}),[n,a]),{layoutChangedVersion:s}}(t,n,i),[a,r]=(0,z.useState)(!1);(0,z.useEffect)((()=>{requestAnimationFrame((()=>{if(!i.current)return;const e=parseInt(getComputedStyle(i.current).height);r(e<=30)}))}),[s]);const{activeRevision:l,spellRevisions:c,fetching:d,showSuccessIfNeeded:u}=e.store((e=>({spellRevisions:e.spellRevisions,fetching:e.fetching,activeRevision:e.activeRevision,showSuccessIfNeeded:e.showSuccessIfNeeded}))),h=(0,uh.A)(c),m=function(e){const[t,n]=(0,z.useState)(!1),i=(0,z.useCallback)((0,_t.A)((()=>{let t=!1;e.splitContentTextRectIterator((n=>{const i=e.dom.getBoundingClientRect(),s=(0,o.A)((0,o.A)({},im),{},{y:i.bottom-im.height,top:i.bottom-im.height,x:i.right-im.width,left:i.right-im.width,bottom:i.bottom,right:i.right});return!(n.bottom<s.top&&n.right<s.left)&&(a=n,(r=s).left>a.right||r.right<a.left||r.top>a.bottom||r.bottom<a.top||(t=!0,!1));var a,r})),n(t)}),200,{leading:!1}),[]);return(0,z.useEffect)((()=>(e.addListener("contentChange",i),()=>{e.removeListener("contentChange",i)})),[]),t}(e.editor);return(0,K.jsx)("div",{className:qh,ref:t,"data-host":window.location.hostname,children:(0,K.jsxs)("div",{className:Vh,ref:n,children:[(0,K.jsx)("div",{className:$h,ref:i,children:h.flatMap((e=>e.rects.map(((t,n)=>(0,K.jsx)("div",{className:re()(Kh,Gh,{[Wh]:e.revision.id===(null==l?void 0:l.id)}),style:{top:t.top,left:t.left,width:t.width,height:t.height}},`${e.revision.id}-${n}`)))))}),(0,K.jsx)(nm,{showDotBadgeTip:m,isMiniEditor:a,onBadgeTipClick:()=>{e.replaceAll()},loading:d,showSuccess:u,revisionCount:h.length})]})})};class rm extends Uh{constructor(e){super(v.GW),(0,f.A)(this,"env",void 0),this.dom.style.zIndex="2",this.env=e,this.env.highlighterShadowContainer=this.dom}mount(){this.env.editor.dom.after(this.dom)}render(){return(0,K.jsx)(jh,{value:this.env,children:(0,K.jsx)(am,{})})}}var lm=n(45400),cm=n(66489),dm=n(58114),um=n(19730),hm=n(7021);const mm=[/\b[ap]\.m\.$/i,/\b\w\.$/,/\b\d+\.$/];function gm(e){return(0,hm.lD)(e).filter((e=>"Sentence"===e.type)).flatMap((e=>(0,ft.A)(e,"children",[]))).filter((e=>"Str"===e.type||"Punctuation"===e.type)).reduce((function(t,n){const i=t[t.length-1];if(i){if(!e.slice(i.end,n.range[0]).includes("\n")){if("Punctuation"===n.type||(s=i.raw,mm.some((e=>e.test(s)))))return i.raw=e.slice(i.start,n.range[1]),i.end=n.range[1],t}}var s;return t.push({raw:n.raw,start:n.range[0],end:n.range[1]}),t}),[])}function pm(e,t=!1){return n=>(n.start=e.transformPosition(n.start),n.end=e.transformPosition(n.end,t),n)}const vm=new Set;function fm(e,t){return`${e} -> ${t}`}class _m extends jn.A{constructor(...e){super(...e),(0,f.A)(this,"sentCounter",0),(0,f.A)(this,"prevText",""),(0,f.A)(this,"spellRevisions",Object.create(null)),(0,f.A)(this,"sentences",Object.create(null)),(0,f.A)(this,"pendingSentences",[]),(0,f.A)(this,"isApplying",!1)}createSent(e){this.sentCounter+=1;const t=this.sentCounter;return this.sentences[t]=(0,o.A)({id:t},e),t}update(e,t,n={keepRevs:!1}){(0,um.A)(this.spellRevisions,pm(t,!0)),(0,um.A)(this.sentences,pm(t,!1));const i=(0,hh.A)(gm(e),"start"),s=(0,dm.A)(this.sentences,"start"),o=new Set,a=[];return new Set([...Object.keys(i),...Object.keys(s)]).forEach((e=>{const t=i[e],n=s[e];if(t&&n){const e=n.filter((e=>!(0,cm.A)(e,t)));if(e.forEach((e=>{delete this.sentences[e.id],a.push({start:e.start,end:e.end})})),e.length===n.length){const e=this.createSent(t);o.add(e)}}else if(t){const e=this.createSent(t);o.add(e)}else n&&n.forEach((e=>{delete this.sentences[e.id],a.push({start:e.start,end:e.end})}))})),n.keepRevs||this.removeRevisionByRanges(a),[...o].map((e=>this.sentences[e]))}removeRevisionByRanges(e){(0,um.A)(this.spellRevisions,((t,n)=>{e.some((e=>ah(t,e)))&&delete this.spellRevisions[n]})),this.emit("revisionChange",this.spellRevisions)}removeRevision(e){delete this.spellRevisions[e],this.emit("revisionChange",this.spellRevisions)}clearRevision(){this.spellRevisions={},this.emit("revisionChange",this.spellRevisions)}getOffsetSortedRevisions(){return Object.values(this.spellRevisions).sort(((e,t)=>e.start-t.start))}ignore(e){var t,n;t=e.raw,n=e.replacement,vm.add(fm(t,n)),this.removeRevision(e.id),this.emit("revisionChange",this.spellRevisions)}updateRevisionOffsetAfterApply(e){const{start:t,end:n,replacement:i}=e,s=this.getOffsetSortedRevisions();(0,um.A)(s,(e=>{if(e.start<n)return;const s=i.length-(n-t);e.start+=s,e.end+=s})),this.emit("revisionChange",this.spellRevisions)}createRevisions(e){e.forEach((e=>{var t;const{sent_id:n}=e,i=this.sentences[n];i&&(null===(t=e.revision_units)||void 0===t||t.forEach((t=>{var s;null===(s=t.span_list)||void 0===s||s.forEach((s=>{const o=i.raw.slice(s.org_start_idx,s.org_end_idx),a=e.replacement.slice(s.edt_start_idx,s.edt_end_idx);if(!o||!a)return;if(((e,t)=>vm.has(fm(e,t)))(o,a))return;const r=(0,lm.A)(),{label_id:l}=t,c=i.start+s.org_start_idx,d=i.start+s.org_end_idx;this.spellRevisions[r]={id:r,labelId:l,sentId:n,type:"diff",raw:o,replacement:a,start:c,end:d}}))})))})),this.emit("revisionChange",this.spellRevisions)}destroy(){this.removeAllListeners(),this.spellRevisions={},this.sentences={},this.pendingSentences=[]}}class ym extends jn.A{constructor(...e){var t;super(...e),t=this,(0,f.A)(this,"queue",[]),(0,f.A)(this,"isRequesting",!1),(0,f.A)(this,"doRequest",(0,a.A)((function*(){if(!t.isRequesting&&0===t.queue.length)return void t.emit("finish");if(t.isRequesting)return;const e=t.queue.slice(0,10);t.queue=t.queue.slice(10),t.isRequesting=!0,t.emit("fetching");try{const n=yield(0,ci.Y_)(e);t.emit("update",n.items)}catch(n){}t.isRequesting=!1,t.doRequest()}))),(0,f.A)(this,"request",((e,t)=>{this.queue=[...this.queue,...e],this.removeInvalidSentence(t),this.doRequest()}))}removeInvalidSentence(e){this.queue=this.queue.filter((t=>e.includes(t.id)))}destroy(){this.queue=[],this.removeAllListeners()}}const xm={spellRevisions:{},fetching:!1,showSuccessIfNeeded:!1},bm=e=>(0,o.A)((0,o.A)({},xm),{},{setSpellRevisions:t=>{e((()=>({spellRevisions:t})))},setActiveRevision:t=>{e((()=>({activeRevision:t})))},setFetching:t=>{e((()=>({fetching:t})))},setShowSuccessIfNeeded:t=>{e((()=>({showSuccessIfNeeded:t})))}});class Am{constructor(e,t){var n=this;(0,f.A)(this,"editor",void 0),(0,f.A)(this,"model",void 0),(0,f.A)(this,"store",void 0),(0,f.A)(this,"highlighterShadowContainer",void 0),(0,f.A)(this,"popupCardShadowContainer",void 0),(0,f.A)(this,"showSuccessTimer",null),(0,f.A)(this,"clearShowSuccessTimer",(()=>{this.showSuccessTimer&&(window.clearTimeout(this.showSuccessTimer),this.showSuccessTimer=null)})),(0,f.A)(this,"showSuccess",(()=>{this.store.getState().setShowSuccessIfNeeded(!0),this.clearShowSuccessTimer(),this.showSuccessTimer=window.setTimeout((()=>{this.store.getState().setShowSuccessIfNeeded(!1),this.showSuccessTimer=null}),1500)})),(0,f.A)(this,"ignore",(e=>{this.model.ignore(e)})),(0,f.A)(this,"replace",function(){var e=(0,a.A)((function*(e){n.model.isApplying=!0,yield n.editor.replace(e.start,e.end,e.replacement),n.model.removeRevision(e.id),n.model.isApplying=!1,n.showSuccess()}));return function(t){return e.apply(this,arguments)}}()),(0,f.A)(this,"replaceAll",(0,a.A)((function*(){n.model.isApplying=!0;const e=n.model.getOffsetSortedRevisions().reverse();for(const t of e)yield n.editor.replace(t.start,t.end,t.replacement);n.model.clearRevision(),n.model.isApplying=!1,n.showSuccess()}))),this.editor=e,this.model=t,this.store=(0,ii.vt)()((0,ni.eh)(bm))}setRevisionStore(e){this.store.getState().setSpellRevisions(e.spellRevisions)}getRevisionState(){return this.store.getState()}destroy(){this.store.destroy(),this.highlighterShadowContainer=void 0,this.popupCardShadowContainer=void 0,this.clearShowSuccessTimer()}}const wm=["BLOCKQUOTE"];function Sm(e){if(ih(e)){if(wm.includes(e.tagName))return NodeFilter.FILTER_REJECT;if(e instanceof HTMLButtonElement||"button"===e.getAttribute("role"))return NodeFilter.FILTER_REJECT;if("none"===getComputedStyle(e).display)return NodeFilter.FILTER_REJECT}if(e instanceof Text){if(!e.nodeValue||!e.parentElement)return NodeFilter.FILTER_REJECT;if(/^\s*\n\s*$/.test(e.nodeValue)&&!getComputedStyle(e.parentElement).whiteSpace.startsWith("pre"))return NodeFilter.FILTER_REJECT}return NodeFilter.FILTER_ACCEPT}const Cm=NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT;function*km(e,t){var n,i;const s=null!==(n=null==t?void 0:t.isNewline)&&void 0!==n?n:Em,o=null!==(i=null==t?void 0:t.filter)&&void 0!==i?i:Sm,a=document.createTreeWalker(e,Cm,o);let r=a.nextNode(),l=!1,c=!1;const d=[],u=e=>{const t=e.previousElementSibling,n=t?d.indexOf(t):-1;if(n>-1){return d.splice(n).some(s)}return!1};for(;r;){if(c=c||u(r),r instanceof Text){const e=c||l;c=!1,l=!1,yield{newline:e,node:r}}else r.childNodes.length>0&&d.push(r);l=l||s(r),r=a.nextNode()}}const Im=["block","flex","grid","flow-root","table","-webkit-box","-moz-box","-webkit-flex","-moz-flex","-ms-flexbox","list-item"];function Em(e){if(e instanceof HTMLElement){if("BR"===e.tagName)return!0;const t=getComputedStyle(e),[n=""]=t.display.split(" ");if(Im.includes(n))return!0}return!1}function Tm(e){var t;if(!e.parentElement||!e.nodeValue)return"";let n=null===(t=e.nodeValue)||void 0===t?void 0:t.replace(/\u200b/g,"").replace(/\u00a0|\u2002|\u2003/g," ");return getComputedStyle(e.parentElement).whiteSpace.startsWith("pre")||(n=n.replace(/\n/g,"")),n}class jm extends jn.A{}class Nm extends jm{constructor(e){var t,n;super(),t=this,(0,f.A)(this,"dom",void 0),(0,f.A)(this,"filter",void 0),(0,f.A)(this,"textNodes",void 0),(0,f.A)(this,"mutationObserver",void 0),(0,f.A)(this,"isComposition",!1),(0,f.A)(this,"handleCompositionStart",(()=>this.isComposition=!0)),(0,f.A)(this,"handleCompositionEnd",(()=>{this.isComposition=!1,this.handleChange()})),(0,f.A)(this,"bind",(()=>{this.dom.addEventListener("compositionstart",this.handleCompositionStart),this.dom.addEventListener("compositionend",this.handleCompositionEnd),this.mutationObserver=new MutationObserver(this.handleChange),this.mutationObserver.observe(this.dom,{subtree:!0,childList:!0,characterData:!0})})),(0,f.A)(this,"unbind",(()=>{var e;this.dom.removeEventListener("compositionstart",this.handleCompositionStart),this.dom.removeEventListener("compositionend",this.handleCompositionEnd),null===(e=this.mutationObserver)||void 0===e||e.disconnect(),this.mutationObserver=void 0})),(0,f.A)(this,"handleChange",(()=>{this.isComposition||(this.textNodes=this.extractTextNodes(),this.emit("contentChange",this.text))})),(0,f.A)(this,"splitContentTextRectIterator",(e=>{for(let t=this.textNodes.length-1;t>=0;t--){const n=this.textNodes[t].node,i=document.createRange();i.setStart(n,0),i.setEnd(n,n.length);const s=Array.from(i.getClientRects());for(let t=s.length-1;t>=0;t--)if(!1===e(s[t]))return}})),(0,f.A)(this,"getSelection",(()=>{const e=document.getSelection();if(!e||e.rangeCount<1)return;const t=e.getRangeAt(0);if(!this.dom.contains(t.commonAncestorContainer))return;let n,i,s=0;for(const o of this.textNodes){if(o.newline&&(s+=1),t.startContainer.contains(o.node)&&(n=s+t.startOffset),t.endContainer.contains(o.node)&&(i=s+t.endOffset),n&&i){const e=(0,eh.A)(t.getClientRects());return{collapsed:t.collapsed,start:n,end:i,rect:e,text:this.text.slice(n,i)}}s+=Tm(o.node).length}})),(0,f.A)(this,"selectText",((e,t,n)=>{const i=window.getSelection(),s=new Range;return s.setStart(e,t),s.setEnd(e,n),null==i||i.removeAllRanges(),null==i||i.addRange(s),s})),(0,f.A)(this,"insertText",((e,t)=>{const n={bubbles:!0,cancelable:!0,inputType:"insertText",data:e};if("StaticRange"in window&&"getTargetRanges"in InputEvent.prototype)try{n.targetRanges=[new StaticRange(t)]}catch(s){}const i=new InputEvent("beforeinput",n);this.dom.dispatchEvent(i),document.execCommand("insertText",!1,e)})),(0,f.A)(this,"applyReplacement",function(){var e=(0,a.A)((function*(e,n,i,s){const o=t.selectText(e,n,i);yield(0,u.uk)(),t.insertText(s,o)}));return function(t,n,i,s){return e.apply(this,arguments)}}()),(0,f.A)(this,"replace",function(){var e=(0,a.A)((function*(e,n,i){t.dom.focus();const s=t.getRelativeTextNodesByRange(e,n).map(((e,t)=>(0,o.A)((0,o.A)({},e),{},{replacement:0===t?i:""})));for(const o of s.reverse())yield t.applyReplacement(o.node,o.from,o.to,o.replacement);t.dom.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!1})),t.dom.dispatchEvent(new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0,keyCode:17,which:17,charCode:0,location:1,key:"Control",code:"ControlLeft"})),yield(0,u.uk)()}));return function(t,n,i){return e.apply(this,arguments)}}()),this.filter=nh(n=window.location.hostname,"notion.so")?e=>ih(e)&&(e.classList.contains("notion-page-controls")||"true"===e.getAttribute("data-content-editable-void")||"14vh"===e.style.marginBottom)?NodeFilter.FILTER_REJECT:Sm(e):nh(n,"mail.google.com",3)?e=>ih(e)&&e.classList.contains("gmail_quote")?NodeFilter.FILTER_REJECT:Sm(e):nh(n,"feishu.cn")?e=>ih(e)&&(e.classList.contains("code-block-container")||e.classList.contains("uneditable")||e.classList.contains("docx-code-block-container")||e.classList.contains("docx-diagram-block")||e.classList.contains("docx-chat_card-block")||e.classList.contains("doc-meta-entry-wrapper")||e.classList.contains("doc-info-wrapper")||e.classList.contains("scrollable-wrapper")||e.classList.contains("resizable-container")||e.classList.contains("ace-line")&&!e.isContentEditable)?NodeFilter.FILTER_REJECT:Sm(e):nh(n,"outlook.live.com",3)?e=>{var t;return!ih(e)||"divRplyFwdMsg"!==e.id&&"divRplyFwdMsg"!==(null===(t=e.previousElementSibling)||void 0===t?void 0:t.id)?Sm(e):NodeFilter.FILTER_REJECT}:Sm,this.dom=e,this.textNodes=this.extractTextNodes(),this.bind()}extractTextNodes(){let e=0;return[...km(this.dom,{filter:this.filter})].map((t=>{const{node:n,newline:i}=t;i&&(e+=1);const s=Tm(n),a=(0,o.A)((0,o.A)({},t),{},{text:s,offset:e});return e+=s.length,a}))}calcPureText(){let e="";for(const t of this.textNodes)t.newline&&(e+="\n"),e+=Tm(t.node);return e}get text(){return this.calcPureText()}valid(e){if(rh(e,(e=>e instanceof HTMLAnchorElement))||function(e){return rh(e,(e=>e instanceof HTMLElement&&e.matches("code")))}(e))return!1;var t,n;if(nh(window.location.hostname,"feishu.cn")&&(null!==(t=sh(e,2))&&void 0!==t&&t.classList.contains("smart-correction-text")||null!==(n=sh(e,4))&&void 0!==n&&n.classList.contains("grammar-check")))return!1;return!0}getRevisionRect(e){const t=[],n=new Set,{textNodes:i}=this;e:for(const s of e){if(n.has(s.sentId))continue;let e=[],o=0;for(const t of i){const i=Tm(t.node).length;t.newline&&(o+=1);if(ah(s,{start:o,end:o+i})){if(!this.valid(t.node)){n.add(s.sentId);continue e}const a=Math.max(s.start,o)-o,r=Math.min(s.end,o+i)-o;e.push(...lh(t.node,a,r))}o+=i}e=e.filter((e=>e.width>0));const a=ch(this.dom,e);a.length>0&&t.push({revision:s,rects:a})}return t.filter((e=>!n.has(e.revision.sentId)))}getRelativeTextNodesByRange(e,t){const n=[];for(const i of this.textNodes){const{text:s,node:o,offset:a}=i;ah({start:e,end:t-1},{start:a,end:a+s.length-1})&&n.push({from:Math.max(e,a)-a,to:Math.min(t,a+s.length)-a,node:o})}return n}destroy(){this.removeAllListeners(),this.unbind()}}class Mm extends jm{constructor(e){var t;super(),t=this,(0,f.A)(this,"dom",void 0),(0,f.A)(this,"isComposition",!1),(0,f.A)(this,"handleCompositionStart",(()=>this.isComposition=!0)),(0,f.A)(this,"handleCompositionEnd",(()=>{this.isComposition=!1,this.handleChange()})),(0,f.A)(this,"bind",(()=>{this.dom.addEventListener("compositionstart",this.handleCompositionStart),this.dom.addEventListener("compositionend",this.handleCompositionEnd),this.dom.addEventListener("input",this.handleChange),this.dom.addEventListener("change",this.handleChange)})),(0,f.A)(this,"unbind",(()=>{this.dom.removeEventListener("compositionstart",this.handleCompositionStart),this.dom.removeEventListener("compositionend",this.handleCompositionEnd),this.dom.removeEventListener("input",this.handleChange),this.dom.removeEventListener("change",this.handleChange)})),(0,f.A)(this,"handleChange",(()=>{this.isComposition||this.emit("contentChange",this.text)})),(0,f.A)(this,"splitContentTextRectIterator",(e=>{const t=Dh(this.dom,"INPUT"===this.dom.tagName).firstChild;if(!t)return[];const n=document.createRange();n.setStart(t,0),n.setEnd(t,t.length);const{top:i,left:s}=this.dom.getBoundingClientRect(),o=Array.from(n.getClientRects()).map((e=>({top:e.top+i,left:e.left+s,y:e.y+i,x:e.x+s,width:e.width,height:e.height,right:e.right+s,bottom:e.bottom+i})));for(let a=o.length-1;a>=0;a--)if(!1===e(o[a]))return})),(0,f.A)(this,"replace",function(){var e=(0,a.A)((function*(e,n,i){document.activeElement!==t.dom&&(t.dom.focus(),yield(0,u.uk)()),t.dom.setSelectionRange(e,n,"forward"),document.execCommand("insertText",!1,i),yield(0,u.uk)()}));return function(t,n,i){return e.apply(this,arguments)}}()),this.dom=e,this.bind()}get text(){return this.dom.value}getSelection(){const e=this.dom.selectionStart,t=this.dom.selectionEnd;if(!e||!t)return;const n=Dh(this.dom,"INPUT"===this.dom.tagName).firstChild;if(!n)return;const i=document.createRange();i.setStart(n,e),i.setEnd(n,t);const s=(0,eh.A)(i.getClientRects());if(!s)return;const{top:o,left:a}=this.dom.getBoundingClientRect();return{start:e,end:t,rect:{top:o+s.top,left:a+s.left,y:o+s.y,x:a+s.x,width:s.width,height:s.height,right:s.right+a,bottom:s.bottom+o},collapsed:e===t,text:this.text.slice(e,t)}}getRevisionRect(e){const t=[],n=Dh(this.dom,"INPUT"===this.dom.tagName),i=document.createRange(),s=n.firstChild;if(!s)return t;for(const a of e)try{i.setStart(s,a.start),i.setEnd(s,a.end);const e=[...i.getClientRects()];t.push({revision:a,rects:e})}catch(o){}return i.detach(),t}destroy(){this.unbind(),this.removeAllListeners()}}class Lm extends jn.A{constructor(e){super(),(0,f.A)(this,"editor",void 0),(0,f.A)(this,"model",void 0),(0,f.A)(this,"env",void 0),(0,f.A)(this,"fetcher",void 0),(0,f.A)(this,"highlightRenderer",void 0),(0,f.A)(this,"popupCardRenderer",void 0),(0,f.A)(this,"disconnectObserveEditorLayout",void 0),(0,f.A)(this,"cacheNewSentences",[]),(0,f.A)(this,"bind",(()=>{this.disconnectObserveEditorLayout=sm(this.editor.dom,this.updateRevisionsRectsState),this.editor.addListener("contentChange",this.handleEditorContentChange),this.model.addListener("revisionChange",this.updateRevisionsRectsState),this.fetcher.addListener("update",this.handleRevisionFetchResp),this.fetcher.addListener("fetching",this.handleFetching),this.fetcher.addListener("finish",this.handleFetchFinish)})),(0,f.A)(this,"unbind",(()=>{var e;null===(e=this.disconnectObserveEditorLayout)||void 0===e||e.call(this),this.editor.removeListener("contentChange",this.handleEditorContentChange),this.model.removeListener("revisionChange",this.updateRevisionsRectsState),this.fetcher.removeListener("update",this.handleRevisionFetchResp),this.fetcher.removeListener("fetching",this.handleFetching),this.fetcher.removeListener("finish",this.handleFetchFinish)})),(0,f.A)(this,"handleRevisionFetchResp",(e=>{this.model.createRevisions(e)})),(0,f.A)(this,"handleFetching",(()=>{this.env.store.getState().setFetching(!0)})),(0,f.A)(this,"handleFetchFinish",(()=>{this.env.store.getState().setFetching(!1)})),(0,f.A)(this,"updateRevisionsRectsState",(()=>{const e=this.editor.getRevisionRect((0,uh.A)(this.model.spellRevisions));this.env.setRevisionStore({spellRevisions:(0,hh.A)(e,(e=>e.revision.id))})})),(0,f.A)(this,"handleEditorContentChange",(()=>{const{text:e}=this.editor,t=(new(gh())).insert(this.model.prevText).diff((new(gh())).insert(e));if(0===t.ops.length)return;this.model.prevText=e;const n=this.model.update(e,t,{keepRevs:this.model.isApplying});this.cacheNewSentences.push(...n),this.model.isApplying||this.debounceDoRevision()})),(0,f.A)(this,"doRevision",(()=>{const e=Object.keys(this.model.sentences).map(Number);this.fetcher.request(this.cacheNewSentences,e),this.cacheNewSentences=[]})),(0,f.A)(this,"debounceDoRevision",(0,xt.A)(this.doRevision,1500));const{editorType:t,element:n}=e;this.editor=this.createEditor(t,n),this.model=new _m,this.env=new Am(this.editor,this.model),this.fetcher=new ym,this.highlightRenderer=new rm(this.env),this.popupCardRenderer=new Hh(this.env),this.bind(),this.handleEditorContentChange()}createEditor(e,t){return e===th.Input?new Mm(t):new Nm(t)}destroy(){this.cacheNewSentences=[],this.unbind(),this.env.destroy(),this.editor.destroy(),this.model.destroy(),this.fetcher.destroy(),this.highlightRenderer.destroy(),this.popupCardRenderer.destroy()}}const Rm=new class{constructor(){var e=this;(0,f.A)(this,"inited",!1),(0,f.A)(this,"controllerPool",new Map),(0,f.A)(this,"editorRemoveObservers",[]),(0,f.A)(this,"bindAppStorageConfigChange",(()=>{Wn.A.watch({disableGlobalGrammar:this.handleAppStorageConfigChange,disableGrammarHosts:this.handleAppStorageConfigChange})})),(0,f.A)(this,"unbindAppStorageConfigChange",(()=>{Wn.A.unwatch({disableGlobalGrammar:this.handleAppStorageConfigChange,disableGrammarHosts:this.handleAppStorageConfigChange})})),(0,f.A)(this,"handleAppStorageConfigChange",(0,a.A)((function*(){yield(0,u.uk)(500),e.isDisabledGrammar()?e.reset():e.init()}))),(0,f.A)(this,"isDisabledGrammar",(()=>{const e=(0,X.TK)("disableGlobalGrammar"),t=(0,X.TK)("disableGrammarHosts");return!(!e&&!t.includes(window.location.hostname))})),(0,f.A)(this,"bind",(()=>{document.addEventListener("focus",this.handleFocus,!0)})),(0,f.A)(this,"unbind",(()=>{document.removeEventListener("focus",this.handleFocus,!0)})),(0,f.A)(this,"handleFocus",(e=>{const{target:t}=e;t instanceof HTMLElement&&this.activeEditor(t)})),(0,f.A)(this,"observeEditorElementRemove",(e=>{if(!e.parentElement)return;const t=new MutationObserver((n=>{for(const i of n)if(i.removedNodes)for(const n of i.removedNodes)if(n===e){const n=this.controllerPool.get(e);return null==n||n.destroy(),this.controllerPool.delete(e),void t.disconnect()}}));return t.observe(e.parentElement,{childList:!0}),t})),(0,f.A)(this,"addController",((e,t)=>{let n=this.controllerPool.get(e);if(!n){n=new Lm({element:e,editorType:t}),this.controllerPool.set(e,n);const i=this.observeEditorElementRemove(e);i&&this.editorRemoveObservers.push(i)}})),(0,f.A)(this,"activeEditor",(e=>{if(!(e instanceof HTMLElement))return!1;if(!this.isValid(e))return;const t=function(e){const t=oh(e,(e=>{var t,n;const i=null!==(t=null===(n=e.getAttribute("contenteditable"))||void 0===n?void 0:n.toLowerCase())&&void 0!==t?t:"false",s=e.getAttribute("data-language");return"false"!==i&&!s&&!e.classList.contains("cm-content")}));if(t)return{type:th.Rich,element:t};const n=oh(e,(e=>"TEXTAREA"===e.nodeName||"INPUT"===e.nodeName));return n?{type:th.Input,element:n}:void 0}(e);if(!t)return;const{type:n,element:i}=t;this.addController(i,n)})),(0,f.A)(this,"isValid",(e=>!!function(e){var t;const{hostname:n}=window.location;return!(dh.some((e=>nh(n,e)))||nh(n,"outlook.live.com",3)&&e.classList.contains("EditorClass")||e.classList.contains("mm-editor")&&null!==(t=sh(e))&&void 0!==t&&t.classList.contains("minder-editor-container")||e instanceof HTMLInputElement)}(e))),this.bindAppStorageConfigChange()}init(){this.isDisabledGrammar()||this.inited||(this.inited=!0,this.activeEditor(document.activeElement),this.bind())}reset(){this.inited=!1,this.unbind(),this.editorRemoveObservers.forEach((e=>e.disconnect())),this.editorRemoveObservers=[],this.controllerPool.forEach((e=>e.destroy())),this.controllerPool.clear()}destroy(){this.reset(),this.unbindAppStorageConfigChange()}};var Pm=n(18811),Bm=n(21589),Om=n(62277),Dm=n(34847),Fm=n(87667);const Um={name:"close-cici-sidebar",handle:()=>{se.l.getState().setIsShowSidebar(!1,Q.cz.other)}},Hm={name:"content-menu-click",handle:e=>{const{actionKey:t,selectionText:n=""}=e||{};if(t)if("collect_page"===t)(0,O.X)({collectFrom:m.vP.collect_this_page,collectionType:h.X.Web});else{const{inputText:e,selectionBaseInfo:i}=fl.t_.getState(),s=!e||_l.IF.getState().type===gi.u9.pdf||!(e=>{const{top:t,left:n,width:i,height:s,clientBottom:o}=e;return[t,n,i,s,o].every((e=>null!=e&&!isNaN(e)))})(i);if(s&&n){const e=(0,o.A)((0,o.A)({},yl.Ws),{},{text:n,contextText:n,anchorOffset:0});fl.t_.setState({inputText:n,selectionBaseInfo:e,simpleSelectionBaseInfo:e})}(0,Ol.qZ)(t,Q.Z5.context_menu,s)}}},zm={name:"tab-activated",handle:e=>{io.on.getState().setTabInfo({tabId:e.tabId}),(0,Nu.BF)()}},qm={name:"toggle-cici-sidebar",handle:()=>{se.l.getState().toggleShowSidebar(Q.cz.other)}},Vm={name:"receive_tts_audio",handle:e=>{const{id:t,data:n}=e;return Sl.emit(t,n),t}},$m=()=>{const e=(0,Mu.c)(Object.values(s));return()=>{e(),Mu.F.destroy()}};var Km=n(71291);let Wm;const Gm=e=>{const{shadowContainer:t,shadowHost:n,shadowRoot:i}=(0,is.VT)(v.ly);return(e=>{d.m.getInstance().init(),Wm=d.m.getInstance().getHostId(),e.dataset.hostId=Wm})(n),(0,is.YB)(n),e.mark("load_css_start"),(0,is.NR)(i,v.QN).then((()=>{e.mark("load_css_end"),(0,is.XX)(t,$u),e.mark("component_mounted"),setTimeout((()=>{document.querySelector("#Cici-ai-assistant")||e.mark("component_mounted_error"),e.end("component_mounted_end")}),500)})),i},Ym=()=>{if((0,r.Ny)())return;const e=[];e.push((()=>{var e;const t=(0,Vo.Ay)(location.href);if(!t)return null;let n=null===(e=t.watchRouteChange)||void 0===e?void 0:e.call(t,(()=>{al(t)}));return al(t),()=>{var e;null===(e=n)||void 0===e||e(),n=void 0}})()),e.push((()=>{const e=(e,t,n)=>{const{setVideoId:i,setVideoTitle:s,setVideoPartId:o}=ie.e.getState();i(e||""),s(t||""),o(n||"0");const a=(0,ue.Ay)(location.href);al(a)},t=t=>{var n;const i=null==t||null===(n=t.detail)||void 0===n||null===(n=n.response)||void 0===n||null===(n=n.playerResponse)||void 0===n?void 0:n.videoDetails;e(null==i?void 0:i.videoId,null==i?void 0:i.title)},n=()=>{if(!(0,ue.jB)("bilibili"))return;const{videoId:t,title:n,partId:i}=(0,oe.OX)();e(t,n,i)};let i,s;(()=>{const t=(0,ue.Ay)(location.href);if((0,ue.jB)(null==t?void 0:t.name)){let o="",a="";var n;if("youtube"===(null==t?void 0:t.name))o=(0,oe.Wd)(t),a=null===(n=document)||void 0===n?void 0:n.title,e(o,a);else if("bilibili"===(null==t?void 0:t.name)){var s;i=null===(s=t.pageIsReady)||void 0===s?void 0:s.call(t,(()=>{const{videoId:t,title:n,partId:i}=(0,oe.OX)();o=t,a=n,e(o,a,i)}))}}})();const o=(0,ue.Ay)(location.href);var a;return(0,ue.jB)("bilibili")&&(s=null==o||null===(a=o.onUrlChange)||void 0===a?void 0:a.call(o,n)),window.addEventListener("yt-navigate-finish",t),()=>{var e,n;window.removeEventListener("yt-navigate-finish",t),null===(e=s)||void 0===e||e(),null===(n=i)||void 0===n||n()}})()),e.push((()=>{var e;const t=(0,nl.Ay)(location.href);if(!t)return;let n;const i=null===(e=t.watchMailWritable)||void 0===e?void 0:e.call(t,(()=>{var e;null===(e=n)||void 0===e||e(),n=cl(t)}));return n=cl(t),()=>{var e;null==i||i(),null===(e=n)||void 0===e||e()}})()),e.push(ul()),e.push((()=>{if(!(0,p.ku)())return()=>"";const e=H();return()=>{null==e||e()}})()),d.m.getInstance().registerRecyclables(e)},Qm=function(){var e=(0,a.A)((function*(){try{var e;(0,d.A)((()=>{const e=[gl(),$m()];return()=>{e.forEach((e=>e()))}})()),(0,Dm.Ao)();const t=Yn.Qz.create("cici_assistant_startup_perf",!0);yield(0,Pm.n)(),l.j.init({httpClient:ut.sY,getCommonHeaders:Km.Ql,getCommonParams:Km.wH,baseURL:Om.i4}),yield G.Ay.initTea(),yield(0,bi.LE)(),yield(0,Fm.S)(),yield Xu();const n=Gm(t);if(null===(e=(0,Dm.Gl)())||void 0===e||e.startResourceMonitor(n),Ym(),Bm.F&&(Rm.init(),(0,d.A)((()=>Rm.reset()))),-1!==location.origin.indexOf("www.baidu.com")){const e=new MutationObserver((function(e){for(const i of e)for(const e of i.removedNodes){var n;(null==e||null===(n=e.dataset)||void 0===n?void 0:n.hostId)===Wm&&Gm(t)}}));e.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),(0,d.A)((()=>null==e?void 0:e.disconnect()))}0,(0,Nu.BF)()}catch(t){console.error(t),xi.vF.persist.info({eventName:"[CSUI] - BOOTSTRAP",meta:(0,o.A)({},t)})}}));return function(){return e.apply(this,arguments)}}();try{null===(Jm=document)||void 0===Jm||null===(Jm=Jm.querySelectorAll(`#${v.Yq}`))||void 0===Jm||Jm.forEach((e=>{var t;e&&e instanceof HTMLElement&&void 0===(null==e||null===(t=e.dataset)||void 0===t?void 0:t.hostId)&&(-1!==location.origin.indexOf("www.baidu.com")?(e.id=`${e.id}-depressed`,e.style.display="none"):e.remove())})),null===(Xm=document)||void 0===Xm||null===(Xm=Xm.querySelectorAll(`#${v.hs}`))||void 0===Xm||Xm.forEach((e=>{var t;e instanceof HTMLElement&&void 0===(null==e||null===(t=e.dataset)||void 0===t?void 0:t.fullSearchHostId)&&(e.id=`${e.id}-depressed`,e.style.display="none")})),null===(Zm=document)||void 0===Zm||null===(Zm=Zm.querySelectorAll(`#${v.U6}`))||void 0===Zm||Zm.forEach((e=>{var t;e instanceof HTMLElement&&void 0===(null==e||null===(t=e.dataset)||void 0===t?void 0:t.searchHostId)&&(e.id=`${e.id}-depressed`,e.style.display="none")})),null===(eg=document)||void 0===eg||null===(eg=eg.querySelectorAll(`#${v.$9}`))||void 0===eg||eg.forEach((e=>{var t;e instanceof HTMLElement&&void 0===(null==e||null===(t=e.dataset)||void 0===t?void 0:t.videoSearchHostId)&&(e.id=`${e.id}-depressed`,e.style.display="none")})),null===(tg=document.querySelectorAll(`[id*=${v.AJ}]`))||void 0===tg||tg.forEach((e=>{var t;e instanceof HTMLElement&&void 0===(null==e||null===(t=e.dataset)||void 0===t?void 0:t.mailHostId)&&(e.id=`${e.id}-depressed`,e.style.display="none")}))}catch(ng){console.error("\u8001\u7248\u672c\u63d2\u4ef6\u8d44\u6e90\u91ca\u653e\u5f02\u5e38",ng)}var Jm,Xm,Zm,eg,tg;Qm().finally((()=>{(0,d.A)((()=>{var e;console.log("lcj--\x3e destory....",Wm),void 0!==Wm&&(null===(e=document)||void 0===e||null===(e=e.querySelector(`[data-host-id="${Wm}"]`))||void 0===e||e.remove(),Wm=void 0)})),(0,d.A)(X.LR),(0,d.A)((()=>{c.Lh$.socketAdaptor&&(c.Lh$.socketAdaptor.drop(),c.Lh$.socketAdaptor.client=void 0)}))}))},41104:(e,t,n)=>{n.d(t,{Dn:()=>s,Sx:()=>o,wU:()=>i});const i=["ul:has(li)"],s=["block","flow-root","grid","list-item","flex","-webkit-box"],o="en-US"},566:(e,t,n)=>{n.d(t,{DC:()=>l,N3:()=>c,OP:()=>d,UU:()=>v,W$:()=>u,ZG:()=>g,iw:()=>p,mp:()=>h,xd:()=>m});var i=n(41104);const s=e=>e instanceof Element&&"STYLE"===e.tagName.toUpperCase(),o=e=>e instanceof Element&&"LINK"===e.tagName.toUpperCase(),a=e=>e instanceof Element&&"SCRIPT"===e.tagName.toUpperCase(),r=e=>8===e.nodeType,l=e=>[s,o,a,r].some((t=>t(e)));const c=e=>{const t=window.getComputedStyle(e);return"none"===t.display||"hidden"===t.visibility||"0"===t.opacity};function d(e){const t=document.createElement("div");return t.innerText=t.textContent=e,e=t.innerHTML}function u(e){return/^[\n\s]*$/.test(e.textContent||"")}const h=e=>{const t=/^[\s\n]*$/,n=e=>{if(e.nodeType===Node.TEXT_NODE){const n=e.textContent||"";if(!t.test(n))return!0}else if(e.nodeType===Node.ELEMENT_NODE&&e instanceof Element&&!l(e))for(const t of Array.from(e.childNodes))if(n(t))return!0;return!1};return n(e)},m=e=>Array.from(e.children).some((e=>{const{isBlockOrTableDisplay:t}=g(e);return!!t||e.children.length>0&&e instanceof HTMLElement&&m(e)})),g=e=>{const t=getComputedStyle(e).getPropertyValue("display"),n="br"===e.tagName.toLowerCase()||i.Dn.includes(t)||t.includes("table");return{display:t,isBlockOrTableDisplay:n}};function p(e,t){return e=e.replaceAll(/[\n\s]/g,""),t=t.replaceAll(/[\n\s]/g,""),e.toLocaleLowerCase()===t.toLocaleLowerCase()}function v(e){return e.replaceAll(/[\n]\s*/g,"")}},32750:(e,t,n)=>{n.d(t,{BB:()=>v,OB:()=>g,vh:()=>f});var i=n(44557),s=n(11855),o=n(41967),a=n(2393),r=n(57512),l=n(22315),c=n(14144),d=n(26106),u=n(82741),h=n(35746);const m="onboardingActionRecord",g=(e,t="web")=>{switch(e){case l.EU.ask:return`${t}_ask`;case l.EU.mail:return`${t}_gmail`;default:return`${t}_${e}`}},p=e=>{const{action:t}=e;if(t){if(!a.bc.includes(t))return!0;const n=(({action:e,update:t,record:n})=>{if(a.fW.includes(e)){var i;let s=Number((null===(i=n||(0,r.TK)(m))||void 0===i||null===(i=i[e])||void 0===i?void 0:i.count)||0);return t&&(s++,(0,c.Rm)(`action ${e} used count: ${s}`),(0,r.vE)(m,{[e]:{count:s}},!0)),s}{const t=new Error(`action [${e}] not found in predefined keys`);d.vF.persist.error({eventName:"[Onboarding Action] not found action",error:t}),(0,c.z3)(t)}})((0,i.A)((0,i.A)({},e),{},{action:t}));if((0,o.A)(n)&&n<=a.C9[t])return!0}return!1},v=e=>{const{action:t,triggerLogin:n=!0,loginParams:i}=e,s=(0,r.TK)("authInfo");if(!(null!=s&&s.isAuthenticated||p({action:t,update:!0})))return n&&(0,h.DT)(i),!0},f=(e,t)=>{var n;const i=null===(n=(0,u.Y)("authInfo")[0])||void 0===n?void 0:n.isAuthenticated,o=(0,u.Y)(m)[0],a=(0,s.useMemo)((()=>!i&&p({action:e,record:o,update:!1})),[o,e,i]);return i||!t&&a}},99916:(e,t,n)=>{n.d(t,{Bc:()=>_,Pe:()=>x,ci:()=>v});var i=n(14065),s=n(34553),o=n(51187),a=n(50779),r=n(94682),l=n(58020),c=n(52335),d=n(12893),u=n(69366),h=n(26106),m=n(97946),g=n(10992);function p(){return(p=(0,i.A)((function*(e){yield(0,u.c)({name:"clear-http-cache",body:["message/list","samantha/feed"]});const t=yield r.pU.getState().fetchUpdateConversationInfo(e);yield o.ozw.getState().initMessageList({conversationId:e,messageCursor:Number(null==t?void 0:t.message_cursor),messageIndex:Number(null==t?void 0:t.message_index),range:{start:Number(null==t?void 0:t.message_cursor),end:Number(null==t?void 0:t.message_index)}})}))).apply(this,arguments)}function v(e){return f.apply(this,arguments)}function f(){return f=(0,i.A)((function*({messageIds:e=[],switchMessageId:t="0"}){const n=yield(0,d.$D)();if(void 0!==n){try{yield(0,g.U8)({conversationId:n,messageIds:e,switchMessageId:t})}catch(i){h.vF.persist.error({message:"push record error",error:i})}c.l.getState().isSidePanelMode&&!m._.isInSidePanel?(0,u.c)({name:"continue-in-chat",body:{conversationId:n}}):function(e){p.apply(this,arguments)}(n)}})),f.apply(this,arguments)}function _(e,t){return y.apply(this,arguments)}function y(){return(y=(0,i.A)((function*(e,t){c.l.getState().isSidePanelMode&&!m._.isInSidePanel?yield(0,u.c)({name:"send-message-to-chat",body:{msg:t,chatType:e}}):(0,a.C)(t,{chatType:e})}))).apply(this,arguments)}function x(e,t,n){const i=e===l.He.NewThread;return{botId:n,conversationId:i?void 0:t,localConversationId:i?t:void 0,conversationType:i?s.Cr.CocoWebSub:void 0}}},36792:(e,t,n)=>{n.d(t,{CE:()=>_,Lv:()=>x,N0:()=>B,NK:()=>M,Qx:()=>A,Yb:()=>j,aZ:()=>S,gP:()=>v,rV:()=>R,s6:()=>k,y6:()=>E});var i=n(44557),s=n(14065),o=n(46487),a=n(23718),r=n(71967),l=n(25508),c=n(57512),d=n(30510),u=n(31774),h=n(45110);function m(e){var t;return{id:-1,tags:[],language:null!==(t=(0,o.wz)((0,c.TK)("uiLanguage")))&&void 0!==t?t:navigator.language,collection_type:e,source_url:location.href}}function g(e){return p.apply(this,arguments)}function p(){return(p=(0,s.A)((function*(e){const t=yield(0,h.S6)({method:"POST",url:`${l.kD}/collection/create`,data:e});if(t instanceof Error)throw t;return t}))).apply(this,arguments)}function v(e){return f.apply(this,arguments)}function f(){return(f=(0,s.A)((function*(e){const t={collection:(0,i.A)((0,i.A)({},m(a.e.TextFragment)),{},{text_fragment:{ctx_text:e.contextText,selection_text:e.selectionText,anchor_offset:e.anchorOffset}})};return yield g(t)}))).apply(this,arguments)}function _(e,t){return y.apply(this,arguments)}function y(){return(y=(0,s.A)((function*(e,t){const n={collection:(0,i.A)((0,i.A)({},m(a.e.TranslateResult)),{},{summary:t.translatedText,summary_msg_id_str:e,translate_result:{selection_text:t.selectionText,translate_language:t.translate_lang}})};return yield g(n)}))).apply(this,arguments)}function x(e,t){return b.apply(this,arguments)}function b(){return(b=(0,s.A)((function*(e,t){const n={collection:(0,i.A)((0,i.A)({},m(a.e.ExplainResult)),{},{summary:t.explainedText,summary_msg_id_str:e,explain_result:{selection_text:t.selectionText}})};return yield g(n)}))).apply(this,arguments)}function A(e,t){return w.apply(this,arguments)}function w(){return(w=(0,s.A)((function*(e,t){const n={collection:(0,i.A)((0,i.A)({},m(a.e.SearchResult)),{},{summary:t.generatedText,summary_msg_id_str:e,search_result:{search_text:t.searchText}})};return yield g(n)}))).apply(this,arguments)}function S(e,t,n){return C.apply(this,arguments)}function C(){return(C=(0,s.A)((function*(e,t,n){const s={collection:(0,i.A)((0,i.A)({},m(a.e.Web)),{},{fingerprint:t,web:{text_content:e.text_content,html_content:e.html_content,title:e.title,dir:e.dir,description:e.description,cover_image_url:e.cover_image_url,snapshot_img_key:e.snapshot_img_key}})};return n&&(s.collection.source_url=n),yield g(s)}))).apply(this,arguments)}function k(e){return I.apply(this,arguments)}function I(){return(I=(0,s.A)((function*(e){const t={collection:(0,i.A)((0,i.A)({},m(a.e.Pdf)),{},{fingerprint:yield(0,r.K)(a.e.Pdf),pdf:e})};return yield g(t)}))).apply(this,arguments)}function E(e,t){return T.apply(this,arguments)}function T(){return(T=(0,s.A)((function*(e,t){const n={collection:(0,i.A)((0,i.A)({},m(a.e.SocialWebCard)),{},{social_web_card:e})};return t&&(n.collection.source_url=t),yield g(n)}))).apply(this,arguments)}function j(e,t,n){return N.apply(this,arguments)}function N(){return(N=(0,s.A)((function*(e,t,n){n.highlights_message_id=n.highlights_message_id||void 0;const s={collection:(0,i.A)((0,i.A)({},m(a.e.VideoSummary)),{},{fingerprint:yield(0,r.K)(a.e.VideoSummary),summary:e,summary_msg_id_str:t,video_summary:n})};return yield g(s)}))).apply(this,arguments)}function M(e){return L.apply(this,arguments)}function L(){return(L=(0,s.A)((function*(e){const t=yield(0,h.S6)({method:"GET",url:`${l.kD}/collection/fingerprint/get/${e}`});if(!(t instanceof Error))return t.id}))).apply(this,arguments)}function R(e){return P.apply(this,arguments)}function P(){return(P=(0,s.A)((function*(e){return!((yield(0,h.S6)({method:"POST",url:`${l.kD}/collection/delete/${e}`}))instanceof Error)}))).apply(this,arguments)}function B(e=!0){return new Promise(((t,n)=>{const i=document.querySelector(`#${u.Yq}`),{display:s}=(null==i?void 0:i.style)||{};let o;e&&i&&(i.style.display="none",o=setTimeout((()=>{i.style.display=s,o=void 0}),2e3)),setTimeout((()=>{(0,d.cs)("capture-visible-tab").then((n=>{t(n.data),e&&i&&(i.style.display=s),void 0!==o&&clearTimeout(o)})).catch((e=>{void 0!==o&&clearTimeout(o),n(e)}))}),100)}))}},22921:(e,t,n)=>{n.d(t,{g:()=>r});var i=n(8719),s=n(25508),o=n(71291),a=n(45110);const r=(0,i.n)({httpClient:a.sY,getCommonParams:o.wH,baseURL:s.C1})},94314:(e,t,n)=>{n.d(t,{I:()=>a});var i=n(35746),s=n(57512),o=n(30510);const a=e=>{(0,s.TK)("authInfo").isAuthenticated?(0,o.cs)({name:"open-options-page",body:e}):(0,i.DT)()}},44343:(e,t,n)=>{n.d(t,{w:()=>a});var i=n(34870),s=n(45498),o=n(47647);const a=(0,s.vt)()((0,i.eh)(o.$))},10592:(e,t,n)=>{n.d(t,{t_:()=>p});var i=n(14065),s=n(44557),o=n(34870),a=n(45498),r=n(34539),l=n(13907),c=n(73257),d=n(49508),u=n(73648),h=n(57512),m=n(22315);const g={barVisible:!1,barFakeHide:!1,boxVisible:!1,displayMode:"bar",inputText:"",contextText:"",range:null,currentAction:m.EU.explain,actionMessages:{},messageCursor:0,askContent:"",writeEnabled:!1,selectionBaseInfo:(0,s.A)({},c.Ws),simpleSelectionBaseInfo:(0,s.A)({},c.Ws)},p=(0,a.vt)()((0,o.eh)(((e,t)=>{return(0,s.A)((0,s.A)({},g),{},{setBarVisible:t=>e((()=>({barVisible:t,barFakeHide:!t}))),setBarFakeHide:t=>e((()=>({barFakeHide:t}))),setBoxVisible:t=>e((()=>({boxVisible:t}))),setDisplayMode:t=>e((()=>({displayMode:t}))),setInputText:t=>e((()=>({inputText:t}))),setContextText:t=>e((()=>({contextText:t}))),setRange:t=>e((()=>({range:t}))),setAskContent:t=>e((()=>({askContent:t}))),setCurrentAction:t=>e((()=>({currentAction:t}))),clearMessages:()=>e((()=>g)),setMessageCursor:t=>e((()=>({messageCursor:t}))),setWriteEnabled:t=>{e((()=>({writeEnabled:t})))},search:n=>{var i,o,a;const{inputText:c,currentAction:d,lastSearchId:u="",abort:g,askContent:p,range:v}=t();g(null!==(i=null==n||null===(o=n.abortOptions)||void 0===o?void 0:o.id)&&void 0!==i?i:u,null==n?void 0:n.abortOptions);const{enter_chat_method:f,current_page:_="",scene:y="",contextText:x="",translateService:b,answerWithSuggest:A}=n||{},w=(null==n?void 0:n.text)||c;let S=w;const C=d===m.EU.translate?(0,h.TK)("translateLanguage"):"";let k="";d===m.EU.ask?k=p:d===m.EU.translate&&v&&(S=(0,l.l$)(v)||S);const I=r.P.getState().sendMessage({text:S,prompt:d,language:null!==(a=null==n?void 0:n.language)&&void 0!==a?a:C,answerWithSuggest:A,enter_chat_method:f,current_page:_,scene:y,userQueryContent:k,sec_scene:null==n?void 0:n.sec_scene,isUserCustomSkill:(0,m.em)(d),contextText:x,translateService:b});e((e=>({inputText:d===m.EU.ask?w:S,actionMessages:(0,s.A)((0,s.A)({},e.actionMessages),{},{[e.currentAction]:[I]}),messageCursor:0,lastSearchId:I})))},regenerate:({replyId:n,enter_chat_method:i,current_page:o="",scene:a="",answerWithSuggest:l}={})=>{var c,d;const{actionMessages:u,inputText:g,currentAction:p,messageCursor:v}=t(),f=null===(c=u[p])||void 0===c?void 0:c[v],_=r.P.getState().messages[null!=f?f:""],y=r.P.getState().sendMessage({text:g,prompt:p,enter_chat_method:i,current_page:o,scene:a,language:p===m.EU.translate?(0,h.TK)("translateLanguage"):navigator.language,isRegenerate:!0,replyId:n||(null==_||null===(d=_.body)||void 0===d||null===(d=d.message)||void 0===d?void 0:d.reply_id),isUserCustomSkill:(0,m.em)(p),answerWithSuggest:l});e((e=>{var t;const n=[...null!==(t=e.actionMessages[e.currentAction])&&void 0!==t?t:[],y];return{actionMessages:(0,s.A)((0,s.A)({},e.actionMessages),{},{[e.currentAction]:n}),messageCursor:n.length-1,lastSearchId:y}}))},retry:({enter_chat_method:n,current_page:i="",scene:o=""}={})=>{const{inputText:a,currentAction:l}=t(),c=r.P.getState().sendMessage({text:a,prompt:l,enter_chat_method:n,current_page:i,scene:o,language:l===m.EU.translate?(0,h.TK)("translateLanguage"):navigator.language,isUserCustomSkill:(0,m.em)(l)});e((e=>{var t;const n=null!==(t=e.actionMessages[e.currentAction])&&void 0!==t?t:[];return n.splice(e.messageCursor,1,c),{actionMessages:(0,s.A)((0,s.A)({},e.actionMessages),{},{[e.currentAction]:n}),lastSearchId:c}}))},abort:(e,t)=>{r.P.getState().abortMessage(e,t)},checkAndSetInputLang:(n=(0,i.A)((function*(){e({inputTextLangDetecting:!0});const n=yield(0,d.v)(t().inputText);return e({inputTextLang:n,inputTextLangDetecting:!1}),n})),function(){return n.apply(this,arguments)})});var n})));u.m.getInstance().registerStore("useSelectAssistantStore",p)},34539:(e,t,n)=>{n.d(t,{P:()=>h});var i=n(44557),s=n(34870),o=n(45498),a=n(33664),r=n(56819),l=n(14144),c=n(31774),d=n(75351);const u={messages:{},pushMessages:{}},h=(0,o.vt)()((0,s.eh)(((e,t)=>(0,i.A)((0,i.A)({},u),{},{sendMessage:n=>{const s=(0,d._)(n,{onOpen:t=>{e((e=>({messages:(0,i.A)((0,i.A)({},e.messages),{},{[s]:(0,i.A)((0,i.A)((0,i.A)({},e.messages[s]),t),{},{isOpen:!0,originParam:n})})})))},onUpdate:t=>{e((e=>{var n;const{message_id:o="",reply_id:r="",content:l="{}",content_type:c}=(null===(n=t.body)||void 0===n?void 0:n.message)||{};var d;if("0"===r)return{pushMessages:(0,i.A)((0,i.A)({},e.pushMessages),{},{[o]:null===(d=t.body)||void 0===d?void 0:d.message})};let u={};var h;e.pushMessages[o]||(u=(0,i.A)((0,i.A)({},e.pushMessages),{},{[o]:null===(h=t.body)||void 0===h?void 0:h.message}));let{text:m="",suggests:g=[],cardResult:p={}}=e.messages[s]||{};try{const e=JSON.parse(l);var v;if(c===a.cM.PluginSearchResult)p=null==e?void 0:e.search_result;else e.text&&(m=`${m}${e.text}`),null!==(v=e.suggest)&&void 0!==v&&v.length&&(g=g.concat(e.suggest))}catch(f){console.error("parse message content error",t,f)}return(0,i.A)({messages:(0,i.A)((0,i.A)({},e.messages),{},{[s]:(0,i.A)((0,i.A)((0,i.A)({},e.messages[s]),t),{},{text:m,suggests:g,cardResult:p})})},u)}))},onDone:()=>{e((e=>({messages:(0,i.A)((0,i.A)({},e.messages),{},{[s]:(0,i.A)((0,i.A)({},e.messages[s]),{},{isDone:!0})})})))},onError:({code:t,message:n})=>{var o;const a=`${null===(o=(0,r.O)(n,""))||void 0===o?void 0:o.code}`,d=[c.BW,c.Be].some((e=>e===a));(0,l.Rm)("stream call bot error: ",n,t),e((e=>({messages:(0,i.A)((0,i.A)({},e.messages),{},{[s]:(0,i.A)((0,i.A)({},e.messages[s]),{},{code:t,message:n,isError:!0,isUnAuthorized:d})})})))},onAbort:()=>{e((e=>({messages:(0,i.A)((0,i.A)({},e.messages),{},{[s]:(0,i.A)((0,i.A)({},e.messages[s]),{},{isAborted:!0})})})))}});return e((()=>({messages:(0,i.A)((0,i.A)({},t().messages),{},{[s]:{id:s,isOpen:!1,isDone:!1,isError:!1,isAborted:!1,isUnAuthorized:!1,text:"",suggest:[]}})}))),s},abortMessage:(n,s)=>{const o=t().messages[n];!o||null!=o&&o.isAborted||null!=o&&o.isDone||null!=o&&o.isError||((0,d.y)(n,s),e((()=>({messages:(0,i.A)((0,i.A)({},t().messages),{},{[n]:{id:n,isAborted:!0}})}))))}}))))},16456:(e,t,n)=>{n.d(t,{Gq:()=>g,Ie:()=>c,Jg:()=>d,R_:()=>h,S1:()=>a,eR:()=>m,j$:()=>p,jv:()=>l,mu:()=>u,oJ:()=>r});var i=n(47113),s=n(474),o=n(93507);let a=function(e){return e.NORMAL="normal",e.READ_PAGE="read_this_page",e}({});const r=()=>{(0,i.z8)(s.Ur.showChatAssistant,{})},l=()=>{(0,i.z8)(s.Ur.showChatAssistantPopover,{})},c=({button_name:e})=>{(0,i.z8)(s.Ur.clickChatAssistantPopover,{button_name:e,click_from:s.Z5.chatAssistantPopover})},d=({button_name:e})=>{(0,i.z8)(s.Ur.showChatAssistantPopoverSettings,{button_name:e})},u=({button_name:e,value:t})=>{(0,i.z8)(s.Ur.clickChatAssistantPopoverSettings,{value:t?"1":"0",button_name:e,click_from:s.Z5.chatAssistantPopoverSettings})},h=({button_name:e})=>{(0,i.z8)(s.Ur.showChatHeaderBtn,{current_page:o.$2.chat,button_name:e})},m=({button_name:e})=>{(0,i.z8)(s.Ur.clickChatHeaderBtn,{current_page:o.$2.chat,button_name:e})},g=({highlight_page_url:e,module_name:t})=>{(0,i.z8)(s.Ur.showChatFloatCard,{highlight_page:(0,i.M5)(e),module_name:t})},p=({highlight_page_url:e,module_name:t,button_name:n})=>{(0,i.z8)(s.Ur.clickChatFloatCard,{highlight_page:(0,i.M5)(e),module_name:t,button_name:n})}},48850:(e,t,n)=>{n.d(t,{Kp:()=>h,Zl:()=>d,ct:()=>u,hc:()=>m});var i=n(44557),s=n(33451),o=n(47113),a=n(474);const r=["message_id","click_from","skill_name"],l=["message_id","click_from","skill_name"],c=["message_id","click_from","skill_name"],d=({message_id:e,click_from:t,skill_name:n})=>{(0,o.z8)(a.Ur.regenerate,{message_id:e,button_name:a.Ur.regenerate,click_from:t,skill_name:n})},u=e=>{let{message_id:t,click_from:n,skill_name:l}=e,c=(0,s.A)(e,r);(0,o.z8)(a.Ur.copy,(0,i.A)({message_id:t,button_name:a.Ur.copy,click_from:n,skill_name:l},c))},h=e=>{let{message_id:t,click_from:n,skill_name:r}=e,c=(0,s.A)(e,l);(0,o.z8)(a.Ur.continueInChat,(0,i.A)({message_id:t,button_name:a.Ur.continueInChat,click_from:n,skill_name:r},c))},m=e=>{let{message_id:t,click_from:n,skill_name:r}=e,l=(0,s.A)(e,c);(0,o.z8)(a.Ur.retry,(0,i.A)({message_id:t,button_name:a.Ur.retry,click_from:n,skill_name:r},l))}},474:(e,t,n)=>{n.d(t,{Ld:()=>r,Ur:()=>l,Yd:()=>o,Z5:()=>s,_h:()=>a,cz:()=>c,g6:()=>i});let i=function(e){return e.setting="setting",e.landing="landing",e.welcome="extension_welcome",e.login="login",e.uninstall="uninstall",e.extensionOther="extension_other",e.baidu="search_engine_baidu",e.google="search_engine_google",e.bing="search_engine_bing",e.toutiao="search_engine_toutiao",e.youtube="youtube",e.bilibili="bilibili",e.chat="chat",e.chatgpt="chatgpt",e.mail="mail_page",e.xiaoyuzhou="xiaoyuzhou",e.webOther="web_otherpage",e}({}),s=function(e){return e.onboarding="onboarding",e.selectAssistantMenu="highlight_function_bar",e.selectAssistantMoreMenu="highlight_function_bar_dropdown",e.selectAssistantResult="highlight_result_card",e.searchAssistant="search_result_card",e.videoAssistant="video_page_summarize",e.chatAssistantPopover="sidebar_action_popover",e.chatAssistantPopoverSettings="sidebar_action_popover_settings",e.sendMessageInChat="send_message_in_chat",e.mailCreate="mail_create",e.mailUpdate="mail_update",e.mailEntryButton="mail_entry_button",e.mailPositive="mail_positive",e.mailNegative="mail_negative",e.mailNeedMore="mail_need_more",e.arxiv="arxiv",e.pdf="pdf",e.context_menu="context_menu",e}({}),o=function(e){return e.setting="setting",e.addASkill="add_a_skill",e.discoverSkill="discover_skill",e}({}),a=function(e){return e.insert="insert_below",e.replace="replace_selection",e.suggest="suggest",e.summarizeVideo="summarize_video",e.immersionGuideTips="immersion_guide_tips",e.immersionGuideIcon="immersion_guide_icon",e.translatePage="translate_this_page",e.summarizePage="summarize_this_page",e.languageSettings="language_settings",e.displayOriginalText="display_original_text",e.alwaysTranslatePage="always_translate_this_page",e.viewInWeb="view_in_web",e.settings="settings",e.historyChats="history_chats",e.highlightSelectionBar="highlight_selection_bar",e.fold="fold",e.expand="expand",e.expanded="expanded",e.collapsed="collapsed",e.regeneration="regeneration",e.formalize="formalize",e.elaborate="elaborate",e.shorten="shorten",e.write="help_me_write",e.rewrite="rewrite",e.changeReplyLang="change_reply_lang",e}({}),r=function(e){return e.search="search_related_suggested_prompt",e.select_explain="explain_related_suggested_prompt",e}({}),l=function(e){return e.copy="copy",e.regenerate="click_regenerate",e.continueInChat="continue_in_chat",e.retry="retry",e.enterPage="enter_page",e.generationFailure="generation_failure",e.share="share",e.viewDAU="view_dau",e.activeDAU="active_dau",e.sendMessage="send_message",e.showSelectAssistantMenu="highlight_function_bar_show",e.showSelectAssistantBtn="highlight_function_bar_function_show",e.clickSelectAssistantMenuBtn="highlight_function_bar_click",e.showSelectAssistantResult="highlight_result_show",e.clickSelectAssistantResultBtn="highlight_result_action",e.closeSelectAssistantResult="highlight_result_close",e.showChatAssistant="side_bar_entrance_show",e.showChatAssistantPopover="show_side_bar_popover",e.clickChatAssistantPopover="click_side_bar_popover",e.showChatAssistantPopoverSettings="show_side_bar_settings_popover_button",e.clickChatAssistantPopoverSettings="click_side_bar_settings_popover_button",e.showChatHeaderBtn="show_chat_header_button",e.clickChatHeaderBtn="click_chat_header_button",e.showChatFloatCard="highlight_action_module_sidebarshow",e.clickChatFloatCard="highlight_action_module_sidebarclick",e.showSearchAssistant="search_result_card_show",e.showSearchAssistantSuggest="show_suggested_prompt",e.showSearchAssistantSuggestQuestion="show_suggested_prompt_single_question",e.clickSearchAssistantSuggest="click_suggested_prompt",e.closeSearchAssistant="search_result_card_disappear",e.showDeepSearchAssistant="search_summarize_result_show",e.showSources="sources_show",e.clickSources="sources_click",e.collapseDeepSearchCard="search_card_collapse",e.showDeepSearchBtn="deep_search_button_show",e.clickDeepSearchBtn="deep_search_button_click",e.showVideoAssistant="video_summarize_module_show",e.clickVideoAssistantSummarizeBtn="video_summarize_module_click",e.showVideoAssistantSummarizeResult="video_summarize_result_show",e.clickVideoAssistantSummarizeResult="video_summarize_result_click",e.showVideoAssistantHighlightsTimeline="highlights_timeline_singleshow",e.clickVideoAssistantHighlightsTimeline="highlights_timeline_singleclick",e.clickVideoImmersion="video_immersion_click",e.showVideoImmersion="video_immersion_show",e.immersionTimeLine="immersion_timeline",e.showVideoImmersionGuideTips="video_immersion_guide_tips_show",e.clickVideoImmersionGuideTips="video_immersion_guide_tips_click",e.showVideoImmersionGuideIcon="video_immersion_guide_icon_show",e.clickVideoImmersionGuideIcon="video_immersion_guide_icon_click",e.showMailEntryButton="mail_entry_button_show",e.clickMailEntryButton="mail_entry_button_click",e.clickInputBar="input_bar_click",e.showMailThreadResult="mail_thread_result_show",e.clickMailThreadResult="mail_thread_result_click",e.insertMailThreadResult="mail_thread_result_insert",e.closeMailThreadResult="mail_thread_result_close",e.quickReplyButtonShow="ai_reply_button_show",e.hoverQuickReplyButton="hover_ai_reply_button",e.showPdfAssistant="pdf_read_show",e.clickReadPdfBtn="pdf_read_click",e.showDisableMenu="disable_menu_show",e.clickDisableMenu="confirm_close_function",e.chooseLanguage="choose_language_result",e.newSkillAdd="new_skill_add",e.skillEditClick="skill_edit_click",e.skillEditDelete="skill_edit_delete",e.skillPopupSave="skill_popup_save",e.skillPopupIconClick="skill_popup_icon_click",e.skillPopupCancel="skill_popup_cancel",e.skillPopupClose="skill_popup_close",e.exampleClick="example_click",e.examplePopupClose="example_popup_close",e.collectionButtonShow="collection_button_show",e.collectionButtonClickSave="collection_button_click_save",e.collectionButtonClickSaveStatus="collection_button_click_save_status",e}({}),c=function(e){return e.clickSidebar="click_side_bar",e.selectAssistantMenu="highlight_function_bar",e.selectAssistantResult="highlight_result_card",e.searchAssistant="search_result_card",e.videoAssistant="video_page_summarize",e.onboarding="onboarding",e.chatHeader="chat_header",e.disableMenu="close_function",e.other="other",e}({})},47113:(e,t,n)=>{n.d(t,{M5:()=>v,bs:()=>_,z8:()=>f});var i=n(44557),s=n(474),o=n(90720),a=n(80911),r=n(52335),l=n(58876),c=n(12893),d=n(57512),u=n(69327),h=n(33186),m=n(42325),g=n(31774),p=n(20409);const v=e=>{if(e.startsWith((0,m.Yh)()))return s.g6.setting;if(e.includes(g.o2))return s.g6.landing;if(e.includes(g.EP))return s.g6.login;if(e.includes(g.JE))return s.g6.welcome;if(e.includes(g.j0))return s.g6.uninstall;if(e.includes(g.Cp))return s.g6.extensionOther;const t=(0,u.Ay)(e);return t?s.g6[t.name]:(0,l.jB)("youtube")?s.g6.youtube:(0,l.jB)("bilibili")?s.g6.bilibili:(0,h.nW)(e)?s.g6.mail:/https?:\/\/(\w+\.)?chatgpt\.com\//gi.test(e)?s.g6.chatgpt:(0,p.gw)(e)?s.g6.xiaoyuzhou:function(e){try{const t=new URL(e);if(/^https?:?$/.test(t.protocol))return t.host.replace(/\./gi,"_")}catch(t){}return s.g6.webOther}(e)},f=(e,t)=>{var n;const s=v(location.href);null===(n=a.Ay.Tea)||void 0===n||n.event(e,(0,i.A)({current_page:s},t)),(0,o.g)(e,(0,i.A)({current_page:s},t)),(0,o.z)(e,(0,i.A)({current_page:s},t))},_=(e,t)=>{var n;const l=r.l.getState().enterSidebarMode,{assistantBotId:u}=(0,d.ue)();null===(n=a.Ay.Tea)||void 0===n||n.event(e,(0,i.A)({current_page:s.g6.chat,enter_chat_method:l,bot_id:u,conversation_id:(0,c.IK)().convId},t)),(0,o.g)(e,{current_page:s.g6.chat}),(0,o.z)(e,{current_page:s.g6.chat})}},46350:(e,t,n)=>{n.d(t,{Bp:()=>d,DM:()=>x,Dp:()=>_,Rr:()=>y,T:()=>b,VM:()=>m,_B:()=>l,aX:()=>v,gy:()=>f,iN:()=>h,ih:()=>c,oR:()=>g,t7:()=>p,x$:()=>u});var i=n(44557),s=n(47113),o=n(474),a=n(48850),r=n(57512);const l=()=>{(0,s.z8)(o.Ur.showSelectAssistantMenu,{})},c=({button_name:e,show_from:t})=>{(0,s.z8)(o.Ur.showSelectAssistantBtn,{button_name:e,show_from:t})},d=({button_name:e,click_from:t=o.Z5.selectAssistantMenu})=>{(0,s.z8)(o.Ur.clickSelectAssistantMenuBtn,{button_name:e,click_from:t})},u=({before_language:e,after_language:t,button_name:n,message_id:i})=>{(0,s.z8)(o.Ur.showSelectAssistantResult,{before_language:e,after_language:t,button_name:n,message_id:i})},h=({message_id:e,skill_name:t})=>{(0,a.ct)({message_id:e,click_from:o.Z5.selectAssistantResult,skill_name:t})},m=({message_id:e,skill_name:t})=>{(0,a.Zl)({message_id:e,click_from:o.Z5.selectAssistantResult,skill_name:t})},g=({message_id:e,skill_name:t})=>{(0,a.Kp)({message_id:e,click_from:o.Z5.selectAssistantResult,skill_name:t})},p=({message_id:e,skill_name:t})=>{(0,a.hc)({message_id:e,click_from:o.Z5.selectAssistantResult,skill_name:t})},v=({button_name:e,action_name:t,message_id:n})=>{(0,s.z8)(o.Ur.clickSelectAssistantResultBtn,{button_name:e,action_name:t,message_id:n,click_from:o.Z5.selectAssistantResult})},f=e=>{(0,s.z8)(o.Ur.closeSelectAssistantResult,e)},_=({message_id:e})=>{(0,s.z8)(o.Ur.clickSelectAssistantResultBtn,{message_id:e,click_from:o.Z5.selectAssistantResult,action_name:"ask",button_name:"ai_search"})},y=e=>{const{assistantBotId:t}=(0,r.ue)();(0,s.z8)(o.Ur.clickSearchAssistantSuggest,(0,i.A)({bot_id:t,current_page:o.g6.webOther,suggested_type:o.Ld.select_explain},e))},x=e=>{const{assistantBotId:t}=(0,r.ue)();(0,s.z8)(o.Ur.showSearchAssistantSuggest,(0,i.A)((0,i.A)({bot_id:t},e),{},{current_page:o.g6.webOther,suggested_type:o.Ld.select_explain}))},b=e=>{const{assistantBotId:t}=(0,r.ue)();(0,s.z8)(o.Ur.showSearchAssistantSuggestQuestion,(0,i.A)((0,i.A)({bot_id:t},e),{},{current_page:o.g6.webOther,suggested_type:o.Ld.select_explain}))}},55742:(e,t,n)=>{n.d(t,{Bq:()=>m,Su:()=>p,jk:()=>g,jv:()=>d});var i=n(46487),s=n(47113),o=n(474),a=n(93507);let r=function(e){return e.selectAssistant="highlight_result",e.searchAssistant="search_result_card",e.chatAssistant="side_bar_entrance",e.youtubeAssistant="youtube_summarize",e}({}),l=function(e){return e.page="disable_page",e.global="disable_all",e.temp="hide_till_next_time",e}({}),c=function(e){return e.drop_down_box="drop_down_box",e}({}),d=function(e){return e.translate_this_page="translate_this_page",e.highlight_result_choose="highlight_result_choose",e.youtube_page_summary="youtube_page_summary",e.settings="settings",e.mail="gmail",e}({});const u=e=>{let t="";switch(e){case a.lf.chatAssistant:t=r.chatAssistant;break;case a.lf.searchAssistant:t=r.searchAssistant;break;case a.lf.selectAssistant:t=r.selectAssistant}return t},h=e=>{let t="";switch(e){case a.iI.temp:t=l.temp;break;case a.iI.page:t=l.page;break;case a.iI.global:t=l.global}return t},m=e=>{(0,s.z8)(o.Ur.showDisableMenu,{enter_method:u(e)})},g=(e,t)=>{(0,s.z8)(o.Ur.clickDisableMenu,{enter_method:u(t),button_name:h(e)})},p=({before_language_result:e,after_language_result:t,scene:n})=>{(0,s.z8)(o.Ur.chooseLanguage,{choose_way:c.drop_down_box,before_language_result:(0,i.wz)(e),after_language_result:(0,i.wz)(t),scene:n})}},93507:(e,t,n)=>{n.d(t,{$2:()=>o,c$:()=>r,cD:()=>a,iI:()=>s,lf:()=>i,th:()=>l});let i=function(e){return e.chatAssistant="sidebarButton",e.searchAssistant="search",e.selectAssistant="quick",e.grammar="grammar",e}({}),s=function(e){return e.temp="temp",e.page="page",e.global="global",e}({}),o=function(e){return e.youtube="youtube",e.chat="chat",e}({}),a=function(e){return e.insert_below="insert_below",e.replace_selection="replace_selection",e}({}),r=function(e){return e.HUOSHAN="huoshan",e.DOUBAO="doubao",e.GPT="gpt",e.GOOGLE="google",e.MICROSOFT="microsoft",e.DEEPL="deepl",e}({}),l=function(e){return e.HUOSHAN="0",e.LLM="1",e.GOOGLE="2",e}({})},79962:(e,t,n)=>{n.d(t,{_o:()=>o,g6:()=>i,sJ:()=>s});let i=function(e){return e.search_engine="search_engine",e.chat="chat",e.welcome="extension_welcome",e.landing="landing",e.setting="setting",e.web_otherpage="web_otherpage",e}({}),s=function(e){return e.search_engine="search_engine",e.search_related_suggested_prompt="search_related_suggested_prompt",e.highlight_search_result_tool="highlight_search_result_tool",e.highlight_search_result_tool_edit="highlight_search_result_tool_edit",e.chat_action_bar="chat_action_bar",e.suggested_prompts="suggested_prompts",e.onboarding_suggestion="onboarding_suggestion",e.resend="resend",e.edit="edit",e.side_bar_popover_summarize="side_bar_popover_summarize",e.highlight_search_result_go_chat="highlight_search_result_go_chat",e.side_bar_popover_click="side_bar_popover_click",e.webpage_sidebar_link="webpage_sidebar_link",e.youtube_click="youtube_click",e.youtube_go_chat="youtube_go_chat",e.highlight_in_siderbar_chat="highlight_in_siderbar_chat",e.mail="mail",e.podcast="podcast",e}({}),o=function(e){return e.highlight_search_result_ask="highlight_search_result_ask",e.side_bar_popover_click_summarize="side_bar_popover_click_summarize",e.side_bar_popover_click_translate="side_bar_popover_click_translate",e.webpage_sidebar_link_summarize="webpage_sidebar_link_summarize",e.youtube_click_summarize="youtube_click_summarize",e.youtube_go_chat="youtube_go_chat",e.highlight_in_sidebar_chat_explain="highlight_in_sidebar_chat_explain",e.highlight_in_sidebar_chat_translate="highlight_in_sidebar_chat_translate",e.podcast_click_summary="podcast_click_summary",e}({})},12648:(e,t,n)=>{n.d(t,{E8:()=>o,EY:()=>a,uk:()=>s});var i=n(31774);function s(e=0){return new Promise((t=>setTimeout(t,e)))}function o(){var e;return null===(e=document.querySelector(i.ly))||void 0===e||null===(e=e.shadowRoot)||void 0===e?void 0:e.querySelector(".cici-popup-container")}function a(e){if(!document.head){const e=document.createElement("head");document.documentElement.appendChild(e)}document.head.appendChild(e)}},25508:(e,t,n)=>{n.d(t,{C1:()=>r,FI:()=>s,Jk:()=>h,Ud:()=>p,Vl:()=>m,_E:()=>f,ch:()=>c,eG:()=>v,gH:()=>l,kD:()=>u,lx:()=>d,nD:()=>a,o8:()=>g,sZ:()=>o,zs:()=>_});var i=n(93507);const s="www.ciciai.com",o="564371",a="production",r="https://www.ciciai.com",l=420,c=10,d="web",u=`https://${s}/samantha`,h=`https://${s}/alice`,m=`https://${s}/chat/collection`,g="ciciai.com",p="doubao.com",v="release_version",f=[{name:"flow_web_ext_sidebar_hide_1",key:i.iI.temp,id:1},{name:"flow_web_ext_sidebar_hide_2",key:i.iI.page,id:2},{name:"flow_web_ext_sidebar_hide_3",key:i.iI.global,id:3}],_={[i.lf.chatAssistant]:{global:"sidebarButtonDisabledAll",page:"sidebarButtonDisabledHosts"},[i.lf.searchAssistant]:{global:"searchDisabledAll",page:"searchDisabledHosts"},[i.lf.selectAssistant]:{global:"quickDisabledAll",page:"quickDisabledHosts"},[i.lf.grammar]:{global:"disableGlobalGrammar",page:"disableGrammarHosts"}}},84645:(e,t,n)=>{n.d(t,{SM:()=>a,V$:()=>r,d:()=>o,u9:()=>s});var i=n(42325);let s=function(e){return e.web="web",e.pdf="pdf",e}({});const o=()=>{const e=document.body.firstElementChild;return{type:"EMBED"===(null==e?void 0:e.nodeName)&&"application/pdf"===(null==e?void 0:e.type)?s.pdf:s.web,url:window.location.href,title:document.title,favicon:(0,i.p2)(window.location.host,window.location.protocol)}},a=(e,t)=>{let n=e.classList.toString();const i=new MutationObserver((i=>{for(const s of i)if("class"===s.attributeName){const i=e.classList.toString();if(i!==n){t(i),n=i;break}}}));return i.observe(e,{attributes:!0}),i},r=(e,t)=>{const n=new MutationObserver(t);return n.observe(e,{attributes:!0}),n}},80196:(e,t,n)=>{n.d(t,{Vv:()=>a,n_:()=>o});var i=n(30510);function s(e){(0,i.cs)({name:"remove-fetch-cross-header",body:e})}function o(e){return new Promise(((t,n)=>{(0,i.cs)({name:"add-fetch-cross-header",body:e}).then((({data:i})=>{try{o=i,fetch(e).then((e=>{if(!e.ok)throw new Error("Network response was not ok");e.blob().then((n=>t({blob:n,type:e.headers.get("Content-Type")||"image/jpg"}))).catch(n)})).catch(n).finally((()=>{s(o)}))}catch(a){s(i),n(a)}var o})).catch(n)}))}function a(e,t){const{compressImage:n=!0,maxWidth:i=600,maxHeight:s=600,qulity:a}=t||{};return new Promise(((t,l)=>{o(e).then((({blob:e,type:o})=>{n?function(e,t,n,i="image/jpeg",s){return new Promise(((o,a)=>{const l=new FileReader;l.onload=e=>{var l;const c=new Image;c.onload=()=>{const e=document.createElement("canvas"),l=e.getContext("2d"),d=Math.min(t/c.width,n/c.height);e.width=c.width*d,e.height=c.height*d,null==l||l.drawImage(c,0,0,e.width,e.height),e.toBlob((e=>e&&r(e).then(o).catch(a)),i,s)},c.onerror=a,c.src=(null===(l=e.target)||void 0===l?void 0:l.result)||""},l.onerror=a,l.readAsDataURL(e)}))}(e,i,s,o,a).then(t).catch(l):r(e).then(t).catch(l)})).catch(l)}))}function r(e){return new Promise(((t,n)=>{const i=new FileReader;i.onload=function(e){var n;t((null===(n=e.target)||void 0===n?void 0:n.result)||"")},i.onerror=function(e){n(e)},i.readAsDataURL(e)}))}},14450:()=>{window.Prism=window.Prism||{},window.Prism.manual=!0},13907:(e,t,n)=>{n.d(t,{q4:()=>_,YA:()=>y,l$:()=>f,Oi:()=>x});var i=n(15510),s=n(5687),o=n(89380),a=n(43714),r=n.n(a),l=n(31934),c=n(566);function d(e,t=[]){const n=(0,o.A)(e);let i="";for(const s of n){if((0,c.DC)(s))continue;if(!(s instanceof HTMLElement)){i+=s.textContent||"";continue}const e=s.tagName.toLowerCase();if(l.A2.includes(e)){const n=l.hT[e],o={};for(const{key:e,getter:t}of(null==n?void 0:n.attrs)||[]){const n=t?t(s):s.getAttribute(e);n&&(o[e]=n)}t.push({tag:e,originContent:(0,c.UU)(s.textContent||""),attrs:o});const a=t.length-1,{output:r}=d(Array.from(s.childNodes),t);i+=`<b${a}>${r}</b${a}>`;continue}const{output:n}=d(Array.from(s.childNodes),t);i+=n}return{output:(0,c.UU)(i),metaInfo:t}}const u=(e,t=[])=>((0,s.A)(t,((t,n)=>{const{tag:i,originContent:s}=t;if(!l.Jy.includes(i))return;const o=new RegExp(`<\\s*[bB]\\s*${n}\\s*>([\\s\\S]*?)<\\s*/\\s*[bB]\\s*${n}\\s*>`),a=`<b0>${s}</b0>`;e=e.replace(o,a)})),e=(0,i.qP)(e)),h=(e,t=[])=>{(0,s.A)(t,((t,n)=>{const{tag:i,originContent:s}=t,o=new RegExp(`<\\s*[bB]\\s*${n}\\s*>([\\s\\S]*?)<\\s*/\\s*[bB]\\s*${n}\\s*>`),{openTag:a,closeTag:r}=function(e){const{tag:t,attrs:n={}}=e;let i="";for(const[s,o]of Object.entries(n))i+=` ${s}="${o}"`;return["li","ol"].includes(t)?{openTag:`<ul><${t}${i}>`,closeTag:`</${t}></ul>`}:"code"===t?{openTag:"`",closeTag:"`"}:{openTag:`<${t}${i}>`,closeTag:`</${t}>`}}(t),c=l.Jy.includes(i)?`${a}${s}${r}`:`${a}$1${r}`;e=e.replace(o,c)})),e=(e=(0,i.qP)(e)).replaceAll(/\n/g,"<br />");try{return r()(e)}catch(n){return e}};var m=n(56027),g=n(75351),p=n(22315);let v;function f(e){if(e.commonAncestorContainer instanceof Element){(0,m.M)(e.commonAncestorContainer);const t=e.cloneContents(),n=(0,m.u)(Array.from(t.childNodes));v=[];return n.map((e=>d(e,v))).map((e=>e.output)).join("\n")}v=void 0}function _(e){return h(e,v||[])}function y(e){return u(e,v||[])}function x(e){const{encodeText:t,lang:n,translateService:s,contextText:o}=e,a=(0,i.qP)(t);return new Promise((e=>{(0,g._)({text:a,prompt:p.EU.translate,language:n,answerWithSuggest:!1,translateService:s,contextText:o},{onDone(t,n){e(n)}})}))}},15510:(e,t,n)=>{function i(e){const t=e.getAttribute("data-cici-select-uid");if(t){const e=document.querySelector(`[data-cici-select-uid="${t}"]`);if(e)return getComputedStyle(e)}}function s(e){return e.replaceAll(/<\s*\/?\s*[bB]\s*\d+\s*>/g,"")}function o(e){return e.replace(/<\s*\/?\s*[bB]?\s*\d*\s*$/,"")}n.d(t,{D6:()=>i,qP:()=>s,sh:()=>o})},73257:(e,t,n)=>{n.d(t,{GF:()=>S,yI:()=>C,Ws:()=>A,C3:()=>k});var i=n(44557),s=n(29068),o=n(14144);const a=["SCRIPT","STYLE","LINK","IMG","VIDEO","FIGURE","svg"],r=(()=>{let e=null;return()=>(e=e||new TextEncoder,e)})(),l=(e,t)=>r().encode(e).length>t,c=(e="")=>e.replace(/\s+/g," "),d=(e,t,n)=>{let i=e;const s="prev"===t?"previousSibling":"nextSibling";for(;i&&!i[s];)if(i=i.parentNode,null!=n&&n(i))return null;return i?i[s]:null},u=(e,t,n,i,s)=>{if(n>=50||e===t)return!1;let o=e;const r="prev"===i?"lastChild":"firstChild",l="prev"===i?"previousSibling":"nextSibling";for(;o;){let e="";for(;o&&m(o);){const t=h(o);t.replace(/\s+/g,"")&&(e="prev"===i?t+e:e+t),o=o[l]}if(e&&s(e))return!0;if(o){if(!a.some((e=>o.nodeName===e))&&o.childNodes.length){let e=o;for(;e[r];)e=e[r];const t=u(e,o,n+1,i,s);if(t)return t}o=o[l]}}if(e.parentNode!==t){const o=d(e.parentNode,i,(e=>e===t));if(o)return u(o,t,n+1,i,s)}return!1};function h(e){return e.nodeType===Node.TEXT_NODE?e.nodeValue||"":e.nodeType===Node.ELEMENT_NODE&&e.innerText||""}function m(e){if(!e)return!1;switch(e.nodeType){case Node.TEXT_NODE:case Node.COMMENT_NODE:case Node.CDATA_SECTION_NODE:return!0;case Node.ELEMENT_NODE:switch(e.tagName){case"A":case"ABBR":case"B":case"BDI":case"BDO":case"BR":case"CITE":case"CODE":case"DATA":case"DFN":case"EM":case"I":case"KBD":case"MARK":case"Q":case"RP":case"RT":case"RTC":case"RUBY":case"S":case"SAMP":case"SMALL":case"SPAN":case"STRONG":case"SUB":case"SUP":case"TIME":case"U":case"VAR":case"WBR":return!0;default:return!1}}return!1}function g(e,t=800){const n={contextText:"",selectedText:"",start:"",end:""};try{if(!e||e.rangeCount<=0)return n;const i=e.toString();if(!i.trim())return n;const s=e.getRangeAt(0);if(!s)return n;const o=function(e,t){let n=e.startContainer,i="";switch(n.nodeType){case Node.TEXT_NODE:{const{textContent:t}=n;t&&(i=t.slice(0,e.startOffset));break}case Node.COMMENT_NODE:case Node.CDATA_SECTION_NODE:break;default:n=n.childNodes[e.startOffset]}const s=d(n,"prev");return s&&u(s,document.body,0,"prev",(e=>{const n=c(e);return i=`${n}\n${i}`,l(i,t)})),i}(s,t/2).trimStart(),a=function(e,t){let n=e.endContainer,i="";switch(n.nodeType){case Node.TEXT_NODE:{const{textContent:t}=n;t&&(i=t.slice(e.endOffset));break}case Node.COMMENT_NODE:case Node.CDATA_SECTION_NODE:break;default:n=n.childNodes[e.endOffset-1]}const s=d(n,"next");return s&&u(s,document.body,0,"next",(e=>{const n=c(e);return i=`${i}\n${n}`,l(i,t)})),i}(s,t/2).trimEnd();return{contextText:o+i+a,selectedText:i,start:o,end:a}}catch(i){return(0,o.z3)("[selection] context text error: ",i),n}}var p=n(10633);const v=["width","height","max-width","max-height","min-width","min-height","padding-top","padding-bottom","padding-left","padding-right","border","box-sizing","line-height","text-indent","text-align","font-size","font-family","font-weight","font-style","font-variant","letter-spacing","white-space","word-spacing","word-wrap","word-break","position","overflow"],f=class{getStyles(e,t=v){const n=window.getComputedStyle(e),i={};return t.map((t=>{const s=function(e,t=["-","_"]){let n=[],i=0,s=new Set(t);for(;i<e.length;)s.has(e[i])?(n.push(e[i+1].toUpperCase()),i++):n.push(e[i]),i++;return n.join("")}(t),o=n.getPropertyValue(t);if(["width","height"].includes(t)&&"auto"===o){const t=e.getBoundingClientRect();i[s]=`${t[s]}px`}else["max-width","max-height","min-width","min-height"].includes(t)?i[s]=this.convertPercentToPx(e,t,o):i[s]=o})),i}getStyle(e,t){return window.getComputedStyle(e).getPropertyValue(t)}getCssText(e,t=v){const n=window.getComputedStyle(e);return t.map((t=>{const i=n.getPropertyValue(t);if(["width","height"].includes(t)&&"auto"===i){return`${t}: ${e.getBoundingClientRect()[t]}px`}return["max-width","max-height","min-width","min-height"].includes(t)?`${t}: ${this.convertPercentToPx(e,t,i)}`:`${t}: ${i}`})).join(";")}getFontStyles(e){const t=window.getComputedStyle(e);return{fontFamily:t.getPropertyValue("font-family"),fontSize:parseFloat(t.getPropertyValue("font-size")),fontWeight:parseFloat(t.getPropertyValue("font-weight")),lineHeight:parseFloat(t.getPropertyValue("line-height"))}}getContentBox(e){return{width:e.scrollWidth,height:e.scrollHeight}}getScrollbarWidth(e){const t=window.getComputedStyle(e),n=parseFloat(t.getPropertyValue("border-left-width"))||0,i=parseFloat(t.getPropertyValue("border-right-width"))||0;return e.offsetWidth-e.clientWidth-n-i}convertPercentToPx(e,t,n){if(!n.includes("%"))return n;const i=parseFloat(n)/100,s=e.parentElement;if(!s)return"none";let o=window.getComputedStyle(s),a=parseFloat(o.getPropertyValue("width")),r=parseFloat(o.getPropertyValue("height")),l=o.getPropertyValue("box-sizing"),c=parseFloat(o.getPropertyValue("border-width")),d=parseFloat(o.getPropertyValue("padding-left")),u=parseFloat(o.getPropertyValue("padding-right")),h=parseFloat(o.getPropertyValue("padding-top")),m=parseFloat(o.getPropertyValue("padding-bottom")),g=a,p=r;return"border-box"===l&&(g=a-d-u-2*c,p=r-h-m-2*c),t.includes("height")?p*i+"px":g*i+"px"}},_=class{constructor(){if((0,p.A)(this,"nodeId","-aichat-mirrorTextNode"),(0,p.A)(this,"mirrorTextNode",void 0),(0,p.A)(this,"domMeasurement",new f),(0,p.A)(this,"mirrorContainer",void 0),!document)throw new Error("TextareaMeasurement can only be run under DOM environment");this.initMirrorTextarea()}measureText(e,t,n){const i=this.domMeasurement.getStyle(e,"display"),s=this.domMeasurement.getCssText(e);return this.mirrorTextNode.style.cssText=s,"inline"===i&&(this.mirrorTextNode.style.textAlign="initial"),this.mirrorTextNode.innerHTML=t.split("").map((e=>`<span>${e}</span>`)).join(""),this.doMeasureText({element:e,display:i,text:t,index:n})}loadElement(e,t){let n=this.domMeasurement.getStyle(e,"display"),i=parseFloat(this.domMeasurement.getStyle(e,"width"))-this.domMeasurement.getScrollbarWidth(e),s=this.domMeasurement.getCssText(e);return s+=`; height: auto; max-height: none; width: ${i}px; overflow: hidden;`,"inline"===n&&(s+="; text-align: initial"),this.mirrorTextNode.style.cssText=s,this.mirrorTextNode.innerHTML=t.split("").map((e=>`<span>${e}</span>`)).join(""),{measureText:i=>this.doMeasureText({element:e,display:n,text:t,index:i})}}destroy(){this.mirrorContainer.remove()}doMeasureText(e){const{element:t,display:n,index:i,text:s}=e;if(i<0||i>s.length-1)throw new Error(`char indexing(index: ${i})overflowed, allowed range:0 - ${s.length-1}`);let o=this.mirrorTextNode.querySelector(`span:nth-child(${i+1})`),{offsetLeft:a,offsetTop:r,offsetHeight:l,offsetWidth:c}=o,d=0;if("inline"===n){const e=this.mirrorTextNode.querySelector("span:nth-child(1)");e&&(d=e.offsetTop)}let u=r,h=a;if("\n"===s[i]&&i===s.length-1){u+=parseFloat(this.domMeasurement.getStyle(t,"line-height")),h=0}return{left:h,right:h+c,top:u,bottom:u+l,width:c,height:l,deviation:d}}initMirrorTextarea(){const e=document.createElement("div");this.mirrorContainer=e,e.setAttribute("contenteditable","false"),e.id=this.nodeId,e.style.position="absolute",e.style.width="0px",e.style.height="0px",e.style.overflow="hidden",document.body.appendChild(e);const t=e.shadowRoot||e.attachShadow({mode:"open"});if(!this.mirrorTextNode){const e=document.createElement("div");e.className="mirror-text-container",t.appendChild(e),this.mirrorTextNode=e,this.mirrorTextNode.style.display="block"}}},y=new class{getSelectionRect(e){if(!e.collapsed){const t=e.getBoundingClientRect();if(0!==t.width||0!==t.height)return t}const t=e.startContainer;if(t instanceof HTMLElement){const n=t.childNodes[e.startOffset];if(n&&this.isBasicInput(n)){const e=this.getSelectionRectForBasicInputV2(n);return e.left=Math.round(e.left),e.right=Math.round(e.right),e.top=Math.round(e.top),e.bottom=Math.round(e.bottom),e.width=Math.round(e.width),e.height=Math.round(e.height),e}}return null}getSelectedText(e){if(e.commonAncestorContainer.nodeType===Node.TEXT_NODE){const t=r(e.commonAncestorContainer.parentElement);return t.selectable?a(t.whiteSpaceType,e.commonAncestorContainer.textContent.slice(e.startOffset,e.endOffset).trim()):""}if(e.startContainer instanceof HTMLElement){const t=e.startContainer.childNodes[e.startOffset];if(t&&this.isBasicInput(t)){if(!r(t).selectable)return"";const{selectionStart:e,selectionEnd:n}=t;return t.value.slice(e,n).trim()}}let t,n=[],i=!1,s=!1,o=(t,l)=>{t.nodeType===Node.TEXT_NODE?function(t,o){function r(e){return a(o.whiteSpaceType,e)}t===e.startContainer&&(i=!0),i&&t.nodeType===Node.TEXT_NODE&&o.selectable&&(t===e.startContainer&&t===e.endContainer?n.push({content:r(t.textContent.slice(e.startOffset,e.endOffset))}):t===e.startContainer?n.push({content:r(t.textContent.slice(e.startOffset))}):t===e.endContainer?n.push({content:r(t.textContent.slice(0,e.endOffset))}):n.push({content:r(t.textContent)})),t===e.endContainer&&(s=!0)}(t,l):t.nodeType===Node.ELEMENT_NODE&&function(t){if(t===e.startContainer&&(i=!0),t===e.endContainer)return void(s=!0);const a=r(t);a.selectable&&n.push({content:" "});for(const e of t.childNodes)if(o(e,a),s)break;a.selectable&&(function(e,t){return"BR"===e.tagName||!t.display.startsWith("inline")}(t,a.style)?n.push({content:"\n"}):n.push({content:" "}))}(t)};return t=e.commonAncestorContainer instanceof HTMLElement?r(e.commonAncestorContainer):r(e.commonAncestorContainer.parentElement),o(e.commonAncestorContainer,t),n.map((e=>e.content)).join("").trim().split("\n").map((e=>e.trim())).join("\n").replace(/\n\n+/g,"\n\n").replace(/  +/g," ");function a(e,t){return"normal"===e?t.split("\n").map((e=>e.trim())).join(""):"keepNewLine"===e?t.split("\n").map((e=>e.trim())).join("\n"):t}function r(e){const t=getComputedStyle(e);if("SCRIPT"===e.tagName||"STYLE"===e.tagName||"none"===t.userSelect||"0"===t.opacity||"none"===t.display||"hidden"===t.visibility)return{style:t,selectable:!1,whiteSpaceType:"normal"};let n;return n="pre-line"===t.whiteSpace?"keepNewLine":t.whiteSpace.startsWith("pre")||"break-spaces"===t.whiteSpace?"keepNewLineAndSpace":"normal",{style:t,selectable:!0,whiteSpaceType:n}}}isBasicInput(e){return e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement}getSelectionRectForBasicInputV2(e){const t=e.getBoundingClientRect(),n=e.selectionStart,i=e.selectionEnd-1,s=e.scrollTop,o=e.value,a=new _,{measureText:r}=a.loadElement(e,e.value),l=r(n),c=r(i);if(l.top===c.top)return a.destroy(),{left:t.left+l.left,right:t.left+c.left,top:t.top+l.top-s,bottom:t.top+c.bottom,width:c.left-l.left,height:c.bottom-l.top};let d="",u="",h=n,m=n;for(let _=n;_<=i;_++){const e=o[_];"\n"===e||_===i?(u.length>d.length&&(d=u,h=m),u="",m=_+1):u+=e}const g=r(h),p=r(h+d.length);if(g.top!==p.top)return a.destroy(),{left:t.left,right:t.right,top:t.top+l.top-s,bottom:t.top+c.bottom,width:t.width,height:c.bottom-l.top};const v=Math.min(l.left,c.left,g.left,p.left),f=Math.max(l.left,c.left,g.left,p.left);return a.destroy(),{left:t.left+v,right:t.left+f,top:t.top+l.top-s,bottom:t.top+c.bottom,width:f-v,height:c.bottom-l.top}}};var x=n(31774);const b={top:NaN,left:NaN,bottom:NaN,right:NaN,height:NaN,width:NaN,clientBottom:NaN},A=(0,i.A)({text:"",contextText:"",range:null},b),w=e=>{if(!e)return b;if(e.rangeCount<1)return b;const t=e.getRangeAt(0),n=y.getSelectionRect(t),i=t.getBoundingClientRect();if(!n)return null;const s=window.innerHeight-i.bottom,{top:o,left:a,bottom:r,right:l,width:c,height:d}=n;return{top:o,left:a,bottom:r,right:l,width:c,height:d,clientBottom:s}},S=e=>{var t;let n=null,s="",a=b;if(!window.getSelection)return;n=window.getSelection();let r=!1;var l,c,d;null!==(t=n)&&void 0!==t&&null!==(t=t.anchorNode)&&void 0!==t&&t.childNodes&&(r=!(null===(l=Array.prototype.slice.call(null===(d=n)||void 0===d||null===(d=d.anchorNode)||void 0===d?void 0:d.childNodes))||void 0===l||null===(c=l.filter)||void 0===c||!c.call(l,(e=>e.id===x.Yq)).length));s=n?n.toString():"";let u=null;if(n&&n.rangeCount>0&&(u=n.getRangeAt(0).cloneRange()),"close"===e&&!s&&r)return A;if(r)return;if(""!==s.trim()){if(a=w(n),!a)return A;const{contextText:e,selectedText:t,start:s}=g(n);return(0,o.Rm)("[selection] context content:\n ",e),(0,i.A)({text:t,contextText:e,range:u,anchorOffset:s.length},a)}return A},C=e=>{var t;let n=null,o="",a="",r=b;if(!window.getSelection)return;n=window.getSelection();let l=!1;var c,d,u;null!==(t=n)&&void 0!==t&&null!==(t=t.anchorNode)&&void 0!==t&&t.childNodes&&(l=!(null===(c=Array.prototype.slice.call(null===(u=n)||void 0===u||null===(u=u.anchorNode)||void 0===u?void 0:u.childNodes))||void 0===c||null===(d=c.filter)||void 0===d||!d.call(c,(e=>e.id===x.Yq)).length));if(o=n?n.toString():"","close"===e&&!o&&l)return A;if(l)return;let h=null;n&&n.rangeCount>0&&(h=n.getRangeAt(0).cloneRange()),a=(0,s.Fd)(n);if(""!==o.trim()){var m;if(r=w(n),!r)return A;const e=a.indexOf(o);return(0,i.A)({text:o,anchorOffset:Math.max((null===(m=n)||void 0===m?void 0:m.anchorOffset)||0,e),contextText:a,range:h},r)}return A},k=(e=[])=>{var t;const n=window.getSelection();let i=null==n||null===(t=n.anchorNode)||void 0===t?void 0:t.parentElement;if(i)for(;i;){if(e.some((e=>{var t;return null===(t=i)||void 0===t||null===(t=t.className)||void 0===t?void 0:t.includes(e)})))return!0;i=i.parentElement}return!1}},65952:(e,t,n)=>{n.d(t,{ID:()=>s,id:()=>a,o6:()=>r,tY:()=>o});var i=n(83826);n(25508),n(57512);function s(e,t={}){return`${e}?${Object.keys(t).reduce(((e,n)=>e=`${e}&${n}=${t[n]}`),"").replace(/^&/,"")}`}function o(){const e=window.location.hostname;return!!e.startsWith("youtube.com")||e.indexOf(".youtube.com")>0}function a(){const e=window.location.hostname;return!!e.startsWith("bilibili.com")||e.indexOf(".bilibili.com")>0}function r(){var e;return null===(e=location.hash)||void 0===e?void 0:e.startsWith(i.RB)}},66930:(e,t,n)=>{n.d(t,{$2:()=>y,Az:()=>p,Qe:()=>f,aK:()=>_,uV:()=>m,yz:()=>g,zO:()=>x});var i=n(44557),s=n(94654),o=n(33664),a=n(98101),r=n(11003),l=n(9530),c=n(54020),d=n(56448),u=n(94682),h=n(36266);const m=()=>(0,s.A)(),g=({ctx:{conversationId:e,localConversationId:t}})=>{const n=t||e;if(!n)throw new Error("conversationId is empty");return n},p=({ctx:e,resolved:t},n=u.pU.getState())=>{const{cancelReason:i}=v({store:a.oz.getState(),conversation:n.conversationMap[t.conversationId]});if(i)return h.vF.persist.info({eventName:"send_message_cancel",meta:{local_message_id:t.localMessageId,from:a.aU.Socket,conversation_id:e.conversationId,conversation_type:e.conversationType,reason:i}}),Boolean(i)},v=({store:e,conversation:t})=>{const n=null!=t&&t.bot_id?r.C.actions.getBot(t.bot_id):{};return null!=n&&n.disabled?{cancelReason:"bot deleted"}:e.rateLimitConfig.isLimited?{cancelReason:"rate limit"}:{}};function f({conversationId:e,store:t}){const{lastAvailableMessageLink:n}=(0,c.to)(e);null!=n&&n.regen_head&&t.updateMessageList({conversationId:e,immerUpdate(e){const{draftMessageLinks:t,draftRegenerateMessageMap:i,draftMessageMap:s,draftLocalMessageMap:o}=e,r=(0,a.A4)({localMessageMap:o,messageMap:s});t.forEach((t=>{if(t.regen_head===n.regen_head){var s;delete t.regen_head,(null===(s=i.messageMap)||void 0===s?void 0:s[t.messageId])&&delete i.messageMap[t.messageId];const n=t.isLocalMessage?r(t):void 0;n&&(0,a.HN)(n)&&(0,a.k)(e,t)}}))}})}const _=(e,t)=>{const{replace:n,remove:s,regenerate:o,scene:r,resolved:d,resume:u}=e,h=function({conversationId:e,store:t}){var n;const i=(0,c.WP)(e);if(!i)return;if((0,a.Ji)(i))return;const s=(0,a.WZ)(t.messageLinkMap[e],(n=>Boolean(n.regen_head)&&(0,a.$4)((0,c.Tc)(e,n,t))));return!s||null!=s&&s.isLocalMessage||(null===(n=(0,c.Tc)(e,s,t))||void 0===n?void 0:n.reply_id)!==i.reply_id?void 0:s.messageId}({store:t,conversationId:d.conversationId});return(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)({stream:"1"},l.v.answerWithSuggest&&{answer_with_suggest:"1"}),l.v.namedEntityHighlight&&{wiki:"1"}),l.v.answerWithVideo&&{media_search_type:"2"}),n?{replace:"1"}:{}),s?{delete:"1"}:{}),o?{regen:"1"}:{}),u?{resume:"1"}:{}),n||u||s||o||!h?{}:{lastRegenerateSelectedMessageId:h}),"onboarding_suggestion"===r?{onboarding_v2:"1"}:{}),"keyboard_unlog"===r?{scene:r}:{}),d.localCreateExt)},y=(e,t)=>{var n;return t?null===(n=e.find((({resolved:e})=>{return(null==(n=e)||null===(i=n.localContent)||void 0===i?void 0:i.preprocess_key)===t;var n,i})))||void 0===n?void 0:n.resolved.localMessageId:void 0},x=(e,t)=>e?Date.now()+d.hn:t!==o.cM.File?Date.now()+d._q:void 0},67186:(e,t,n)=>{n.d(t,{c:()=>a});var i=n(35754),s=n(98101),o=n(42767);const a=e=>{const t=s.oz.getState();return(0,i.A)(e.map((e=>{var n;const{conversationId:i}=e.ctx;if(!i)return e;if(e.replace&&null!==(n=(0,o.Tc)(i,e.replace.messageLink,t))&&void 0!==n&&null!==(n=n.ext)&&void 0!==n&&n.collection_id){var a;const n=(0,o.Tc)(i,e.replace.messageLink,t),r=null==n||null===(a=n.ext)||void 0===a?void 0:a.collection_id;if(!r||!(0,s.pu)(n))return e;const l=t.messageLinkMap[i],c=t.messageMap[i];return l.filter((e=>{var n;return(0,s.c8)(c[e.messageId],t.userInfo.secUserId)&&(null===(n=c[e.messageId])||void 0===n||null===(n=n.ext)||void 0===n?void 0:n.collection_id)===r})).map((t=>t.messageId===n.message_id?e:{ctx:e.ctx,scene:e.scene,replace:{messageLink:t}}))}return e})))}},3187:(e,t,n)=>{n.d(t,{L:()=>l});var i=n(44557),s=n(36266),o=n(66930),a=n(98101),r=n(56146);const l=e=>{const{msgPayload:t,resolved:n,messageExt:l,regenerate:c,store:d,ctx:u,scene:h,reportEvents:m,chatType:g,sec_scene:p,use_skill:v,skill_name:f,skill_id:_,reportParams:y,is_ogf:x}=e,b=(0,i.A)({start_local_conversation_id:u.localConversationId,start_conversation_id:u.conversationId,start_bot_id:u.botId,start_local_message_id:n.localMessageId,ext:l,conversation_type:u.conversationType,content_type:n.content_type,content_source:t.content_source,enter_from:u.enterFrom,scene:h,sec_scene:p,use_skill:v,skill_name:f,skill_id:_,is_ogf:x,chat_type:g},y);return a.oz.getState().mergeReportEvents(n.conversationId,n.localMessageId,(0,i.A)((0,i.A)({},m),{},{send_message:(0,s.XB)({eventName:"send_message",meta:b,once:!0})},v&&f?{[`${f}_message`]:(0,s.XB)({eventName:`${f}_message`,meta:b})}:{})),(0,a.xf)({localMessageStatus:n.isReady?c?a.FQ.SendingRegenerate:a.FQ.Sending:a.FQ.Preprocessing,message:(0,i.A)((0,i.A)({},t),{},{reply_id:c?"0":t.reply_id,contentObj:n.contentObj,sec_sender:r.tL}),failedExpired:(0,o.zO)(n.isReady,n.content_type),sendLoadingExpired:Date.now()+r.On,messageLinks:d.messageLinkMap[n.conversationId],isRegenerate:n.isRegenerate,prevMessageId:n.isRegenerate?null==c?void 0:c.regenerateTailMessageId:void 0,localContent:n.localContent,enterFrom:u.enterFrom})}},56853:(e,t,n)=>{n.d(t,{V:()=>r});var i=n(9012),s=n(53713),o=n(33664),a=n(66930);const r=(e,t,n)=>{var r;const l=(0,a.$2)(n,e);if(!l)return"";const c=null===(r=n.find((({resolved:e})=>e.localMessageId===l)))||void 0===r?void 0:r.resolved;return c?c.content_type===o.cM.Image?(e=>JSON.stringify({image_list:[{key:e}]}))(t):c.content_type===o.cM.File?((e,t)=>(0,s.e4x)({src:"user-sent",file_list:[{key:e,file_name:(0,i.A)(t,"contentObj.file_list[0].file_name","")}]}))(t,c):"":""}},49578:(e,t,n)=>{n.d(t,{W:()=>r});var i=n(44557),s=n(53713),o=n(33664),a=n(98101);const r=({ctx:e,replace:t,remove:n,regenerate:r,resume:l,content_source:c,resolved:d},u)=>{var h;return(0,i.A)((0,i.A)((0,i.A)((0,i.A)({local_conversation_id:e.localConversationId,bot_id:e.botId,conversation_id:e.conversationId,section_id:u.lastSectionIdMap[d.conversationId]||"",local_message_id:d.localMessageId,message_type:o.Go.Message,content_type:d.content_type,content:(0,s.e4x)(d.contentObj),create_time:Date.now()},t||n||l?{message_id:null===(h=t||n||l)||void 0===h||null===(h=h.messageLink)||void 0===h?void 0:h.messageId}:{}),r?{reply_id:r.sentMessageId,local_message_id:r.sentLocalMessageId}:{}),d.content_type===o.cM.Text?{content_source:(null==c?void 0:c.source)||a.Zp.Other,template_id:null==c?void 0:c.templateId}:{}),{},{ext:d.localCreateExt})}},53523:(e,t,n)=>{n.d(t,{Az:()=>s.Az,Bu:()=>r.Bu,I0:()=>o.I0,ID:()=>l.I,JG:()=>r.JG,KH:()=>o.KH,O4:()=>i.O,QP:()=>r.QP,YV:()=>r.YV,c8:()=>d.c,fr:()=>r.fr,gk:()=>o.gk,kk:()=>r.kk,p4:()=>c.p,p8:()=>u.p,uV:()=>s.uV,vm:()=>a.v,yx:()=>h.y});var i=n(13538),s=n(66930),o=n(5189),a=n(70301),r=(n(27245),n(74826)),l=n(74841),c=n(86801),d=n(67186),u=n(90722),h=n(13149)},5189:(e,t,n)=>{n.d(t,{I0:()=>d,KH:()=>h,gk:()=>u});var i=n(44557),s=n(48485),o=n(92431),a=n(98502),r=n(36266),l=n(33664),c=n(98101);const d=(e,t)=>{var n;const s=c.oz.getState().regenerateMessageMap[e];if(!s){const n=(0,r.XB)({eventName:t});return c.oz.setState((0,a.jM)((i=>(i.regenerateMessageMap[e]={messageMap:{},reportEvents:{[t]:n}},i)))),n}if(null==s||null===(n=s.reportEvents)||void 0===n||!n[t]){const n=(0,r.XB)({eventName:t});return c.oz.setState((0,a.jM)((o=>(o.regenerateMessageMap[e].reportEvents=(0,i.A)((0,i.A)({},s.reportEvents),{},{[t]:n}),o)))),n}return s.reportEvents[t]},u=e=>({setRegenMessageInActive:({messageId:t})=>{const{draftMessageMap:{[t]:n},draftRegenerateMessageMap:{messageMap:{[t]:s}={}}={},draftRegenerateMessageMap:a}=e;{var r;const e=null!=s?s:(0,o.A)(n);null==s||null===(r=s.ext)||void 0===r||delete r.regen_active,(null==e?void 0:e.ext)&&(e.ext.regen="1"),a.messageMap=(0,i.A)((0,i.A)({},a.messageMap),{},{[t]:e})}n.ext&&(n.ext.regen="1"),(0,c.Ji)(n)||(n.status=l.q7.InVisible)},setRegenMessageActive:t=>{const{messageId:n}=t,{draftMessageMap:s,draftRegenerateMessageMap:{messageMap:{[n]:a}={}}}=e;a&&(s[n]=(0,i.A)((0,i.A)({},s[n]),(0,o.A)(a)),a.ext&&(a.ext.regen_active="1"))}}),h=(e,t)=>{if(!e||!t.reply_id)return!1;const n=t.reply_id,i=c.oz.getState(),o=i.messageLinkMap[e],a=(0,c.A4)({messageMap:i.messageMap[e],localMessageMap:i.localMessageMap[e]}),r=(0,c.rU)({messageLinks:o,replyId:n,getMessage:a});if(1===(null==r?void 0:r.length))return!0;return(0,s.A)(r,(e=>{const t=a(e);return t&&(0,c.oQ)(t)}))}},90722:(e,t,n)=>{n.d(t,{p:()=>I});var i=n(44557),s=n(53719),o=n(2633),a=n(35754),r=n(92431),l=n(94654),c=n(53713),d=n(36266),u=n(33664),h=n(74826),m=n(66930),g=n(98101),p=n(29654),v=n(11003),f=n(54020),_=n(76454),y=n(19260);const x={onboarding_first_met:"onboarding_first_met_sug",onboarding_welcome_back:"onboarding_welcome_back_sug"},b=e=>{const{blob:t,type:n,from:i,store:s,botId:o,localKey:a,localMessageId:r}=e;var l;if(a)return{localKey:a,key:(null===(l=s.preprocessTaskMap[a])||void 0===l?void 0:l.key)||""};{const e=s.preprocessFile(t,n,{moduleActionId:"",conversationId:"",chatType:"other_default",skillType:0,skillId:"",uploadFrom:"upload_pinbutton",botId:o,from:i,uploadCollectionWay:"single",uploadId:r,uploadWay:"browse folder"},{preHandle:{version:"pre_handle"}});return{localKey:e.local_key,key:e.key}}},A={parseTextPayload:(e,t,n)=>({content_type:u.cM.Text,contentObj:{text:e.text.trim()},isReady:!0,localCreateExt:(0,i.A)((0,i.A)({},e.extraExt),{},{source:n})}),parseImagePayload:(e,t,n,s,o)=>{const a=[];let r,l=!1;if("image_key"in e)a.push({key:e.image_key,image_ori:e.image_ori,image_thumb:e.image_thumb}),l=!0;else{const{localKey:i,key:s}=b({type:"image",blob:e.image,localKey:e.local_key,botId:n,store:t,from:e.from,localMessageId:o});a.push({key:s}),r={preprocess_key:i},l=Boolean(s)}return{content_type:u.cM.Image,contentObj:{image_list:a},isReady:l,localContent:r,localCreateExt:(0,i.A)((0,i.A)({},e.extraExt),{},{source:s})}},parseFilePayload:(e,t,n,s,o)=>{const a=[];let r,l=!1;if("file_key"in e)a.push({file_name:e.file_name,key:e.file_key}),l=!0;else{const{localKey:i,key:s}=b({type:"file",blob:e.file,localKey:e.local_key,botId:n,store:t,from:e.from,localMessageId:o});a.push({file_name:(0,p.p)("name")(e.file),key:s||""}),r={preprocess_key:i},l=Boolean(s)}return{content_type:u.cM.File,contentObj:{file_list:a},isReady:l,localContent:r,localCreateExt:(0,i.A)((0,i.A)({},e.extraExt),{},{source:s})}},parseCompositePayload:(e,t,n,s,o)=>{let a,r=!0;const l=e=>{const i=[];return e.forEach(((e,s)=>{if("key"in e)i.push(e);else{const{localKey:l,key:c}=b({type:"file",blob:e.blob,localKey:e.local_key,botId:n,store:t,from:e.from,localMessageId:o});i.push({file_name:(0,p.p)("name")(e.blob),key:c||""}),0===s&&(a={preprocess_key:l}),r&&(r=Boolean(c))}})),i};return{contentObj:(0,h.fr)(e)?{text:e.compositeContent.text,image_model:{image_list:l(e.compositeContent.images)}}:(0,h.kk)(e)?{text:e.compositeContent.text,file_model:{file_list:l(e.compositeContent.files)}}:(0,h.YV)(e)?{text:e.compositeContent.text,link_model:{url:e.compositeContent.links[0]}}:{},content_type:u.cM.Composite,isReady:r,localContent:a,localCreateExt:(0,i.A)((0,i.A)({},e.extraExt),{},{source:s})}},parseNestedPayload:(e,t)=>{const{nestedItems:n,text:s}=e,o=n.reduce(((e,t)=>(0,h.$g)(t)?[...e,{entity_type:t.type,entity_content:{file:{file_name:t.fileName,key:t.fileKey,size:t.size}},identifier:t.identifier,file_parse_state:t.parseState,file_name_state:t.reviewState}]:e),[]);return 0===o.length?{content_type:u.cM.Text,contentObj:{text:s.trim()},isReady:!0,localCreateExt:(0,i.A)((0,i.A)({},e.extraExt),{},{source:t})}:{content_type:u.cM.Nested,contentObj:{text:s.trim(),entities:o},isReady:!0,localCreateExt:(0,i.A)((0,i.A)({},e.extraExt),{},{source:t})}},parseCopySendPayload:(e,t,n)=>{if(!e.copySend)return;const{messageLink:s}=e.copySend,o=s?(0,f.Tc)(n,s,t):void 0;return(0,g.xY)(o)?w.parseNestedMessage(o,(0,i.A)({},e.extraExt)):{content_type:null==o?void 0:o.content_type,contentObj:null==o?void 0:o.contentObj,localContent:null==o?void 0:o.localContent,isReady:!0,localCreateExt:(0,i.A)({},e.extraExt)}},parseSinglePayload:(e,t,n,i,s,o)=>(0,h.Bu)(e)?A.parseNestedPayload(e,s):"text"in e?A.parseTextPayload(e,t,s):"image"in e||"image_key"in e?A.parseImagePayload(e,t,n,s,o):"file"in e||"file_key"in e?A.parseFilePayload(e,t,n,s,o):(0,h.Fh)(e)?A.parseCompositePayload(e,t,n,s,o):"copySend"in e&&e.copySend?A.parseCopySendPayload(e,t,i):void 0},w={parseTextMessage:(e,t,n)=>({content_type:u.cM.Text,isReady:!0,contentObj:{text:(0,g.P5)(e)},localCreateExt:(0,i.A)({},n)}),parseImageMessage:(e,t,n)=>{var s,o;const a=e.contentObj.image_list[0].key||(null===(s=t.preprocessTaskMap[(null==e||null===(o=e.localContent)||void 0===o?void 0:o.preprocess_key)||""])||void 0===s?void 0:s.key);return{content_type:u.cM.Image,isReady:Boolean(a),contentObj:{image_list:[{key:a}]},localContent:e.localContent,localCreateExt:(0,i.A)({},n)}},parseFileMessage:(e,t,n)=>{var s,o,a;const r=e.contentObj.file_list[0].key||(null===(s=t.preprocessTaskMap[(null==e||null===(o=e.localContent)||void 0===o?void 0:o.preprocess_key)||""])||void 0===s?void 0:s.key);return{content_type:u.cM.File,isReady:Boolean(r),contentObj:{file_list:[{key:r,file_name:null===(a=e.contentObj.file_list)||void 0===a||null===(a=a[0])||void 0===a?void 0:a.file_name}]},localContent:e.localContent,localCreateExt:(0,i.A)({},n)}},parseCompositeMessage:(e,t,n)=>{var s,o,a,r,l,c;if((0,g.U9)(e))return{content_type:u.cM.Composite,contentObj:{text:(null===(l=e.contentObj.text)||void 0===l?void 0:l.trim())||"",link_model:{url:(null===(c=e.contentObj.link_model)||void 0===c?void 0:c.url)||""}},isReady:!0,localCreateExt:(0,i.A)({},n)};const d=(0,g.zl)(e),h=(0,g.aX)(e),m=d?null===(s=e.contentObj.image_model)||void 0===s?void 0:s.image_list:h?null===(o=e.contentObj.file_model)||void 0===o?void 0:o.file_list:void 0;var v;if(null==m||!m[0])return{content_type:u.cM.Text,contentObj:{text:(null===(v=e.contentObj.text)||void 0===v?void 0:v.trim())||""},isReady:!0,localCreateExt:(0,i.A)({},n)};const f=m.map((({key:n})=>{var i,s;return n||(null===(i=t.preprocessTaskMap[(null==e||null===(s=e.localContent)||void 0===s?void 0:s.preprocess_key)||""])||void 0===i?void 0:i.key)}));return{contentObj:d?{text:(null===(a=e.contentObj.text)||void 0===a?void 0:a.trim())||"",image_model:{image_list:f.map((e=>({key:e})))}}:h?{text:(null===(r=e.contentObj.text)||void 0===r?void 0:r.trim())||"",file_model:{file_list:m.map(((e,t)=>({file_name:(0,p.p)("file_name")(e),key:f[t]||""})))}}:{},content_type:u.cM.Composite,isReady:f.every((e=>!!e)),localContent:e.localContent,localCreateExt:(0,i.A)({},n)}},parseNestedMessage:(e,t)=>{const n=(0,r.A)(e.contentObj);return n.entities.forEach((e=>{delete e.file_name_state,delete e.file_parse_state})),{content_type:u.cM.Nested,contentObj:n,isReady:!0,localCreateExt:(0,i.A)({},t)}},parseSingleMessage:(e,t,n)=>{const o=(0,i.A)({source:n},(0,s.A)(null==e?void 0:e.ext,["msg_template_id","collection_id","input_skill","need_create_thread","ugc_plugin_auth_infos","reference_content","immersive_reading_files","pdf_hover_position"]));return(0,g.pu)(e)&&(0,g.P5)(e)?w.parseTextMessage(e,t,o):(0,g.Ji)(e)?w.parseImageMessage(e,t,o):(0,g.Bv)(e)?w.parseCompositeMessage(e,t,o):(0,g.xY)(e)?w.parseNestedMessage(e,o):(0,g.ml)(e)?w.parseFileMessage(e,t,o):void 0}},S=(e,t,n,i)=>{var s,a;let r=x[e.scene]||e.scene;const l=e.ctx.botId||(0,_.Qo)(e.ctx.conversationId)||"",u=A.parseSinglePayload(e,n,l,t,r,i);if(u)return[u];const{replace:h,resume:m,remove:p,regenerate:v,resend:y}=e,b=null!==(s=null===(a=h||m||p||y)||void 0===a?void 0:a.messageLink)&&void 0!==s?s:v?{messageId:v.sentMessageId,isLocalMessage:!1,regen_head:v.regenerateHeadMessageId}:void 0,S=b?(0,f.Tc)(t,b,n):void 0,C=v?((e,t)=>{var n;if(!e)return[];const i=null==e||null===(n=e.ext)||void 0===n?void 0:n.collection_id;if(!i)return[e];const s=g.oz.getState(),o=s.messageLinkMap[t],a=s.messageMap[t];return o.filter((e=>{var t;return(0,g.c8)(a[e.messageId],s.userInfo.secUserId)&&(null===(t=a[e.messageId])||void 0===t||null===(t=t.ext)||void 0===t?void 0:t.collection_id)===i})).map((e=>(0,f.Tc)(t,e,s))).filter(c.q3w)})(S,t):[S].filter(c.q3w),k=C.map((t=>{var i;const s=(null==t||null===(i=t.ext)||void 0===i?void 0:i.source)||e.scene;r=v||h&&"edit"!==e.scene||y?s:e.scene;const o=w.parseSingleMessage(t,n,r);var a,l;m&&null!=o&&o.localCreateExt&&(o.localCreateExt.ugc_plugin_auth_infos=null!==(a=null===(l=e.extraExt)||void 0===l?void 0:l.ugc_plugin_auth_infos)&&void 0!==a?a:"");return o})).filter(c.q3w);if(!(0,o.A)(k))return k;throw d.vF.persist.warning("sendMsgUnsupportedTypeOrScene"),Error("Unsupported MessageType")},C=(e,t)=>{var n;const i=t.botId||(0,_.Qo)(t.conversationId)||"",s=v.C.actions.getBot(i),o=null!==(n=t.conversationType)&&void 0!==n?n:(0,y.e)(t.conversationId),a=(0,_.CB)(t.conversationId,s,o);let r=function(e){return e.Text="text",e.Picture="pic",e.File="file",e}({});const l={[u.cM.Text]:r.Text,[u.cM.Image]:r.Picture,[u.cM.File]:r.File};return{bot_id:i,chat_type:a,conversation_type:o,message_type:(c=e.content_type,c&&l[c]||r.Text)};var c},k=e=>{const t=g.oz.getState(),{regenerate:n,replace:s,preGeneratedlocalMessageId:o}=e,a=o||(null==n?void 0:n.sentLocalMessageId)||(0,m.uV)(),r=(0,m.yz)(e),l=S(e,r,t,a);return s&&l.forEach((e=>{e.localCreateExt&&delete e.localCreateExt.collection_id})),l.map((t=>(0,i.A)((0,i.A)({},e),{},{resolved:(0,i.A)((0,i.A)({},t),{},{localMessageId:a,conversationId:r,isRegenerate:Boolean(n)},C(t,e.ctx))})))},I=e=>{if(e.length<=0)return;const t=(0,a.A)(e.map(k)).filter(c.q3w);if(0===t.length)return;if(1===t.length)return t;if(t.every((e=>{var t;return!(null===(t=e.resolved.localCreateExt)||void 0===t||!t.collection_id)})))return t;const n=(0,l.A)();return t.map((e=>(e.resolved.localCreateExt=(0,i.A)((0,i.A)({},e.resolved.localCreateExt),{},{collection_id:n}),e)))}},70301:(e,t,n)=>{n.d(t,{v:()=>w});var i=n(44557),s=n(20716),o=n(89380),a=n(94682),r=n(96744),l=n(66930),c=n(67186),d=n(3187),u=n(56853),h=n(49578),m=n(90722),g=n(27245),p=n(72004),v=n(84917),f=n(98101),_=n(49850),y=n(66221);const x=e=>!(null==e||!e.key),b=e=>!e||e.failed,A=e=>{const t=f.oz.getState(),{sendingMessages:n,localMessages:i,payloads:s,sendMessageCallback:o,customSendWaitTimeout:a,protocolType:r}=e;y.B.emit("message.beforeSend",n),(0,g.R1)({messages:n,customSendWaitTimeout:a,protocolType:r}),i.forEach((e=>v.Q.logSendMessage(e))),s.some((({scene:e})=>"onboarding"===e))?v.Q.trackOnBoardingMessageSentEvent():(s.forEach(((e,t)=>v.Q.trackSendMessageEvent(e,i[t]))),n.forEach((e=>v.Q.trackSendMessageStartEvent(e))),s.forEach((e=>{v.Q.trackUploadParseStatus(t,e)})),null==o||o(n))},w=(e,{chatType:t,sendMessageCallback:n,customSendWaitTimeout:g,protocolType:v})=>{const y=f.oz.getState(),w=(0,m.p)((0,c.c)((0,o.A)(e)));if(!w)return;const S=w[0].resolved.conversationId||"",C=w.every((({resolved:e})=>e.isReady));if(w.some((({ctx:e,resolved:t})=>(0,l.Az)({ctx:e,resolved:t},a.pU.getState()))))return;(0,f.P7)(f.oz,S),w.forEach((({resend:e,replace:t,remove:n,resume:i,regenerate:s})=>{var o,a,r,l;if(null!=e&&null!==(o=e.messageLink)&&void 0!==o&&o.messageId)y.logicalDeleteMessage({conversationId:S,messageLink:null==e?void 0:e.messageLink});else if(null!=t&&null!==(a=t.messageLink)&&void 0!==a&&a.messageId){var c;y.logicalDeleteMessage({conversationId:S,messageLink:null==t?void 0:t.messageLink,deleteReply:!0}),(0,_.PF)(null==t||null===(c=t.messageLink)||void 0===c?void 0:c.messageId)}else if(null!=i&&null!==(r=i.messageLink)&&void 0!==r&&r.messageId){var d;y.logicalDeleteMessage({conversationId:S,messageLink:null==i?void 0:i.messageLink,deleteReply:!0}),(0,_.PF)(null==i||null===(d=i.messageLink)||void 0===d?void 0:d.messageId)}else if(null!=n&&null!==(l=n.messageLink)&&void 0!==l&&l.messageId){var u;y.logicalDeleteMessage({conversationId:S,messageLink:null==n?void 0:n.messageLink,deleteReply:!0}),y.updateMessageList({conversationId:S,immerUpdate:(e,t)=>t.resetMessageLink(n.messageLink.messageId)}),(0,_.PF)(null==n||null===(u=n.messageLink)||void 0===u?void 0:u.messageId)}else null!=s&&s.sentMessageId&&(0,_.PF)(null==s?void 0:s.sentMessageId)})),w.some((({resolved:e})=>e.isRegenerate))||(0,l.Qe)({store:y,conversationId:S}),y.clearSuggestMessage(S);const k=w.map((e=>(0,h.W)(e,a.pU.getState()))),I=k.map(((e,n)=>(0,d.L)({is_ogf:(0,r.h)(),msgPayload:e,resolved:w[n].resolved,messageExt:(0,l.aK)(w[n],y),regenerate:w[n].regenerate,store:y,ctx:w[n].ctx,reportEvents:w[n].reportEvents,chatType:t,scene:w[n].scene,sec_scene:w[n].sec_scene,use_skill:w[n].use_skill,skill_name:w[n].skill_name,skill_id:w[n].skill_id,reportParams:w[n].reportParams})));if(I.forEach(((e,t)=>{w[t].remove||p.C.insertMessageIntoStore(w[t].resolved,y,e,w[t].regenerate)})),C)A({sendingMessages:k.map(((e,t)=>(0,i.A)((0,i.A)({},e),{},{ext:(0,l.aK)(w[t],y)}))),localMessages:I,payloads:w,sendMessageCallback:n,customSendWaitTimeout:g,protocolType:v});else{const e=w.map((({resolved:e})=>{var t;return(null===(t=e.localContent)||void 0===t?void 0:t.preprocess_key)||""})).filter((e=>!!e));e.forEach((e=>{const t=y.preprocessTaskMap[e],n=w.find((t=>{var n;return(null===(n=t.resolved.localContent)||void 0===n?void 0:n.preprocess_key)===e}));var i;null!=t&&t.failed&&n&&y.reUpload(e,null!==(i=n.ctx.botId)&&void 0!==i?i:"")}));const t=f.oz.subscribe((t=>e.map((e=>t.preprocessTaskMap[e]))),(e=>{if(e.some(b))return w.forEach((({resolved:e})=>p.C.setStoreMessageFailed(y,e))),void t();if(e.every(x)){const s=new Map(e.map((e=>[(0,l.$2)(w,e.local_key),(0,u.V)(e.local_key,e.key,w)])));s.forEach(((e,t)=>{const n=((e,t)=>t?e.find((e=>e.resolved.localMessageId===t)):void 0)(w,t);p.C.updateStoreMessageAfterSend(y,null==n?void 0:n.resolved,e,null==n?void 0:n.regenerate)}));const o=k.map(((e,t)=>(0,i.A)((0,i.A)({},e),{},{ext:(0,l.aK)(w[t],y)},s.has(e.local_message_id)?{content:s.get(e.local_message_id)}:{})));(0,f.P7)(f.oz,S),y.clearSuggestMessage(S),A({payloads:w,localMessages:I,sendingMessages:o,sendMessageCallback:n,customSendWaitTimeout:g,protocolType:v}),t()}}),{equalityFn:s.A})}}},72004:(e,t,n)=>{n.d(t,{C:()=>r});var i=n(98101),s=n(94343),o=n(56448);const a=(e,t,n,a)=>{const[r]=e,l=i.oz.getState();if((0,i.hT)(r),t.isReady){var c,d,u;const{send_message:r}=l.getReportEvents(n.conversation_id||"",n.local_message_id||"");(0,s.eT)({isRegenerate:t.isRegenerate,immerUpdateMessage:e,newLocalMessageId:o.rR,conversationId:null!==(c=n.conversation_id)&&void 0!==c?c:"",replyId:t.isRegenerate?null!==(d=null==a?void 0:a.sentMessageId)&&void 0!==d?d:"":t.localMessageId,sectionId:n.section_id,timeout:null==n||null===(u=n.ext)||void 0===u?void 0:u.timeout,scene:String(null==r?void 0:r.getMeta().scene),localMessageStatus:i.FQ.WaitingAck,createdFrom:"send-message",message:{ext:(0,s.Gm)(l)}}),(0,s.dk)({isRegenerate:t.isRegenerate,immerUpdateMessage:e,newLocalMessageId:o.rR,regenHead:null==a?void 0:a.regenerateHeadMessageId})}},r={insertMessageIntoStore:(e,t,n,i)=>{t.updateMessageList({conversationId:e.conversationId,immerUpdate:(...t)=>{const[s]=t,{draftMessageLinks:o,draftLocalMessageMap:r}=s;r[e.localMessageId]=n;const l={isLocalMessage:!0,messageId:e.localMessageId};e.isRegenerate||o.push(l),a(t,e,n,i)}})},setStoreMessageFailed:(e,t)=>{e.updateMessageList({conversationId:t.conversationId,immerUpdate:({draftLocalMessageMap:{[t.localMessageId]:e}})=>{null!=e&&e.local&&(e.local.failed=!0,e.local.status=i.FQ.PreprocessFailed)}})},updateStoreMessageAfterSend:(e,t,n,s)=>{t?e.updateMessageList({conversationId:t.conversationId,immerUpdate:(...e)=>{const[r]=e,{draftLocalMessageMap:{[t.localMessageId]:l},draftMessageLinks:c}=r;null!=l&&l.local&&(l.local.failedExpired=Date.now()+o.hn,l.local.status=s?i.FQ.SendingRegenerate:i.FQ.Sending),l.content=n,l.create_time=Date.now();const d=c.findIndex((e=>e.messageId===t.localMessageId));~d&&d!==c.length-1&&c.push(...c.splice(d,1)),a(e,t,l,s)}}):console.error("\u4e0d\u7b26\u5408\u9884\u671f\u7684\u5206\u652f")}}},74826:(e,t,n)=>{n.d(t,{$g:()=>u,Bu:()=>d,Fh:()=>a,JG:()=>s,QP:()=>o,YV:()=>c,fr:()=>r,kk:()=>l});var i=n(98101);const s=e=>"image"in e||"image_key"in e,o=e=>"file"in e||"file_key"in e,a=e=>"compositeContent"in e,r=e=>a(e)&&"images"in e.compositeContent&&!!e.compositeContent.images,l=e=>a(e)&&"files"in e.compositeContent&&!!e.compositeContent.files,c=e=>a(e)&&"links"in e.compositeContent&&!!e.compositeContent.links,d=e=>"nestedItems"in e,u=e=>e.type===i.WR.File},13027:(e,t,n)=>{n.d(t,{Zp:()=>i,bU:()=>s});let i=function(e){return e.Original="original",e.UseTemplate="use_template",e.ChangeTemplate="change_template",e.Paste="paste",e.Other="other",e.NotMessage="notMessage",e}({}),s=function(e){return e[e.RUYI=1]="RUYI",e[e.LEGO=2]="LEGO",e[e.CARD_BUILDER=3]="CARD_BUILDER",e}({})},60737:(e,t,n)=>{n.d(t,{IU:()=>c,Ns:()=>l,PF:()=>o.PF,Pt:()=>r,Pv:()=>o.Pv,QY:()=>o.QY,yN:()=>o.yN,zN:()=>o.zN});var i=n(36266),s=n(54343),o=n(7201),a=n(52494);const r=({event:e,adaptor:t})=>{try{const{event_type:n,message:i,cmd:o,message_list:a}=e;n===s.B.Message&&a&&a.forEach((e=>t.emit("message",e))),n===s.B.Message&&i&&t.emit("message",i),n===s.B.Cmd&&o&&t.emit("cmd",o)}catch(n){n instanceof Error&&i.vF.error({message:`unexpected error in event handler,${n.message}`,error:n})}},l=({store:e,adaptor:t})=>{t.on("message",(t=>(0,o.aT)(e,t))),t.on("cmd",(t=>(0,a.e)(e,t)))},c=({adaptor:e})=>{e.off("message"),e.off("cmd")}},7201:(e,t,n)=>{n.d(t,{PF:()=>o.PF,Pv:()=>o.Pv,QY:()=>o.QY,aT:()=>p,yN:()=>g.yN,zN:()=>g.zN});var i=n(44557),s=n(33664),o=n(94343),a=n(25334),r=n(17771),l=n(91073),c=n(43412),d=n(68843),u=n(76049),h=n(9530),m=n(36266),g=n(82289);const p=(e,t)=>{var n,g;const{conversation_id:p,message_type:v,message_id:f=""}=t,_={namespace:null===(n=t.localInfo)||void 0===n?void 0:n.from,meta:{message:t}};var y;null!==(g=h.v.localFeatureConfig)&&void 0!==g&&g.consoleFullMessagePacket&&m.vF.info((0,i.A)((0,i.A)({},_),{},{message:`Full Message Received, From: ${null===(y=t.localInfo)||void 0===y?void 0:y.from}`}));if(!p)return void m.vF.warning((0,i.A)((0,i.A)({},_),{},{message:"message.conversation_id is empty when update message in handleMessage"}));const x=(0,i.A)((0,i.A)({},t),{},{conversation_id:p});if(v===s.Go.Ack)return void(0,c.f)(e,x);if((0,d.ey)(t)){(0,r.Y)(e,x);const{next_connection_type:n,localInfo:i}=t;return n===s.ConnectionType.WebSocket&&(0,o.O6)(t),void(n===s.ConnectionType.HttpChunk&&(null==i?void 0:i.from)===u.aU.Socket&&(0,o.V3)(t))}if(!f)return void m.vF.warning((0,i.A)((0,i.A)({},_),{},{message:"message.message_id is empty when update message in handleMessage"}));const b=(0,i.A)((0,i.A)({},t),{},{message_id:f,conversation_id:p});if((0,d.yU)(b))(0,l.C)(e,b);else{(0,a.P)(e,b);const{next_connection_type:n,localInfo:i}=t;if(n===s.ConnectionType.HttpChunk&&(null==i?void 0:i.from)===u.aU.Socket&&(0,o.V3)(t),!(0,d.oS)(t))if(n===s.ConnectionType.WebSocket)(0,o.O6)(t);else if(n===s.ConnectionType.HttpChunk&&t.reply_id){var A;null===(A=o.Pv.getHttpAdapter())||void 0===A||A.abortMessage({replyId:t.reply_id})}}}},42767:(e,t,n)=>{n.d(t,{GR:()=>s,H9:()=>r,LW:()=>c,Tc:()=>a,WP:()=>o,rj:()=>l,to:()=>u});var i=n(98101);const s=(e,t,n)=>(0,i.qQ)(i.oz.getState(),e,t,n),o=e=>{const t=i.oz.getState(),n=t.messageLinkMap[e],s=(0,i.A4)({localMessageMap:t.localMessageMap[e],messageMap:t.messageMap[e]}),o=(0,i.WZ)(n,(e=>{const n=s(e);return!!n&&(0,i.$4)(n)&&!!n.reply_id&&!(0,i.c8)(n,t.userInfo.secUserId)}));return o?s(o):void 0},a=(e,t,n=i.oz.getState())=>(0,i.tP)(n,e,t),r=({messageLink:e,conversationId:t})=>{var n;const o=i.oz.getState(),r=null===(n=a(t,e,o))||void 0===n?void 0:n.reply_id,{message:l}=s(t,o.messageLinkMap[t],(({messageLink:e})=>e.messageId===r));return l},l=(e,t)=>{for(let n=t.length-1;n>=0;n--){const s=t[n],o=t[n-1],r=a(e,s),l=a(e,o);if((0,i.i8)(r)&&(0,i.i8)(l))return(0,i.hd)(r)?o:s;if((0,i.$4)(r))return s}},c=e=>{const t=i.oz.getState().messageLinkMap[e];return d(e,t)},d=(e,t,n)=>{const s=(0,i.rQ)(t);if(!s)return 0;const o=a(e,s,n);return o?Number(o.index||0):0},u=e=>(0,i.bR)(i.oz.getState(),e)},26037:(e,t,n)=>{n.d(t,{LM:()=>u,V5:()=>f,Wy:()=>h,ic:()=>m,j5:()=>g,on:()=>v,qr:()=>p});var i=n(3888),s=n(90321),o=n(11855),a=n(56642),r=n(94682),l=n(21331),c=n(5162),d=(n(54020),n(98101));const u=e=>(0,r.pU)((t=>(0,l.VN)(t,e)),a.x),h=e=>(0,r.pU)((t=>(0,l.Gl)(t,e)),a.x),m=e=>(0,d.oz)((t=>{if((0,s.A)(t.messageMap,e)){const n=t.messageMap[e];return!!(0,i.A)(n).every((e=>(0,d.RR)(e)))}return!0}),a.x),g=e=>{const{setActiveConversation:t}=r.pU.getState();(0,o.useEffect)((()=>{t(e)}),[e])},p=()=>(0,r.pU)(l.mV,a.x),v=()=>(0,r.pU)((e=>e.samanthaBot)),f=(e,t)=>{var n;const i=null!==(n=u(e))&&void 0!==n?n:{};return(0,c.gm)(i,t)}},36162:(e,t,n)=>{n.d(t,{K:()=>o,Z:()=>a});var i=n(11855),s=n(98101);const o=e=>{const[t,n]=(0,i.useState)(s.oz.persist.hasHydrated);return(0,i.useEffect)((()=>{const t=s.oz.persist.onHydrate((()=>n(!1))),i=s.oz.persist.onFinishHydration((()=>{n(!0),null==e||e()}));return n(s.oz.persist.hasHydrated()),s.oz.persist.hasHydrated()&&(null==e||e()),()=>{t(),i()}}),[]),t},a=()=>s.oz.persist.hasHydrated()?Promise.resolve():new Promise((e=>{s.oz.persist.onFinishHydration((()=>{e()}))}))},3112:(e,t,n)=>{n.d(t,{AG:()=>o.AG,IM:()=>o.IM,JX:()=>o.JX,KR:()=>c.K,LM:()=>r.LM,MH:()=>m,P9:()=>o.P9,Pm:()=>d,Rk:()=>o.Rk,UQ:()=>o.UQ,V5:()=>r.V5,Wy:()=>r.Wy,ZU:()=>c.Z,a1:()=>h,hJ:()=>o.hJ,ic:()=>r.ic,j5:()=>r.j5,kA:()=>a.k,ku:()=>l.k,on:()=>r.on,qr:()=>r.qr,tb:()=>a.t,uj:()=>o.uj,zQ:()=>u});var i=n(98101),s=n(56642),o=(n(65284),n(52346)),a=n(7901),r=n(26037),l=n(98114),c=n(36162);const d=()=>(0,i.oz)((e=>{var t;return null===(t=e.userInfo)||void 0===t?void 0:t.secUserId})),u=()=>(0,i.oz)((e=>{var t;return null===(t=e.userInfo)||void 0===t?void 0:t.userNickName})),h=()=>(0,i.oz)((e=>e.userOgfQuota),s.x),m=()=>(0,i.oz)((e=>e.userOgf),s.x)},7901:(e,t,n)=>{n.d(t,{k:()=>a,t:()=>o});var i=n(36266),s=n(54020);const o=({sendMessage:e,messageLink:t,conversationId:n})=>()=>{const s=(0,i.XB)({eventName:"retry_send_message",meta:{conversation_id:n,message_id:null==t?void 0:t.messageId,is_local_message:null==t?void 0:t.isLocalMessage}});try{e({scene:"resend",resend:{messageLink:t}}),s.successIfIdle(3e3)}catch(o){s.error({reason:"send message happen error, retry failed"})}},a=({sendMessage:e,messageLink:t,conversationId:n})=>()=>{const o=(0,s.Tc)(n,t),a=(0,i.XB)({eventName:"retry_receive_message",meta:{conversation_id:n,reply_id:null==o?void 0:o.reply_id,message_id:null==o?void 0:o.message_id}}),{reply_id:r}=o||{};if(!r)return void a.error({reason:"reply_id is null, retry failed"});const l={isLocalMessage:!1,messageId:r},c=(0,s.Tc)(n,l);try{e({replace:{messageLink:l},scene:"resend"}),a.successIfIdle(3e3)}catch(d){a.error({reason:"send message happen error, retry failed",error:d,meta:{content_type:null==c?void 0:c.content_type,is_local_message:null==l?void 0:l.isLocalMessage}})}}},52346:(e,t,n)=>{n.d(t,{AG:()=>x,IM:()=>S,JX:()=>y,P9:()=>A,Rk:()=>_,UQ:()=>w,hJ:()=>b,uj:()=>f});var i=n(44557),s=n(20716),o=n(72372),a=n(86204),r=n(2325),l=n(65284),c=n(98101),d=n(54020),u=n(56448),h=n(21331),m=n(94682),g=n(56642);const p=(0,l.B)(((e,t)=>e.messageLinkMap[t]||[])),v=(0,l.B)(((e,t)=>e.messageListStatusMap[t]||{})),f=(0,l.B)(((e,t)=>{const n=v.raw(e,t),i=p.raw(e,t),s=v.raw(e,u.i9),o=p.raw(e,u.i9),r=(0,h.VN)(m.pU.getState(),t);return(null==r?void 0:r.conversation_type)===a.Cr.Coco&&0===i.length?{status:s,messageLinks:o,resolveConversationId:u.i9}:{status:n,messageLinks:i,resolveConversationId:t}})),_=(0,l.B)(((e,t,n)=>{var s,a;const{feedback:l}=null!==(s=(0,d.Tc)(t,{isLocalMessage:!1,messageId:n},e))&&void 0!==s?s:{},c=(0,o.A)((0,i.A)({},null===(a=e.messageFeedbackMap[t])||void 0===a?void 0:a[n]),{feedback_type:l});return{liked:c.feedback_type===r.MW.Like,disliked:c.feedback_type===r.MW.Unlike,detail:c}}),s.A),y=((0,l.B)(((e,t)=>e.messageMap[t]||{})),(0,l.B)(((e,t)=>e.localMessageMap[t]||{})),(0,l.B)(((e,t,n)=>{var i;if(!n)return;return null===(i=(n.isLocalMessage?e.localMessageMap:e.messageMap)[t])||void 0===i?void 0:i[n.messageId]}))),x=(0,l.B)(((e,t,n)=>{const i=(0,c.A4)((0,c.tv)(e,t)),s=[];for(const o of n){const e=i(o);e&&s.push(e)}return s})),b=((0,l.B)(((e,t,n)=>{var i;return n?null===(i=e.localMessageMap[t])||void 0===i?void 0:i[n]:void 0})),(0,l.B)(((e,t,n)=>{var s,o,a;const{regenerateMessageMap:{[t]:r},messageLinkMap:{[t]:l},messageMap:{[t]:d}}=e,u=(0,c.tP)(e,t,n),h=(()=>{if(null!=u&&u.reply_id&&(0,c.oQ)(u))return(0,c.Ji)(u)?(0,c.rU)({messageLinks:l,replyId:u.reply_id,getMessage:(0,c.A4)({localMessageMap:e.localMessageMap[t],messageMap:e.messageMap[t]})}):n.regen_head?null==l?void 0:l.filter((e=>e.regen_head===n.regen_head||e.messageId===n.regen_head)).map((e=>(0,i.A)((0,i.A)({},e),{},{regen_head:e.regen_head||e.messageId}))):void 0})(),m=null===(s=[n,...null!=h?h:[]].map((e=>e.messageId in d?d[e.messageId]:null)).find((e=>null==e?void 0:e.reply_id)))||void 0===s?void 0:s.reply_id;return{activeRegenerateMessage:null!=h&&h.length?null==r||null===(o=r.messageMap)||void 0===o?void 0:o[n.messageId]:void 0,regenerateActiveIndex:null==h?void 0:h.findIndex((({messageId:e})=>e===n.messageId)),isRegenerateHead:Boolean(n.regen_head&&n.messageId),isRegenerateTail:Boolean(n.regen_head&&(null==h||null===(a=h[h.length-1])||void 0===a?void 0:a.messageId)===n.messageId),regenerateMessageLinks:h,replyFromMessage:m&&d[m]||void 0}}))),A=(0,l.B)(((e,t,n)=>{const i=e.suggestMessageMap[t];return(null==i?void 0:i.replyId)===n?i:void 0})),w=e=>(0,m.pU)((t=>t.lastSectionIdMap[e]),g.x),S=((0,l.B)(((e,t)=>e.lastMessageMap[t])),(0,l.B)(((e,t)=>(e.messageLinkMap[t]||[]).filter((e=>e.isLocalMessage)).map((e=>(0,d.Tc)(null!=t?t:"",e))).some((e=>!(0,c.oS)(e))))))},98114:(e,t,n)=>{n.d(t,{k:()=>u});var i=n(44557),s=n(14065),o=n(33451),a=n(11855),r=n(97327),l=n(9530);const c=["getUploadAuthToken"],d=e=>{let{getUploadAuthToken:t}=e,n=(0,o.A)(e,c);const i=(0,a.useRef)();return(0,s.A)((function*(){if(!i.current||(()=>{if(!i.current)return!0;const{auth:{expired_time:e,current_time:t}={}}=i.current;return!e||!t||new Date(e).getTime()<new Date(t).getTime()})()){const{data:e={}}=yield t(n);i.current=e}return i.current}))},u=({data_type:e})=>{const t=d({scene:"bot_chat",data_type:e,getUploadAuthToken:r.j.apiService.resource.GetUploadAuthToken.bind(r.j.apiService)});return{getUploader:function(){var n=(0,s.A)((function*(){var n;const s=yield t();return yield l.v.createUploader((0,i.A)((0,i.A)({},"image"===e?{imageConfig:s}:{fileConfig:s}),{},{userId:null!==(n=l.v.userId)&&void 0!==n?n:"",appId:l.v.appId}))}));return function(){return n.apply(this,arguments)}}()}}},51187:(e,t,n)=>{n.d(t,{$4u:()=>i.$4,A4i:()=>i.A4,AC:()=>i.AC,AG7:()=>l.AG,AUP:()=>i.AU,AmB:()=>i.Am,Azp:()=>a.Az,BFS:()=>i.BF,BV0:()=>i.BV,BlE:()=>c.B,BuH:()=>a.Bu,Bvk:()=>i.Bv,C5N:()=>i.C5,C9Q:()=>i.C9,CdX:()=>i.Cd,D6I:()=>i.D6,EKy:()=>i.EK,EtJ:()=>i.Et,FQ7:()=>i.FQ,GR_:()=>r.GR,H9Q:()=>r.H9,HN1:()=>i.HN,HyY:()=>i.Hy,I0B:()=>a.I0,IDn:()=>a.ID,IMW:()=>l.IM,JGj:()=>a.JG,JXh:()=>l.JX,Jij:()=>i.Ji,K71:()=>i.K7,K7t:()=>i.rK,KH8:()=>a.KH,KR9:()=>l.KR,LM8:()=>l.LM,LWX:()=>r.LW,LWw:()=>i.LW,Lh$:()=>o.Lh,MHV:()=>l.MH,O4i:()=>a.O4,ObL:()=>i.Ob,Oft:()=>i.Of,OtU:()=>i.Ot,P5b:()=>i.P5,P7$:()=>i.P7,P9k:()=>l.P9,PFX:()=>s.PF,P_A:()=>i.P_,Pmh:()=>l.Pm,PrW:()=>i.Pr,QP5:()=>a.QP,QVB:()=>o.QV,QYF:()=>s.QY,Qke:()=>i.Qk,RRO:()=>i.RR,Rkc:()=>l.Rk,SXk:()=>i.SX,T7u:()=>i.T7,TQL:()=>i.kc,TcN:()=>r.Tc,Tqp:()=>i.Tq,Tww:()=>i.Tw,UQO:()=>l.UQ,V5j:()=>l.V5,WRI:()=>i.WR,WkF:()=>i.Wk,Wpp:()=>i.Wp,Wrc:()=>i.Wr,WwN:()=>i.Ww,Wy4:()=>l.Wy,X$x:()=>i.X$,Y4y:()=>i.Y4,YFs:()=>i.YF,YVR:()=>a.YV,YfP:()=>i.Yf,ZUR:()=>l.ZU,Zp_:()=>i.Zp,ZwP:()=>i.Zw,_Kj:()=>i._K,_nB:()=>i._n,a13:()=>l.a1,aUK:()=>i.aU,aXB:()=>i.aX,c84:()=>i.c8,c89:()=>a.c8,dt3:()=>i.dt,dz7:()=>i.dz,e1A:()=>i.e1,eHr:()=>i.eH,eyX:()=>i.ey,frm:()=>a.fr,fyq:()=>i.fy,gkd:()=>a.gk,hJ8:()=>l.hJ,hTZ:()=>i.hT,hdx:()=>i.hd,hyk:()=>r.hy,i0O:()=>i.i0,iFS:()=>i.iF,icy:()=>l.ic,j5H:()=>l.j5,jHo:()=>i.jH,kAv:()=>l.kA,kH0:()=>i.kH,kII:()=>i.kI,kPB:()=>i.kP,kkt:()=>a.kk,kuT:()=>l.ku,lTU:()=>i.lT,m$:()=>i.m$,m7o:()=>i.m7,mf0:()=>i.mf,mlu:()=>i.ml,nMi:()=>i.nM,nt_:()=>i.nt,oMq:()=>i.oM,oSs:()=>i.oS,onb:()=>l.on,ozw:()=>i.oz,p4m:()=>a.p4,p8b:()=>a.p8,plQ:()=>i.pl,pu_:()=>i.pu,qr7:()=>l.qr,rJA:()=>i.rJ,rb6:()=>i.rb,rj$:()=>r.rj,t6R:()=>i.t6,tGr:()=>i.tG,tUh:()=>i.tU,tb7:()=>l.tb,tgJ:()=>i.tg,uVf:()=>a.uV,ujw:()=>l.uj,vmW:()=>a.vm,wIk:()=>i.wI,wqF:()=>i.wq,xTA:()=>i.xT,xX2:()=>i.xX,xYz:()=>i.xY,yNb:()=>s.yN,yxl:()=>a.yx,zNU:()=>s.zN,zQY:()=>l.zQ,zex:()=>i.ze,zgo:()=>i.zg});var i=n(98101),s=n(60737),o=n(1964),a=n(53523),r=n(54020),l=n(3112),c=n(66221)},94587:(e,t,n)=>{n.d(t,{L:()=>r});var i=n(10633),s=n(50068),o=n(1099),a=n(18029);class r{static get httpAdaptor(){var e;return this._httpAdaptor=null!==(e=this._httpAdaptor)&&void 0!==e?e:new o.m}static get httpChunkAdaptor(){var e;return this._httpChunkAdaptor=null!==(e=this._httpChunkAdaptor)&&void 0!==e?e:new a.d}static get socketAdaptor(){var e;return this._socketAdaptor=null!==(e=this._socketAdaptor)&&void 0!==e?e:new s.x}}(0,i.A)(r,"_httpAdaptor",void 0),(0,i.A)(r,"_httpChunkAdaptor",void 0),(0,i.A)(r,"_socketAdaptor",void 0)},47245:(e,t,n)=>{n.d(t,{Aj:()=>s.A,BF:()=>r.BF,EM:()=>o.E,FQ:()=>r.FQ,I6:()=>a.I,WR:()=>r.WR,Zp:()=>r.Zp,aU:()=>r.aU,hT:()=>i.hT,k:()=>i.k,pl:()=>l.p});var i=n(35482),s=n(47285),o=n(80590),a=n(26453),r=n(51065),l=n(21858)},63964:(e,t,n)=>{n.d(t,{YJ:()=>d,Zw:()=>h,bR:()=>s,mf:()=>u,qQ:()=>l,qo:()=>r,tP:()=>a,vW:()=>c});var i=n(68843);const s=(e,t)=>{const n=e.messageLinkMap[t]?o(e,t,e.messageLinkMap[t]):void 0;return{lastAvailableMessage:n?a(e,t,n):void 0,lastAvailableMessageLink:n}},o=(e,t,n)=>{for(let s=n.length-1;s>=0;s--){const o=n[s],r=n[s-1],l=a(e,t,o),c=a(e,t,r);if((0,i.i8)(l)&&(0,i.i8)(c))return(0,i.hd)(l)?r:o;if((0,i.$4)(l))return o}},a=(e,t,n)=>(0,i.A4)((0,i.tv)(e,t))(n),r=(e,t)=>{const{message:n}=l(e,t,e.messageLinkMap[t],(({messageLink:e})=>e.isLocalMessage&&!!e.messageId));return n&&(0,i.xX)(n)?n:void 0},l=(e,t,n,s)=>{const o=(0,i.A4)((0,i.tv)(e,t)),a=(0,i.WZ)(n||[],(e=>s({messageLink:e,getMessage:()=>o(e)})));return{messageLink:a,message:a?o(a):void 0}},c=(e,{conversationId:t,replyId:n})=>{const s=(0,i.ci)({messageLinks:e.messageLinkMap[t],replyId:n,getMessage:(0,i.A4)((0,i.tv)(e,t))});return s?a(e,t,s):void 0},d=(e,t,n)=>{var i;return(null===(i=e.localMessageMap[t])||void 0===i?void 0:i[n])||{}},u=(e,t)=>e.preprocessTaskMap[t].key,h=(e,t,n)=>{const i=e.messageMap[t],s=i[n];if(!s)return[];const o=!s.reply_id||"0"===s.reply_id?n:s.reply_id,a=i[null!=o?o:""],r=Object.keys(i).filter((e=>{var t;return(null===(t=i[e])||void 0===t?void 0:t.reply_id)===o})).map((e=>Number(i[e].index)));return[...a?[Number(a.index)]:[],...r]}},8136:(e,t,n)=>{n.d(t,{k:()=>l});var i=n(21511),s=n(78053),o=n(36536),a=n(45498),r=n(56146);const l=(0,a.vt)()(((e,t)=>({isSelectMode:!1,messageIndexList:[],preShareId:"",preMessageIndexList:[],enterSelectMode:n=>{var i,s;t().isSelectMode||e({isSelectMode:!0,messageIndexList:[],preShareId:null!==(i=null==n?void 0:n.share_id)&&void 0!==i?i:"",preMessageIndexList:2===(null==n?void 0:n.share_status)&&null!==(s=null==n?void 0:n.message_index_list)&&void 0!==s?s:[]})},exitSelectMode:()=>{t().isSelectMode&&e({isSelectMode:!1,messageIndexList:[],preShareId:"",preMessageIndexList:[]})},toggleMessage:(n,s)=>{const a=t().messageIndexList;a.includes(n)?e({messageIndexList:(0,o.A)(a,n)}):a.length>=r.fV||(a.length+s.length>r.fV?e({messageIndexList:[...a,n].sort()}):e({messageIndexList:(0,i.A)([...a,...s]).sort()}))},selectAll:t=>{e({messageIndexList:(0,s.A)(1,t+1)})},deselectAll:()=>{e({messageIndexList:[]})},getIsSelectAllChecked:e=>t().messageIndexList.length>=e})))},18435:(e,t,n)=>{n.d(t,{A4:()=>d,AC:()=>v,Kj:()=>l,Ww:()=>p,i0:()=>g,kI:()=>m,rJ:()=>h,tv:()=>c,uT:()=>r,um:()=>u});var i=n(28159),s=n(33664),o=n(2615),a=n(51065);n(56448);const r=({messageLinks:e,getMessage:t,range:n})=>{var i;const s=Number(null===(i=t(e[0]))||void 0===i?void 0:i.index)||0;return{hasMore:s>n.start,lastCursor:s,loading:!1}},l=({messageLinks:e,getMessage:t,size:n})=>{if(Array.isArray(e)&&e.length>0){var i;const s=Number(null===(i=t(e[0]))||void 0===i?void 0:i.index)||0,o=e.length>=n;return{hasMore:s>1&&o,lastCursor:s,loading:!1}}return{hasMore:!1,lastCursor:0,loading:!1}},c=(e,t)=>({messageMap:e.messageMap[t],localMessageMap:e.localMessageMap[t],messageLinks:e.messageLinkMap[t],messageListStatus:e.messageListStatusMap[t]}),d=e=>t=>{var n,i;if(!t)return;const{isLocalMessage:s,messageId:o}=t;return s?null===(n=e.localMessageMap)||void 0===n?void 0:n[o]:null===(i=e.messageMap)||void 0===i?void 0:i[o]},u=e=>`replyTo${e}`,h=e=>e?(0,o.Ji)(e)?"pic":(0,o.ze)(e)?"video":(0,o.dz)(e)?"music":(0,o.ml)(e)?"file":(0,o._n)(e)?"search_card":(0,o.TQ)(e)?"lyrics_to_song_lyric":(0,o.lT)(e)?"lyrics_to_song_music":"text":"text",m=e=>{if(e&&(0,o.pu)(e)){const{text:t}=e.contentObj||{};return(0,i.A)(t)?t.length:0}return 0},g=e=>{if(e&&(0,o.pu)(e)){const{text:t}=e.contentObj||{};return(0,i.A)(t)&&t.includes("coco://sendMessage")?1:0}return 0};function p(e){const{ConnectionType:t}=s;return e.next_connection_type===t.WebSocket?a.aU.Socket:e.next_connection_type===t.HttpChunk?a.aU.HttpChunk:null===(n=e.localInfo)||void 0===n?void 0:n.from;var n}function v(e){var t,n,i,s,o,a,r;return{conversation_id:e.conversation_id,message_id:e.message_id,from:null===(t=e.localInfo)||void 0===t?void 0:t.from,local_message_id:null==e?void 0:e.local_message_id,is_regenerate:"local"in e&&(null==e||null===(n=e.local)||void 0===n?void 0:n.isRegenerate),has_err:null==e||null===(i=e.ext)||void 0===i?void 0:i.has_err,log_id:null===(s=e.localInfo)||void 0===s?void 0:s.logId,inner_log_id:null==e||null===(o=e.ext)||void 0===o?void 0:o.log_id,trace_id:null===(a=e.localInfo)||void 0===a?void 0:a.traceId,retried:null==e||null===(r=e.localInfo)||void 0===r?void 0:r.retried,next_connection_type:null==e?void 0:e.next_connection_type}}},95460:(e,t,n)=>{n.d(t,{D6:()=>l,P5:()=>r,YF:()=>c,oM:()=>a});var i=n(28159),s=n(2633),o=n(2615);const a=e=>{if(e&&(0,o.pu)(e)){var t,n;if((0,i.A)(null==e||null===(t=e.contentObj)||void 0===t?void 0:t.text))return null==e||null===(n=e.contentObj)||void 0===n?void 0:n.text;if((0,i.A)(e.tts_content)&&e.tts_content&&!(0,o.RR)(e))return e.tts_content}},r=(e,t,n)=>{if(!e)return;const r=a(e);return(0,i.A)(r)?r:(0,o.HN)(e)||(0,o.Ji)(e)?void 0:t?(0,s.A)(null==e?void 0:e.contentObj)?`${n} message.content\uff1a${null==e?void 0:e.content}`:`${n} message.content\uff1a\n\n\`\`\`json\n${JSON.stringify(null==e?void 0:e.contentObj,void 0,2)}\n\`\`\`\n\n`:n},l=e=>{const t=null==e?void 0:e.match(/\[(\S*?)\](?=\(coco:\/\/sendMessage)/g);return null!=t&&t.length?t.map((e=>e.split(/[\[\]]/).join(""))):[]},c=e=>{var t;return(0,o.TQ)(e)&&(null==e||null===(t=e.contentObj)||void 0===t?void 0:t.text)||""}},30949:(e,t,n)=>{n.d(t,{B:()=>c,C:()=>l});var i=n(33451),s=n(11855),o=n(63159);const a=["children"],r=(0,s.createContext)({t:(e,t="",n={})=>(console.warn(`Not use I18nProvider to wrapper target component when using translation of ${e}`),t)}),l=e=>{let{children:t}=e,n=(0,i.A)(e,a);return(0,o.jsx)(r.Provider,{value:n,children:t})},c=()=>{const{t:e}=(0,s.useContext)(r);return e}},18195:(e,t,n)=>{n.d(t,{U:()=>o,Y:()=>s});var i=n(11855);const s=(0,i.createContext)(null);function o(e){const{allowNull:t=!1}=e||{},n=(0,i.useContext)(s);if(!t&&!n)throw new Error("expect logger in LoggerContext but not found");return n}},33413:(e,t,n)=>{n.r(t),n.d(t,{MathJaxTex:()=>w,default:()=>S});var i=n(11855),s=n(24489),o=n.n(s),a=n(86843),r=n(1862),l=n(56912),c=n(60669),d=n(51128),u=n(68767),h=n(29019),m=n.n(h),g=n(75135),p=n(84697),v=n(63159);let f,_=e=>e;const y=(0,u.liteAdaptor)();(0,d.J)(y);const x=new c.TeX({packages:[...l.B.sort().join(", ").split(/\s*,\s*/),"physics","mhchem"],macros:{equalparallel:"{\\lower{2.6pt}{\\arrowvert\\hspace{-4.2pt}\\arrowvert}\\above{-2pt}\\raise{7.5pt}{=}}",number:["{#1}",1],unit:["{#1}",1],div:"{\xf7}"}}),b=new a.SVG({fontCache:"none"}),A=r.mathjax.document("",{InputJax:x,OutputJax:b}),w=({tex:e,mode:t,className:n,style:s})=>{const a=(0,i.useMemo)((()=>{var t;const n=o().replace(e,o()(String.raw(f||(f=_`[^\P{C}\n\t]+`)),"ug"),""),i=A.convert(n,{display:!0,em:16,ex:8,containerWidth:1280});return y.outerHTML(null==i||null===(t=i.children)||void 0===t?void 0:t[0])}),[e]);return(0,g.F)(a).includes("data-mjx-error")?(0,v.jsx)("span",{className:m()(p.A["math-error"],n),style:s,children:e}):(0,v.jsx)("span",{className:m()("math-inline",n),style:s,dangerouslySetInnerHTML:{__html:(0,g.F)(a)}})},S=w},73795:(e,t,n)=>{n.r(t),n.d(t,{PrismCodeBlockHighlighter:()=>c,default:()=>d});var i=n(29019),s=n.n(i),o=n(1600),a=n(31324),r=n(75135),l=(n(83392),n(63159));const c=({code:e,language:t="",className:n,style:i})=>{const c=(0,o.W)(e,t);return(0,l.jsx)("pre",{className:s()(t&&`language-${t}`,a.A["light-scrollbar"],n),style:i,children:(0,l.jsx)("code",{dangerouslySetInnerHTML:{__html:(0,r.F)(c)}})})},d=c},79474:(e,t,n)=>{n.d(t,{B94:()=>qe,DC3:()=>ie,DaB:()=>le,Dkt:()=>Q,DqC:()=>R,EGn:()=>Ue,EWR:()=>ee,EwG:()=>A,FC_:()=>q,FDz:()=>ge,FXq:()=>L,FrO:()=>oe,G2z:()=>Ce,GeG:()=>it,H6p:()=>b,HXh:()=>Fe,IDX:()=>Pe,IVD:()=>Ke,In9:()=>v,InS:()=>G,KkG:()=>u,KsF:()=>C,Lc8:()=>Re,Npf:()=>D,OPx:()=>re,P3c:()=>U,PTM:()=>Z,PoW:()=>ye,QAj:()=>pe,QL3:()=>Ve,QVi:()=>Se,RNZ:()=>We,RuR:()=>H,T6T:()=>Ge,TDm:()=>x,TNb:()=>d,TTe:()=>Ie,TgH:()=>Ne,U5z:()=>se,ULr:()=>Qe,UNM:()=>fe,WsO:()=>Te,Wur:()=>we,X4:()=>V,X9Y:()=>tt,XgB:()=>de,XgE:()=>Ze,YaG:()=>be,ZKw:()=>k,ZR1:()=>h,ZZJ:()=>m,_4N:()=>_e,_H0:()=>T,_wR:()=>xe,aLc:()=>Je,abE:()=>Be,bo3:()=>y,cs5:()=>Ye,d0m:()=>S,d0t:()=>ze,dTV:()=>He,eKK:()=>E,eWz:()=>je,fFY:()=>Me,fkI:()=>W,fsR:()=>Le,fvB:()=>K,gXP:()=>J,ifA:()=>nt,k3s:()=>ve,k4K:()=>w,kcO:()=>P,lNg:()=>he,lSc:()=>g,lUW:()=>$e,lkE:()=>f,mFg:()=>ke,npH:()=>ae,oZ9:()=>j,qDU:()=>$,qUP:()=>et,qjL:()=>B,r9y:()=>Xe,rN9:()=>ne,rQU:()=>Oe,sBK:()=>Y,sPs:()=>p,sTf:()=>X,st6:()=>_,svv:()=>N,sxB:()=>Ee,u06:()=>Ae,uGY:()=>De,v9Y:()=>z,vPz:()=>ce,vek:()=>te,vlM:()=>c,wve:()=>ue,xP8:()=>M,xdu:()=>O,z18:()=>me,zSs:()=>I,zzu:()=>F});var i=n(44557),s=n(83632),o=n(94790),a=n(11855),r=n(63159);const l=a.lazy((()=>Promise.resolve().then(n.bind(n,6411)).catch((e=>(console.error("IconByKey lazy error:",e),{default:()=>null}))))),c=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcWriteIcon"},t))})},d=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcUploadIcon"},t))})},u=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcTrashIcon"},t))})},h=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcTranslateOffIcon"},t))})},m=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcTipIcon"},t))})},g=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcThumbsUpFillIcon"},t))})},p=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcThumbsUpIcon"},t))})},v=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcThumbsDownFillIcon"},t))})},f=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcThumbsDownIcon"},t))})},_=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSunIcon"},t))})},y=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSummarizeWebpaegFillIcon"},t))})},x=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcStopFillIcon"},t))})},b=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSnowIcon"},t))})},A=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSkillsFillExplorationIcon"},t))})},w=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSkillsIcon"},t))})},S=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcShareIcon"},t))})},C=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcShakeIcon"},t))})},k=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSettingsIcon"},t))})},I=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSearchSmartIcon"},t))})},E=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSearchIcon"},t))})},T=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcRegenerateIcon"},t))})},j=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcReadSparkleIcon"},t))})},N=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcReadIcon"},t))})},M=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcQuote1Icon"},t))})},L=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcPositionIcon"},t))})},R=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcPlayFillIcon"},t))})},P=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcPlayIcon"},t))})},B=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcPhotoIcon"},t))})},O=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcNotificationIcon"},t))})},D=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcMusicSparkleIcon"},t))})},F=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcMusicIcon"},t))})},U=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcMoreIcon"},t))})},H=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcMoonIcon"},t))})},z=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcModifyShorterIcon"},t))})},q=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcModifyMediumIcon"},t))})},V=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcModifyLongerIcon"},t))})},$=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcMicroIcon"},t))})},K=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcMassageIcon"},t))})},W=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcMailIcon"},t))})},G=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcLyricsIcon"},t))})},Y=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcLoveIcon"},t))})},Q=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcLinkExternalIcon"},t))})},J=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcLinkIcon"},t))})},X=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcLeafIcon"},t))})},Z=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcImageSparkleIcon"},t))})},ee=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeWhiteXlsxIcon"},t))})},te=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeWhiteTxtAndOthersIcon"},t))})},ne=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeWhitePptxIcon"},t))})},ie=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeWhitePdfIcon"},t))})},se=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeWhiteImageIcon"},t))})},oe=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeWhiteDocIcon"},t))})},ae=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeWhiteCsvIcon"},t))})},re=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeGreyXlsxIcon"},t))})},le=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeGreyTxtAndOthersIcon"},t))})},ce=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeGreyPptxIcon"},t))})},de=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeGreyPdfIcon"},t))})},ue=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeGreyImageIcon"},t))})},he=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeGreyDocIcon"},t))})},me=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeGreyCsvIcon"},t))})},ge=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulXlsxIcon"},t))})},pe=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulTxtAndOthersIcon"},t))})},ve=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulPptxIcon"},t))})},fe=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulPdfIcon"},t))})},_e=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulLinkIcon"},t))})},ye=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulImageIcon"},t))})},xe=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulDocIcon"},t))})},be=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulCsvIcon"},t))})},Ae=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFavoriteDoneIcon"},t))})},we=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFavoriteIcon"},t))})},Se=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcExpandIcon"},t))})},Ce=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcEditIcon"},t))})},ke=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcDragIcon"},t))})},Ie=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcDownloadAppIcon"},t))})},Ee=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcDownloadIcon"},t))})},Te=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcDoneWithCircleIcon"},t))})},je=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcDoneIcon"},t))})},Ne=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcCoreIcon"},t))})},Me=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcCopyIcon"},t))})},Le=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcControlIcon"},t))})},Re=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcCollapseIcon"},t))})},Pe=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcCloudyIcon"},t))})},Be=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcCloseIcon"},t))})},Oe=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcChevronRightIcon"},t))})},De=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcChevronLeftIcon"},t))})},Fe=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcChevronDownIcon"},t))})},Ue=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcChatIcon"},t))})},He=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcCameraIcon"},t))})},ze=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcBookIcon"},t))})},qe=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcArrowIcon"},t))})},Ve=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcAllThreadsIcon"},t))})},$e=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcAddIcon"},t))})},Ke=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcAcademicCiteIcon"},t))})},We=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcAcademicIcon"},t))})},Ge=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"VideoPlayIcon"},t))})},Ye=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"PlusWithoutCircleIcon"},t))})},Qe=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IconMusicPlayIcon"},t))})},Je=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IconMusicPauseIcon"},t))})},Xe=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IconMusicDefaultIcon"},t))})},Ze=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"FlowerLoadingIcon"},t))})},et=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"EditIcon"},t))})},tt=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"BlueMagicIcon"},t))})},nt=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"ArrowUpCircleIcon"},t))})},it=e=>{let t=(0,o.A)({},((0,s.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"AddAvatarIcon"},t))})}},53631:(e,t,n)=>{n.d(t,{v:()=>a});var i=n(10633),s=n(60162);class o extends Error{constructor(...e){super(...e),(0,i.A)(this,"name","assert_error")}}const a=(e,t)=>{if(!e){if((0,s.A)(t))throw t;throw new o(t)}}},86652:(e,t,n)=>{n.d(t,{Bo:()=>a,kf:()=>r,q3:()=>l,tH:()=>c,yy:()=>d});var i=n(49392),s=n(28159),o=n(91689);n(49196);const a=e=>(0,o.A)(e)&&e.every(s.A),r=e=>{const t=e.replace(/,/g,"");return!isNaN(t)&&!isNaN(parseFloat(t))};const l=e=>!(0,i.A)(e),c=e=>{if(e<0)return console.error("[convertBytes] bytes is less than 0."),"0B";const t=Math.floor(e);if(e!==t&&console.error("[convertBytes] bytes is not an integer."),t<Math.pow(1024,1))return`${t}B`;if(t<Math.pow(1024,2)){const e=t/Math.pow(1024,1);return`${Math.round(e)}KB`}if(t<Math.pow(1024,3)){const e=t/Math.pow(1024,2);return`${Math.round(e)}MB`}const n=t/Math.pow(1024,3);return`${Math.round(n)}GB`},d=e=>{let t;const n=new Promise((e=>{t=e}));return setTimeout((()=>{var e;null===(e=t)||void 0===e||e()}),e),n}},95988:(e,t,n)=>{n.d(t,{G:()=>i});const i="flow-ext-disable-select-bar"},33898:(e,t,n)=>{n.d(t,{B4:()=>i.B4,EE:()=>i.EE,FT:()=>i.FT,Gg:()=>g.G,IL:()=>i.IL,Ij:()=>i.Ij,Kl:()=>u.K,Ls:()=>c.L,ML:()=>i.ML,Mk:()=>i.Mk,Qf:()=>r.Qf,VS:()=>d.V,Wp:()=>i.Wp,XX:()=>i.XX,Z3:()=>i.Z3,ZC:()=>i.ZC,bP:()=>i.bP,k9:()=>l.k,kU:()=>s.k,lB:()=>a.l,my:()=>h.m,v_:()=>o.v,w5:()=>i.w5,wY:()=>m.w,xD:()=>i.xD});var i=n(48748),s=n(49385),o=n(13479),a=n(32594),r=(n(90004),n(5809),n(96172)),l=(n(78513),n(32019)),c=n(97502),d=(n(11516),n(73090)),u=n(35362),h=n(31469),m=n(99109),g=(n(53352),n(61096));n(23853),n(30226),n(29392),n(75593),n(37301)},97502:(e,t,n)=>{n.d(t,{L:()=>o});var i=n(11855);const s="click";function o(e,t,n=s,o){const a=(0,i.useRef)(),r=(0,i.useCallback)((n=>{var i;const s=("function"==typeof e?e():e)||a.current;!s||s.contains(n.target)||null!==(i=n.composedPath)&&void 0!==i&&i.call(n).includes(s)||t(n)}),[a.current,t,e]);return(0,i.useEffect)((()=>(document.addEventListener(n,r,o),()=>{document.removeEventListener(n,r,o)})),[n,o,r]),a}},73090:(e,t,n)=>{n.d(t,{V:()=>s});var i=n(11855);const s=(e,t)=>{const n=(0,i.useRef)(e);return t(e,n.current)||(n.current=e),n.current}},32019:(e,t,n)=>{n.d(t,{k:()=>o});var i=n(11855),s=n(20716);const o=(e,t=s.A)=>{const n=(0,i.useRef)(e),o=t(n.current,e);return(0,i.useEffect)((()=>{o||(n.current=e)})),o?n.current:e}},35362:(e,t,n)=>{n.d(t,{K:()=>s});var i=n(11855);const s=e=>{const t=(0,i.useRef)(e);return t.current=t.current||e,t.current}},31469:(e,t,n)=>{n.d(t,{m:()=>r});var i=n(33451),s=n(11855);const o=["ref"],a=(e,t,n)=>e>=t&&e<=n,r=e=>{let{ref:t}=e,n=(0,i.A)(e,o);const[r,l]=(0,s.useState)(!1);return(0,s.useLayoutEffect)((()=>{null!=t&&t.current&&((e,t={})=>{const{top:n,left:i,bottom:s,right:o}=e.getBoundingClientRect(),{topOffset:r=0,bottomOffset:l=0,leftOffset:c=0,rightOffset:d=0}=t,u=window.innerWidth||document.documentElement.clientWidth,h=window.innerHeight||document.documentElement.clientHeight;return(a(n,-r,h+l)||a(s,-r,h+l)||n<-r&&s>h+l)&&(a(i,-c,u+d)||a(o,-c,u+d)||i<-c&&o>u+d)})(t.current,n)&&l(!0)}),[]),{ref:t,inView:r}}},96172:(e,t,n)=>{n.d(t,{Qf:()=>o});var i=n(11855);const s={media:"",matches:!1,onchange:()=>{},addListener:()=>{},removeListener:()=>{},addEventListener:()=>{},removeEventListener:()=>{},dispatchEvent:()=>!0},o=(e,t=!1)=>{const[n,o]=(0,i.useState)(t),a=function(e){return"string"==typeof e?e:Object.entries(e).map((([e,t])=>{const n=e.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`)).toLowerCase();let i=t;return"boolean"==typeof i?i?n:`not ${n}`:("number"==typeof i&&/[height|width]$/.test(n)&&(i=`${i}px`),`(${n}: ${i})`)})).join(" and ")}(e);return(0,i.useEffect)((()=>{let e=!0;const t="undefined"==typeof window?s:window.matchMedia(a),n=()=>{e&&o(Boolean(t.matches))};return t.addListener(n),o(t.matches),()=>{e=!1,t.removeListener(n)}}),[a]),n}},99109:(e,t,n)=>{n.d(t,{w:()=>l});var i=n(49392),s=n(9388),o=n(11855),a=n(37517),r=n(97785);"undefined"==typeof window||window.ResizeObserver||(window.ResizeObserver=r.tb);const l=(e={})=>{const{ref:t,onlyBothNilIsFirstScreen:n=!0,onResize:r}=e,l=(0,o.useRef)(null),c=null!=t?t:l,[d,u]=(0,o.useState)(),[h,m]=(0,o.useState)();(0,o.useLayoutEffect)((()=>{g()}),[]),(0,o.useLayoutEffect)((()=>{(0,i.A)(d)||(0,i.A)(h)||null==r||r({width:d,height:h})}),[d,h]);const g=()=>{if(c.current){const{width:e,height:t}=c.current.getBoundingClientRect();u(e),m(t)}else u(void 0),m(void 0)},{width:p,height:v}=(0,a.A)({ref:c,onResize:e=>{null==r||r(e);const{width:t,height:n}=e;(0,s.flushSync)((()=>{u(null!=t?t:0),m(null!=n?n:0)}))}});(0,o.useLayoutEffect)((()=>{u(void 0)}),[p]),(0,o.useLayoutEffect)((()=>{m(void 0)}),[v]);const f=n&&(0,i.A)(p)&&(0,i.A)(v);return{ref:c,width:null!=d?d:f?void 0:null!=p?p:0,height:null!=h?h:f?void 0:null!=v?v:0,refresh:g}}},61096:(e,t,n)=>{n.d(t,{G:()=>o});var i=n(49392),s=n(11855);const o=e=>{const t=(0,s.useRef)(),n=()=>{t.current&&(clearTimeout(t.current),t.current=null)};return(0,s.useEffect)((()=>n),[]),{setExpired:s=>{if(n(),(0,i.A)(s))return;const o=Math.max(s-Date.now(),0);t.current=window.setTimeout((()=>{e()}),o)},reset:n}}},38474:(e,t,n)=>{n.d(t,{V8:()=>c,r$:()=>u,zH:()=>l});var i=n(14065),s=n(11855),o=n(22933),a=n(66404),r=n(62556);const l=()=>"undefined"==typeof navigator?"":navigator.language,c=e=>{var t;return null!==(t=(0,o.isRtlLang)(null!=e?e:l()))&&void 0!==t&&t},d=function(){var e=(0,i.A)((function*(e,t=!1){try{const s=e.trim();if(!s)return t;const{franc:o}=yield(0,r.ts)((()=>Promise.resolve().then(n.bind(n,6683)))),l=o(s,{minLength:20});return"und"===l?(i=s.charAt(0),new RegExp("^[^A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02b8\u0300-\u0590\u0800-\u1fff\u2c00-\ufb1c\ufdfe-\ufe6f\ufefd-\uffff]*[\u0591-\u07ff\ufb1d-\ufdfd\ufe70-\ufefc]").test(i)):a.T.includes(l)}catch(s){return t}var i}));return function(t){return e.apply(this,arguments)}}(),u=(e,t=!1)=>{const[n,o]=(0,s.useState)("ltr"),a=function(){var n=(0,i.A)((function*(){const n=yield d(e,t);o(n?"rtl":"ltr")}));return function(){return n.apply(this,arguments)}}();return(0,s.useEffect)((()=>{a()}),[e,t]),n}},53713:(e,t,n)=>{n.d(t,{Asr:()=>m.A,BKw:()=>g.BK,BPM:()=>p.BP,Bog:()=>i.Bo,EE$:()=>u.EE,Eop:()=>a.Eo,FTe:()=>u.FT,F_u:()=>c.F_,FrL:()=>c.Fr,G2O:()=>v.G,GOI:()=>p.GO,GgW:()=>u.Gg,ILi:()=>u.IL,IjL:()=>u.Ij,JgS:()=>p.Jg,JxI:()=>h.J,Kld:()=>u.Kl,LsG:()=>u.Ls,MLh:()=>u.ML,MaB:()=>c.M,Mks:()=>u.Mk,Mx4:()=>c.Mx,Ny:()=>c.Ny,OlY:()=>s.O,QfP:()=>u.Qf,UPE:()=>c.UP,V8t:()=>d.V8,V9O:()=>p.V9,VSZ:()=>u.VS,Wpb:()=>u.Wp,XXc:()=>u.XX,Yq5:()=>a.Yq,Z3i:()=>u.Z3,Z57:()=>c.Z5,ZCR:()=>u.ZC,bPQ:()=>u.bP,e4x:()=>s.e,gml:()=>c.gm,h9L:()=>l.h9,jco:()=>c.jc,k92:()=>u.k9,kU9:()=>u.kU,kf$:()=>i.kf,lBS:()=>u.lB,myZ:()=>u.my,nJq:()=>r.nJ,nrF:()=>c.nr,q3w:()=>i.q3,r$W:()=>d.r$,tHD:()=>i.tH,tHN:()=>l.tH,tiF:()=>p.ti,tkF:()=>p.tk,tsJ:()=>l.ts,vAR:()=>o.v,v_R:()=>u.v_,w5E:()=>u.w5,wYm:()=>u.wY,w_h:()=>c.w_,wu0:()=>p.wu,xDQ:()=>u.xD,yK0:()=>p.yK,yy4:()=>i.yy,zH3:()=>d.zH});var i=n(86652),s=n(47807),o=n(53631),a=n(12620),r=n(67713),l=n(62556),c=n(80990),d=n(38474),u=(n(54900),n(33898)),h=(n(85204),n(74317),n(71262)),m=n(37114),g=n(69220),p=n(49931),v=(n(61336),n(95988))},1161:(e,t,n)=>{n.d(t,{zV:()=>i});const i=(e,t="",n=512)=>{var i;const s=null!==(i=e.split(",")[1])&&void 0!==i?i:e,o=atob(s),a=[];for(let r=0;r<o.length;r+=n){const e=o.slice(r,r+n),t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);const i=new Uint8Array(t);a.push(i)}return new Blob(a,{type:t})}},80990:(e,t,n)=>{n.d(t,{F_:()=>h,Fr:()=>a,M:()=>f,Mx:()=>u,Ny:()=>r,UP:()=>g,Z5:()=>_,gm:()=>m,jc:()=>d,nr:()=>p,w_:()=>v});var i=n(7685),s=n.n(i);let o;const a=()=>s().getParser(navigator.userAgent).getPlatformType(!0).includes("mobile"),r=()=>(void 0===o&&(o=a()),o);let l;let c;const d=()=>{if(void 0===c){const{userAgent:e}=navigator,t=/iPad/.test(e),n=e.includes("Macintosh")&&"ontouchstart"in document.documentElement;c=t||n}return c},u=()=>r()||(()=>{if("undefined"==typeof document)return!1;if(void 0===l){const{userAgent:e}=navigator,t=/iPad|iPhone|iPod/.test(e),n=e.includes("Macintosh")&&"ontouchstart"in document.documentElement;l=t||n}return l})(),h=()=>"function"==typeof window.webkitConvertPointFromNodeToPage,m=()=>navigator.userAgent.toLowerCase().includes("firefox"),g=()=>/edge?\//.test(navigator.userAgent.toLowerCase()),p=()=>navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome"),v=()=>h()&&!u();const f="undefined"!=typeof window,_=()=>{if("undefined"==typeof navigator)return;const e=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)/);if(null===e||5!==e.length)return;const[,t,n,i,s]=e.map((e=>parseInt(e,10)));return{major:t,minor:n,build:i,patch:s}}},62556:(e,t,n)=>{n.d(t,{h9:()=>o,tH:()=>r,ts:()=>s});var i=n(14065);n(11855);const s=(e,t=3,n=1e3)=>new Promise(((i,o)=>{e().then(i).catch((a=>{setTimeout((()=>{1!==t?s(e,t-1,n).then(i,o):o(a)}),n)}))})),o=({fn:e,retriesLeft:t=3,interval:n=1e3,fallback:i={default:()=>null},onError:s=(()=>{})})=>new Promise(((a,r)=>{e().then(a).catch((l=>{setTimeout((()=>{if(1===t)return console.error("retryLoadWithFallBack error:",l),null==s||s(l),void a(i);o({fn:e,retriesLeft:t-1,interval:n,fallback:i,onError:s}).then(a,r)}),n)}))})),a=e=>new Promise((t=>{setTimeout(t,e)})),r=function(){var e=(0,i.A)((function*(e,t,n,i){for(let o=0;o<t;o++){const r=o+1;try{return yield e()}catch(s){if(r>=t)throw s;null==i||i(s,o)}const l="number"==typeof n?n:n(r);yield a(l)}throw Error("retry times out of limit")}));return function(t,n,i,s){return e.apply(this,arguments)}}()},12620:(e,t,n)=>{n.d(t,{Eo:()=>a,Yq:()=>o});var i=n(42579),s=n.n(i);const o=(e,t="YYYY/MM/DD HH:mm:ss")=>s()(parseInt(String(e))).format(t),a=(e,t=!0)=>s()(parseInt(String(e))).format(t?"YYYY/MM/DD HH:mm:ss.SSS":"HH:mm:ss.SSS")}},s={};function o(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={id:e,loaded:!1,exports:{}};return i[e].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=i,o.amdO={},e=[],o.O=(t,n,i,s)=>{if(!n){var a=1/0;for(d=0;d<e.length;d++){for(var[n,i,s]=e[d],r=!0,l=0;l<n.length;l++)(!1&s||a>=s)&&Object.keys(o.O).every((e=>o.O[e](n[l])))?n.splice(l--,1):(r=!1,s<a&&(a=s));if(r){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[n,i,s]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(e,i){if(1&i&&(e=this(e)),8&i)return e;if("object"==typeof e&&e){if(4&i&&e.__esModule)return e;if(16&i&&"function"==typeof e.then)return e}var s=Object.create(null);o.r(s);var a={};t=t||[null,n({}),n([]),n(n)];for(var r=2&i&&e;"object"==typeof r&&!~t.indexOf(r);r=n(r))Object.getOwnPropertyNames(r).forEach((t=>a[t]=()=>e[t]));return a.default=()=>e,o.d(s,a),s},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o.p="/",(()=>{var e={854:0,788:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var i,s,[a,r,l]=n,c=0;if(a.some((t=>0!==e[t]))){for(i in r)o.o(r,i)&&(o.m[i]=r[i]);if(l)var d=l(o)}for(t&&t(n);c<a.length;c++)s=a[c],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(d)},n=self.webpackChunkflow_web_extension=self.webpackChunkflow_web_extension||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),o.O(void 0,[147,102,295,934,980,771,143,681,883,964],(()=>o(21753)));var a=o.O(void 0,[147,102,295,934,980,771,143,681,883,964],(()=>o(7745)));a=o.O(a);