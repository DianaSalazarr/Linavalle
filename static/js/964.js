(self.webpackChunkflow_web_extension=self.webpackChunkflow_web_extension||[]).push([[964],{12201:(e,t,i)=>{i.d(t,{v:()=>o});var n=i(14144);let s=[];const o=e=>{try{s.forEach((t=>null==t?void 0:t.postMessage(e)))}catch(t){(0,n.z3)("[lwx] send log to port error",t)}}},39044:(e,t,i)=>{i.d(t,{bo:()=>r});var n=i(14144);let s={};const o=["user/launch","skill/recommend"],r=(e,t,i)=>{if(o.some((t=>e.includes(t)))&&0===(null==i?void 0:i.code))try{const n=JSON.stringify(t||{});s[e]={token:n,data:i}}catch(r){(0,n.Rm)("http set cache error",r)}}},23754:(e,t,i)=>{i.d(t,{AT:()=>p});var n=i(44557),s=i(14065),o=i(39044),r=i(12201),a=i(65952),l=i(32163),c=i(72070),d=i(74901),u=i(71291);class h extends Error{constructor(e,t){super(`ServerError, code: ${e}, msg:${t}`),this.code=e}}class v extends Error{constructor(e,t){super(`ClientError, code: ${e}, msg:${t}`),this.code=e}}const m=function(){var e=(0,s.A)((function*(e,t){var i,s;const{url:l,method:c,data:d,params:h,headers:v}=e,m=yield fetch((0,a.ID)(l,(0,n.A)((0,n.A)({},(0,u.wH)()),h)),{method:c,body:JSON.stringify(d),headers:(0,n.A)((0,n.A)({},(0,u.Ql)()),{},{"Content-Type":"application/json"},v)}),p=null===(i=m.headers)||void 0===i||null===(s=i.get)||void 0===s?void 0:s.call(i,"x-tt-logid");if(!m.ok)throw(0,r.v)({type:"http-request",payload:{config:e,response:{statusText:m.statusText},logId:p}}),new Error(m.statusText);const g=yield m.json();return(0,r.v)({type:"http-request",payload:{config:e,response:g,logId:p}}),(0,o.bo)(l,h,g),(0,n.A)((0,n.A)({},g),{},{logId:p})}));return function(t,i){return e.apply(this,arguments)}}(),p=function(){var e=(0,s.A)((function*(...e){if(!navigator.onLine)throw new v(l.Y.NetworkError,"network error");const{code:t,msg:i,data:s,logId:o}=yield m(...e);var r;if(void 0!==t&&0!==t)throw d.F8.sendEvent((0,n.A)({name:"response_server_code_invalid"},(0,c.i)({url:null===(r=e[0])||void 0===r?void 0:r.url,msg:i,code:`${t}`,statusCode:200,isSse:!1,logId:o}))),new h(t,i);return s}));return function(){return e.apply(this,arguments)}}()},87667:(e,t,i)=>{i.d(t,{S:()=>r});var n=i(14065),s=i(57921),o=i(27547);function r(){return a.apply(this,arguments)}function a(){return(a=(0,n.A)((function*(){try{yield(0,s.Uv)()}catch(e){console.error("initCollectionUserSetting error",e)}(0,o.QH)()}))).apply(this,arguments)}},33557:(e,t,i)=>{i.d(t,{q:()=>r});var n=i(14065),s=i(38062),o=i(42402);function r(e){return a.apply(this,arguments)}function a(){return a=(0,n.A)((function*(e){return(/doubao/.test(location.hostname)||/ciciai/.test(location.hostname))&&location.pathname.startsWith("/browser-extension/welcome")?function(e){return l.apply(this,arguments)}(e):(0,s.Tp)(e)})),a.apply(this,arguments)}function l(){return(l=(0,n.A)((function*(e){const t=(0,s.Tp)(e),i=document.querySelector("[class^=welcomeCard]");if(i&&t){const{width:e,height:n}=i.getBoundingClientRect(),s=yield(0,o.dp)(i);t.content=(0,o.NS)(s.innerHTML,n,e)}return t}))).apply(this,arguments)}},95514:(e,t,i)=>{i.d(t,{E:()=>o});var n=i(14065),s=i(10633);class o{constructor(e){var t=this;(0,s.A)(this,"macrotaskQueue",[]),(0,s.A)(this,"onFinished",void 0),(0,s.A)(this,"pushTask",(e=>{this.macrotaskQueue.push(e)})),(0,s.A)(this,"loop",(()=>{this.macrotaskQueue.length?setTimeout((0,n.A)((function*(){const e=t.macrotaskQueue.pop();e&&(yield e(),t.loop())})),0):this.onFinished()})),this.onFinished=e}}},9741:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(30510),s=i(3690),o=i(97946),r=i(94282),a=i(52335);const l=()=>a.l.getState().isSidePanelMode&&!o._.isInSidePanel?new Promise((e=>{s.A.once("chat-page-ready",(t=>e(t))),(0,n.cs)("check-page-ready",6e4).then((t=>{null!=t&&t.success&&e(t.data)}))})):new Promise((e=>{if(r.on.getState().chatPageReady)e(!0);else{const t=r.on.subscribe((e=>e.chatPageReady),(i=>{i&&(e(!0),t())}))}}))},3690:(e,t,i)=>{i.d(t,{A:()=>n});const n=new(i(60588).b)},7728:(e,t,i)=>{i.d(t,{B:()=>m});var n=i(10633),s=i(60588),o=i(60779),r=i(45319),a=i(14144);const l=e=>`on-open-${e}`,c=e=>`on-update-${e}`,d=e=>`on-done-${e}`,u=e=>`on-error-${e}`,h=e=>`on-abort-${e}`,v=e=>`on-close-${e}`;const m=new class{constructor(){(0,n.A)(this,"eventEmitter",new s.b),(0,n.A)(this,"messageCommunication",void 0),(0,n.A)(this,"abort",((e,t)=>{var i;(0,a.Rm)("[zoei] FetchStreamProxy.abort",e,t),null===(i=this.messageCommunication)||void 0===i||i.postMessage({body:{id:e,type:"abort",reason:t}}),this.removeListeners(e)})),(0,n.A)(this,"handleMessage",(e=>{var t;const i=(null===(t=this.messageCommunication)||void 0===t?void 0:t.formatMessage(e))||{},{id:n,event:s}=i;switch(s){case"open":return void this.eventEmitter.emit(l(n),i);case"data":return void this.eventEmitter.emit(c(n),i);case"done":return this.eventEmitter.emit(d(n),i),void this.removeListeners(n);case"error":return this.eventEmitter.emit(u(n),i),void this.removeListeners(n);case"abort":return this.eventEmitter.emit(h(n),i),void this.removeListeners(n);case"close":return this.eventEmitter.emit(v(n),i),void this.removeListeners(n)}})),this.messageCommunication=(0,o.A)("fetch-stream"),this.messageCommunication.onMessage.addListener(this.handleMessage)}fetch(e,t){var i;const{id:n=(0,r.AP)(),onOpen:s,onUpdate:o,onDone:m,onError:p,onAbort:g,onClose:f}=t;return(0,a.Rm)("[zoei] FetchStreamProxy.fetch",{id:n,payload:e}),null===(i=this.messageCommunication)||void 0===i||i.postMessage({body:{id:n,type:"fetch",payload:e}}),s&&this.eventEmitter.addListener(l(n),s),o&&this.eventEmitter.addListener(c(n),o),m&&this.eventEmitter.addListener(d(n),m),p&&this.eventEmitter.addListener(u(n),p),g&&this.eventEmitter.addListener(h(n),g),f&&this.eventEmitter.addListener(v(n),f),n}removeListeners(e){this.eventEmitter.removeAllListeners(l(e)),this.eventEmitter.removeAllListeners(c(e)),this.eventEmitter.removeAllListeners(d(e)),this.eventEmitter.removeAllListeners(u(e)),this.eventEmitter.removeAllListeners(h(e))}}},57921:(e,t,i)=>{i.d(t,{Uv:()=>c,ku:()=>l});var n=i(44557),s=i(14065),o=i(57512),r=i(45110),a=i(25508);const l=()=>{var e;return null===(e=(0,o.TK)("tccConfig"))||void 0===e||null===(e=e["collection-config"])||void 0===e?void 0:e.showEntry};function c(){return d.apply(this,arguments)}function d(){return d=(0,s.A)((function*(){var e;const t=yield function(){return u.apply(this,arguments)}(),i="enable"===(null==t||null===(e=t.ab_config.ab_results)||void 0===e?void 0:e.extension_collection_entry),s=(0,o.TK)("tccConfig");(0,o.vE)("tccConfig",(0,n.A)((0,n.A)({},s||{}),{},{"collection-config":(0,n.A)((0,n.A)({},(null==s?void 0:s["collection-config"])||{}),{},{showEntry:i})}))})),d.apply(this,arguments)}function u(){return(u=(0,s.A)((function*(){return yield(0,r.S6)({method:"POST",url:`${a.kD}/user/setting/get`,data:{ab_param:{ab_request:{extension_collection_entry:{parmas:["collection_ability","show_entry"],is_login:!0}}}}})}))).apply(this,arguments)}},71834:(e,t,i)=>{i.d(t,{A:()=>o});var n=i(11855),s=i(8506);const o=(e,t=!1)=>{const i=(0,n.useRef)(null),o=t=>{const n=t.composedPath&&t.composedPath();n&&!n.includes(i.current)&&e()},r=t=>{(0,s.LE)(t.target.id)||e()};return(0,n.useEffect)((()=>(document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)})),[]),(0,n.useEffect)((()=>{if(t)return document.addEventListener("touchstart",r),()=>{document.removeEventListener("touchstart",r)}}),[t]),i}},89996:(e,t,i)=>{i.d(t,{r:()=>l});var n=i(14065),s=i(20716),o=i(11855),r=i(67593),a=i(43523);const l=(e,t)=>{const i="object"==typeof e,l=i?e.key:e,[c,d]=(0,o.useState)(t),u=(0,o.useRef)(!1),h=(0,o.useRef)(t instanceof Function?t():t);(0,o.useEffect)((()=>{h.current=c}),[c]);const v=(0,o.useRef)(i?e.instance:new r.w({area:a.q})),m=(0,o.useCallback)((e=>v.current.set(l,void 0!==e?e:h.current)),[l]),p=(0,o.useCallback)(function(){var e=(0,n.A)((function*(e){const t=e instanceof Function?e(h.current):e;yield m(t),u.current&&d(t)}));return function(t){return e.apply(this,arguments)}}(),[m]);(0,o.useEffect)((()=>{var e;u.current=!0;const i={[l]:e=>{u.current&&d(e.newValue)}};return v.current.watch(i),null===(e=v.current.get(l))||void 0===e||e.then((e=>{if(t instanceof Function){const i=null==t?void 0:t(e,!0);void 0!==i&&p(i)}else(0,s.A)(e,t)||d(void 0!==e?e:t)})),()=>{u.current=!1,v.current.unwatch(i),t instanceof Function&&d(t)}}),[l,p]);const g=(0,o.useCallback)((()=>{v.current.remove(l),d(void 0)}),[l]);return[c,p,{setRenderValue:d,setStoreValue:m,remove:g}]}},67122:(e,t,i)=>{i.d(t,{A:()=>u});var n=i(44557),s=i(10633),o=i(73572),r=i(76917),a=i(35580),l=i(74215),c=i(30510);class d extends o.A{constructor(e,t){super(e,t),(0,s.A)(this,"injectTabIds",void 0),(0,s.A)(this,"removeTabId",(e=>{var t;this.injectTabIds.has(e)&&(clearTimeout(null===(t=this.injectTabIds.get(e))||void 0===t?void 0:t.timer),this.injectTabIds.delete(e))})),(0,s.A)(this,"clearTimeId",(e=>{var t;void 0!==e&&this.injectTabIds.has(e)&&(clearTimeout(null===(t=this.injectTabIds.get(e))||void 0===t?void 0:t.timer),this.injectTabIds.set(e,(0,n.A)((0,n.A)({},this.injectTabIds.get(e)),{},{timer:null,active:!1})))})),(0,s.A)(this,"clearAllTimers",(()=>{this.injectTabIds.forEach(((e,t)=>{clearTimeout(null==e?void 0:e.timer),this.injectTabIds.set(t,(0,n.A)((0,n.A)({},e),{},{timer:null,active:!1}))}))})),(0,s.A)(this,"start",(()=>{try{this.clearAllTimers();const e=this;chrome.tabs.query({active:!0},(t=>{t.forEach((t=>{null!=t&&t.id&&this.injectTabIds.has(null==t?void 0:t.id)&&e.sendHeartBeat(t,0)}))}))}catch(e){console.log(e)}})),(0,s.A)(this,"sendHeartBeat",((e,t=0)=>{let i=t;if(null!=e&&e.id&&this.injectTabIds.has(null==e?void 0:e.id)){var n;this.clearTimeId(null==e?void 0:e.id),Number(new Date)-((null===(n=this.injectTabIds.get(null==e?void 0:e.id))||void 0===n?void 0:n.lastTimestamp)||Number(new Date))>8e3&&(this.updateActiveTime(null==e?void 0:e.id),i++),this.crashLog&&console.log("HEARTBEAT_ALIVE_TAB~~~~~~~~~~~",null==e?void 0:e.id),this.crashLog&&console.log(this.injectTabIds);try{var s;(0,c.UL)({tabId:null==e?void 0:e.id,name:"crash-monitor-message",body:{type:a.lh.HEARTBEAT,tabId:null==e?void 0:e.id}}).then((e=>{if(e.success){const{type:t,tabId:i}=e.data||{};t===a.lh.HEARTBEAT_RESPONSE&&this.updateActiveTime(i),t===a.lh.HEARTBEAT_STOP&&this.removeTabId(i)}})),this.injectTabIds.set(null==e?void 0:e.id,{timer:setTimeout((()=>{var t;i>=2?this.stopHeartBeatAndReport((null==e?void 0:e.id)||0):(this.crashLog&&console.log("curRetryCount:",i),void 0!==(null==e?void 0:e.id)&&null!==(t=this.injectTabIds.get(null==e?void 0:e.id))&&void 0!==t&&t.active&&this.sendHeartBeat(e,i))}),5e3),lastTimestamp:(null===(s=this.injectTabIds.get(null==e?void 0:e.id))||void 0===s?void 0:s.lastTimestamp)||Number(new Date),tabInfo:e,active:!0})}catch(o){console.log(o)}}})),(0,s.A)(this,"updateActiveTime",(e=>{void 0!==e&&this.injectTabIds.has(e)&&this.injectTabIds.set(e,(0,n.A)((0,n.A)({},this.injectTabIds.get(e)),{},{lastTimestamp:Number(new Date),active:!0}))})),(0,s.A)(this,"stopHeartBeatAndReport",(e=>{var t,i,n,s,o;this.crashLog&&console.log(">>>>>>>>>>>>crash>>>>>>>>>>>>>>>>",null===(t=this.injectTabIds.get(e))||void 0===t?void 0:t.tabInfo),this.category=r.w.PAGE_CRASH,this.msg=`${(null===(i=this.injectTabIds.get(e))||void 0===i||null===(i=i.tabInfo)||void 0===i?void 0:i.title)||""}\u53d1\u751fcrash\uff0c\u9875\u9762\u72b6\u6001\u4e3a${(null===(n=this.injectTabIds.get(e))||void 0===n||null===(n=n.tabInfo)||void 0===n?void 0:n.status)||""}`,this.pageUrl=(null===(s=this.injectTabIds.get(e))||void 0===s||null===(s=s.tabInfo)||void 0===s?void 0:s.url)||"",this.recordError({name:r.w.PAGE_CRASH}),clearTimeout(null===(o=this.injectTabIds.get(e))||void 0===o?void 0:o.timer),this.injectTabIds.delete(e)})),this.injectTabIds=new Map,this.initListeners()}initListeners(){var e;const t=this,i={name:"crash-monitor-message",handle:(e,i)=>{var n,s,o,r,l,c,d;if(null!=e&&e.crashMonitorInject&&null!=i&&null!==(n=i.tab)&&void 0!==n&&n.id)return t.removeTabId(null==i||null===(s=i.tab)||void 0===s?void 0:s.id),t.injectTabIds.set(null===(o=i.tab)||void 0===o?void 0:o.id,null),t.crashLog&&console.log("injectTabIds: ",t.injectTabIds),t.start(),!0;(null==e?void 0:e.type)===a.lh.PAGE_VISIBILITY_FALSE&&(t.crashLog&&console.log("PAGE_VISIBILITY_FALSE: ",null===(r=i.tab)||void 0===r?void 0:r.id),t.clearTimeId(null==i||null===(l=i.tab)||void 0===l?void 0:l.id));(null==e?void 0:e.type)===a.lh.PAGE_VISIBILITY_TRUE&&(t.crashLog&&console.log("PAGE_VISIBILITY_TRUE: ",null===(c=i.tab)||void 0===c?void 0:c.id),t.updateActiveTime(null==i||null===(d=i.tab)||void 0===d?void 0:d.id),t.start())}};(0,l.c)(i),null===(e=chrome.tabs)||void 0===e||e.onActivated.addListener((e=>{t.crashLog&&console.log("currentActiveTabId:  ",null==e?void 0:e.tabId),t.updateActiveTime(null==e?void 0:e.tabId),t.start()})),chrome.tabs.onRemoved.addListener((e=>{t.removeTabId(e)}))}}const u=d},76129:(e,t,i)=>{i.d(t,{A:()=>a});var n=i(10633),s=i(73572),o=i(76917);class r extends s.A{constructor(e){super(e.region),(0,n.A)(this,"rule",void 0),this.run(),this.rule=e.rule}run(){const e=self,t=this,i=e.fetch;e.fetch=function(...e){return new Promise(((n,s)=>{var r;const a=[null==e||null===(r=e[0])||void 0===r?void 0:r.replace("#skipBGMonitor=true",""),...null==e?void 0:e.slice(1)];i.apply(this,a).then((e=>{var i;const s=e.headers.get("x-tt-logid");t.msg=`Network error ${null==e?void 0:e.status}`,t.url=e.url||"",t.statusCode=(null==e?void 0:e.status)||0,t.logId=s||"",/^2\d{2}$/.test(null==e||null===(i=e.status)||void 0===i?void 0:i.toString())||t.recordError({name:o.w.FETCH_ERROR}),n(e)})).catch((e=>s(e)))}))}}}const a=r},19425:(e,t,i)=>{i.d(t,{A:()=>o});var n=i(73572),s=i(76917);class o extends n.A{constructor(e){super(e),this.run()}run(){self.onerror=(e,t,i,n,o)=>{try{this.msg=JSON.stringify(e),this.url=t||"",this.line=i||0,this.col=n||0,this.errorName=(null==o?void 0:o.name)||"",this.stack=(null==o?void 0:o.stack)||"",this.recordError({name:s.w.JS_ERROR})}catch(o){console.log("js\u9519\u8bef\u5f02\u5e38",o)}}}destroy(){self.onerror=null}}},68008:(e,t,i)=>{i.d(t,{A:()=>a});var n=i(10633),s=i(73572),o=i(76917);class r extends s.A{constructor(e){super(e),(0,n.A)(this,"handleError",(e=>{try{var t,i,n,s;if(null==e||!e.reason)return;const r=(null==e?void 0:e.fileName)||"unknown",a=0,l=`${null==e||null===(t=e.reason)||void 0===t?void 0:t.message}\n   at ? (${r}:${a})`,c=(null==e||null===(i=e.reason)||void 0===i?void 0:i.stack)||l,d="string"==typeof(null==e?void 0:e.reason)?null==e?void 0:e.reason:null!==(n=JSON.stringify(null==e?void 0:e.reason))&&void 0!==n?n:"Unspecified reason";null!==(s=e.reason.config)&&void 0!==s&&s.url&&(this.url=e.reason.config.url),this.stack=c,this.msg=d,this.recordError({name:o.w.PROMISE_ERROR})}catch(r){console.log(r)}})),this.run()}run(){self.addEventListener("unhandledrejection",this.handleError,!0)}destroy(){self.removeEventListener("unhandledrejection",this.handleError)}}const a=r},22419:(e,t,i)=>{i.d(t,{sN:()=>c});var n=i(3127),s=i(25508),o=i(14144);let r=null;const a=new n.qK(100);globalThis.__perfCache=a;const l=new PerformanceObserver((function(e,t){e.getEntries().forEach((e=>{if("resource"===e.entryType){const t=(e=>{try{const t=new URL(e);return!!t.origin.includes(s.FI)&&`${t.origin}${t.pathname}`}catch(t){return!1}})(e.name);if(t){(0,o.Rm)("[Daniel] PerformanceObserver",`${t} duration: ${e.duration}`,e);const{startTime:i,domainLookupStart:n,domainLookupEnd:s,connectStart:l,connectEnd:c,requestStart:d,responseStart:u,responseEnd:h,transferSize:v,encodedBodySize:m,duration:p}=e;r?r.sendEvent({name:"api_timing",metrics:{startTime:i,domainLookupStart:n,domainLookupEnd:s,connectStart:l,connectEnd:c,requestStart:d,responseStart:u,responseEnd:h,transferSize:v,encodedBodySize:m,duration:p},categories:{url:t}}):(0,o.z3)("[lwx] BgSlardar not set!!"),a.set(`${Date.now()} - ${t}`,{"server-origin":performance.timeOrigin,"server-duration":p,"server-startTime":i,"server-transferSize":v,"server-requestStart":d,"server-responseStart":u,"server-responseEnd":h,"server-encodedBodySize":m})}}}))})),c=e=>{r=e,l.observe({entryTypes:["resource"]})}},24686:(e,t,i)=>{i.d(t,{m:()=>r});var n=i(14065),s=i(37462);const o=function(){var e=(0,n.A)((function*(e,t){const{url:i,data:n,success:o=s.A,fail:r=s.A}=t,a={method:e,headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"};n&&(a.body=n);try{const e=yield fetch(i,a),t=yield e.json();if(!e.ok)throw Error(t);o(t)}catch(l){r(l)}}));return function(t,i){return e.apply(this,arguments)}}(),r=()=>"function"==typeof fetch?{get(e){o("GET",e)},post(e){o("POST",e)}}:{get:s.A,post:s.A}},38062:(e,t,i)=>{i.d(t,{B9:()=>c,Tp:()=>l});var n=i(89586);const s=10485760;class o extends Error{constructor(e,t){super(`readability: ${e}`,t)}}const r=new RegExp("^https?:\\/\\/www\\.zhihu\\.com\\/question\\/\\d+");const a={charThreshold:500,keepClasses:!1};function l(e){const t=(e=e||document).cloneNode(!0);r.test(location.href)&&(n.Readability.prototype.REGEXPS.negative=/-ad-|^kfecollection-viprecommendcard$|hidden|^hid$| hid$| hid |^hid |banner|combx|comment|com-|contact|foot|footer|footnote|gdpr|masthead|media|meta|outbrain|promo|related|scroll|share|shoutbox|sidebar|skyscraper|sponsor|shopping|tags|tool|widget/i);const i=new n.Readability(t,a).parse();if(i&&i.content.length>s)throw new o(`Content Length exceeds the limit of ${s} characters; ${i.content.length} found`);return i}function c(){return new Promise(((e,t)=>{const i=document,n=()=>{try{const t=l(i);e(t)}catch(n){t(n)}};"complete"===i.readyState||"interactive"===i.readyState?n():document.addEventListener("DOMContentLoaded",(e=>{n()}))}))}},99792:(e,t,i)=>{i.d(t,{A:()=>y});var n=i(85335),s=i(11855),o=i(29019),r=i.n(o),a=i(30949),l=i(34944),c=i(82574),d=i(25508),u=i(93507),h=i(55742),v=i(474),m=i(10592),p=i(52335),g=i(94314),f=i(71834),_=i(82741);const b={area:"area-AdxVTy",info:"info-zicQ8s",link:"link-URSKaa",dropdown:"dropdown-fl_iip"};var A=i(63159);function y(e){const{position:t="bottomRight",disableKey:i=u.lf.selectAssistant,className:o,show:y,setShow:x,cssStyle:w={},closeClick:E,renderChildren:I,spacing:k=4}=e,T=r()(b.disableModal,o),S=(0,f.A)((()=>{null==x||x(!1)})),C=(0,a.B)(),L=(0,m.t_)((e=>e.setBarVisible)),{setIsShowSidebarBtn:j,setIsShowSearch:N,setIsShowQuick:M}=(0,p.l)(),[,R]=(0,_.Y)(d.zs[i].global),[P,B]=(0,_.Y)(d.zs[i].page),O=e=>{e.preventDefault(),e.stopPropagation(),null==x||x(!0),null==E||E()};return(0,s.useEffect)((()=>{y&&(0,h.Bq)(i)}),[y]),(0,A.jsx)("div",{className:T,ref:S,style:w,children:(0,A.jsx)(l.ms,{trigger:"custom",visible:y,spacing:k,position:t,className:b.dropdown,getPopupContainer:()=>S.current,render:(0,A.jsx)("div",{onClick:e=>{e.preventDefault(),e.stopPropagation(),null==x||x(!0)},style:{overflow:"hidden"},children:(0,A.jsxs)(l.ms.Menu,{children:[d._E.map((e=>(0,A.jsx)(l.ms.Item,{onClick:()=>(e=>{if((0,h.jk)(e.key,i),"page"===e.key){const e=window.location.host;P.includes(e)||P.unshift(e),B([...P])}else"global"===e.key?R(!0):("quick"===i&&(M(!1),L(!1)),"search"===i&&N(!1),"sidebarButton"===i&&j(!1))})(e),className:b.dropItem,children:(0,A.jsx)("span",{className:b.name,children:C(e.name)})},e.id))),(0,A.jsx)("p",{className:b.info,children:(0,A.jsxs)(n.x,{i18nKey:"flow_web_ext_setting_reopen",children:["Reopen in",(0,A.jsx)("span",{className:b.link,onClick:()=>(0,g.I)({enter_method:v.cz.disableMenu}),children:"\xa0setting \xa0"})]})})]})}),children:I?I({onTriggerClick:O}):(0,A.jsx)("div",{className:b.area,onClick:O,children:(0,A.jsx)(c.gz,{className:b.icon})})})})}},53472:(e,t,i)=>{i.d(t,{t:()=>Z});var n=i(44557),s=i(11855),o=i(29019),r=i.n(o),a=i(34944),l=i(53713),c=i(30949),d=i(79474),u=i(82574),h=i(46350),v=i(474),m=i(27547),p=i(94314),g=i(57512),f=i(22315),_=i(7332),b=i(82741);const A="configBtnContainer-PyLLM0",y="isOpen-nUJVGv",x="configBtn-PHODxg",w="moreIconContainer-O4DZxj",E="name-rkPj8K",I="dropdownContainer-sjKguw",k="dropdownItem-hFsOSP";var T=i(63159);const S=e=>{var t;const{setMoreBtnVisible:i,handleClickBtn:o,setDisableMenuVisible:l,disableMenuVisible:S,moreActionList:C=[],isDemo:L=!1}=e,[j,N]=(0,s.useState)(!1),M=null===(t=(0,_.A)())||void 0===t?void 0:t.getPopupContainer,[R]=(0,b.Y)("isSelectbarMoreMenuClicked"),P=(0,c.B)(),B=(0,s.useCallback)((()=>{N(!j),l(!1),(0,g.vE)("isSelectbarMoreMenuClicked",!0)}),[j]),O=(0,s.useCallback)(((e,t={})=>{(0,h.Bp)({button_name:e,click_from:v.Z5.selectAssistantMoreMenu}),(0,p.I)((0,n.A)((0,n.A)({},t),{},{enter_method:v.cz.selectAssistantMenu,settting_key:"toolbar-configuration"}))}),[]),z=(0,s.useMemo)((()=>[{title:P("flow_web_ext_setting_toolbar_discover"),icon:(0,T.jsx)(d.k4K,{}),btnName:v.Yd.discoverSkill,handleClick:()=>O(v.Yd.discoverSkill,{discover_skill:"true"})},{title:P("flow_web_ext_setting_toolbar_addskill"),icon:(0,T.jsx)(d.lUW,{}),btnName:v.Yd.addASkill,handleClick:()=>O(v.Yd.addASkill,{add_prompt:"true"})},{title:P("flow_web_ext_action_settings"),icon:(0,T.jsx)(d.ZKw,{}),btnName:v.Yd.setting,handleClick:()=>O(v.Yd.setting)}]),[P]);return(0,s.useEffect)((()=>{if(!j)return;C.forEach((e=>{(0,h.ih)({button_name:e.id,show_from:v.Z5.selectAssistantMoreMenu})})),z.forEach((e=>{(0,h.ih)({button_name:e.btnName,show_from:v.Z5.selectAssistantMoreMenu})}));C.find((e=>e.id===f.EU.collect))&&(0,m.ae)(m.vP.highlight_function_bar,m.p6.textfragment)}),[j,C]),(0,s.useEffect)((()=>{S&&N(!1)}),[S]),(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(a.ms,{clickToHide:!0,visible:j,trigger:"custom",getPopupContainer:M,spacing:6,position:"bottomRight",onClickOutSide:()=>N(!1),className:I,render:(0,T.jsxs)("div",{onMouseEnter:()=>{i(!1)},onPointerUp:()=>{i(!1),N(!1)},style:{padding:4},children:[C.length>0&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(a.ms.Menu,{style:{padding:0},children:C.map((e=>{return t=e,(0,T.jsxs)(a.ms.Item,{onClick:e=>o(t,e),"data-testid":`select-bar-more-${t.id}-action`,className:k,children:[(0,T.jsx)("div",{className:w,children:(0,u.I)(t.icon)}),(0,T.jsx)("span",{className:E,children:P(t.name,t.options)})]},t.id);var t}))}),(0,T.jsx)("div",{style:{paddingLeft:10,paddingRight:10},children:(0,T.jsx)(a.cG,{margin:5})})]}),(0,T.jsx)(a.ms.Menu,{style:{padding:0},children:z.map((e=>(0,T.jsxs)(a.ms.Item,{onClick:e.handleClick,className:k,children:[(0,T.jsx)("div",{className:w,children:e.icon}),(0,T.jsx)("span",{className:E,children:e.title})]},e.title)))})]}),children:(0,T.jsx)("div",{className:r()(A,{[y]:j}),children:(0,T.jsx)("button",{type:"button",className:x,onPointerUp:B,"data-testid":"select-bar-more-action",children:L||j||R?(0,T.jsx)(d.HXh,{}):(0,T.jsx)(a.Ex,{dot:!0,type:"danger",children:(0,T.jsx)(d.HXh,{})})})})})})};var C=i(99792),L=i(45319),j=i(93507),N=i(74375),M=i(57921);const R="container_mac-Zkbzgm",P="container-XWDV0F",B="action-container-IZGz9g",O="actions-CriGMt",z="btnArea-SqnOyh",$="btn_area_mac-uQsFYd",D="icon-edhNJn",U="name-VSTPWY",V="isCustomSkill-YLTik2",F="extra-nu7DvO",q="closeBtnContainer-DOn6ux",H="closeBtn-yuxJN3",Y="closeBtnVisible-YjzwHn",K="closeBtnActive-Lc6OPB",W=(0,l.jco)();function G(e){var t;const{selectBarOnlyIcon:i,availableActionList:n,moreActionList:o=[],isDemo:l}=e,d=(0,c.B)(),[p,g]=(0,s.useState)(!1),[b,A]=(0,s.useState)(!1),y=null===(t=(0,_.A)())||void 0===t?void 0:t.getPopupContainer;(0,s.useEffect)((()=>{n.forEach((e=>{(0,h.ih)({button_name:e.id,show_from:v.Z5.selectAssistantMenu})}))}),[n]);const x=(0,L.kW)(),w=(e,t,i=!1)=>{e.id===f.EU.ask&&(t.preventDefault(),t.stopPropagation()),(0,N.qZ)(e.id,i?v.Z5.selectAssistantMoreMenu:v.Z5.selectAssistantMenu,"sidebar"===e.displayMode)},E=e=>{e.preventDefault(),e.stopPropagation()},I=p||x||W,k=(0,s.useCallback)(((e,t)=>w(e,t,!0)),[]);(0,s.useEffect)((()=>{n.find((e=>e.id===f.EU.collect))&&(0,M.ku)()&&(0,m.ae)(m.vP.highlight_function_bar,m.p6.textfragment)}),[]);return(0,T.jsx)("div",{className:W?R:P,"data-testid":"select-bar-container",children:(0,T.jsxs)("div",{onMouseDown:E,className:B,children:[(0,T.jsx)("div",{className:O,children:n.map((e=>(e=>{const t=(0,f.em)(e.id),n=(0,T.jsxs)("button",{type:"button",className:r()(z,{[$]:W}),onPointerUp:t=>w(e,t),"data-testid":`select-bar-${e.id}-action`,children:[(0,T.jsx)("div",{className:D,children:(0,u.I)(e.icon)}),!i&&(0,T.jsx)("span",{className:r()(U,{[V]:t}),children:d(e.name,e.options)})]});return(0,T.jsx)("div",{children:i?(0,T.jsx)(a.m_,{content:W?void 0:d(e.name),spacing:16,getPopupContainer:y,children:n}):n},e.id)})(e)))}),(0,T.jsx)(a.cG,{margin:2,layout:"vertical",style:{height:12}}),(0,T.jsxs)("div",{className:F,onMouseEnter:()=>{g(!0)},onMouseLeave:()=>{b||g(!1)},children:[(0,T.jsx)(S,{setMoreBtnVisible:g,handleClickBtn:k,disableMenuVisible:b,setDisableMenuVisible:A,moreActionList:o,isDemo:l}),(0,T.jsx)(C.A,{cssStyle:{position:"relative",height:"100%"},position:"bottomRight",spacing:0,disableKey:j.lf.selectAssistant,show:b,setShow:A,renderChildren:({onTriggerClick:e})=>(0,T.jsx)("div",{className:q,children:(0,T.jsx)(u.gz,{className:r()(H,{[Y]:I,[K]:b}),onClick:t=>{b?A(!b):e(t)}})})})]})]})})}var J=i(47421),Q=i(66956);const X=e=>{const{selectBarOnlyIcon:t,availableActionList:i,moreActionList:n,isAliginLeft:o,isDemo:a}=e,l=(0,s.useRef)(null);return(0,s.useEffect)((()=>{if(l.current&&o){const e=l.current.getBoundingClientRect(),{parentElement:t}=l.current;let{width:i}=e;if(t){t.style.height=`${e.height}px`,t.style.width=`${e.width}px`;const{width:n}=t.getBoundingClientRect();i-=n}l.current.style.left=`-${i/2}px`}}),[i]),(0,T.jsx)("div",{className:r()({[Q.A.isContentAliginLeft]:o}),children:(0,T.jsx)("div",{className:r()(Q.A.contentContainer),ref:l,children:(0,T.jsx)(G,{selectBarOnlyIcon:t,availableActionList:i,moreActionList:n,isDemo:a})})})},Z=e=>{var t;const i=null===(t=(0,s.useContext)(J.A))||void 0===t?void 0:t.getPopupContainer,{children:o,visible:r,rePosKey:l,autoAdjustOverflow:c,style:d={},selectBarOnlyIcon:u,availableActionList:h,moreActionList:v=[],position:m="top",isAliginLeft:p,getPopupContainer:g=i,isDemo:f}=e;return(0,T.jsx)(a.AM,{position:m,showArrow:!1,content:(0,T.jsx)(X,{selectBarOnlyIcon:u,availableActionList:h,moreActionList:v,isAliginLeft:p,isDemo:f}),trigger:"custom",visible:r,getPopupContainer:g,style:(0,n.A)((0,n.A)({},{boxShadow:"none",padding:"0",backgroundColor:"transparent"}),d),rePosKey:l,autoAdjustOverflow:c,children:o})}},21589:(e,t,i)=>{i.d(t,{F:()=>n});const n=!1},71967:(e,t,i)=>{i.d(t,{K:()=>d});var n=i(14065),s=i(24323),o=i.n(s),r=i(46487),a=i(23718),l=i(57512),c=i(33557);function d(e,t){return u.apply(this,arguments)}function u(){return(u=(0,n.A)((function*(e,t){var i;const n=null!==(i=(0,r.wz)((0,l.TK)("uiLanguage")))&&void 0!==i?i:navigator.language,s=`${e}_${location.href}_${n}_`;let d="";try{var u;if(e===a.e.Web)d=void 0!==t?t:(null===(u=yield(0,c.q)(document))||void 0===u?void 0:u.textContent)||""}catch(h){console.error("calc business str error ",h)}return o()(s+d)}))).apply(this,arguments)}},6430:(e,t,i)=>{i.d(t,{e:()=>l});var n=i(44557),s=i(34870),o=i(45498),r=i(73648);const a={videoId:"",title:"",partId:"0",highlightExploreCount:1,isLoadingDone:!1},l=(0,o.vt)()((0,s.eh)((e=>(0,n.A)((0,n.A)({},a),{},{setVideoId:t=>e((()=>({videoId:t}))),setVideoTitle:t=>e((()=>({title:t}))),setVideoPartId:t=>e((()=>({partId:t}))),setHighlightExploreCount:()=>e((e=>({highlightExploreCount:e.highlightExploreCount+1}))),setIsLoadingDone:t=>e((()=>({isLoadingDone:t})))}))));r.m.getInstance().registerStore("useVideoSummaryAssistantStore",l)},27547:(e,t,i)=>{i.d(t,{QH:()=>p,ae:()=>u,mL:()=>v,o2:()=>h,p6:()=>l,vP:()=>a});var n=i(47113),s=i(474),o=i(73648),r=i(57921);let a=function(e){return e.arxiv_view_pdf="arxiv_view_pdf",e.chrome_pdf_viewer="chrome_pdf_viewer",e.side_bar_popover="side_bar_popover",e.search_result_card="search_result_card",e.video_page_summarize="video_page_summarize",e.highlight_result_card_translate="highlight_result_card_translate",e.highlight_result_card_explain="highlight_result_card_explain",e.highlight_function_bar="highlight_function_bar",e.right_click="right_click",e.collect_this_page="collect_this_page",e.webimage_collect="webimage_collect",e}({}),l=function(e){return e.videosummary="videosummary",e.searchresult="searchresult",e.textfragment="textfragment",e.TranslateResult="TranslateResult",e.ExplainResult="ExplainResult",e.web="web",e.pdf="pdf",e}({});function c(e=location.hostname){return e}function d(){let e=(0,n.M5)(location.href);return e.startsWith("search_engine_")&&(e="search_engine"),e}function u(e,t){(0,n.z8)(s.Ur.collectionButtonShow,{show_from:e,current_page:d(),collect_type:t,collect_from_site:c()})}function h(e,t){(0,n.z8)(s.Ur.collectionButtonClickSave,{click_from:e,collect_type:t,current_page:d(),collect_from_site:c()})}function v(e,t,i,o){(0,n.z8)(s.Ur.collectionButtonClickSaveStatus,{click_from:e,current_page:d(),collect_from_site:c(),success:t,collect_type:i,collect_id:o})}function m(){if(!(0,r.ku)())return;const e=window.getSelection();(null==e?void 0:e.toString().trim())?u(a.right_click,l.textfragment):u(a.collect_this_page,l.web)}function p(){document.addEventListener("contextmenu",m),(0,o.A)((()=>{document.removeEventListener("contextmenu",m)}))}},51809:(e,t,i)=>{i.d(t,{X:()=>n});const n=i(23718).e},32163:(e,t,i)=>{i.d(t,{Y:()=>n});let n=function(e){return e[e.NetworkError=-1e3]="NetworkError",e}({})},45319:(e,t,i)=>{i.d(t,{AP:()=>l,XQ:()=>d,YJ:()=>u,kW:()=>c});var n=i(14065),s=i(77793),o=i(46487),r=i(57512),a=i(43523);"undefined"!=typeof window?window:self;performance.timeOrigin.toString(36);const l=()=>(0,s.A)(),c=()=>{const{userAgent:e}=navigator;return!!/Windows/.test(e)};function d(e="en"){var t;return null!==(t=(0,o.wz)((0,r.TK)("uiLanguage")).replace(/-.*$/,""))&&void 0!==t?t:e}const u=function(){var e=(0,n.A)((function*(){const e=yield a.A.get("uuid");if(e)return e;const t=(()=>{const e=Math.floor(1e8+9e8*Math.random()),t=Math.floor(1e8+9e8*Math.random());return String(e)+String(t)})();return a.A.set("uuid",t),t}));return function(){return e.apply(this,arguments)}}()},12487:(e,t,i)=>{i.d(t,{r:()=>o});var n=i(51187),s=i(62277);function o(e,t="image"){return(0,s.ab)(),new Promise(((i,s)=>{try{const o=n.ozw.getState(),{local_key:r}=o.preprocessFile(e,t);n.ozw.subscribe((e=>e.preprocessTaskMap[r]),(e=>{null!=e&&e.failed?s(new Error("upload file faild")):null!=e&&e.key&&i(e.key)}))}catch(o){console.error("upload image failed",o),s(o)}}))}},3127:(e,t,i)=>{i.d(t,{qK:()=>r});var n=i(10633);let s=function(e){return e[e.None=0]="None",e[e.AsOld=1]="AsOld",e[e.AsNew=2]="AsNew",e}({});class o{constructor(){(0,n.A)(this,"_map",void 0),(0,n.A)(this,"_head",void 0),(0,n.A)(this,"_tail",void 0),(0,n.A)(this,"_size",void 0),this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return null===(e=this._head)||void 0===e?void 0:e.value}get last(){var e;return null===(e=this._tail)||void 0===e?void 0:e.value}has(e){return this._map.has(e)}get(e,t=s.None){const i=this._map.get(e);if(i)return t!==s.None&&this.touch(i,t),i.value}set(e,t,i=s.None){let n=this._map.get(e);if(n)n.value=t,i!==s.None&&this.touch(n,i);else{switch(n={key:e,value:t,next:void 0,previous:void 0},i){case s.None:this.addItemLast(n);break;case s.AsOld:this.addItemFirst(n);break;case s.AsNew:default:this.addItemLast(n)}this._map.set(e,n),this._size++}}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let i=this._head;for(;i;)t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),i=i.next}forEachLast(e,t){let i=this._tail;for(;i;)t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),i=i.previous}findLast(e){let t=this._tail;for(;t;){if(e(t.value,t.key,this))return t;t=t.previous}}find(e){let t=this._head;for(;t;){if(e(t.value,t.key,this))return t;t=t.next}}values(){const e=[];let t=this._head;for(;t;)e.push(t.value),t=t.next;return e}keys(){const e=[];let t=this._head;for(;t;)e.push(t.key),t=t.next;return e}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0)}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const{next:t}=e,{previous:i}=e;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===s.AsOld||t===s.AsNew)if(t===s.AsOld){if(e===this._head)return;const{next:t}=e,{previous:i}=e;e===this._tail?(i.next=void 0,this._tail=i):(t.previous=i,i.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e}else if(t===s.AsNew){if(e===this._tail)return;const{next:t}=e,{previous:i}=e;e===this._head?(t.previous=void 0,this._head=t):(t.previous=i,i.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e}}toJSON(){const e=[];return this.forEach(((t,i)=>{e.push([i,t])})),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}class r extends o{constructor(e,t=1){super(),(0,n.A)(this,"_limit",void 0),(0,n.A)(this,"_ratio",void 0),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e){return super.get(e,s.AsNew)}peek(e){return super.get(e,s.None)}set(e,t){super.set(e,t,s.AsNew),this.checkTrim()}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}},48456:(e,t,i)=>{function n(e,t,i){let n=!1;return e.then((e=>{n=!0})),setTimeout((()=>{n||i()}),t),e}i.d(t,{Rf:()=>n})},31934:(e,t,i)=>{i.d(t,{A2:()=>s,Jy:()=>o,hT:()=>n});const n={li:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},a:{attrs:[{key:"href",getter:e=>e.href}]},code:{},strong:{},i:{},em:{},cite:{},ol:{}},s=Object.keys(n),o=["code"]},46246:(e,t,i)=>{i.d(t,{Oq:()=>b,XG:()=>p,_M:()=>h,dD:()=>m,j_:()=>f,k2:()=>v,tW:()=>g,vN:()=>_});var n=i(44557),s=i(83894),o=i(81407),r=i(76049),a=i(35482),l=i(11003),c=i(94682),d=i(70053),u=i(66221);function h(e,t){const{limit_time:i,limit_tips:n}=t.ext||{};e.updateRateLimitConfig({isLimited:!0,limitExpired:Date.now()+1e3*Number(i)||0,limitTips:n})}function v(e,t){u.B.emit("guest.reachLimit",{conversation_id:t.conversation_id});const{conversation_id:i,local_message_id:n}=t;i&&n&&e.updateMessageList({conversationId:i,immerUpdate:(...e)=>{const[t]=e;(0,a.k)(t,{isLocalMessage:!0,messageId:n}),(0,a.hT)(t)}})}function m(e,t){c.pU.getState().setGuestReachCreateThreadLimit(!0),u.B.emit("guest.reachThreadLimitError");const{conversation_id:i,local_message_id:n}=t;i&&n&&e.updateMessageList({conversationId:i,immerUpdate:(...e)=>{const[t]=e;(0,a.k)(t,{isLocalMessage:!0,messageId:n}),(0,a.hT)(t)}})}function p(e,t){var i;if(t.conversation_id)if((null==t||null===(i=t.ext)||void 0===i?void 0:i.has_err)===String(s.t.BOT_REVIEWING)){const e=(0,d.Xc)(c.pU.getState(),t.conversation_id);l.C.actions.updateBot({id:e,disabled:!0})}else c.pU.getState().fetchUpdateConversationInfo(t.conversation_id)}function g(e,t){const{conversation_id:i,reply_id:n,message_id:s}=t;i&&n&&s&&(0,a.k)(e,{isLocalMessage:!1,messageId:n})}function f(e,t){if(!t.conversation_id)return void o.g.emit(o.P.CONVERSATION_INVALID);const{removeConversationFromLinks:i,removeConversationFromMap:n}=c.pU.getState();i({conversationId:t.conversation_id}),n({conversationId:t.conversation_id}),o.g.emit(o.P.CONVERSATION_INVALID)}function _(e){var t;o.g.emit(o.P.USER_BANNED,null==e||null===(t=e.ext)||void 0===t?void 0:t.err_msg)}function b(e,t){const{conversation_id:i,local_message_id:s}=t;i&&s?e.updateMessageList({conversationId:i,immerUpdate:(...e)=>{const[i]=e,o=i.draftLocalMessageMap[s];o.local=(0,n.A)((0,n.A)({},o.local),{},{status:r.FQ.SafetyError,failed:!0}),o.ext=(0,n.A)((0,n.A)({},o.ext),t.ext),(0,a.hT)(i)}}):console.error("Unexpected: handleImageSafetyError no conversation_id or no local_message_id.")}},96744:(e,t,i)=>{i.d(t,{h:()=>s});var n=i(98101);const s=()=>(e=>{const{userOgf:t}=e;if(null!=t&&t.featureEnabled)return null!=t&&t.value?1:0})(n.oz.getState())},82474:(e,t,i)=>{i.d(t,{P:()=>v});var n=i(44557),s=i(5099),o=i(36266),r=i(33664),a=i(97327),l=i(68843),c=i(33187),d=i(25334),u=i(60737);function h(e,t,i,c){if(!i||!(0,l.xX)(i)||!i.local_message_id||(0,l.wt)(i))return;const{message_id:h,local_message_id:v,reply_id:m}=i,p=e.getState();if((0,l.e1)(i)||(0,l.ET)(i))return p.finishSendMessageTask(v),void p.updateMessageList({conversationId:t,immerUpdate:e=>{const{draftLocalMessageMap:t}=e,n=t[(null==i?void 0:i.local_message_id)||""];n&&(n.local.hasBroken=!0)}});if((0,l.Qk)(i)||(0,l.Ys)(i)){(0,u.PF)(m||""),(0,l.Wi)(i)?p.updateMessageList({conversationId:t,immerUpdate:({draftLocalMessageMap:e})=>{const t=e[v||""];t&&(t.local.hasBroken=!0,t.status=r.q7.InVisible)}}):(0,l.EK)(i)&&h&&(0,d.P)(e,(0,n.A)((0,n.A)({conversation_id:t,message_id:h},(0,s.A)(i,["local","local_message_id"])),{},{status:r.q7.Broken,ext:(0,n.A)((0,n.A)({},i.ext),{},{is_finish:"1"})}));const g=m||h,f=(0,o.XB)({eventName:"break_message"});a.j.apiService.message.MessageReport({reply_id:g,conversation_id:t,action:"break"}).then((()=>{f.addDurationPoint("success"),f.success()}),(e=>{f.error({reason:"break message failed",error:e,meta:{replyId:g,conversation_id:t}}),null==c||c()}))}}function v(e,t){const i=e.getState();h(e,t,(0,c.qo)(i,t));const n=(0,c.qo)(i,t);(0,l.nt)(n)&&h(e,t,n)}},55329:(e,t,i)=>{i.d(t,{P:()=>n.P});var n=i(82474)},32608:(e,t,i)=>{i.d(t,{Bq:()=>o});var n=i(44557),s=i(48869);const o=e=>{var t;if(!(e=>{if("string"==typeof e)try{const t=JSON.parse(e);return!("object"!=typeof t||!t)}catch(t){return!1}return!1})(e))return!1;const i=JSON.parse(e);if(!i.some((e=>r(null==e?void 0:e.timestamp))))return!1;return null==i||null===(t=i.filter((e=>r(null==e?void 0:e.timestamp)&&e.section)))||void 0===t?void 0:t.map((e=>{var t;if(e.bullet_points&&(null===(t=e.bullet_points)||void 0===t?void 0:t.length)>0){const t=e.bullet_points.filter((e=>r(null==e?void 0:e.timestamp)&&e.point)),i=(0,s.A)(t,"timestamp",["asc"]);return(0,n.A)((0,n.A)({},e),{},{bullet_points:i})}}))},r=e=>Number(e)>=0},64498:(e,t,i)=>{i.d(t,{$_:()=>n});const n="data-img-tos-key"},23718:(e,t,i)=>{i.d(t,{e:()=>n});let n=function(e){return e.VideoSummary="VideoSummary",e.SearchResult="SearchResult",e.TextFragment="TextFragment",e.TranslateResult="TranslateResult",e.ExplainResult="ExplainResult",e.Web="Web",e.Pdf="pdf",e.SocialWebCard="SocialWebCard",e}({})},85204:(e,t,i)=>{i.d(t,{OM:()=>n});i(80160);function n(){return/youtube/.test(location.hostname)?!!location.pathname.startsWith("/watch"):!!/bilibili/.test(location.hostname)&&!!location.pathname.startsWith("/video/")}},37114:(e,t,i)=>{i.d(t,{A:()=>o});var n=i(21511),s=i(92431);const o={length(e){let t=0,i=0;for(let n=0;n<e.length;++n)i=e.charCodeAt(n),i<128?t+=1:i<2048?t+=2:55296==(64512&i)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},read(e,t,i){if(i-t<1)return"";let n="";for(let s=t;s<i;){const t=e[s++];if(t<=127)n+=String.fromCharCode(t);else if(t>=192&&t<224)n+=String.fromCharCode((31&t)<<6|63&e[s++]);else if(t>=224&&t<240)n+=String.fromCharCode((15&t)<<12|(63&e[s++])<<6|63&e[s++]);else if(t>=240){const i=((7&t)<<18|(63&e[s++])<<12|(63&e[s++])<<6|63&e[s++])-65536;n+=String.fromCharCode(55296+(i>>10)),n+=String.fromCharCode(56320+(1023&i))}}return n},write(e,t,i){const n=i;let s,o;for(let r=0;r<e.length;++r)s=e.charCodeAt(r),s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=63&s|128):55296==(64512&s)&&56320==(64512&(o=e.charCodeAt(r+1)))?(s=65536+((1023&s)<<10)+(1023&o),++r,t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=63&s|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=63&s|128);return i-n},posCalcRange(e,t){let i=0;const o={};let r=(0,s.A)(t);r=(0,n.A)(r.sort(((e,t)=>e-t)));for(let n=0;n<e.length&&(i===r[0]&&(o[r[0]]=n,r.shift()),55296==(64512&e[n].charCodeAt(0))&&56320==(64512&e[n+1].charCodeAt(0))?(i+=this.length(`${e[n]}${e[n+1]}`),n++):i+=this.length(e[n]),r.length);n++);return o},posCalc(e,t){let i="",n=0;for(let s=0;s<e.length;s++)if(i+=e[s],this.length(i)===t)return n=s+1,n;return n}}},44859:(e,t,i)=>{i.d(t,{A:()=>n});const n={toastContainer:"toastContainer-jcLkom",text:"text-ELyTEi",loadingText:"loadingText-pUEs4H",errorText:"errorText-s3voUO",linkToInfo:"linkToInfo-S7mz4k",toastCard:"toastCard-r9ido1",toastLoadingCard:"toastLoadingCard-twMuk9",toastErrorCard:"toastErrorCard-FBzVqH"}},66956:(e,t,i)=>{i.d(t,{A:()=>n});const n={isContentAliginLeft:"isContentAliginLeft-EVm25k",contentContainer:"contentContainer-Iw2rQe","popover-container":"popover-container-uaJ7XT",popoverContainer:"popover-container-uaJ7XT"}}}]);